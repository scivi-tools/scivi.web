var SciViFSGraph="object"==typeof SciViFSGraph?SciViFSGraph:{};SciViFSGraph.main=function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./src/index.ts")}({"./modified_modules/NonRandomLouvain/index.js":function(t,e,n){var i=n("./modified_modules/NonRandomLouvain/lib/createCommunityGraph.js"),s=n("./modified_modules/NonRandomLouvain/lib/createCommunity.js");t.exports=function(t,e){var n=i(t),r=s(n,e),o=r.modularity(),a=r.optimizeModularity(),l=r.modularity();return{canCoarse:function(){return a},originalModularity:o,newModularity:l,getClass:function(t){var e=n.getNodeIdFromNgraph(t);return r.getClass(e)}}}},"./modified_modules/NonRandomLouvain/lib/createCommunity.js":function(t,e){t.exports=function(t,e){for(var n=t.weight,i=t.nodeCount,s=new Float32Array(i),r=new Float32Array(i),o=new Uint32Array(i),a=0;a<i;++a)o[a]=a,s[a]=t.getWeightedDegree(a),r[a]=t.getSelfLoopsCount(a);return{modularity:d,optimizeModularity:function(){var e,n,s=function(){for(var t=[],e=0;e<i;++e)t[e]=e;return t}(),r=d(),a=!1;do{n=0,e=r;for(var g=0;g<s.length;++g){var p=s[g],f=o[p],m=l(p),_=m.get(f);u(p,f,_);var v=t.getWeightedDegree(p),y=f,b=0;m.forEach(function(t,e){var n=h(t,e,v);n<=b||(y=e,b=n)});var x=m.get(y);c(p,y,x),y!==f&&(n+=1)}r=d(),n>0&&(a=!0)}while(n>0&&r-e>1e-6);return a},getClass:function(t){return o[t]}};function l(e){var n=new Map;return n.set(o[e],0),t.forEachNeigbour(e,function(t,e){var i=o[t],s=n.get(i)||0;n.set(i,s+e)}),n}function h(t,e,i){var r=s[e];return t-r*i/n}function u(e,n,i){s[n]-=t.getWeightedDegree(e),r[n]-=2*i+t.getSelfLoopsCount(e),o[e]=-1}function c(e,n,i){s[n]+=t.getWeightedDegree(e),r[n]+=2*i+t.getSelfLoopsCount(e),o[e]=n}function d(){for(var t=0,e=0;e<i;++e)if(s[e]>0){var o=s[e]/n;t+=r[e]/n-o*o}return t}}},"./modified_modules/NonRandomLouvain/lib/createCommunityGraph.js":function(t,e){t.exports=function(t){var e=t.getNodesCount(),n=0,i=[],s=new Map;return t.forEachNode(function(t){var e,n;e=t.id,n=i.length,s.set(e,n),i.push({selfLoopsCount:0,weightedDegree:0,neighbours:null})}),t.forEachLink(function(t){var e,n=r(t.fromId),s=r(t.toId),a=(e=t.data)?"number"==typeof e?e:"number"==typeof e.weight?e.weight:1:1,l=i[n],h=i[s];n===s?(l.selfLoopsCount+=a,l.weightedDegree+=a):(o(l,s,a),o(h,n,a),l.weightedDegree+=a,h.weightedDegree+=a)}),n=function(){for(var t=0,n=0;n<e;++n)t+=a(n);return t}(),{nodeCount:e,weight:n,forEachNeigbour:function(t,e){var n=l(t);if(n.neighbours)for(var i=0;i<n.neighbours.length;++i){var s=n.neighbours[i];e(s.id,s.weight)}},getWeightedDegree:a,getSelfLoopsCount:function(t){return l(t).selfLoopsCount},getNodeIdFromNgraph:r};function r(t){var e=s.get(t);if(void 0===e)throw new Error("Unknown node id: "+t);return e}function o(t,e,n){var i={id:e,weight:n};t.neighbours?t.neighbours.push(i):t.neighbours=[i]}function a(t){return l(t).weightedDegree}function l(t){var e=i[t];if(!e)throw new Error("cannot find node with id: "+t);return e}}},"./modified_modules/tsm/constants.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"epsilon",function(){return i});const i=1e-5},"./modified_modules/tsm/mat2.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return r});var i=n("./modified_modules/tsm/vec2.ts"),s=n("./modified_modules/tsm/constants.ts");class r{constructor(t){this.values=new Float32Array(4),void 0!==t&&this.init(t)}at(t){return this.values[t]}init(t){for(let e=0;e<4;e++)this.values[e]=t[e];return this}reset(){for(let t=0;t<4;t++)this.values[t]=0}copy(t){t||(t=new r);for(let e=0;e<4;e++)t.values[e]=this.values[e];return t}all(){const t=[];for(let e=0;e<4;e++)t[e]=this.values[e];return t}row(t){return[this.values[2*t+0],this.values[2*t+1]]}col(t){return[this.values[t],this.values[t+2]]}equals(t,e=s.epsilon){for(let n=0;n<4;n++)if(Math.abs(this.values[n]-t.at(n))>e)return!1;return!0}determinant(){return this.values[0]*this.values[3]-this.values[2]*this.values[1]}setIdentity(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=1,this}transpose(){const t=this.values[1];return this.values[1]=this.values[2],this.values[2]=t,this}inverse(){let t=this.determinant();if(!t)return null;t=1/t;const e=this.values[0];return this.values[0]=t*this.values[3],this.values[1]=t*-this.values[1],this.values[2]=t*-this.values[2],this.values[3]=t*e,this}multiply(t){const e=this.values[0],n=this.values[1],i=this.values[2],s=this.values[3];return this.values[0]=e*t.at(0)+n*t.at(2),this.values[1]=e*t.at(1)+n*t.at(3),this.values[2]=i*t.at(0)+s*t.at(2),this.values[3]=i*t.at(1)+s*t.at(3),this}rotate(t){const e=this.values[0],n=this.values[1],i=this.values[2],s=this.values[3],r=Math.sin(t),o=Math.cos(t);return this.values[0]=e*o+n*r,this.values[1]=e*-r+n*o,this.values[2]=i*o+s*r,this.values[3]=i*-r+s*o,this}multiplyVec2(t,e){const n=t.x,s=t.y;return e?(e.xy=[n*this.values[0]+s*this.values[1],n*this.values[2]+s*this.values[3]],e):new i.default([n*this.values[0]+s*this.values[1],n*this.values[2]+s*this.values[3]])}scale(t){const e=this.values[0],n=this.values[1],i=this.values[2],s=this.values[3],r=t.x,o=t.y;return this.values[0]=e*r,this.values[1]=n*o,this.values[2]=i*r,this.values[3]=s*o,this}static product(t,e,n){const i=t.at(0),s=t.at(1),o=t.at(2),a=t.at(3);return n?(n.init([i*e.at(0)+s*e.at(2),i*e.at(1)+s*e.at(3),o*e.at(0)+a*e.at(2),o*e.at(1)+a*e.at(3)]),n):new r([i*e.at(0)+s*e.at(2),i*e.at(1)+s*e.at(3),o*e.at(0)+a*e.at(2),o*e.at(1)+a*e.at(3)])}}r.identity=(new r).setIdentity()},"./modified_modules/tsm/mat3.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return l});var i=n("./modified_modules/tsm/mat4.ts"),s=n("./modified_modules/tsm/quat.ts"),r=n("./modified_modules/tsm/vec2.ts"),o=n("./modified_modules/tsm/vec3.ts"),a=n("./modified_modules/tsm/constants.ts");class l{constructor(t){this.values=new Float32Array(9),void 0!==t&&this.init(t)}at(t){return this.values[t]}init(t){for(let e=0;e<9;e++)this.values[e]=t[e];return this}reset(){for(let t=0;t<9;t++)this.values[t]=0}copy(t){t||(t=new l);for(let e=0;e<9;e++)t.values[e]=this.values[e];return t}all(){const t=[];for(let e=0;e<9;e++)t[e]=this.values[e];return t}row(t){return[this.values[3*t+0],this.values[3*t+1],this.values[3*t+2]]}col(t){return[this.values[t],this.values[t+3],this.values[t+6]]}equals(t,e=a.epsilon){for(let n=0;n<9;n++)if(Math.abs(this.values[n]-t.at(n))>e)return!1;return!0}determinant(){const t=this.values[0],e=this.values[1],n=this.values[2],i=this.values[3],s=this.values[4],r=this.values[5],o=this.values[6],a=this.values[7],l=this.values[8];return t*(l*s-r*a)+e*(-l*i+r*o)+n*(a*i-s*o)}setIdentity(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=0,this.values[4]=1,this.values[5]=0,this.values[6]=0,this.values[7]=0,this.values[8]=1,this}transpose(){const t=this.values[1],e=this.values[2],n=this.values[5];return this.values[1]=this.values[3],this.values[2]=this.values[6],this.values[3]=t,this.values[5]=this.values[7],this.values[6]=e,this.values[7]=n,this}inverse(){const t=this.values[0],e=this.values[1],n=this.values[2],i=this.values[3],s=this.values[4],r=this.values[5],o=this.values[6],a=this.values[7],l=this.values[8],h=l*s-r*a,u=-l*i+r*o,c=a*i-s*o;let d=t*h+e*u+n*c;return d?(d=1/d,this.values[0]=h*d,this.values[1]=(-l*e+n*a)*d,this.values[2]=(r*e-n*s)*d,this.values[3]=u*d,this.values[4]=(l*t-n*o)*d,this.values[5]=(-r*t+n*i)*d,this.values[6]=c*d,this.values[7]=(-a*t+e*o)*d,this.values[8]=(s*t-e*i)*d,this):null}multiply(t){const e=this.values[0],n=this.values[1],i=this.values[2],s=this.values[3],r=this.values[4],o=this.values[5],a=this.values[6],l=this.values[7],h=this.values[8],u=t.at(0),c=t.at(1),d=t.at(2),g=t.at(3),p=t.at(4),f=t.at(5),m=t.at(6),_=t.at(7),v=t.at(8);return this.values[0]=u*e+c*s+d*a,this.values[1]=u*n+c*r+d*l,this.values[2]=u*i+c*o+d*h,this.values[3]=g*e+p*s+f*a,this.values[4]=g*n+p*r+f*l,this.values[5]=g*i+p*o+f*h,this.values[6]=m*e+_*s+v*a,this.values[7]=m*n+_*r+v*l,this.values[8]=m*i+_*o+v*h,this}multiplyVec2(t,e){const n=t.x,i=t.y;return e?(e.xy=[n*this.values[0]+i*this.values[3]+this.values[6],n*this.values[1]+i*this.values[4]+this.values[7]],e):new r.default([n*this.values[0]+i*this.values[3]+this.values[6],n*this.values[1]+i*this.values[4]+this.values[7]])}multiplyVec3(t,e){const n=t.x,i=t.y,s=t.z;return e?(e.xyz=[n*this.values[0]+i*this.values[3]+s*this.values[6],n*this.values[1]+i*this.values[4]+s*this.values[7],n*this.values[2]+i*this.values[5]+s*this.values[8]],e):new o.default([n*this.values[0]+i*this.values[3]+s*this.values[6],n*this.values[1]+i*this.values[4]+s*this.values[7],n*this.values[2]+i*this.values[5]+s*this.values[8]])}toMat4(t){return t?(t.init([this.values[0],this.values[1],this.values[2],0,this.values[3],this.values[4],this.values[5],0,this.values[6],this.values[7],this.values[8],0,0,0,0,1]),t):new i.default([this.values[0],this.values[1],this.values[2],0,this.values[3],this.values[4],this.values[5],0,this.values[6],this.values[7],this.values[8],0,0,0,0,1])}toQuat(){const t=this.values[0],e=this.values[1],n=this.values[2],i=this.values[3],r=this.values[4],o=this.values[5],a=this.values[6],l=this.values[7],h=this.values[8],u=t-r-h,c=r-t-h,d=h-t-r;let g=0,p=t+r+h;u>p&&(p=u,g=1),c>p&&(p=c,g=2),d>p&&(p=d,g=3);const f=.5*Math.sqrt(p+1),m=.25/f,_=new s.default;switch(g){case 0:_.w=f,_.x=(o-l)*m,_.y=(a-n)*m,_.z=(e-i)*m;break;case 1:_.w=(o-l)*m,_.x=f,_.y=(e+i)*m,_.z=(a+n)*m;break;case 2:_.w=(a-n)*m,_.x=(e+i)*m,_.y=f,_.z=(o+l)*m;break;case 3:_.w=(e-i)*m,_.x=(a+n)*m,_.y=(o+l)*m,_.z=f}return _}rotate(t,e){let n=e.x,i=e.y,s=e.z,r=Math.sqrt(n*n+i*i+s*s);if(!r)return null;1!==r&&(n*=r=1/r,i*=r,s*=r);const o=Math.sin(t),a=Math.cos(t),l=1-a,h=this.values[0],u=this.values[1],c=this.values[2],d=this.values[4],g=this.values[5],p=this.values[6],f=this.values[8],m=this.values[9],_=this.values[10],v=n*n*l+a,y=i*n*l+s*o,b=s*n*l-i*o,x=n*i*l-s*o,w=i*i*l+a,E=s*i*l+n*o,S=n*s*l+i*o,k=i*s*l-n*o,z=s*s*l+a;return this.values[0]=h*v+d*y+f*b,this.values[1]=u*v+g*y+m*b,this.values[2]=c*v+p*y+_*b,this.values[3]=h*x+d*w+f*E,this.values[4]=u*x+g*w+m*E,this.values[5]=c*x+p*w+_*E,this.values[6]=h*S+d*k+f*z,this.values[7]=u*S+g*k+m*z,this.values[8]=c*S+p*k+_*z,this}static product(t,e,n){const i=t.at(0),s=t.at(1),r=t.at(2),o=t.at(3),a=t.at(4),h=t.at(5),u=t.at(6),c=t.at(7),d=t.at(8),g=e.at(0),p=e.at(1),f=e.at(2),m=e.at(3),_=e.at(4),v=e.at(5),y=e.at(6),b=e.at(7),x=e.at(8);return n?(n.init([g*i+p*o+f*u,g*s+p*a+f*c,g*r+p*h+f*d,m*i+_*o+v*u,m*s+_*a+v*c,m*r+_*h+v*d,y*i+b*o+x*u,y*s+b*a+x*c,y*r+b*h+x*d]),n):new l([g*i+p*o+f*u,g*s+p*a+f*c,g*r+p*h+f*d,m*i+_*o+v*u,m*s+_*a+v*c,m*r+_*h+v*d,y*i+b*o+x*u,y*s+b*a+x*c,y*r+b*h+x*d])}}l.identity=(new l).setIdentity()},"./modified_modules/tsm/mat4.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return a});var i=n("./modified_modules/tsm/mat3.ts"),s=n("./modified_modules/tsm/vec3.ts"),r=n("./modified_modules/tsm/vec4.ts"),o=n("./modified_modules/tsm/constants.ts");class a{constructor(t){this.values=new Float32Array(16),void 0!==t&&this.init(t)}at(t){return this.values[t]}init(t){for(let e=0;e<16;e++)this.values[e]=t[e];return this}reset(){for(let t=0;t<16;t++)this.values[t]=0}copy(t){t||(t=new a);for(let e=0;e<16;e++)t.values[e]=this.values[e];return t}all(){const t=[];for(let e=0;e<16;e++)t[e]=this.values[e];return t}row(t){return[this.values[4*t+0],this.values[4*t+1],this.values[4*t+2],this.values[4*t+3]]}col(t){return[this.values[t],this.values[t+4],this.values[t+8],this.values[t+12]]}equals(t,e=o.epsilon){for(let n=0;n<16;n++)if(Math.abs(this.values[n]-t.at(n))>e)return!1;return!0}determinant(){const t=this.values[0],e=this.values[1],n=this.values[2],i=this.values[3],s=this.values[4],r=this.values[5],o=this.values[6],a=this.values[7],l=this.values[8],h=this.values[9],u=this.values[10],c=this.values[11],d=this.values[12],g=this.values[13],p=this.values[14],f=this.values[15];return(t*r-e*s)*(u*f-c*p)-(t*o-n*s)*(h*f-c*g)+(t*a-i*s)*(h*p-u*g)+(e*o-n*r)*(l*f-c*d)-(e*a-i*r)*(l*p-u*d)+(n*a-i*o)*(l*g-h*d)}setIdentity(){return this.values[0]=1,this.values[1]=0,this.values[2]=0,this.values[3]=0,this.values[4]=0,this.values[5]=1,this.values[6]=0,this.values[7]=0,this.values[8]=0,this.values[9]=0,this.values[10]=1,this.values[11]=0,this.values[12]=0,this.values[13]=0,this.values[14]=0,this.values[15]=1,this}transpose(){const t=this.values[1],e=this.values[2],n=this.values[3],i=this.values[6],s=this.values[7],r=this.values[11];return this.values[1]=this.values[4],this.values[2]=this.values[8],this.values[3]=this.values[12],this.values[4]=t,this.values[6]=this.values[9],this.values[7]=this.values[13],this.values[8]=e,this.values[9]=i,this.values[11]=this.values[14],this.values[12]=n,this.values[13]=s,this.values[14]=r,this}inverse(){const t=this.values[0],e=this.values[1],n=this.values[2],i=this.values[3],s=this.values[4],r=this.values[5],o=this.values[6],a=this.values[7],l=this.values[8],h=this.values[9],u=this.values[10],c=this.values[11],d=this.values[12],g=this.values[13],p=this.values[14],f=this.values[15],m=t*r-e*s,_=t*o-n*s,v=t*a-i*s,y=e*o-n*r,b=e*a-i*r,x=n*a-i*o,w=l*g-h*d,E=l*p-u*d,S=l*f-c*d,k=h*p-u*g,z=h*f-c*g,j=u*f-c*p;let A=m*j-_*z+v*k+y*S-b*E+x*w;return A?(A=1/A,this.values[0]=(r*j-o*z+a*k)*A,this.values[1]=(-e*j+n*z-i*k)*A,this.values[2]=(g*x-p*b+f*y)*A,this.values[3]=(-h*x+u*b-c*y)*A,this.values[4]=(-s*j+o*S-a*E)*A,this.values[5]=(t*j-n*S+i*E)*A,this.values[6]=(-d*x+p*v-f*_)*A,this.values[7]=(l*x-u*v+c*_)*A,this.values[8]=(s*z-r*S+a*w)*A,this.values[9]=(-t*z+e*S-i*w)*A,this.values[10]=(d*b-g*v+f*m)*A,this.values[11]=(-l*b+h*v-c*m)*A,this.values[12]=(-s*k+r*E-o*w)*A,this.values[13]=(t*k-e*E+n*w)*A,this.values[14]=(-d*y+g*_-p*m)*A,this.values[15]=(l*y-h*_+u*m)*A,this):null}multiply(t){const e=this.values[0],n=this.values[1],i=this.values[2],s=this.values[3],r=this.values[4],o=this.values[5],a=this.values[6],l=this.values[7],h=this.values[8],u=this.values[9],c=this.values[10],d=this.values[11],g=this.values[12],p=this.values[13],f=this.values[14],m=this.values[15];let _=t.at(0),v=t.at(1),y=t.at(2),b=t.at(3);return this.values[0]=_*e+v*r+y*h+b*g,this.values[1]=_*n+v*o+y*u+b*p,this.values[2]=_*i+v*a+y*c+b*f,this.values[3]=_*s+v*l+y*d+b*m,_=t.at(4),v=t.at(5),y=t.at(6),b=t.at(7),this.values[4]=_*e+v*r+y*h+b*g,this.values[5]=_*n+v*o+y*u+b*p,this.values[6]=_*i+v*a+y*c+b*f,this.values[7]=_*s+v*l+y*d+b*m,_=t.at(8),v=t.at(9),y=t.at(10),b=t.at(11),this.values[8]=_*e+v*r+y*h+b*g,this.values[9]=_*n+v*o+y*u+b*p,this.values[10]=_*i+v*a+y*c+b*f,this.values[11]=_*s+v*l+y*d+b*m,_=t.at(12),v=t.at(13),y=t.at(14),b=t.at(15),this.values[12]=_*e+v*r+y*h+b*g,this.values[13]=_*n+v*o+y*u+b*p,this.values[14]=_*i+v*a+y*c+b*f,this.values[15]=_*s+v*l+y*d+b*m,this}multiplyVec3(t){const e=t.x,n=t.y,i=t.z;return new s.default([this.values[0]*e+this.values[4]*n+this.values[8]*i+this.values[12],this.values[1]*e+this.values[5]*n+this.values[9]*i+this.values[13],this.values[2]*e+this.values[6]*n+this.values[10]*i+this.values[14]])}multiplyVec4(t,e){e||(e=new r.default);const n=t.x,i=t.y,s=t.z,o=t.w;return e.x=this.values[0]*n+this.values[4]*i+this.values[8]*s+this.values[12]*o,e.y=this.values[1]*n+this.values[5]*i+this.values[9]*s+this.values[13]*o,e.z=this.values[2]*n+this.values[6]*i+this.values[10]*s+this.values[14]*o,e.w=this.values[3]*n+this.values[7]*i+this.values[11]*s+this.values[15]*o,e}toMat3(){return new i.default([this.values[0],this.values[1],this.values[2],this.values[4],this.values[5],this.values[6],this.values[8],this.values[9],this.values[10]])}toInverseMat3(){const t=this.values[0],e=this.values[1],n=this.values[2],s=this.values[4],r=this.values[5],o=this.values[6],a=this.values[8],l=this.values[9],h=this.values[10],u=h*r-o*l,c=-h*s+o*a,d=l*s-r*a;let g=t*u+e*c+n*d;return g?(g=1/g,new i.default([u*g,(-h*e+n*l)*g,(o*e-n*r)*g,c*g,(h*t-n*a)*g,(-o*t+n*s)*g,d*g,(-l*t+e*a)*g,(r*t-e*s)*g])):null}translate(t){const e=t.x,n=t.y,i=t.z;return this.values[12]+=this.values[0]*e+this.values[4]*n+this.values[8]*i,this.values[13]+=this.values[1]*e+this.values[5]*n+this.values[9]*i,this.values[14]+=this.values[2]*e+this.values[6]*n+this.values[10]*i,this.values[15]+=this.values[3]*e+this.values[7]*n+this.values[11]*i,this}scale(t){const e=t.x,n=t.y,i=t.z;return this.values[0]*=e,this.values[1]*=e,this.values[2]*=e,this.values[3]*=e,this.values[4]*=n,this.values[5]*=n,this.values[6]*=n,this.values[7]*=n,this.values[8]*=i,this.values[9]*=i,this.values[10]*=i,this.values[11]*=i,this}rotate(t,e){let n=e.x,i=e.y,s=e.z,r=Math.sqrt(n*n+i*i+s*s);if(!r)return null;1!==r&&(n*=r=1/r,i*=r,s*=r);const o=Math.sin(t),a=Math.cos(t),l=1-a,h=this.values[0],u=this.values[1],c=this.values[2],d=this.values[3],g=this.values[4],p=this.values[5],f=this.values[6],m=this.values[7],_=this.values[8],v=this.values[9],y=this.values[10],b=this.values[11],x=n*n*l+a,w=i*n*l+s*o,E=s*n*l-i*o,S=n*i*l-s*o,k=i*i*l+a,z=s*i*l+n*o,j=n*s*l+i*o,A=i*s*l-n*o,C=s*s*l+a;return this.values[0]=h*x+g*w+_*E,this.values[1]=u*x+p*w+v*E,this.values[2]=c*x+f*w+y*E,this.values[3]=d*x+m*w+b*E,this.values[4]=h*S+g*k+_*z,this.values[5]=u*S+p*k+v*z,this.values[6]=c*S+f*k+y*z,this.values[7]=d*S+m*k+b*z,this.values[8]=h*j+g*A+_*C,this.values[9]=u*j+p*A+v*C,this.values[10]=c*j+f*A+y*C,this.values[11]=d*j+m*A+b*C,this}static frustum(t,e,n,i,s,r){const o=e-t,l=i-n,h=r-s;return new a([2*s/o,0,0,0,0,2*s/l,0,0,(e+t)/o,(i+n)/l,-(r+s)/h,-1,0,0,-r*s*2/h,0])}static perspective(t,e,n,i){const s=n*Math.tan(t*Math.PI/360),r=s*e;return a.frustum(-r,r,-s,s,n,i)}static orthographic(t,e,n,i,s,r){const o=e-t,l=i-n,h=r-s;return new a([2/o,0,0,0,0,2/l,0,0,0,0,-2/h,0,-(t+e)/o,-(i+n)/l,-(r+s)/h,1])}static lookAt(t,e,n=s.default.up){if(t.equals(e))return this.identity;const i=s.default.difference(t,e).normalize(),r=s.default.cross(n,i).normalize(),o=s.default.cross(i,r).normalize();return new a([r.x,o.x,i.x,0,r.y,o.y,i.y,0,r.z,o.z,i.z,0,-s.default.dot(r,t),-s.default.dot(o,t),-s.default.dot(i,t),1])}static product(t,e,n){const i=t.at(0),s=t.at(1),r=t.at(2),o=t.at(3),l=t.at(4),h=t.at(5),u=t.at(6),c=t.at(7),d=t.at(8),g=t.at(9),p=t.at(10),f=t.at(11),m=t.at(12),_=t.at(13),v=t.at(14),y=t.at(15),b=e.at(0),x=e.at(1),w=e.at(2),E=e.at(3),S=e.at(4),k=e.at(5),z=e.at(6),j=e.at(7),A=e.at(8),C=e.at(9),O=e.at(10),N=e.at(11),L=e.at(12),M=e.at(13),T=e.at(14),R=e.at(15);return n?(n.init([b*i+x*l+w*d+E*m,b*s+x*h+w*g+E*_,b*r+x*u+w*p+E*v,b*o+x*c+w*f+E*y,S*i+k*l+z*d+j*m,S*s+k*h+z*g+j*_,S*r+k*u+z*p+j*v,S*o+k*c+z*f+j*y,A*i+C*l+O*d+N*m,A*s+C*h+O*g+N*_,A*r+C*u+O*p+N*v,A*o+C*c+O*f+N*y,L*i+M*l+T*d+R*m,L*s+M*h+T*g+R*_,L*r+M*u+T*p+R*v,L*o+M*c+T*f+R*y]),n):new a([b*i+x*l+w*d+E*m,b*s+x*h+w*g+E*_,b*r+x*u+w*p+E*v,b*o+x*c+w*f+E*y,S*i+k*l+z*d+j*m,S*s+k*h+z*g+j*_,S*r+k*u+z*p+j*v,S*o+k*c+z*f+j*y,A*i+C*l+O*d+N*m,A*s+C*h+O*g+N*_,A*r+C*u+O*p+N*v,A*o+C*c+O*f+N*y,L*i+M*l+T*d+R*m,L*s+M*h+T*g+R*_,L*r+M*u+T*p+R*v,L*o+M*c+T*f+R*y])}}a.identity=(new a).setIdentity()},"./modified_modules/tsm/quat.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return a});var i=n("./modified_modules/tsm/mat3.ts"),s=n("./modified_modules/tsm/mat4.ts"),r=n("./modified_modules/tsm/vec3.ts"),o=n("./modified_modules/tsm/constants.ts");class a{constructor(t){this.values=new Float32Array(4),void 0!==t&&(this.xyzw=t)}get x(){return this.values[0]}get y(){return this.values[1]}get z(){return this.values[2]}get w(){return this.values[3]}get xy(){return[this.values[0],this.values[1]]}get xyz(){return[this.values[0],this.values[1],this.values[2]]}get xyzw(){return[this.values[0],this.values[1],this.values[2],this.values[3]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set z(t){this.values[2]=t}set w(t){this.values[3]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}set xyz(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}set xyzw(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]}at(t){return this.values[t]}reset(){for(let t=0;t<4;t++)this.values[t]=0}copy(t){t||(t=new a);for(let e=0;e<4;e++)t.values[e]=this.values[e];return t}roll(){const t=this.x,e=this.y,n=this.z,i=this.w;return Math.atan2(2*(t*e+i*n),i*i+t*t-e*e-n*n)}pitch(){const t=this.x,e=this.y,n=this.z,i=this.w;return Math.atan2(2*(e*n+i*t),i*i-t*t-e*e+n*n)}yaw(){return Math.asin(2*(this.x*this.z-this.w*this.y))}equals(t,e=o.epsilon){for(let n=0;n<4;n++)if(Math.abs(this.values[n]-t.at(n))>e)return!1;return!0}setIdentity(){return this.x=0,this.y=0,this.z=0,this.w=1,this}calculateW(){const t=this.x,e=this.y,n=this.z;return this.w=-Math.sqrt(Math.abs(1-t*t-e*e-n*n)),this}inverse(){const t=a.dot(this,this);if(!t)return this.xyzw=[0,0,0,0],this;const e=t?1/t:0;return this.x*=-e,this.y*=-e,this.z*=-e,this.w*=e,this}conjugate(){return this.values[0]*=-1,this.values[1]*=-1,this.values[2]*=-1,this}length(){const t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)}normalize(t){t||(t=this);const e=this.x,n=this.y,i=this.z,s=this.w;let r=Math.sqrt(e*e+n*n+i*i+s*s);return r?(r=1/r,t.x=e*r,t.y=n*r,t.z=i*r,t.w=s*r,t):(t.x=0,t.y=0,t.z=0,t.w=0,t)}add(t){for(let e=0;e<4;e++)this.values[e]+=t.at(e);return this}multiply(t){const e=this.values[0],n=this.values[1],i=this.values[2],s=this.values[3],r=t.x,o=t.y,a=t.z,l=t.w;return this.x=e*l+s*r+n*a-i*o,this.y=n*l+s*o+i*r-e*a,this.z=i*l+s*a+e*o-n*r,this.w=s*l-e*r-n*o-i*a,this}multiplyVec3(t,e){e||(e=new r.default);const n=t.x,i=t.y,s=t.z,o=this.x,a=this.y,l=this.z,h=this.w,u=h*n+a*s-l*i,c=h*i+l*n-o*s,d=h*s+o*i-a*n,g=-o*n-a*i-l*s;return e.x=u*h+g*-o+c*-l-d*-a,e.y=c*h+g*-a+d*-o-u*-l,e.z=d*h+g*-l+u*-a-c*-o,e}toMat3(t){t||(t=new i.default);const e=this.x,n=this.y,s=this.z,r=this.w,o=e+e,a=n+n,l=s+s,h=e*o,u=e*a,c=e*l,d=n*a,g=n*l,p=s*l,f=r*o,m=r*a,_=r*l;return t.init([1-(d+p),u+_,c-m,u-_,1-(h+p),g+f,c+m,g-f,1-(h+d)]),t}toMat4(t){t||(t=new s.default);const e=this.x,n=this.y,i=this.z,r=this.w,o=e+e,a=n+n,l=i+i,h=e*o,u=e*a,c=e*l,d=n*a,g=n*l,p=i*l,f=r*o,m=r*a,_=r*l;return t.init([1-(d+p),u+_,c-m,0,u-_,1-(h+p),g+f,0,c+m,g-f,1-(h+d),0,0,0,0,1]),t}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}static sum(t,e,n){return n||(n=new a),n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n.w=t.w+e.w,n}static product(t,e,n){n||(n=new a);const i=t.x,s=t.y,r=t.z,o=t.w,l=e.x,h=e.y,u=e.z,c=e.w;return n.x=i*c+o*l+s*u-r*h,n.y=s*c+o*h+r*l-i*u,n.z=r*c+o*u+i*h-s*l,n.w=o*c-i*l-s*h-r*u,n}static cross(t,e,n){n||(n=new a);const i=t.x,s=t.y,r=t.z,o=t.w,l=e.x,h=e.y,u=e.z,c=e.w;return n.x=o*u+r*c+i*h-s*l,n.y=o*c-i*l-s*h-r*u,n.z=o*l+i*c+s*u-r*h,n.w=o*h+s*c+r*l-i*u,n}static shortMix(t,e,n,i){if(i||(i=new a),n<=0)return i.xyzw=t.xyzw,i;if(n>=1)return i.xyzw=e.xyzw,i;let s=a.dot(t,e);const r=e.copy();let o,l;if(s<0&&(r.inverse(),s=-s),s>.9999)o=1-n,l=0+n;else{const t=Math.sqrt(1-s*s),e=Math.atan2(t,s),i=1/t;o=Math.sin((1-n)*e)*i,l=Math.sin((0+n)*e)*i}return i.x=o*t.x+l*r.x,i.y=o*t.y+l*r.y,i.z=o*t.z+l*r.z,i.w=o*t.w+l*r.w,i}static mix(t,e,n,i){i||(i=new a);const s=t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w;if(Math.abs(s)>=1)return i.xyzw=t.xyzw,i;const r=Math.acos(s),o=Math.sqrt(1-s*s);if(Math.abs(o)<.001)return i.x=.5*t.x+.5*e.x,i.y=.5*t.y+.5*e.y,i.z=.5*t.z+.5*e.z,i.w=.5*t.w+.5*e.w,i;const l=Math.sin((1-n)*r)/o,h=Math.sin(n*r)/o;return i.x=t.x*l+e.x*h,i.y=t.y*l+e.y*h,i.z=t.z*l+e.z*h,i.w=t.w*l+e.w*h,i}static fromAxisAngle(t,e,n){n||(n=new a),e*=.5;const i=Math.sin(e);return n.x=t.x*i,n.y=t.y*i,n.z=t.z*i,n.w=Math.cos(e),n}}a.identity=(new a).setIdentity()},"./modified_modules/tsm/tsm.ts":function(t,e,n){"use strict";n.r(e);var i=n("./modified_modules/tsm/mat2.ts");n.d(e,"mat2",function(){return i.default});var s=n("./modified_modules/tsm/mat3.ts");n.d(e,"mat3",function(){return s.default});var r=n("./modified_modules/tsm/mat4.ts");n.d(e,"mat4",function(){return r.default});var o=n("./modified_modules/tsm/quat.ts");n.d(e,"quat",function(){return o.default});var a=n("./modified_modules/tsm/vec2.ts");n.d(e,"vec2",function(){return a.default});var l=n("./modified_modules/tsm/vec3.ts");n.d(e,"vec3",function(){return l.default});var h=n("./modified_modules/tsm/vec4.ts");n.d(e,"vec4",function(){return h.default})},"./modified_modules/tsm/vec2.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return r});var i=n("./modified_modules/tsm/vec3.ts"),s=n("./modified_modules/tsm/constants.ts");class r{constructor(t){this.values=new Float32Array(2),void 0!==t&&(this.xy=t)}get x(){return this.values[0]}get y(){return this.values[1]}get xy(){return[this.values[0],this.values[1]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}at(t){return this.values[t]}reset(){this.x=0,this.y=0}copy(t){return t||(t=new r),t.x=this.x,t.y=this.y,t}negate(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t}equals(t,e=s.epsilon){return!(Math.abs(this.x-t.x)>e)&&!(Math.abs(this.y-t.y)>e)}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.x,e=this.y;return t*t+e*e}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}divide(t){return this.x/=t.x,this.y/=t.y,this}scale(t,e){return e||(e=this),e.x*=t,e.y*=t,e}normalize(t){t||(t=this);let e=this.length();return 1===e?this:0===e?(t.x=0,t.y=0,t):(e=1/e,t.x*=e,t.y*=e,t)}multiplyMat2(t,e){return e||(e=this),t.multiplyVec2(this,e)}multiplyMat3(t,e){return e||(e=this),t.multiplyVec2(this,e)}static cross(t,e,n){n||(n=new i.default);const s=t.x,r=t.y,o=e.x,a=s*e.y-r*o;return n.x=0,n.y=0,n.z=a,n}static dot(t,e){return t.x*e.x+t.y*e.y}static distance(t,e){return Math.sqrt(this.squaredDistance(t,e))}static squaredDistance(t,e){const n=e.x-t.x,i=e.y-t.y;return n*n+i*i}static direction(t,e,n){n||(n=new r);const i=t.x-e.x,s=t.y-e.y;let o=Math.sqrt(i*i+s*s);return 0===o?(n.x=0,n.y=0,n):(o=1/o,n.x=i*o,n.y=s*o,n)}static mix(t,e,n,i){i||(i=new r);const s=t.x,o=t.y,a=e.x,l=e.y;return i.x=s+n*(a-s),i.y=o+n*(l-o),i}static sum(t,e,n){return n||(n=new r),n.x=t.x+e.x,n.y=t.y+e.y,n}static difference(t,e,n){return n||(n=new r),n.x=t.x-e.x,n.y=t.y-e.y,n}static product(t,e,n){return n||(n=new r),n.x=t.x*e.x,n.y=t.y*e.y,n}static quotient(t,e,n){return n||(n=new r),n.x=t.x/e.x,n.y=t.y/e.y,n}}r.zero=new r([0,0]),r.one=new r([1,1])},"./modified_modules/tsm/vec3.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return r});var i=n("./modified_modules/tsm/quat.ts"),s=n("./modified_modules/tsm/constants.ts");class r{constructor(t){this.values=new Float32Array(3),void 0!==t&&(this.xyz=t)}get x(){return this.values[0]}get y(){return this.values[1]}get z(){return this.values[2]}get xy(){return[this.values[0],this.values[1]]}get xyz(){return[this.values[0],this.values[1],this.values[2]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set z(t){this.values[2]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}set xyz(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}at(t){return this.values[t]}reset(){this.x=0,this.y=0,this.z=0}copy(t){return t||(t=new r),t.x=this.x,t.y=this.y,t.z=this.z,t}negate(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t.z=-this.z,t}equals(t,e=s.epsilon){return!(Math.abs(this.x-t.x)>e)&&(!(Math.abs(this.y-t.y)>e)&&!(Math.abs(this.z-t.z)>e))}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.x,e=this.y,n=this.z;return t*t+e*e+n*n}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}subtract(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}scale(t,e){return e||(e=this),e.x*=t,e.y*=t,e.z*=t,e}normalize(t){t||(t=this);let e=this.length();return 1===e?this:0===e?(t.x=0,t.y=0,t.z=0,t):(e=1/e,t.x*=e,t.y*=e,t.z*=e,t)}multiplyByMat3(t,e){return e||(e=this),t.multiplyVec3(this,e)}multiplyByQuat(t,e){return e||(e=this),t.multiplyVec3(this,e)}toQuat(t){t||(t=new i.default);const e=new r,n=new r;return e.x=Math.cos(.5*this.x),n.x=Math.sin(.5*this.x),e.y=Math.cos(.5*this.y),n.y=Math.sin(.5*this.y),e.z=Math.cos(.5*this.z),n.z=Math.sin(.5*this.z),t.x=n.x*e.y*e.z-e.x*n.y*n.z,t.y=e.x*n.y*e.z+n.x*e.y*n.z,t.z=e.x*e.y*n.z-n.x*n.y*e.z,t.w=e.x*e.y*e.z+n.x*n.y*n.z,t}static cross(t,e,n){n||(n=new r);const i=t.x,s=t.y,o=t.z,a=e.x,l=e.y,h=e.z;return n.x=s*h-o*l,n.y=o*a-i*h,n.z=i*l-s*a,n}static dot(t,e){const n=t.x,i=t.y,s=t.z;return n*e.x+i*e.y+s*e.z}static distance(t,e){e.x,t.x,e.y,t.y,e.z,t.z;return Math.sqrt(this.squaredDistance(t,e))}static squaredDistance(t,e){const n=e.x-t.x,i=e.y-t.y,s=e.z-t.z;return n*n+i*i+s*s}static direction(t,e,n){n||(n=new r);const i=t.x-e.x,s=t.y-e.y,o=t.z-e.z;let a=Math.sqrt(i*i+s*s+o*o);return 0===a?(n.x=0,n.y=0,n.z=0,n):(a=1/a,n.x=i*a,n.y=s*a,n.z=o*a,n)}static mix(t,e,n,i){return i||(i=new r),i.x=t.x+n*(e.x-t.x),i.y=t.y+n*(e.y-t.y),i.z=t.z+n*(e.z-t.z),i}static sum(t,e,n){return n||(n=new r),n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n}static difference(t,e,n){return n||(n=new r),n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n}static product(t,e,n){return n||(n=new r),n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z,n}static quotient(t,e,n){return n||(n=new r),n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z,n}}r.zero=new r([0,0,0]),r.one=new r([1,1,1]),r.up=new r([0,1,0]),r.right=new r([1,0,0]),r.forward=new r([0,0,1])},"./modified_modules/tsm/vec4.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return s});var i=n("./modified_modules/tsm/constants.ts");class s{constructor(t){this.values=new Float32Array(4),void 0!==t&&(this.xyzw=t)}get x(){return this.values[0]}get y(){return this.values[1]}get z(){return this.values[2]}get w(){return this.values[3]}get xy(){return[this.values[0],this.values[1]]}get xyz(){return[this.values[0],this.values[1],this.values[2]]}get xyzw(){return[this.values[0],this.values[1],this.values[2],this.values[3]]}set x(t){this.values[0]=t}set y(t){this.values[1]=t}set z(t){this.values[2]=t}set w(t){this.values[3]=t}set xy(t){this.values[0]=t[0],this.values[1]=t[1]}set xyz(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}set xyzw(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]}get r(){return this.values[0]}get g(){return this.values[1]}get b(){return this.values[2]}get a(){return this.values[3]}get rg(){return[this.values[0],this.values[1]]}get rgb(){return[this.values[0],this.values[1],this.values[2]]}get rgba(){return[this.values[0],this.values[1],this.values[2],this.values[3]]}set r(t){this.values[0]=t}set g(t){this.values[1]=t}set b(t){this.values[2]=t}set a(t){this.values[3]=t}set rg(t){this.values[0]=t[0],this.values[1]=t[1]}set rgb(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2]}set rgba(t){this.values[0]=t[0],this.values[1]=t[1],this.values[2]=t[2],this.values[3]=t[3]}at(t){return this.values[t]}reset(){this.x=0,this.y=0,this.z=0,this.w=0}copy(t){return t||(t=new s),t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t}negate(t){return t||(t=this),t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=-this.w,t}equals(t,e=i.epsilon){return!(Math.abs(this.x-t.x)>e)&&(!(Math.abs(this.y-t.y)>e)&&(!(Math.abs(this.z-t.z)>e)&&!(Math.abs(this.w-t.w)>e)))}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}subtract(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}scale(t,e){return e||(e=this),e.x*=t,e.y*=t,e.z*=t,e.w*=t,e}normalize(t){t||(t=this);let e=this.length();return 1===e?this:0===e?(t.x*=0,t.y*=0,t.z*=0,t.w*=0,t):(e=1/e,t.x*=e,t.y*=e,t.z*=e,t.w*=e,t)}multiplyMat4(t,e){return e||(e=this),t.multiplyVec4(this,e)}static mix(t,e,n,i){return i||(i=new s),i.x=t.x+n*(e.x-t.x),i.y=t.y+n*(e.y-t.y),i.z=t.z+n*(e.z-t.z),i.w=t.w+n*(e.w-t.w),i}static sum(t,e,n){return n||(n=new s),n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n.w=t.w+e.w,n}static difference(t,e,n){return n||(n=new s),n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n.w=t.w-e.w,n}static product(t,e,n){return n||(n=new s),n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z,n.w=t.w*e.w,n}static quotient(t,e,n){return n||(n=new s),n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z,n.w=t.w/e.w,n}}s.zero=new s([0,0,0,1]),s.one=new s([1,1,1,1])},"./node_modules/call-bind/callBound.js":function(t,e,n){"use strict";var i=n("./node_modules/get-intrinsic/index.js"),s=n("./node_modules/call-bind/index.js"),r=s(i("String.prototype.indexOf"));t.exports=function(t,e){var n=i(t,!!e);return"function"==typeof n&&r(t,".prototype.")>-1?s(n):n}},"./node_modules/call-bind/index.js":function(t,e,n){"use strict";var i=n("./node_modules/function-bind/index.js"),s=n("./node_modules/get-intrinsic/index.js"),r=s("%Function.prototype.apply%"),o=s("%Function.prototype.call%"),a=s("%Reflect.apply%",!0)||i.call(o,r),l=s("%Object.getOwnPropertyDescriptor%",!0),h=s("%Object.defineProperty%",!0),u=s("%Math.max%");if(h)try{h({},"a",{value:1})}catch(t){h=null}t.exports=function(t){var e=a(i,o,arguments);l&&h&&(l(e,"length").configurable&&h(e,"length",{value:1+u(0,t.length-(arguments.length-1))}));return e};var c=function(){return a(i,r,arguments)};h?h(t.exports,"apply",{value:c}):t.exports.apply=c},"./node_modules/chroma.ts/dist/index.es.js":function(t,e,n){"use strict";n.r(e),n.d(e,"Color",function(){return S}),n.d(e,"CubeHelix",function(){return O}),n.d(e,"Scale",function(){return J}),n.d(e,"analyze",function(){return nt}),n.d(e,"average",function(){return H}),n.d(e,"bezier",function(){return W}),n.d(e,"black",function(){return k}),n.d(e,"blend",function(){return Y}),n.d(e,"brewer",function(){return j}),n.d(e,"cmyk",function(){return T}),n.d(e,"color",function(){return E}),n.d(e,"contrast",function(){return Q}),n.d(e,"css",function(){return M}),n.d(e,"cubehelix",function(){return C}),n.d(e,"deltaE",function(){return et}),n.d(e,"distance",function(){return tt}),n.d(e,"gl",function(){return R}),n.d(e,"hcg",function(){return F}),n.d(e,"hsi",function(){return I}),n.d(e,"hsl",function(){return B}),n.d(e,"hsv",function(){return D}),n.d(e,"kelvin",function(){return U}),n.d(e,"lab",function(){return G}),n.d(e,"lch",function(){return P}),n.d(e,"limits",function(){return it}),n.d(e,"mix",function(){return L}),n.d(e,"num",function(){return $}),n.d(e,"random",function(){return N}),n.d(e,"rgb",function(){return q}),n.d(e,"scale",function(){return X}),n.d(e,"scales",function(){return Z}),n.d(e,"w3cx11",function(){return A}),n.d(e,"white",function(){return z}),n.d(e,"xyz",function(){return V});const{abs:i,atan2:s,cos:r,floor:o,log:a,min:l,max:h,round:u,sign:c,sin:d,sqrt:g,cbrt:p,PI:f,hypot:m}=Math;function _(t,e,n){return t+(e-t)*n}function v(t,e=0,n=1){return t<e?e:t>n?n:t}function y(t,e,n,s=1e-8){let r,o=e;for(;n--&&i(r=t(o))>s;){const e=(t(o+s)-r)/s;console.log("fx / dfdx",r/e,"fx",r,"x",o),o-=r/e}return o}const b=2*f,x=f/180,w=180/f;function E(...t){return t[0]instanceof S?t[0]:t.length>1&&"string"==typeof t[t.length-1]?ot(t.slice(0,t.length-1),t[t.length-1]):Array.isArray(t[0])?ot(t[0]):ot(t)}class S{constructor(t,e,n,i=1){this.r=t,this.g=e,this.b=n,this.a=i}mix(t,e,n="rgb"){return L(this,t,e,n)}rgb(t=!0,e=!0){const n=n=>(t&&(n=u(n)),e&&(n=v(n,0,255)),n),{r:i,g:s,b:r}=this;return[n(i),n(s),n(r)]}rgba(t=!0,e=!0){const n=n=>(t&&(n=u(n)),e&&(n=v(n,0,255)),n),{r:i,g:s,b:r,a:o}=this;return[n(i),n(s),n(r),o]}hex(t="rgb"){const{r:e,g:n,b:i,a:s}=this;return function(t,e,n,i,s="rgb"){t=v(u(t),0,255),e=v(u(e),0,255),n=v(u(n),0,255);const r=(t<<16|e<<8|n).toString(16).padStart(6,"0"),o=u(255*v(i)).toString(16).padStart(2,"0");return"#"+("argb"==s?o+r:"rgba"==s?r+o:r)}(e,n,i,s,t)}hsl(){const{r:t,g:e,b:n}=this;return function(t,e,n){const[i,s,r]=kt(t/255,e/255,n/255),o=(r+s)/2;let a;a=r==s?0:o<.5?(r-s)/(r+s):(r-s)/(2-r-s);return[i,a,o]}(t,e,n)}hsv(){const{r:t,g:e,b:n}=this;return function(t,e,n){const[i,s,r]=kt(t,e,n),o=r-s;return[i,0==r?0:o/r,r/255]}(t,e,n)}hcg(){const{r:t,g:e,b:n}=this;return function(t,e,n){const[i,s,r]=kt(t,e,n),o=(r-s)/255;return[i,o,o<1?s/255/(1-o):0]}(t,e,n)}css(t="rgb"){if("rgb"==t){const{r:t,g:e,b:n,a:i}=this;return function(t,e,n,i=1){return i>=1?"rgb("+[t,e,n].map(u).join(",")+")":"rgba("+[t,e,n].map(u).join(",")+","+i+")"}(t,e,n,i)}if("hsl"==t)return function([t,e,n],i){const s=i<1?"hsla":"hsl";return s+"("+yt(t)+","+yt(100*e)+"%,"+yt(100*n)+"%"+("hsla"==s?","+yt(i):"")+")"}(this.hsl(),this.alpha());throw new Error}name(t=!1){const e=this.num(),n=Object.keys(A).find(t=>A[t]==e);if(!n&&t){const[t,e,n]=this.lab();return(i=Object.keys(A))[Bt(i,i=>{const[s,r,o]=$(A[i]).lab();return-m(t-s,e-r,n-o)})]}var i;return n}cmyk(){const{r:t,g:e,b:n}=this;return function(t,e,n){const i=1-h(t/=255,e/=255,n/=255);return 1==i?[0,0,0,1]:[(1-t-i)/(1-i),(1-e-i)/(1-i),(1-n-i)/(1-i),i]}(t,e,n)}gl(){const{r:t,g:e,b:n,a:i}=this;return[t/255,e/255,n/255,i]}luminance(t){const{r:e,g:n,b:i,a:s}=this,[,r]=Pt(e,n,i);if(void 0===t)return r;const o=(t,e,n)=>(n-t)/(e-t);return t>r?L(this,z,o(r,1,t),"xyz").alpha(s):L(k,this,o(0,r,t),"xyz").alpha(s)}temperature(){const{r:t,g:e,b:n}=this;return i=t,s=e,r=n,console.log(r-i),s+r<158.61?(console.log("0 < t < 20"),u(100*y(t=>s-(-155.25485562709179-.44596950469579133*(t-2)+104.49216199393888*a(t-2)),15,4))):r-i<0?(console.log("20 < t < 66"),u(100*y(t=>r-(.8274096064007395*(t-10)-254.76935184120902+115.67994401066147*a(t-10)),43,4))):(console.log("0 < t < 400, start= "+(-1.4*(i+s)+755)),u(100*y(t=>i-(351.97690566805693+.114206453784165*(t-55)-40.25366309332127*a(t-55)),-1.4*(i+s)+755,8)));var i,s,r}set(t,e){const[n,i]=t.split("."),s=this[n](),r=n.indexOf(i);if(-1==r)throw new Error("invalid channel");return s[r]="number"==typeof e?e:e(s[r]),E(s,n).alpha(this.a)}clipped(){const{r:t,g:e,b:n}=this;return!(0<=t&&t<=255&&0<=e&&e<=255&&0<=n&&n<=255)}textColor(){return this.luminance()>.5?k:z}alpha(t){if(void 0===t)return this.a;const{r:e,g:n,b:i}=this;return q(e,n,i,t)}darker(t=1){const[e,n,i]=this.lab();return G(e-Ct*t,n,i,this.alpha())}brighter(t=1){return this.darker(-t)}saturate(t=1){const[e,n,i]=this.lch();return P(e,h(0,n+t*Ct),i,this.alpha())}desaturate(t=1){return this.saturate(-t)}premultiplied(){const{r:t,g:e,b:n,a:i}=this;return q(t*i,e*i,n*i,i)}hsi(){const{r:t,g:e,b:n}=this;return function(t,e,n){const i=t/255,r=e/255,o=n/255,a=(i+r+o)/3;if(i==r&&r==o)return[0,0,a];{const t=.5*(2*i-r-o),e=g(3)/2*(r-o),n=s(e,t),h=l(i,r,o),u=1-h/a;return[(n<0?2*f+n:n)*w,u,a]}}(t,e,n)}lab(){const{r:t,g:e,b:n}=this;return Ft(t,e,n)}num(t="rgb"){const{r:e,g:n,b:i,a:s}=this;return function(t,e,n,i=1,s="rgb"){const r=u(t)<<16|u(e)<<8|u(n);return"rgb"===s?r:"rgba"===s?r<<8|u(255*i)<<24:u(255*i)<<24|r}(e,n,i,s,t)}lch(){const{r:t,g:e,b:n}=this;return function(t,e,n){const[i,r,o]=Ft(t,e,n);return function(t,e,n){const i=m(e,n),r=(s(n,e)*w+360)%360;return[t,i,r]}(i,r,o)}(t,e,n)}xyz(){const{r:t,g:e,b:n}=this;return Pt(t,e,n)}equals(t){const{r:e,g:n,b:i,a:s}=this,{r:r,g:o,b:a,a:l}=t;return e==r&&n==o&&i==a&&s==l}hashCode(){return this.num("rgba")}toSource(){const{r:t,g:e,b:n,a:i}=this;return"chroma.rgb("+t+", "+e+", "+n+(1===i?")":", "+i+")")}}S.prototype.toString=S.prototype.css,S.prototype.kelvin=S.prototype.temperature;const k=new S(0,0,0,1),z=new S(255,255,255,1),j={OrRd:[16775148,16705736,16635038,16628612,16551257,15689032,14102559,11730944,8323072],PuBu:[16775163,15525874,13685222,10927579,7645647,3576e3,356528,285325,145496],BuPu:[16252157,14740724,12571622,10403034,9213638,9202609,8929693,8458108,5046347],Oranges:[16774635,16705230,16634018,16625259,16616764,15821075,14239745,10892803,8333060],BuGn:[16252157,15070713,13429990,10082505,6734500,4304502,2329413,27948,17435],YlOrBr:[16777189,16775100,16704401,16696399,16685353,15495188,13388802,10040324,6694150],YlGn:[16777189,16252089,14282915,11394446,7915129,4303709,2327619,26679,17705],Reds:[16774640,16703698,16563105,16552562,16476746,15678252,13309981,10817301,6750221],RdPu:[16775155,16638173,16565696,16424885,16214177,14496919,11403646,7995767,4784234],Greens:[16252149,15070688,13101504,10607003,7652470,4303709,2329413,27948,17435],YlGnBu:[16777177,15595697,13101492,8375739,4306628,1937856,2252456,2438292,531800],Purples:[16579581,15724021,14342891,12369372,10394312,8420794,6967715,5515151,4128893],GnBu:[16252144,14742491,13429701,11066805,8113348,5157843,2854078,551084,540801],Greys:[16777215,15790320,14277081,12434877,9868950,7566195,5395026,2434341,0],YlOrRd:[16777164,16772512,16701814,16691788,16616764,16535082,14883356,12386342,8388646],PuRd:[16250105,15196655,13941210,13210823,14640560,15149450,13505110,9961539,6750239],Blues:[16251903,14609399,13032431,10406625,7057110,4362950,2191797,545180,536683],PuBuGn:[16775163,15524592,13685222,10927579,6793679,3576e3,164234,93273,83510],Viridis:[4456788,4728695,4147850,3237774,2524047,2071946,7130714,11984427,16705573],Spectral:[10355010,13975119,16018755,16625249,16703627,16777151,15136152,11263396,6734501,3311805,6180770],RdYlGn:[10813478,14102567,16018755,16625249,16703627,16777151,14282635,10934634,6733155,1742928,26679],RdBu:[6750239,11671595,14049357,16033154,16636871,16250871,13755888,9618910,4428739,2188972,340065],PiYG:[9306450,12917629,14579630,15840986,16638191,16250871,15136208,12116358,8371265,5083681,2581529],PRGn:[4194379,7744131,10055851,12756431,15193320,16250871,14282963,10935200,5942881,1800247,17435],RdYlBu:[10813478,14102567,16018755,16625249,16703632,16777151,14742520,11262441,7646673,4552116,3225237],BrBG:[5517317,9195786,12550445,14664317,16181443,16119285,13101797,8441281,3512207,91742,15408],RdGy:[6750239,11671595,14049357,16033154,16636871,16777215,14737632,12237498,8882055,5066061,1710618],PuOr:[8338184,11753478,14713364,16627811,16703670,16250871,14211819,11709394,8418220,5515144,2949195],Set2:[6734501,16551266,9281739,15174339,10934356,16767279,15058068,11776947],Accent:[8374655,12496596,16629894,16777113,3697840,15729279,12540695,6710886],Set1:[14948892,3636920,5091146,9981603,16744192,16777011,10901032,16220607,10066329],Set3:[9294791,16777139,12499674,16482418,8434131,16626786,11787881,16567781,14277081,12353725,13429701,16772463],Dark2:[1810039,14245634,7696563,15149450,6727198,15117058,10909213,6710886],Paired:[10931939,2062516,11722634,3383340,16489113,14883356,16629615,16744192,13284054,6962586,16777113,11622696],Pastel2:[11789005,16633260,13358568,16042724,15136201,16773806,15852236,13421772],Pastel1:[16495790,11783651,13429701,14601188,16701862,16777164,15063229,16636652,15921906]},A={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflower:6591981,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,laserlemon:16777044,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrod:16448210,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,maroon2:8323072,maroon3:11546720,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,purple2:8323199,purple3:10494192,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function C(t=300,e=-1.5,n=1,i=1,s=[0,1]){const r=t=>r.at(t);return Object.getOwnPropertyNames(O.prototype).forEach(t=>r[t]=O.prototype[t]),r.start(t),r.rotations(e),r.hue(n),r.gamma(i),r.lightness(s),r}class O{start(t){return void 0===t?this._start:(this._start=t,this)}rotations(t){return void 0===t?this._rotations:(this._rotations=t,this)}gamma(t){return void 0===t?this._gamma:(this._gamma=t,this)}hue(t){return void 0===t?this._hue:(this._hue=Array.isArray(t)?t:[t,t],this)}lightness(t){return void 0===t?this._lightness:(this._lightness=Array.isArray(t)?t:[t,t],this)}scale(){return X(this)}at(t){const e=b*((this._start+120)/360+this._rotations*t),n=_(this._lightness[0],this._lightness[1],t)**this._gamma,i=_(this._hue[0],this._hue[1],t)*n*(1-n)/2,s=r(e),o=d(e);return q([255*(n+i*(-.14861*s+1.78277*o)),255*(n+i*(-.29227*s-.90649*o)),255*(n+i*(1.97294*s)),1])}}function N(t=Math.random){return $(16777216*t()|0)}function L(t,e,n=.5,i="rgb"){const s=E(t),r=E(e),o=st[i]&&st[i](s,r,n,i);if(!o)throw new Error("color mode "+i+" is not supported");return o.alpha(_(s.alpha(),r.alpha(),n))}function M(t){const[e,n,i,s]=vt(t);return new S(e,n,i,s)}function T(...t){return ot(t,"cmyk")}function R(...t){return ot(t,"gl")}function F(...t){return ot(t,"hcg")}function P(...t){return ot(t,"lch")}function I(...t){return ot(t,"hsi")}function B(...t){return ot(t,"hsl")}function D(...t){return ot(t,"hsv")}function U(t){const[e,n,i]=wt(t);return new S(e,n,i)}function G(...t){return ot(t,"lab")}function $(t){const[e,n,i]=ht(t);return new S(e,n,i)}function q(...t){return ot(t,"rgb")}function V(...t){return ot(t,"xyz")}function H(t,e="rgb"){const n=t.map(t=>E(t));if("lrgb"==e)return function(t){let e=0,n=0,i=0,s=0;for(const r of t){const[t,o,a,l]=r.rgba(!1,!1);e+=t**2,n+=o**2,i+=a**2,s+=l}return new S(g(e)/t.length,g(n)/t.length,g(i)/t.length,s/t.length)}(n);if("num"==e){let t=0,e=0;for(const i of n)t+=i.num(),e+=i.alpha();return $(t/n.length).alpha(e/n.length)}const i=[0,0,0];let o=0,a=0,l=0;for(const t of n){const n=t[e]();l+=t.alpha();for(let t=0;t<i.length;t++)if("h"==e.charAt(t)){const e=n[t]*x;o+=r(e),a+=d(e)}else i[t]+=n[t]}for(let t=0;t<i.length;t++)if("h"==e.charAt(t)){const e=s(a/n.length,o/n.length)*w;i[t]=(e+360)%360}else i[t]=i[t]/n.length;return ot(i,e).alpha(l/n.length)}function W(...t){const e=function t(e){const n=e.map(t=>E(t));const[i,s,r,o]=n.map(t=>t.lab());if(2==e.length)return t=>G([0,1,2].map(e=>_(i[e],s[e],t)));if(3==e.length){const t=(t,e,n,i)=>(1-i)**2*t+2*(1-i)*i*e+i**2*n;return e=>G([0,1,2].map(n=>t(i[n],s[n],r[n],e)))}if(4==e.length){const t=(t,e,n,i,s)=>(1-s)**3*t+3*(1-s)**2*s*e+3*(1-s)*s**2*n+s**3*i;return e=>G([0,1,2].map(n=>t(i[n],s[n],r[n],o[n],e)))}if(5==e.length){const e=t(n.slice(0,3)),i=t(n.slice(2,5));return t=>t<.5?e(2*t):i(2*(t-.5))}throw new Error}(Array.isArray(t[0])?t[0]:t);return e.scale=O.prototype.scale,e}function Y(t,e,n){if(!K[n])throw new Error("unknown blend mode "+n);return K[n](t,e)}const K={normal:Et(St((t,e)=>t)),multiply:Et(St((t,e)=>t*e/255)),screen:Et(St(function(t,e){return 255*(1-(1-t/255)*(1-e/255))})),overlay:Et(St(function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))})),darken:Et(St(l)),lighten:Et(St(h)),dodge:Et(St(function(t,e){if(255==t)return 255;return 255*l(1,e/255/(1-t/255))})),burn:Et(St(function(t,e){return 255*(1-(1-e/255)/(t/255))}))};function X(...t){const e=t=>e._at(t);return Object.getOwnPropertyNames(J.prototype).forEach(t=>e[t]=J.prototype[t]),Array.isArray(t[0])&&(t=t[0]),1==t.length&&"string"==typeof t[0]&&(t=j[t[0]]),e._init("function"==typeof t[0]?t[0]:t.map(t=>E(t))),e}class J{classes(t){if(void 0===t)return this._classes;if(Array.isArray(t))this._classes=t,this.domain(t[0],t[t.length-1]);else{if(t%1!=0||t<1)throw new Error("invalid classes param");this._classes=it(this.domain(),"e",t)}return this}domain(...t){if(void 0===t[0])return"function"!=typeof this._colors?this._pos.map(t=>_(this._min,this._max,t)):[this._min,this._max];if(this._min=t[0],this._max=t[t.length-1],2==t.length)"function"!=typeof this._colors&&(this._pos=this._colors.map((t,e)=>e/(this._colors.length-1)));else{if("function"==typeof this._colors||t.length!=this._colors.length)throw new Error("invalid domain "+t);this._pos=t.map(t=>(function(t,e,n){return(n-t)/(e-t)})(this._min,this._max,t))}return this}mode(t){return void 0===t?this._mode:(this._mode=t,this._resetCache(),this)}out(t){return this._out=t,this}correctLightness(t=!0){if(this._correctLightness!=t){this._resetCache();const e=this._colors;if(t&&"function"!=typeof e){let t=0;for(let n=1;n<e.length;n++){const i=e[n].lab()[0]-e[n-1].lab()[0];if(0==t)t=i;else if(t*i<0)throw new Error("scale color lightnesses must be monotonic")}}}return this._correctLightness=t,this}padding(t,e=t){return t?(this._paddingLeft=t,this._paddingRight=e,this):[this._paddingLeft,this._paddingRight]}colors(t,e="hex"){let n;if(void 0===t)n=this._colors.slice();else if(1==t)n=[this._color((this._min+this._max)/2)];else if(t>1)n=Array.from({length:t},(e,n)=>this._color(_(this._min,this._max,n/(t-1))));else{let t;n=(t=this._classes&&this._classes.length>2?Array.from({length:this._classes.length-1},(t,e)=>.5*(this._classes[e]+this._classes[e+1])):this.domain()).map(t=>this._color(t))}return"color"!=e?n.map(t=>t[e]()):n}cache(t){return void 0===t?!!this._cache:(this._cache=t?this._cache||new Map:void 0,this)}gamma(t){return void 0===t?this._gamma:(this._gamma=t,this)}_at(t){const e=this._color(t);return this._out?e[this._out]():e}_init(t){this._colors=t,"function"!=typeof t&&(this._pos=t.map((e,n)=>n/(t.length-1))),this._mode="rgb",this.domain(0,1),this._paddingLeft=0,this._paddingRight=0,this._correctLightness=!1,this._cache=new Map,this._gamma=1}_getClass(t){return this._classes.findIndex(e=>t<=e)-1}_color(t,e=!1){let n;if(e)n=t;else{const e=this._min,i=this._max;if(this._classes&&this._classes.length>2){n=this._getClass(t)/(this._classes.length-2)}else n=i!==e?(t-e)/(i-e):1;this._correctLightness&&(n=this._tCorrectedLightness(n))}n=n**this._gamma;const i=n=v(n=(this._paddingLeft+n)/(1+this._paddingLeft+this._paddingRight),0,1),s=this._cache&&this._cache.get(i);if(s)return s;{let t;if(Array.isArray(this._colors))for(let e=0;e<this._pos.length;e++){const i=this._pos[e];if(n<=i){t=this._colors[e];break}if(n>=i&&e==this._pos.length-1){t=this._colors[e];break}if(n>i&&n<this._pos[e+1]){n=(n-i)/(this._pos[e+1]-i),t=L(this._colors[e],this._colors[e+1],n,this._mode);break}}else t=this._colors(n);return this._cache&&this._cache.set(i,t),t}}_tCorrectedLightness(t){const e=_(this._color(0,!0).lab()[0],this._color(1,!0).lab()[0],t);return function(t,e,n,i){let s=t(e);for(;i--;){const i=(e+n)/2,r=t(i);c(s)==c(r)?(e=i,s=r):n=i}return(e+n)/2}(t=>this._color(t,!0).lab()[0]-e,0,1,8)}_resetCache(){this._cache&&this._cache.clear()}}var Z;function Q(t,e){const n=E(t).luminance(),i=E(e).luminance();return n>i?(n+.05)/(i+.05):(i+.05)/(n+.05)}function tt(t,e,n="lab"){const i=E(t)[n](),s=E(e)[n](),r=i.map((t,e)=>t-s[e]);return m(...r)}function et(t,e,n=1,o=1){const[a,l,h]=E(t).lab(),[u,c,d]=E(e).lab(),p=g(l*l+h*h),f=g(c*c+d*d),m=a<16?.511:.040975*a/(1+.01765*a),_=.0638*p/(1+.0131*p)+.638,v=lt(p<1e-6?0:s(h,l)*w),y=v>=164&&v<=345?.56+i(.2*r((v+168)*x)):.36+i(.4*r((v+35)*x)),b=p*p*p*p,S=g(b/(b+1900)),k=_*(S*y+1-S),z=p-f,j=l-c,A=h-d,C=(a-u)/(n*m),O=z/(o*_);return g(C*C+O*O+(j*j+A*A-z*z)/(k*k))}function nt(t){const e={min:1/0,max:-1/0,sum:0,values:[],count:0};return t.forEach(t=>(function(t){null==t||isNaN(t)||(e.values.push(t),e.sum+=t,t<e.min&&(e.min=t),t>e.max&&(e.max=t),e.count+=1)})(t)),e.domain=[e.min,e.max],e.limits=function(t,e){return it(this,t,e)},e}function it(t,e="e",n=7){const s=Array.isArray(t)?nt(t):t,{min:r,max:l,values:h}=s;if(h.sort((t,e)=>t-e),1==n)return[r,l];if(e.startsWith("c"))return[r,l];if(e.startsWith("e"))return Array.from({length:n+1},(t,e)=>_(r,l,e/n));if(e.startsWith("l")){if(r<=0)throw new Error("Logarithmic scales are only possible for values > 0");const t=Math.LOG10E*a(r),e=Math.LOG10E*a(l);return Array.from({length:n+1},(i,s)=>10**_(t,e,s/n))}if(e.startsWith("q"))return Array.from({length:n+1},(t,e)=>{const i=(h.length-1)*e/n,s=o(i);return s==i?h[s]:_(h[s],h[s+1],i-s)});if(e.startsWith("k")){const t=h.length,e=new Array(t),s=new Array(n);let o=!0,a=0,u=Array.from({length:n+1},(t,e)=>_(r,l,e/n));do{s.fill(0);for(let t=0;t<h.length;t++){const n=h[t],r=Bt(u,t=>-i(t-n));s[r]++,e[t]=r}const t=new Array(n).fill(0);for(let n=0;n<e.length;n++){t[e[n]]+=h[n]}for(let e=0;e<t.length;e++)t[e]/=s[e];o=t.some((t,e)=>t!=u[e]),u=t}while(a++<200&&o);const c=Array.from({length:n},()=>[]);for(let t=0;t<e.length;t++){c[e[t]].push(h[t])}const d=[];for(const t of c)d.push(t[0],t[t.length-1]);d.sort((t,e)=>t-e);const g=[];g.push(d[0]);for(let t=1;t<d.length;t+=2){const e=d[t];isNaN(e)||-1!=g.indexOf(e)||g.push(e)}return g}throw new Error("unknown mode")}!function(t){t.cool=function(){return X([B(180,1,.9),B(250,.7,.4)])},t.hot=function(){return X(["#000","#f00","#ff0","#fff"]).mode("rgb")}}(Z||(Z={}));const st={},rt={};function ot(t,e){if(Array.isArray(t[0])&&(t=t[0]),!e)if(1==t.length&&t[0]in A)e="name";else if(1==t.length&&"string"==typeof t[0])e="css";else if(3==t.length)e="rgb";else if(4==t.length&&"number"==typeof t[3]&&t[3]>=0&&t[3]<=1)e="rgb";else{if(!(1==t.length&&"number"==typeof t[0]&&t[0]>=0&&t[0]<=16777215))throw new Error("could not guess mode. args "+JSON.stringify(t));e="num"}const n=rt[e](...t);return new S(n[0],n[1],n[2],void 0!==n[3]?n[3]:1)}function at(t){let e;if(e=t.match(/^#?([A-F\d]{2})([A-F\d]{2})([A-F\d]{2})([A-F\d]{2})?$/i))return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),e[4]?parseInt(e[4],16)/255:1];if(e=t.match(/^#?([A-F\d])([A-F\d])([A-F\d])([A-F\d])?$/i))return[17*parseInt(e[1],16),17*parseInt(e[2],16),17*parseInt(e[3],16),e[4]?17*parseInt(e[4],16)/255:1];throw new Error("invalid hex color: "+t)}function lt(t){return(t%360+360)%360}function ht(t){if(!("number"==typeof t&&t>=0&&t<=16777215))throw new Error("unknown num color: "+t);return[t>>16,t>>8&255,255&t,1]}st.xyz=st.rgb=st.lab=function(t,e,n,i){const s=t[i](),r=e[i]();return ot([_(s[0],r[0],n),_(s[1],r[1],n),_(s[2],r[2],n),_(t.alpha(),e.alpha(),n)],i)},st.num=function(t,e,n){return $(_(t.num(),e.num(),n))},st.lrgb=function(t,e,n){const[i,s,r,o]=t.rgba(!1,!1),[a,l,h,u]=e.rgba(!1,!1);return new S(g(i**2*(1-n)+a**2*n),g(s**2*(1-n)+l**2*n),g(r**2*(1-n)+h**2*n),_(o,u,n))},rt.lrgb=rt.rgb,rt.hex=at,rt.hsl=jt,rt.hsv=function(t,e,n,s=1){t=lt(t);const r=n*e;return zt(t,r,r*(1-i(t/60%2-1)),n-r,s)},rt.num=ht;const ut="\\s*",ct="([+-]?(?:\\d*\\.?)?\\d+(?:[eE][+-]?\\d+)?)",dt=new RegExp(["^rgba?\\(",ct,",",ct,",",ct,"(?:,",ct+"(%)?",")?\\)$"].join(ut),"i"),gt=new RegExp(["^rgba?\\(",ct,ct,ct,"(?:/",ct+"(%)?",")?\\)$"].join(ut),"i"),pt=new RegExp(["^rgba?\\(",ct+"%",",",ct+"%",",",ct+"%","(?:,",ct+"(%)?",")?\\)$"].join(ut),"i"),ft=new RegExp(["^rgba?\\(",ct+"%",ct+"%",ct+"%","(?:/",ct+"(%)?",")?\\)$"].join(ut),"i"),mt=new RegExp(["^hsla?\\(",ct+"(deg|rad|turn)?",",",ct+"%",",",ct+"%","(?:,",ct+"(%)?",")?\\)$"].join(ut),"i"),_t=new RegExp(["^hsla?\\(",ct+"(deg|rad|turn)?\\s+"+ct+"%",ct+"%","(?:/",ct+"(%)?",")?\\)$"].join(ut),"i");function vt(t){if(A&&A.hasOwnProperty(t))return ht(A[t.toLowerCase()]);let e;if(e=t.match(dt)||t.match(gt))return[v(+e[1],0,255),v(+e[2],0,255),v(+e[3],0,255),e[4]?v(e[5]?+e[4]/100:+e[4]):1];if(e=t.match(pt)||t.match(ft))return[255*v(+e[1]/100),255*v(+e[2]/100),255*v(+e[3]/100),e[4]?v(e[5]?+e[4]/100:+e[4]):1];if(e=t.match(mt)||t.match(_t)){const t={deg:1,rad:w,turn:360},n=e[2]?e[2].toLowerCase():"deg";return jt((+e[1]*t[n]%360+360)%360,v(+e[3]/100),v(+e[4]/100),e[5]?v(e[6]?+e[5]/100:+e[5]):1)}return at(t)}function yt(t){return u(100*t)/100}function bt(t){const e=t/255;return e<=.04045?e/12.92:((e+.055)/1.055)**2.4}function xt(t){return t<=.0031308?12.92*t*255:255*(1.055*t**(1/2.4)-.055)}function wt(t){const e=t/100;let n,i,s;return e<66?(n=255,i=-155.25485562709179-.44596950469579133*(e-2)+104.49216199393888*a(e-2),s=e<20?0:.8274096064007395*(e-10)-254.76935184120902+115.67994401066147*a(e-10)):(n=351.97690566805693+.114206453784165*(e-55)-40.25366309332127*a(e-55),i=325.4494125711974+.07943456536662342*(e-50)-28.0852963507957*a(e-50),s=255),[n,i,s]}function Et(t){return function(e,n){const[i,s,r]=t(E(n).rgb(),E(e).rgb());return q(i,s,r)}}function St(t){return function(e,n){return e.map((e,i)=>t(e,n[i]))}}function kt(t,e,n){const i=l(t,e,n),s=h(t,e,n),r=s-i;let o;return[60*(o=0==r?0:t==s?(e-n)/r+(e<n?6:0):e==s?2+(n-t)/r:4+(t-e)/r),i,s]}function zt(t,e,n,i,s){const r=255*i,o=255*e+r,a=255*n+r;return t<60?[o,a,r,s]:t<120?[a,o,r,s]:t<180?[r,o,a,s]:t<240?[r,a,o,s]:t<300?[a,r,o,s]:[o,r,a,s]}function jt(t,e,n,s=1){t=lt(t);const r=(1-i(2*n-1))*e;return zt(t,r,r*(1-i(t/60%2-1)),n-r/2,s)}function At(t,e,n,i=1){const[s,r,o]=function(t,e,n){function i(t){return t>Mt?t**3:Tt*(t-4/29)}return[Ot*i((t+16)/116+e/500),Nt*i((t+16)/116),Lt*i((t+16)/116-n/200)]}(t,e,n);return It(s,r,o,i)}rt.css=vt,rt.name=function(t){return ht(A[t])},rt.lch=function(t,e,n,i=1){const[,s,o]=function(t,e,n){return[t,r(n*x)*e,d(n*x)*e]}(t,e,n);return At(t,s,o,i)},rt.cmyk=function(t,e,n,i,s=1){return 1==i?[0,0,0,s]:[255*(1-t)*(1-i),255*(1-e)*(1-i),255*(1-n)*(1-i),s]},rt.gl=function(t,e,n,i=1){return[255*t,255*e,255*n,i]},rt.rgb=((...t)=>t),rt.temperature=rt.kelvin=rt.K=wt,rt.hcg=function(t,e,n,s=1){const r=n*(1-e);return zt(t=lt(t),e,e*(1-i(t/60%2-1)),r,s)};const Ct=18,Ot=.95047,Nt=1,Lt=1.08883,Mt=.206896552,Tt=.12841855,Rt=.008856452;function Ft(t,e,n){const[i,s,r]=Pt(t,e,n);return function(t,e,n){function i(t){return t>Rt?p(t):t/Tt+4/29}return[116*i(e/Nt)-16,500*(i(t/Ot)-i(e/Nt)),200*(i(e/Nt)-i(n/Lt))]}(i,s,r)}function Pt(t,e,n){const i=bt(t),s=bt(e),r=bt(n);return[.4124564*i+.3575761*s+.1804375*r,.2126729*i+.7151522*s+.072175*r,.0193339*i+.119192*s+.9503041*r]}function It(t,e,n,i=1){const s=-.969266*t+1.8760108*e+.041556*n,r=.0556434*t-.2040259*e+1.0572252*n;return[xt(3.2404542*t-1.5371385*e-.4985314*n),xt(s),xt(r),i]}function Bt(t,e){let n=-1/0,i=-1;for(let s=0;s<t.length;s++){const r=e(t[s]);r>n&&(n=r,i=s)}return i}rt.xyz=It,rt.lab=At,rt.hsi=function(t,e,n,i=1){let s,o,a,l=t*x;return l<2*f/3?o=1-((a=(1-e)/3)+(s=(1+e*r(l)/r(f/3-l))/3)):l<4*f/3?a=1-((s=(1-e)/3)+(o=(1+e*r(l-=2*f/3)/r(f/3-l))/3)):s=1-((o=(1-e)/3)+(a=(1+e*r(l-=4*f/3)/r(f/3-l))/3)),[3*n*s*255,3*n*o*255,3*n*a*255,i]},st.hsv=st.hsl=st.hsi=st.lch=st.hcg=function(t,e,n,i){const[s,r,o]=t[i](),[a,l,h]=e[i]();function u(t,e,n){return t+n*(lt(e-t+180)-180)}return E(("h"==i.charAt(0)?u:_)(s,a,n),_(r,l,n),("h"==i.charAt(2)?u:_)(o,h,n),i)}},"./node_modules/define-properties/index.js":function(t,e,n){"use strict";var i=n("./node_modules/object-keys/index.js"),s="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),r=Object.prototype.toString,o=Array.prototype.concat,a=Object.defineProperty,l=a&&function(){var t={};try{for(var e in a(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),h=function(t,e,n,i){var s;e in t&&("function"!=typeof(s=i)||"[object Function]"!==r.call(s)||!i())||(l?a(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0}):t[e]=n)},u=function(t,e){var n=arguments.length>2?arguments[2]:{},r=i(e);s&&(r=o.call(r,Object.getOwnPropertySymbols(e)));for(var a=0;a<r.length;a+=1)h(t,r[a],e[r[a]],n[r[a]])};u.supportsDescriptors=!!l,t.exports=u},"./node_modules/es-abstract/2020/RequireObjectCoercible.js":function(t,e,n){"use strict";t.exports=n("./node_modules/es-abstract/5/CheckObjectCoercible.js")},"./node_modules/es-abstract/2020/ToString.js":function(t,e,n){"use strict";var i=n("./node_modules/get-intrinsic/index.js"),s=i("%String%"),r=i("%TypeError%");t.exports=function(t){if("symbol"==typeof t)throw new r("Cannot convert a Symbol value to a string");return s(t)}},"./node_modules/es-abstract/5/CheckObjectCoercible.js":function(t,e,n){"use strict";var i=n("./node_modules/get-intrinsic/index.js")("%TypeError%");t.exports=function(t,e){if(null==t)throw new i(e||"Cannot call method on "+t);return t}},"./node_modules/for-each/index.js":function(t,e,n){"use strict";var i=n("./node_modules/is-callable/index.js"),s=Object.prototype.toString,r=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){if(!i(e))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=n),"[object Array]"===s.call(t)?function(t,e,n){for(var i=0,s=t.length;i<s;i++)r.call(t,i)&&(null==n?e(t[i],i,t):e.call(n,t[i],i,t))}(t,e,o):"string"==typeof t?function(t,e,n){for(var i=0,s=t.length;i<s;i++)null==n?e(t.charAt(i),i,t):e.call(n,t.charAt(i),i,t)}(t,e,o):function(t,e,n){for(var i in t)r.call(t,i)&&(null==n?e(t[i],i,t):e.call(n,t[i],i,t))}(t,e,o)}},"./node_modules/function-bind/implementation.js":function(t,e,n){"use strict";var i=Array.prototype.slice,s=Object.prototype.toString;t.exports=function(t){var e=this;if("function"!=typeof e||"[object Function]"!==s.call(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var n,r=i.call(arguments,1),o=Math.max(0,e.length-r.length),a=[],l=0;l<o;l++)a.push("$"+l);if(n=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof n){var s=e.apply(this,r.concat(i.call(arguments)));return Object(s)===s?s:this}return e.apply(t,r.concat(i.call(arguments)))}),e.prototype){var h=function(){};h.prototype=e.prototype,n.prototype=new h,h.prototype=null}return n}},"./node_modules/function-bind/index.js":function(t,e,n){"use strict";var i=n("./node_modules/function-bind/implementation.js");t.exports=Function.prototype.bind||i},"./node_modules/get-intrinsic/index.js":function(t,e,n){"use strict";var i=SyntaxError,s=Function,r=TypeError,o=function(t){try{return s('"use strict"; return ('+t+").constructor;")()}catch(t){}},a=Object.getOwnPropertyDescriptor;if(a)try{a({},"")}catch(t){a=null}var l=function(){throw new r},h=a?function(){try{return arguments.callee,l}catch(t){try{return a(arguments,"callee").get}catch(t){return l}}}():l,u=n("./node_modules/has-symbols/index.js")(),c=Object.getPrototypeOf||function(t){return t.__proto__},d={},g="undefined"==typeof Uint8Array?void 0:c(Uint8Array),p={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":u?c([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":d,"%AsyncGenerator%":d,"%AsyncGeneratorFunction%":d,"%AsyncIteratorPrototype%":d,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":s,"%GeneratorFunction%":d,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u?c(c([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&u?c((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&u?c((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":u?c(""[Symbol.iterator]()):void 0,"%Symbol%":u?Symbol:void 0,"%SyntaxError%":i,"%ThrowTypeError%":h,"%TypedArray%":g,"%TypeError%":r,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},f={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},m=n("./node_modules/function-bind/index.js"),_=n("./node_modules/has/src/index.js"),v=m.call(Function.call,Array.prototype.concat),y=m.call(Function.apply,Array.prototype.splice),b=m.call(Function.call,String.prototype.replace),x=m.call(Function.call,String.prototype.slice),w=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,E=/\\(\\)?/g,S=function(t,e){var n,s=t;if(_(f,s)&&(s="%"+(n=f[s])[0]+"%"),_(p,s)){var a=p[s];if(a===d&&(a=function t(e){var n;if("%AsyncFunction%"===e)n=o("async function () {}");else if("%GeneratorFunction%"===e)n=o("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=o("async function* () {}");else if("%AsyncGenerator%"===e){var i=t("%AsyncGeneratorFunction%");i&&(n=i.prototype)}else if("%AsyncIteratorPrototype%"===e){var s=t("%AsyncGenerator%");s&&(n=c(s.prototype))}return p[e]=n,n}(s)),void 0===a&&!e)throw new r("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:s,value:a}}throw new i("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new r("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new r('"allowMissing" argument must be a boolean');var n=function(t){var e=x(t,0,1),n=x(t,-1);if("%"===e&&"%"!==n)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new i("invalid intrinsic syntax, expected opening `%`");var s=[];return b(t,w,function(t,e,n,i){s[s.length]=n?b(i,E,"$1"):e||t}),s}(t),s=n.length>0?n[0]:"",o=S("%"+s+"%",e),l=o.name,h=o.value,u=!1,c=o.alias;c&&(s=c[0],y(n,v([0,1],c)));for(var d=1,g=!0;d<n.length;d+=1){var f=n[d],m=x(f,0,1),k=x(f,-1);if(('"'===m||"'"===m||"`"===m||'"'===k||"'"===k||"`"===k)&&m!==k)throw new i("property names with quotes must have matching quotes");if("constructor"!==f&&g||(u=!0),_(p,l="%"+(s+="."+f)+"%"))h=p[l];else if(null!=h){if(!(f in h)){if(!e)throw new r("base intrinsic for "+t+" exists, but the property is not available.");return}if(a&&d+1>=n.length){var z=a(h,f);h=(g=!!z)&&"get"in z&&!("originalValue"in z.get)?z.get:h[f]}else g=_(h,f),h=h[f];g&&!u&&(p[l]=h)}}return h}},"./node_modules/has-symbols/index.js":function(t,e,n){"use strict";var i="undefined"!=typeof Symbol&&Symbol,s=n("./node_modules/has-symbols/shams.js");t.exports=function(){return"function"==typeof i&&("function"==typeof Symbol&&("symbol"==typeof i("foo")&&("symbol"==typeof Symbol("bar")&&s())))}},"./node_modules/has-symbols/shams.js":function(t,e,n){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var i=Object.getOwnPropertySymbols(t);if(1!==i.length||i[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var s=Object.getOwnPropertyDescriptor(t,e);if(42!==s.value||!0!==s.enumerable)return!1}return!0}},"./node_modules/has/src/index.js":function(t,e,n){"use strict";var i=n("./node_modules/function-bind/index.js");t.exports=i.call(Function.call,Object.prototype.hasOwnProperty)},"./node_modules/is-callable/index.js":function(t,e,n){"use strict";var i,s,r=Function.prototype.toString,o="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof o&&"function"==typeof Object.defineProperty)try{i=Object.defineProperty({},"length",{get:function(){throw s}}),s={},o(function(){throw 42},null,i)}catch(t){t!==s&&(o=null)}else o=null;var a=/^\s*class\b/,l=function(t){try{var e=r.call(t);return a.test(e)}catch(t){return!1}},h=Object.prototype.toString,u="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,c="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{};t.exports=o?function(t){if(t===c)return!0;if(!t)return!1;if("function"!=typeof t&&"object"!=typeof t)return!1;if("function"==typeof t&&!t.prototype)return!0;try{o(t,null,i)}catch(t){if(t!==s)return!1}return!l(t)}:function(t){if(t===c)return!0;if(!t)return!1;if("function"!=typeof t&&"object"!=typeof t)return!1;if("function"==typeof t&&!t.prototype)return!0;if(u)return function(t){try{return!l(t)&&(r.call(t),!0)}catch(t){return!1}}(t);if(l(t))return!1;var e=h.call(t);return"[object Function]"===e||"[object GeneratorFunction]"===e}},"./node_modules/ngraph.events/index.js":function(t,e){t.exports=function(t){!function(t){if(!t)throw new Error("Eventify cannot use falsy object as events subject");for(var e=["on","fire","off"],n=0;n<e.length;++n)if(t.hasOwnProperty(e[n]))throw new Error("Subject cannot be eventified, since it already has property '"+e[n]+"'")}(t);var e=function(t){var e=Object.create(null);return{on:function(n,i,s){if("function"!=typeof i)throw new Error("callback is expected to be a function");var r=e[n];return r||(r=e[n]=[]),r.push({callback:i,ctx:s}),t},off:function(n,i){var s=void 0===n;if(s)return e=Object.create(null),t;if(e[n]){var r="function"!=typeof i;if(r)delete e[n];else for(var o=e[n],a=0;a<o.length;++a)o[a].callback===i&&o.splice(a,1)}return t},fire:function(n){var i,s=e[n];if(!s)return t;arguments.length>1&&(i=Array.prototype.splice.call(arguments,1));for(var r=0;r<s.length;++r){var o=s[r];o.callback.apply(o.ctx,i)}return t}}}(t);return t.on=e.on,t.off=e.off,t.fire=e.fire,t}},"./node_modules/ngraph.graph/index.js":function(t,e,n){t.exports=function(t){"uniqueLinkId"in(t=t||{})&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n","\n","Note: there is also change in default behavior: From now on each graph\nis considered to be not a multigraph by default (each edge is unique)."),t.multigraph=t.uniqueLinkId);void 0===t.multigraph&&(t.multigraph=!1);if("function"!=typeof Map)throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var e=new Map,n=[],h={},u=0,c=t.multigraph?function(t,e,n){var i=l(t,e),s=h.hasOwnProperty(i);if(s||j(t,e)){s||(h[i]=0);var r="@"+ ++h[i];i=l(t+r,e+r)}return new a(t,e,n,i)}:function(t,e,n){var i=l(t,e);return new a(t,e,n,i)},d=[],g=A,p=A,f=A,m=A,_={addNode:x,addLink:function(t,e,i){f();var s=w(t)||x(t),r=w(e)||x(e),a=c(t,e,i);n.push(a),o(s,a),t!==e&&o(r,a);return g(a,"add"),m(),a},removeLink:z,removeNode:E,getNode:w,getNodeCount:S,getLinkCount:k,getLinksCount:k,getNodesCount:S,getLinks:function(t){var e=w(t);return e?e.links:null},forEachNode:N,forEachLinkedNode:function(t,n,i){var s=w(t);if(s&&s.links&&"function"==typeof n)return i?function(t,n,i){for(var s=0;s<t.length;++s){var r=t[s];if(r.fromId===n&&i(e.get(r.toId),r))return!0}}(s.links,t,n):function(t,n,i){for(var s=0;s<t.length;++s){var r=t[s],o=r.fromId===n?r.toId:r.fromId;if(i(e.get(o),r))return!0}}(s.links,t,n)},forEachLink:function(t){var e,i;if("function"==typeof t)for(e=0,i=n.length;e<i;++e)t(n[e])},beginUpdate:f,endUpdate:m,clear:function(){f(),N(function(t){E(t.id)}),m()},hasLink:j,hasNode:w,getLink:j};return i(_),v=_.on,_.on=function(){return _.beginUpdate=f=C,_.endUpdate=m=O,g=y,p=b,_.on=v,v.apply(_,arguments)},_;var v;function y(t,e){d.push({link:t,changeType:e})}function b(t,e){d.push({node:t,changeType:e})}function x(t,n){if(void 0===t)throw new Error("Invalid node identifier");f();var i=w(t);return i?(i.data=n,p(i,"update")):(i=new r(t,n),p(i,"add")),e.set(t,i),m(),i}function w(t){return e.get(t)}function E(t){var n=w(t);if(!n)return!1;f();var i=n.links;if(i){n.links=null;for(var s=0;s<i.length;++s)z(i[s])}return e.delete(t),p(n,"remove"),m(),!0}function S(){return e.size}function k(){return n.length}function z(t){if(!t)return!1;var e=s(t,n);if(e<0)return!1;f(),n.splice(e,1);var i=w(t.fromId),r=w(t.toId);return i&&(e=s(t,i.links))>=0&&i.links.splice(e,1),r&&(e=s(t,r.links))>=0&&r.links.splice(e,1),g(t,"remove"),m(),!0}function j(t,e){var n,i=w(t);if(!i||!i.links)return null;for(n=0;n<i.links.length;++n){var s=i.links[n];if(s.fromId===t&&s.toId===e)return s}return null}function A(){}function C(){u+=1}function O(){0===(u-=1)&&d.length>0&&(_.fire("changed",d),d.length=0)}function N(t){if("function"!=typeof t)throw new Error("Function is expected to iterate over graph nodes. You passed "+t);for(var n=e.values(),i=n.next();!i.done;){if(t(i.value))return!0;i=n.next()}}};var i=n("./node_modules/ngraph.events/index.js");function s(t,e){if(!e)return-1;if(e.indexOf)return e.indexOf(t);var n,i=e.length;for(n=0;n<i;n+=1)if(e[n]===t)return n;return-1}function r(t,e){this.id=t,this.links=null,this.data=e}function o(t,e){t.links?t.links.push(e):t.links=[e]}function a(t,e,n,i){this.fromId=t,this.toId=e,this.data=n,this.id=i}function l(t,e){return t.toString()+" "+e.toString()}},"./node_modules/node-polyglot/index.js":function(t,e,n){"use strict";var i=n("./node_modules/for-each/index.js"),s=n("./node_modules/node-polyglot/node_modules/warning/warning.js"),r=n("./node_modules/has/src/index.js"),o=n("./node_modules/string.prototype.trim/index.js"),a=function(t){s(!1,t)},l=String.prototype.replace,h=String.prototype.split,u="||||",c=function(t){var e=t%100,n=e%10;return 11!==e&&1===n?0:2<=n&&n<=4&&!(e>=12&&e<=14)?1:2},d={pluralTypes:{arabic:function(t){if(t<3)return t;var e=t%100;return e>=3&&e<=10?3:e>=11?4:5},bosnian_serbian:c,chinese:function(){return 0},croatian:c,french:function(t){return t>1?1:0},german:function(t){return 1!==t?1:0},russian:c,lithuanian:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=9&&(t%100<11||t%100>19)?1:2},czech:function(t){return 1===t?0:t>=2&&t<=4?1:2},polish:function(t){if(1===t)return 0;var e=t%10;return 2<=e&&e<=4&&(t%100<10||t%100>=20)?1:2},icelandic:function(t){return t%10!=1||t%100==11?1:0},slovenian:function(t){var e=t%100;return 1===e?0:2===e?1:3===e||4===e?2:3}},pluralTypeToLanguages:{arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]}};function g(t,e){var n,s,r=(n=t.pluralTypeToLanguages,s={},i(n,function(t,e){i(t,function(t){s[t]=e})}),s);return r[e]||r[h.call(e,/-/,1)[0]]||r.en}function p(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var f=/%\{(.*?)\}/g;function m(t,e,n,i,s){if("string"!=typeof t)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==e)return t;var a=t,c=i||f,p=s||d,m="number"==typeof e?{smart_count:e}:e;if(null!=m.smart_count&&a){var _=h.call(a,u);a=o(_[function(t,e,n){return t.pluralTypes[g(t,e)](n)}(p,n||"en",m.smart_count)]||_[0])}return a=l.call(a,c,function(t,e){return r(m,e)&&null!=m[e]?m[e]:t})}function _(t){var e=t||{};this.phrases={},this.extend(e.phrases||{}),this.currentLocale=e.locale||"en";var n=e.allowMissing?m:null;this.onMissingKey="function"==typeof e.onMissingKey?e.onMissingKey:n,this.warn=e.warn||a,this.tokenRegex=function(t){var e=t&&t.prefix||"%{",n=t&&t.suffix||"}";if(e===u||n===u)throw new RangeError('"'+u+'" token is reserved for pluralization');return new RegExp(p(e)+"(.*?)"+p(n),"g")}(e.interpolation),this.pluralRules=e.pluralRules||d}_.prototype.locale=function(t){return t&&(this.currentLocale=t),this.currentLocale},_.prototype.extend=function(t,e){i(t,function(t,n){var i=e?e+"."+n:n;"object"==typeof t?this.extend(t,i):this.phrases[i]=t},this)},_.prototype.unset=function(t,e){"string"==typeof t?delete this.phrases[t]:i(t,function(t,n){var i=e?e+"."+n:n;"object"==typeof t?this.unset(t,i):delete this.phrases[i]},this)},_.prototype.clear=function(){this.phrases={}},_.prototype.replace=function(t){this.clear(),this.extend(t)},_.prototype.t=function(t,e){var n,i,s=null==e?{}:e;if("string"==typeof this.phrases[t])n=this.phrases[t];else if("string"==typeof s._)n=s._;else if(this.onMissingKey){i=(0,this.onMissingKey)(t,s,this.currentLocale,this.tokenRegex,this.pluralRules)}else this.warn('Missing translation for key: "'+t+'"'),i=t;return"string"==typeof n&&(i=m(n,s,this.currentLocale,this.tokenRegex,this.pluralRules)),i},_.prototype.has=function(t){return r(this.phrases,t)},_.transformPhrase=function(t,e,n){return m(t,e,n)},t.exports=_},"./node_modules/node-polyglot/node_modules/warning/warning.js":function(t,e,n){"use strict";var i=function(){};i=function(t,e,n){var i=arguments.length;n=new Array(i>2?i-2:0);for(var s=2;s<i;s++)n[s-2]=arguments[s];if(void 0===e)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");t||function(t,e){var n=arguments.length;e=new Array(n>1?n-1:0);for(var i=1;i<n;i++)e[i-1]=arguments[i];var s=0,r="Warning: "+t.replace(/%s/g,function(){return e[s++]});"undefined"!=typeof console&&console.error(r);try{throw new Error(r)}catch(t){}}.apply(null,[e].concat(n))},t.exports=i},"./node_modules/object-keys/implementation.js":function(t,e,n){"use strict";var i;if(!Object.keys){var s=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=n("./node_modules/object-keys/isArguments.js"),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),h=a.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(t){var e=t.constructor;return e&&e.prototype===t},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},g=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!d["$"+t]&&s.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{c(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();i=function(t){var e=null!==t&&"object"==typeof t,n="[object Function]"===r.call(t),i=o(t),a=e&&"[object String]"===r.call(t),d=[];if(!e&&!n&&!i)throw new TypeError("Object.keys called on a non-object");var p=h&&n;if(a&&t.length>0&&!s.call(t,0))for(var f=0;f<t.length;++f)d.push(String(f));if(i&&t.length>0)for(var m=0;m<t.length;++m)d.push(String(m));else for(var _ in t)p&&"prototype"===_||!s.call(t,_)||d.push(String(_));if(l)for(var v=function(t){if("undefined"==typeof window||!g)return c(t);try{return c(t)}catch(t){return!1}}(t),y=0;y<u.length;++y)v&&"constructor"===u[y]||!s.call(t,u[y])||d.push(u[y]);return d}}t.exports=i},"./node_modules/object-keys/index.js":function(t,e,n){"use strict";var i=Array.prototype.slice,s=n("./node_modules/object-keys/isArguments.js"),r=Object.keys,o=r?function(t){return r(t)}:n("./node_modules/object-keys/implementation.js"),a=Object.keys;o.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return s(t)?a(i.call(t)):a(t)}):Object.keys=o;return Object.keys||o},t.exports=o},"./node_modules/object-keys/isArguments.js":function(t,e,n){"use strict";var i=Object.prototype.toString;t.exports=function(t){var e=i.call(t),n="[object Arguments]"===e;return n||(n="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===i.call(t.callee)),n}},"./node_modules/quadtree-lib/build/js/quadtree.min.js":function(t,e,n){var i,s,r;s=[],void 0===(r="function"==typeof(i=function(){return function(){function t(e){var n,i;if(this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.maxElements=e.maxElements,null==this.width||null==this.height)throw new Error("Missing quadtree dimensions.");if(null==this.x&&(this.x=0),null==this.y&&(this.y=0),null==this.maxElements&&(this.maxElements=1),this.contents=[],this.oversized=[],this.size=0,this.width<1||this.height<1)throw new Error("Dimensions must be positive integers.");if(!Number.isInteger(this.x)||!Number.isInteger(this.y))throw new Error("Coordinates must be integers");if(this.maxElements<1)throw new Error("The maximum number of elements before a split must be a positive integer.");for(n in i=this,this.children={NW:{create:function(){return new t({x:i.x,y:i.y,width:Math.max(Math.floor(i.width/2),1),height:Math.max(Math.floor(i.height/2),1),maxElements:i.maxElements})},tree:null},NE:{create:function(){return new t({x:i.x+Math.max(Math.floor(i.width/2),1),y:i.y,width:Math.ceil(i.width/2),height:Math.max(Math.floor(i.height/2),1),maxElements:i.maxElements})},tree:null},SW:{create:function(){return new t({x:i.x,y:i.y+Math.max(Math.floor(i.height/2),1),width:Math.max(Math.floor(i.width/2),1),height:Math.ceil(i.height/2),maxElements:i.maxElements})},tree:null},SE:{create:function(){return new t({x:i.x+Math.max(Math.floor(i.width/2),1),y:i.y+Math.max(Math.floor(i.height/2),1),width:Math.ceil(i.width/2),height:Math.ceil(i.height/2),maxElements:i.maxElements})},tree:null}},this.children)this.children[n].get=function(){return null!=this.tree?this.tree:(this.tree=this.create(),this.tree)}}var e,n,i,s,r,o,a,l;return s=function(t){var e,n;return{x:Math.floor((null!=(e=t.width)?e:1)/2)+t.x,y:Math.floor((null!=(n=t.height)?n:1)/2)+t.y}},e=function(t,e){var n,i,s,r;return!(t.x>=e.x+(null!=(n=e.width)?n:1)||t.x+(null!=(i=t.width)?i:1)<=e.x||t.y>=e.y+(null!=(s=e.height)?s:1)||t.y+(null!=(r=t.height)?r:1)<=e.y)},n=function(t,e){var n;return n=s(e),t.x<n.x?t.y<n.y?"NW":"SW":t.y<n.y?"NE":"SE"},l=function(t){if("object"!=typeof t)throw new Error("Element must be an Object.");if(null==t.x||null==t.y)throw new Error("Coordinates properties are missing.");if((null!=t?t.width:void 0)<0||(null!=t?t.height:void 0)<0)throw new Error("Width and height must be positive integers.")},o=function(t){var e,n,i,s;return n=Math.max(Math.floor(t.width/2),1),i=Math.ceil(t.width/2),s=Math.max(Math.floor(t.height/2),1),e=Math.ceil(t.height/2),{NW:{x:t.x,y:t.y,width:n,height:s},NE:{x:t.x+n,y:t.y,width:i,height:s},SW:{x:t.x,y:t.y+s,width:n,height:e},SE:{x:t.x+n,y:t.y+s,width:i,height:e}}},i=function(t,n){var i,s,r,a;for(s in a=[],r=o(n))i=r[s],e(t,i)&&a.push(s);return a},r=function(t,e){var n;return(n=function(n){return t["_"+n]=t[n],Object.defineProperty(t,n,{set:function(t){return e.remove(this,!0),this["_"+n]=t,e.push(this)},get:function(){return this["_"+n]},configurable:!0})})("x"),n("y"),n("width"),n("height")},a=function(t){var e;return(e=function(e){if(null!=t["_"+e])return delete t[e],t[e]=t["_"+e],delete t["_"+e]})("x"),e("y"),e("width"),e("height")},t.prototype.clear=function(){var t,e;for(t in this.contents=[],this.oversized=[],this.size=0,e=[],this.children)e.push(this.children[t].tree=null);return e},t.prototype.push=function(t,e){return this.pushAll([t],e)},t.prototype.pushAll=function(t,e){var n,s,o,a,h,u,c,d,g,p,f,m,_,v,y,b,x,w,E,S;for(f=0,v=t.length;f<v;f++)p=t[f],l(p),e&&r(p,this);for(c=[{tree:this,elements:t}];c.length>0;){for(S=(x=c.shift()).tree,d={NW:null,NE:null,SW:null,SE:null},m=0,y=(u=x.elements).length;m<y;m++)if(h=u[m],S.size++,1!==(g=i(h,S)).length||1===S.width||1===S.height)S.oversized.push(h);else if(S.size-S.oversized.length<=S.maxElements)S.contents.push(h);else{for(a=g[0],E=S.children[a],null==d[a]&&(d[a]={tree:E.get(),elements:[]}),d[a].elements.push(h),_=0,b=(w=S.contents).length;_<b;_++)s=w[_],null==d[o=i(s,S)[0]]&&(d[o]={tree:S.children[o].get(),elements:[]}),d[o].elements.push(s);S.contents=[]}for(a in d)null!=(n=d[a])&&c.push(n)}return this},t.prototype.remove=function(t,e){var i,s;return l(t),(i=this.oversized.indexOf(t))>-1?(this.oversized.splice(i,1),this.size--,e||a(t),!0):(i=this.contents.indexOf(t))>-1?(this.contents.splice(i,1),this.size--,e||a(t),!0):!(null==(s=this.children[n(t,this)]).tree||!s.tree.remove(t,e)||(this.size--,0===s.tree.size&&(s.tree=null),0))},t.prototype.colliding=function(t,n){var s,r,o,a,h,u,c,d,g,p,f,m,_,v;for(null==n&&(n=e),l(t),h=[],o=[this];o.length>0;){for(u=0,g=(m=(v=o.shift()).oversized).length;u<g;u++)(r=m[u])!==t&&n(t,r)&&h.push(r);for(c=0,p=(_=v.contents).length;c<p;c++)(r=_[c])!==t&&n(t,r)&&h.push(r);for(0===(a=i(t,v)).length&&(a=[],t.x>=v.x+v.width&&a.push("NE"),t.y>=v.y+v.height&&a.push("SW"),a.length>0&&(1===a.length?a.push("SE"):a=["SE"])),d=0,f=a.length;d<f;d++)s=a[d],null!=v.children[s].tree&&o.push(v.children[s].tree)}return h},t.prototype.onCollision=function(t,n,s){var r,o,a,h,u,c,d,g,p,f,m,_,v;for(null==s&&(s=e),l(t),a=[this];a.length>0;){for(u=0,g=(m=(v=a.shift()).oversized).length;u<g;u++)(o=m[u])!==t&&s(t,o)&&n(o);for(c=0,p=(_=v.contents).length;c<p;c++)(o=_[c])!==t&&s(t,o)&&n(o);for(0===(h=i(t,v)).length&&(h=[],t.x>=v.x+v.width&&h.push("NE"),t.y>=v.y+v.height&&h.push("SW"),h.length>0&&(1===h.length?h.push("SE"):h=["SE"])),d=0,f=h.length;d<f;d++)r=h[d],null!=v.children[r].tree&&a.push(v.children[r].tree)}return null},t.prototype.get=function(t){return this.where(t)},t.prototype.where=function(t){var e,i,s,r,o,a,h,u,c,d,g,p,f;if("object"==typeof t&&(null==t.x||null==t.y))return this.find(function(e){var n,i;for(i in n=!0,t)t[i]!==e[i]&&(n=!1);return n});for(l(t),r=[],s=[this];s.length>0;){for(o=0,u=(d=(f=s.shift()).oversized).length;o<u;o++){for(h in i=d[o],e=!0,t)t[h]!==i[h]&&(e=!1);e&&r.push(i)}for(a=0,c=(g=f.contents).length;a<c;a++){for(h in i=g[a],e=!0,t)t[h]!==i[h]&&(e=!1);e&&r.push(i)}null!=(p=f.children[n(t,f)]).tree&&s.push(p.tree)}return r},t.prototype.each=function(t){var e,n,i,s,r,o,a,l,h,u;for(n=[this];n.length>0;){for(s=0,o=(l=(u=n.shift()).oversized).length;s<o;s++)i=l[s],"function"==typeof t&&t(i);for(r=0,a=(h=u.contents).length;r<a;r++)i=h[r],"function"==typeof t&&t(i);for(e in u.children)null!=u.children[e].tree&&n.push(u.children[e].tree)}return this},t.prototype.find=function(t){var e,n,i,s,r,o,a,l,h,u,c;for(n=[this],s=[];n.length>0;){for(r=0,a=(h=(c=n.shift()).oversized).length;r<a;r++)i=h[r],("function"==typeof t?t(i):void 0)&&s.push(i);for(o=0,l=(u=c.contents).length;o<l;o++)i=u[o],("function"==typeof t?t(i):void 0)&&s.push(i);for(e in c.children)null!=c.children[e].tree&&n.push(c.children[e].tree)}return s},t.prototype.filter=function(e){var n;return(n=function(i){var s,r,o,a,l,h,u,c,d,g,p;for(s in(r=new t({x:i.x,y:i.y,width:i.width,height:i.height,maxElements:i.maxElements})).size=0,i.children)null!=i.children[s].tree&&(r.children[s].tree=n(i.children[s].tree),r.size+=null!=(c=null!=(d=r.children[s].tree)?d.size:void 0)?c:0);for(a=0,h=(g=i.oversized).length;a<h;a++)o=g[a],(null==e||("function"==typeof e?e(o):void 0))&&r.oversized.push(o);for(l=0,u=(p=i.contents).length;l<u;l++)o=p[l],(null==e||("function"==typeof e?e(o):void 0))&&r.contents.push(o);return r.size+=r.oversized.length+r.contents.length,0===r.size?null:r})(this)},t.prototype.reject=function(t){return this.filter(function(e){return!("function"==typeof t?t(e):void 0)})},t.prototype.visit=function(t){var e,n,i;for(n=[this];n.length>0;)for(e in i=n.shift(),t.bind(i)(),i.children)null!=i.children[e].tree&&n.push(i.children[e].tree);return this},t.prototype.pretty=function(){var t,e,n,i,s,r,o;for(r="",n=function(t){var e,n,i;for(i="",e=n=t;n<=0?e<0:e>0;n<=0?++e:--e)i+="   ";return i},e=[{label:"ROOT",tree:this,level:0}];e.length>0;){for(t in r+=(i=n((o=e.shift()).level))+"| "+o.label+"\n"+i+"| ------------\n",o.tree.oversized.length>0&&(r+=i+"| * Oversized elements *\n"+i+"|   "+o.tree.oversized+"\n"),o.tree.contents.length>0&&(r+=i+"| * Leaf content *\n"+i+"|   "+o.tree.contents+"\n"),s=!1,o.tree.children)null!=o.tree.children[t].tree&&(s=!0,e.unshift({label:t,tree:o.tree.children[t].tree,level:o.level+1}));s&&(r+=i+"\n")}return r},t}()})?i.apply(e,s):i)||(t.exports=r)},"./node_modules/split.js/split.js":function(t,e,n){t.exports=function(){"use strict";var t=window,e=t.document,n="addEventListener",i="removeEventListener",s="getBoundingClientRect",r=function(){return!1},o=t.attachEvent&&!t[n],a=["","-webkit-","-moz-","-o-"].filter(function(t){var n=e.createElement("div");return n.style.cssText="width:"+t+"calc(9px)",!!n.style.length}).shift()+"calc",l=function(t){return"string"==typeof t||t instanceof String?e.querySelector(t):t};return function(h,u){var c,d,g,p;void 0===u&&(u={});var f=l(h[0]).parentNode,m=t.getComputedStyle(f).flexDirection,_=u.sizes||h.map(function(){return 100/h.length}),v=void 0!==u.minSize?u.minSize:100,y=Array.isArray(v)?v:h.map(function(){return v}),b=void 0!==u.gutterSize?u.gutterSize:10,x=void 0!==u.snapOffset?u.snapOffset:30,w=u.direction||"horizontal",E=u.cursor||("horizontal"===w?"ew-resize":"ns-resize"),S=u.gutter||function(t,n){var i=e.createElement("div");return i.className="gutter gutter-"+n,i},k=u.elementStyle||function(t,e,n){var i={};return"string"==typeof e||e instanceof String?i[t]=e:i[t]=o?e+"%":a+"("+e+"% - "+n+"px)",i},z=u.gutterStyle||function(t,e){return(n={})[t]=e+"px",n;var n};function j(t,e,n){var i=k(c,e,n);Object.keys(i).forEach(function(e){return t.style[e]=i[e]})}function A(t){var e=p[this.a],n=p[this.b],i=e.size+n.size;e.size=t/this.size*i,n.size=i-t/this.size*i,j(e.element,e.size,this.aGutterSize),j(n.element,n.size,this.bGutterSize)}function C(){var t=p[this.a].element,e=p[this.b].element;this.size=t[s]()[c]+e[s]()[c]+this.aGutterSize+this.bGutterSize,this.start=t[s]()[g]}function O(e){var s=p[this.a].element,o=p[this.b].element;!this.dragging&&u.onDragStart&&u.onDragStart(),e.preventDefault(),this.dragging=!0,this.move=function(t){var e;this.dragging&&((e="touches"in t?t.touches[0][d]-this.start:t[d]-this.start)<=p[this.a].minSize+x+this.aGutterSize?e=p[this.a].minSize+this.aGutterSize:e>=this.size-(p[this.b].minSize+x+this.bGutterSize)&&(e=this.size-(p[this.b].minSize+this.bGutterSize)),A.call(this,e),u.onDrag&&u.onDrag())}.bind(this),this.stop=function(){var e=p[this.a].element,n=p[this.b].element;this.dragging&&u.onDragEnd&&u.onDragEnd(),this.dragging=!1,t[i]("mouseup",this.stop),t[i]("touchend",this.stop),t[i]("touchcancel",this.stop),this.parent[i]("mousemove",this.move),this.parent[i]("touchmove",this.move),delete this.stop,delete this.move,e[i]("selectstart",r),e[i]("dragstart",r),n[i]("selectstart",r),n[i]("dragstart",r),e.style.userSelect="",e.style.webkitUserSelect="",e.style.MozUserSelect="",e.style.pointerEvents="",n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",this.gutter.style.cursor="",this.parent.style.cursor=""}.bind(this),t[n]("mouseup",this.stop),t[n]("touchend",this.stop),t[n]("touchcancel",this.stop),this.parent[n]("mousemove",this.move),this.parent[n]("touchmove",this.move),s[n]("selectstart",r),s[n]("dragstart",r),o[n]("selectstart",r),o[n]("dragstart",r),s.style.userSelect="none",s.style.webkitUserSelect="none",s.style.MozUserSelect="none",s.style.pointerEvents="none",o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",this.gutter.style.cursor=E,this.parent.style.cursor=E,C.call(this)}"horizontal"===w?(c="width",d="clientX",g="left"):"vertical"===w&&(c="height",d="clientY",g="top");var N=[];function L(t){t.forEach(function(e,n){if(n>0){var i=N[n-1],s=p[i.a],r=p[i.b];s.size=t[n-1],r.size=e,j(s.element,s.size,i.aGutterSize),j(r.element,r.size,i.bGutterSize)}})}function M(){N.forEach(function(t){t.parent.removeChild(t.gutter),p[t.a].element.style[c]="",p[t.b].element.style[c]=""})}return p=h.map(function(t,e){var i,r={element:l(t),size:_[e],minSize:y[e]};if(e>0&&((i={a:e-1,b:e,dragging:!1,isFirst:1===e,isLast:e===h.length-1,direction:w,parent:f}).aGutterSize=b,i.bGutterSize=b,i.isFirst&&(i.aGutterSize=b/2),i.isLast&&(i.bGutterSize=b/2),"row-reverse"===m||"column-reverse"===m)){var a=i.a;i.a=i.b,i.b=a}if(!o&&e>0){var u=S(e,w);!function(t,e){var n=z(c,e);Object.keys(n).forEach(function(e){return t.style[e]=n[e]})}(u,b),u[n]("mousedown",O.bind(i)),u[n]("touchstart",O.bind(i)),f.insertBefore(u,r.element),i.gutter=u}0===e||e===h.length-1?j(r.element,r.size,b/2):j(r.element,r.size,b);var d=r.element[s]()[c];return d<r.minSize&&(r.minSize=d),e>0&&N.push(i),r}),o?{setSizes:L,destroy:M}:{setSizes:L,getSizes:function(){return p.map(function(t){return t.size})},collapse:function(t){if(t===N.length){var e=N[t-1];C.call(e),o||A.call(e,e.size-e.bGutterSize)}else{var n=N[t];C.call(n),o||A.call(n,n.aGutterSize)}},destroy:M}}}()},"./node_modules/string.prototype.trim/implementation.js":function(t,e,n){"use strict";var i=n("./node_modules/es-abstract/2020/RequireObjectCoercible.js"),s=n("./node_modules/es-abstract/2020/ToString.js"),r=n("./node_modules/call-bind/callBound.js")("String.prototype.replace"),o=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,a=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;t.exports=function(){var t=s(i(this));return r(r(t,o,""),a,"")}},"./node_modules/string.prototype.trim/index.js":function(t,e,n){"use strict";var i=n("./node_modules/call-bind/index.js"),s=n("./node_modules/define-properties/index.js"),r=n("./node_modules/string.prototype.trim/implementation.js"),o=n("./node_modules/string.prototype.trim/polyfill.js"),a=n("./node_modules/string.prototype.trim/shim.js"),l=i(o());s(l,{getPolyfill:o,implementation:r,shim:a}),t.exports=l},"./node_modules/string.prototype.trim/polyfill.js":function(t,e,n){"use strict";var i=n("./node_modules/string.prototype.trim/implementation.js");t.exports=function(){return String.prototype.trim&&""==="".trim()?String.prototype.trim:i}},"./node_modules/string.prototype.trim/shim.js":function(t,e,n){"use strict";var i=n("./node_modules/define-properties/index.js"),s=n("./node_modules/string.prototype.trim/polyfill.js");t.exports=function(){var t=s();return i(String.prototype,{trim:t},{trim:function(){return String.prototype.trim!==t}}),t}},"./src/@types/Color.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"createColorsForGraphView",function(){return r});var i=n("./node_modules/chroma.ts/dist/index.es.js");function s(t){const e=360*Math.random();let n=Math.random(),s=Math.random();return n=.4*n+.2,s=.25*s+.65,i.color(e,n,s,"hsl").alpha(t)}function r(t,e){const n=[],i=s(e);if(n.push(i.hex("rgba")),t>1){const r=360/t;let o=i.hsl()[0]+r;for(let i=1;i<t;i++){const t=s(e).set("hsl.h",o);n.push(t.hex("rgba")),(o+=r)>360&&(o-=360)}}return n}},"./src/@types/GUI.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"id_prefix",function(){return i});const i="scivi_fsgraph"},"./src/@types/Graph.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"GraphControlling",function(){return i});var i,s=n("./node_modules/ngraph.graph/index.js"),r=n.n(s),o=n("./modified_modules/NonRandomLouvain/index.js"),a=n.n(o),l=n("./src/index.ts");!function(t){function e(t){let e=!1,n=!1;const i=[];if(t.graph.forEachNode(t=>{n=n||t.data.weight;const e=t.data.group;i.includes(e)||i.push(e)}),t.graph.forEachLink(t=>{e=e||t.data.weight}),t.meta.groups_count=i.length,t.meta.links_count=t.graph.getLinksCount(),t.meta.nodes_count=t.graph.getNodesCount(),n){const e={min:1/0,max:-1/0,avg:0};t.graph.forEachNode(t=>(e.max=Math.max(e.max,t.data.weight),e.min=Math.min(e.min,t.data.weight),e.avg+=t.data.weight,!1)),e.avg/=t.graph.getNodesCount(),t.meta.node_weight_range=e,t.graph.forEachNode(e=>{e.data.weight&&(e.data.norm_weight=(e.data.weight-t.meta.node_weight_range.min)/(t.meta.node_weight_range.max-t.meta.node_weight_range.min))})}if(e){const e={min:1/0,max:-1/0,avg:0};t.graph.forEachLink(t=>(e.max=Math.max(e.max,t.data.weight),e.min=Math.min(e.min,t.data.weight),e.avg+=t.data.weight,!1)),e.avg/=t.graph.getLinksCount(),t.meta.link_weight_range=e,t.graph.forEachLink(t=>{t.data.weight&&(t.data.norm_weight=(t.data.weight-e.min)/(e.max-e.min))})}}function n(t){const e=Object.assign({},t);return e.graph=r()(),t.graph.forEachNode(t=>{e.graph.addNode(t.id,t.data)}),t.graph.forEachLink(t=>{e.graph.addLink(t.fromId,t.toId,t.data)}),e}t.EmptyMeta={groups_count:0,nodes_count:0,links_count:0},t.getFirstState=function(t){return t.states[Object.keys(t.states)[0]]},t.updateStateMeta=e,t.updateGraphMeta=function(t){t.meta.node_weight_range=void 0,t.meta.link_weight_range=void 0,Object.values(t.states).forEach(e=>{t.meta.groups_count=Math.max(e.meta.groups_count,t.meta.groups_count),t.meta.links_count=Math.max(e.meta.links_count,t.meta.links_count),t.meta.nodes_count=Math.max(e.meta.nodes_count,t.meta.nodes_count),e.meta.link_weight_range&&(t.meta.link_weight_range||(t.meta.link_weight_range={min:1/0,max:-1/0,avg:0}),t.meta.link_weight_range.min=Math.min(t.meta.link_weight_range.min,e.meta.link_weight_range.min),t.meta.link_weight_range.max=Math.max(t.meta.link_weight_range.max,e.meta.link_weight_range.max),t.meta.link_weight_range.avg+=e.meta.link_weight_range.avg),e.meta.node_weight_range&&(t.meta.node_weight_range||(t.meta.node_weight_range={min:1/0,max:-1/0,avg:0}),t.meta.node_weight_range.min=Math.min(t.meta.node_weight_range.min,e.meta.node_weight_range.min),t.meta.node_weight_range.max=Math.max(t.meta.node_weight_range.max,e.meta.node_weight_range.max),t.meta.node_weight_range.avg+=e.meta.node_weight_range.avg)});const e=Object.keys(t.states).length;t.meta.link_weight_range&&(t.meta.link_weight_range.avg/=e),t.meta.node_weight_range&&(t.meta.node_weight_range.avg/=e)},t.copyState=n,t.clusterize=function(t){const e=a()(t.graph),n=[];let i=-1;t.graph.forEachNode(function(t){const s=e.getClass(t.id);if(t.links&&0!=t.links.length){let e=n.indexOf(s);-1==e&&(n.push(s),e=n.length-1),t.data.group=e}else-1==i&&(n.push(s),i=n.length-1),t.data.group=i}),t.meta.groups_count=n.length},t.calculateState=function(t,i){function s(t,e){let n=null;return t.graph.forEachNode(t=>{t.data.label==e&&(n=t)}),n}function r(t,e,n){let i=null;return t.graph.forEachLink(s=>{if(!i){const r=t.graph.getNode(s.fromId),o=t.graph.getNode(s.toId);r.data.label==e&&o.data.label==n&&(i=s)}}),i}function o(t,e){t.graph.beginUpdate(),e.graph.forEachNode(e=>{const n=s(t,e.data.label);n?n.data.weight=Math.max(n.data.weight,e.data.weight):t.graph.addNode(t.graph.getNodesCount(),e.data)}),e.graph.forEachLink(n=>{let i=e.graph.getNode(n.fromId),o=e.graph.getNode(n.toId);const a=r(t,i.data.label,o.data.label);a?a.data.weight=Math.max(a.data.weight,n.data.weight):(i=s(t,i.data.label),o=s(t,o.data.label),t.graph.addLink(i.id,o.id,n.data))}),t.graph.endUpdate()}function a(t,e){const n=[],i=[];t.graph.forEachLink(n=>{const s=t.graph.getNode(n.fromId),o=t.graph.getNode(n.toId);r(e,s.data.label,o.data.label)||i.push(n)}),t.graph.forEachNode(t=>{s(e,t.data.label)||n.push(t.id)}),t.graph.beginUpdate(),i.forEach(e=>t.graph.removeLink(e)),n.forEach(e=>t.graph.removeNode(e)),t.graph.endUpdate()}function h(t,e){const n=[],i=[];t.graph.forEachLink(n=>{const s=t.graph.getNode(n.fromId),o=t.graph.getNode(n.toId);r(e,s.data.label,o.data.label)&&i.push(n)}),t.graph.forEachNode(t=>{const i=s(e,t.data.label);i?n.push(t.id):t.data.weight=Math.max(t.data.weight-i.data.weight,0)}),t.graph.beginUpdate(),i.forEach(e=>t.graph.removeLink(e)),n.forEach(e=>t.graph.removeNode(e)),t.graph.endUpdate()}function u(t,e){const n=[],i=[];t.graph.forEachLink(n=>{const s=t.graph.getNode(n.fromId),o=t.graph.getNode(n.toId);r(e,s.data.label,o.data.label)&&i.push(n)}),t.graph.forEachNode(t=>{s(e,t.data.label)&&n.push(t.id)}),t.graph.beginUpdate(),i.forEach(e=>t.graph.removeLink(e)),n.forEach(e=>t.graph.removeNode(e)),t.graph.endUpdate(),e.graph.forEachNode(e=>{s(t,e.data.label)||t.graph.addNode(t.graph.getNodesCount(),e.data)}),e.graph.forEachLink(n=>{let i=e.graph.getNode(n.fromId),o=e.graph.getNode(n.toId);r(t,i.data.label,o.data.label)||(i=s(t,i.data.label),o=s(t,o.data.label),t.graph.addLink(i.id,o.id,n.data))})}i.length%2==0&&console.log("incorrect expression for calculation: extra symbols");const c=n(t.states[i[0]]);c.label="calculated";for(let e=1;e<i.length;e+=2)switch(i[e]){case l.StateCalculatorOperand.UNION:o(c,t.states[i[e+1]]);break;case l.StateCalculatorOperand.INTERSECT:a(c,t.states[i[e+1]]);break;case l.StateCalculatorOperand.DIFF:h(c,t.states[i[e+1]]);break;case l.StateCalculatorOperand.SYMDIFF:u(c,t.states[i[e+1]]);break;default:console.log("incorrect expression: invalid operation")}return e(c),c}}(i||(i={}))},"./src/@types/GraphView.ts":function(t,e,n){"use strict";var i;n.r(e),n.d(e,"GraphView",function(){return i}),function(t){t.onNodesReplaced=function(){this.quad_tree.clear(),Object.keys(this.aabbs).forEach(t=>{const e=this.aabbs[t],n=e.scene_object;e.x=n.position.x-n.size,e.y=n.position.y-n.size,this.quad_tree.push(e)})}}(i||(i={}))},"./src/@types/Param.ts":function(t,e,n){"use strict";var i;n.r(e),n.d(e,"ParamType",function(){return i}),n.d(e,"Param",function(){return s}),n.d(e,"ScalarParam",function(){return r}),n.d(e,"BooleanParam",function(){return o}),function(t){t[t.UNKNONW=0]="UNKNONW",t[t.NUMBER=1]="NUMBER",t[t.BOOLEAN=2]="BOOLEAN"}(i||(i={}));class s{Reset(){this._value=this._range.default}get range(){return this._range}get type(){return this._type}get value(){return this._value}}class r extends s{constructor(t,e,n,s){super(),n=n?Math.min(Math.max(n,t),e):t,this._range={min:t,max:e,default:n,step:s||0},this._value=n,this._type=i.NUMBER}get value(){return this._value}set value(t){this._value=Math.min(Math.max(t,this._range.min),this._range.max)}}class o extends s{constructor(t){super(),this._value=t||!1,this._range={min:!1,max:!0,default:t||!1},this._type=i.BOOLEAN}get value(){return this._value}set value(t){this._value=t}}},"./src/CanvasManager/CanvasManager.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"CanvasManager",function(){return c});var i=n("./node_modules/quadtree-lib/build/js/quadtree.min.js"),s=n("./src/@types/GraphView.ts"),r=n("./modified_modules/tsm/vec2.ts"),o=n("./src/CanvasManager/InputManager.ts"),a=n("./src/CanvasManager/GraphRenderer.ts"),l=n("./src/CanvasManager/EventHandlers.ts"),h=n("./node_modules/chroma.ts/dist/index.es.js"),u=s.GraphView.onNodesReplaced;class c{constructor(t,e){this.node_weight_range={min:-1/0,max:1/0,default:0},this.link_weight_range={min:-1/0,max:1/0,default:0},this.graph_view=null,this.view_configuration=null,this.controller=e,this.toggled_node=null,this.canvas=t,this.inputManager=new o.InputManager,this.inputManager.bindCanvas(t,this.detectObjectsUnderCursor.bind(this)),this.renderer=new a.default(t)}bindGraph(t,e){if(this.view_configuration=e,!e)throw new DOMException("There's no view configuration for graph");const n=this.makeGraphView(t.graph,this.view_configuration);this.graph_view&&(Object.keys(n.nodes).forEach(t=>{if(this.graph_view.nodes.hasOwnProperty(t)){const i=n.nodes[t];i.position=this.graph_view.nodes[t].position,i.position.length()>e.scene_size&&i.position.normalize().scale(e.scene_size)}}),n.onNodesReplaced()),this.graph_view=n,this.inputManager.bindScene(this.graph_view),this.renderer.bindGraphView(this.graph_view,this.view_configuration)}updateViewConfiguration(){Object.keys(this.graph_view.nodes).forEach(t=>{const e=this.graph_view.nodes[t],n=this.view_configuration.node_colors_per_group[e.group];e.base_color=h.color(n),e.color=h.color(n)})}update(){this.renderer.render()}layoutGraph(t){t.layout(this.graph_view,this.view_configuration.scene_size)}translateGraph(t){this.renderer.moveCamera(t)}zoomAt(t){this.renderer.scaleGraph(t)}translateNode(t,e){const n=this.graph_view.nodes[t.id],i=this.view_configuration.scene_size;n.position.x+=e.x*i/this.scaleFactor,n.position.y+=e.y*i/this.scaleFactor}HideNode(t){const e=t.id,n=this.graph_view.nodes[e];if(!n.is_hidden){const t=n.group;this.view_configuration.node_renderer_per_group[t].deleteObject(n),n.is_hidden=!0,this.graph_view.quad_tree.remove(this.graph_view.aabbs[e]),this.graph_view.graph_logic_model.getLinks(e).forEach(t=>{this.HideLink(t)})}}ShowNode(t){const e=t.id,n=this.graph_view.nodes[e];if(n.is_hidden&&(!t.data.weight||t.data.weight>=this.node_weight_range.min&&t.data.weight<=this.node_weight_range.max)){const t=n.group;this.view_configuration.node_renderer_per_group[t].addObject(n),n.is_hidden=!1,this.graph_view.quad_tree.push(this.graph_view.aabbs[e]),this.graph_view.graph_logic_model.getLinks(e).forEach(t=>{const e=this.graph_view.nodes[t.toId],n=this.graph_view.nodes[t.fromId];e.is_hidden||n.is_hidden||this.ShowLink(t)})}}ToggleNode(t){const e=this.graph_view.nodes[t.id];this.toggled_node&&t.id==this.toggled_node.node_logic_model.id?(this.toggled_node.is_toggled=!1,c.DeEmphasizeNode(this.toggled_node),this.DeselectAdjacentNodes(this.toggled_node),this.toggled_node=null,this.controller("OnToggleOffNode",{node:t})):(this.toggled_node&&(this.toggled_node.is_toggled=!1,c.DeEmphasizeNode(this.toggled_node),this.DeselectAdjacentNodes(this.toggled_node),this.controller("OnToggleOffNode",{node:t})),this.toggled_node=e,this.toggled_node.is_toggled=!0,c.EmphasizeNode(this.toggled_node),this.SelectAdjacentNodes(e),this.controller("OnToggleOnNode",{node:t}))}SelectNode(t){const e=t.id,n=this.graph_view.nodes[e];n.is_selected=!0,c.EmphasizeNode(n),this.SelectAdjacentNodes(n),this.controller("OnSelectNode",{node:t})}DeselectNode(t){const e=t.id,n=this.graph_view.nodes[e];n.is_selected=!1,c.DeEmphasizeNode(n),this.DeselectAdjacentNodes(n),this.controller("OnDeselectNode",{node:t})}HoverOnNode(t){const e=t.id,n=this.graph_view.nodes[e];n.is_hovered=!0,c.EmphasizeNode(n),this.SelectAdjacentNodes(n)}HoverOffNode(t){const e=t.id,n=this.graph_view.nodes[e];n.is_hovered=!1,c.DeEmphasizeNode(n),this.DeselectAdjacentNodes(n)}ShowLink(t){const e=this.graph_view.links[t.id];if(e.is_hidden&&(!t.data.weight||t.data.weight>=this.link_weight_range.min&&t.data.weight<=this.link_weight_range.max)){this.view_configuration.link_renderer.addObject(e),e.is_hidden=!1}}HideLink(t){const e=this.graph_view.links[t.id];if(!e.is_hidden){this.view_configuration.link_renderer.deleteObject(e),e.is_hidden=!0}}setNodeWeightFilter(t,e){this.node_weight_range.min=t,this.node_weight_range.max=e,this.graph_view.graph_logic_model.forEachNode(t=>(!t.data.weight||t.data.weight>=this.node_weight_range.min&&t.data.weight<=this.node_weight_range.max?this.ShowNode(t):this.HideNode(t),!1))}setLinkWeightFilter(t,e){this.link_weight_range.min=t,this.link_weight_range.max=e,this.graph_view.graph_logic_model.forEachLink(t=>{const e=this.graph_view.nodes[t.toId],n=this.graph_view.nodes[t.fromId],i=!t.data.weight||t.data.weight>=this.link_weight_range.min&&t.data.weight<=this.link_weight_range.max;return e.is_hidden||n.is_hidden||!i?this.HideLink(t):this.ShowLink(t),!1})}toggleLabelsShowing(){this.renderer.toggleLabelsShowing()}setNodeSizeRange(t,e){const n=this.view_configuration;Object.values(this.graph_view.nodes).forEach(i=>{const s=i.node_logic_model.data.norm_weight;i.size=Math.max(Math.min(n.node_sizer(s),e),t)})}setLinkSizeRange(t,e){const n=this.view_configuration;Object.values(this.graph_view.links).forEach(i=>{const s=i.link_logic_model.data.norm_weight;i.size=Math.max(Math.min(n.link_sizer(s),e),t)})}detectObjectsUnderCursor(t){this.renderer.CursorPos=t;const e=this.renderer.CursorPosAtScene,n={x:e.x,y:e.y,width:.05,height:.05};return this.graph_view.quad_tree.colliding(n)}get scaleFactor(){return this.renderer.scaleFactor}makeGraphView(t,e){const n={},s={},r={},o=[],a=new i({width:e.scene_size,height:e.scene_size,maxElements:3}),h={nodes:n,node_groups:s,links:o,node_links:r,graph_logic_model:t,quad_tree:a,aabbs:{},onDrag:l.onDragScene.bind(this),onDragEnd:null,onZoom:l.onZoom.bind(this)};return h.onNodesReplaced=u.bind(h),t.forEachNode(t=>{const i=t.data.group,o=c.makeNodeView(t,h,e);return s[i]||(s[i]=[]),n[t.id]=o,s[i][t.id]=o,r[t.id]=[],!1}),t.forEachLink(n=>{const i=t.getNode(n.fromId),a=t.getNode(n.toId),l=i.data.group,h=a.data.group,u=s[l][i.id],d=s[h][a.id],g=c.makeLinkView(u,d,n,e);return o[n.id]=g,r[n.fromId].push(g),!1}),h.quad_tree.clear(),Object.keys(h.nodes).forEach(t=>{const e=this.makeAABB(h.nodes[t]);h.aabbs[t]=e,h.quad_tree.push(e)}),h}static makeNodeView(t,e,n){const i=t.data.norm_weight,s=t.data.group,o=new r.default([120*Math.random()-60,120*Math.random()-60]),a=n.node_colors_per_group[s];return{group:s,position:o,base_color:h.color(a),color:h.color(a),is_hovered:!1,is_selected:!1,is_toggled:!1,is_emphasized:!1,selected_adjacent_vertex_count:0,is_hidden:!1,size:Math.max(Math.min(n.node_sizer(i),n.max_node_size),n.min_node_size),label:t.data.label,node_logic_model:t,graph_view:e,zOrder:0}}static makeLinkView(t,e,n,i){const s=n.data.norm_weight;return{from:t,to:e,size:Math.max(Math.min(i.link_sizer(s),i.max_link_size),i.min_link_size),alpha:1,zOrder:0,is_emphasized:!1,is_hidden:!1,painter:i.link_painter,link_logic_model:n}}makeAABB(t){return{x:t.position.x-t.size,y:t.position.y-t.size,width:2*t.size,height:2*t.size,scene_object:t,onClick:l.onClickNode.bind(this),onDrag:l.onDragNode.bind(this),onDragEnd:l.onDragEndNode.bind(this),onEnter:l.onEnterNode.bind(this),onLeave:l.onLeaveNode.bind(this)}}SelectAdjacentNodes(t){this.graph_view.node_links[t.node_logic_model.id].forEach(t=>{const e=t.to;e.selected_adjacent_vertex_count++,c.EmphasizeNode(e),c.EmphasizeLink(t)})}DeselectAdjacentNodes(t){this.graph_view.node_links[t.node_logic_model.id].forEach(t=>{const e=t.to;e.selected_adjacent_vertex_count--,c.DeEmphasizeNode(e),c.DeEmphasizeLink(t)})}static EmphasizeNode(t){!t.is_emphasized&&(t.is_hovered||t.is_selected||t.is_toggled||t.selected_adjacent_vertex_count>0)&&(t.color=t.color.set("hsl.l",.5).saturate(1),t.zOrder++,t.is_emphasized=!0)}static DeEmphasizeNode(t){!t.is_emphasized||t.is_toggled||t.is_selected||t.is_hovered||0!=t.selected_adjacent_vertex_count||(t.color=h.color(t.base_color.toString()),t.zOrder--,t.is_emphasized=!1)}static EmphasizeLink(t){const e=t.from;t.to;!t.is_emphasized&&(e.is_selected||e.is_hovered||e.is_toggled)&&(t.zOrder++,t.is_emphasized=!0)}static DeEmphasizeLink(t){const e=t.from;t.to;!t.is_emphasized||e.is_hovered||e.is_selected||e.is_toggled||(t.zOrder--,t.is_emphasized=!1)}}},"./src/CanvasManager/EventHandlers.ts":function(t,e,n){"use strict";async function i(t,e){this.translateGraph(e),this.update()}async function s(t,e,n){this.zoomAt(e),this.update()}async function r(t,e){const n=this,i=t.scene_object;e.shiftKey&&0==e.button?i.is_selected?n.DeselectNode(i.node_logic_model):n.SelectNode(i.node_logic_model):0==e.button?n.ToggleNode(i.node_logic_model):e.button,n.update()}async function o(t,e){const n=t.scene_object;this.translateNode(n.node_logic_model,e),this.update()}async function a(t){const e=t,n=e.scene_object,i=n.graph_view.quad_tree;i.remove(e),e.x=n.position.x-n.size,e.y=n.position.y-n.size,i.push(e)}async function l(t){const e=t.scene_object;this.HoverOnNode(e.node_logic_model),this.update()}async function h(t){const e=t.scene_object;this.HoverOffNode(e.node_logic_model),this.update()}n.r(e),n.d(e,"onDragScene",function(){return i}),n.d(e,"onZoom",function(){return s}),n.d(e,"onClickNode",function(){return r}),n.d(e,"onDragNode",function(){return o}),n.d(e,"onDragEndNode",function(){return a}),n.d(e,"onEnterNode",function(){return l}),n.d(e,"onLeaveNode",function(){return h})},"./src/CanvasManager/GraphRenderer.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return a});var i=n("./modified_modules/tsm/mat3.ts"),s=n("./modified_modules/tsm/vec2.ts"),r=n("./src/Renderers/_ShaderCompiler.ts"),o=n("./node_modules/chroma.ts/dist/index.es.js");class a{constructor(t){this.canvas=t,this.context2D=this.canvas.getContext("2d",{alpha:!1}),this.gl_canvas=document.createElement("canvas");try{this.gl=this.gl_canvas.getContext("webgl",{premultipliedAlpha:!1})}catch(t){this.gl=null,console.error("Can't create webgl context")}this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.ALWAYS),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND),this.gl.enable(this.gl.CULL_FACE),this.camera_pos=new s.default([0,0]),this.zoom_direction=new s.default([0,0]),this.cursor_pos_Scene=new s.default([0,0]),this.PV=i.default.identity.copy(),this.PV_inv=i.default.identity.copy(),this.P=i.default.identity.copy(),this.S=i.default.identity.copy(),this.always_show_labels=!1}bindGraphView(t,e){this.graph_view=t,this.view_configuration=e,e.scroll_value.Reset(),e.link_renderer.bindContext(this.gl,r.ShaderCompiler_default),Object.keys(e.node_renderer_per_group).forEach(t=>{e.node_renderer_per_group[t].bindContext(this.gl,r.ShaderCompiler_default)}),e.link_renderer.clearObjects(),Object.keys(e.node_renderer_per_group).forEach(t=>e.node_renderer_per_group[t].clearObjects()),Object.keys(this.graph_view.node_groups).forEach(t=>{this.graph_view.node_groups[t].forEach(n=>{e.node_renderer_per_group[t].addObject(n)})}),Object.keys(this.graph_view.links).forEach(t=>{e.link_renderer.addObject(this.graph_view.links[t])})}render(){const t={x:0,y:0,width:this.canvas.clientWidth,height:this.canvas.clientHeight},e=t.width/t.height,n=this.view_configuration;a.resizeCanvasFramebuffer(this.canvas,t.width,t.height),a.resizeCanvasFramebuffer(this.gl_canvas,t.width*a.samples_count,t.height*a.samples_count),this.gl.viewport(0,0,t.width*a.samples_count,t.height*a.samples_count);const s=1/e/n.scene_size,r=1/n.scene_size;let o=this.camera_pos.x*s,l=this.camera_pos.y*r;this.P.init([s,0,0,0,r,0,o,l,1]);const h=this.view_configuration.scroll_value.value,u=-this.zoom_direction.x*h+this.zoom_direction.x,c=-this.zoom_direction.y*h+this.zoom_direction.y;this.S.init([h,0,0,0,h,0,u,c,1]),i.default.product(this.P,this.S,this.PV),this.PV_inv.init(this.PV.all()),this.PV_inv.inverse(),this.drawn_nodes=Object.keys(this.graph_view.nodes).map(t=>this.graph_view.nodes[t]),this.drawn_links=Object.keys(this.graph_view.links).map(t=>this.graph_view.links[t]),this.context2D.fillStyle="white",this.context2D.fillRect(0,0,this.canvas.width,this.canvas.height),this.renderGraph(),this.drawLabels(),a.draw_aabb&&this.drawAABBs()}moveCamera(t){this.camera_pos.x+=t.x*this.view_configuration.scene_size,this.camera_pos.y+=t.y*this.view_configuration.scene_size}scaleGraph(t){t=Math.pow(1.25,t);let e=s.default.difference(this.cursor_pos_Scene,this.zoom_direction);this.view_configuration.scroll_value.value*=t,this.zoom_direction.x+=e.x*t,this.zoom_direction.y+=e.y*t}rotateGraph(){}get scaleFactor(){return this.view_configuration.scroll_value.value}get CursorPosAtScene(){return this.cursor_pos_Scene}set CursorPos(t){this.cursor_pos_Scene.x=t.x,this.cursor_pos_Scene.y=t.y,this.ClientToScene(this.cursor_pos_Scene)}toggleLabelsShowing(){this.always_show_labels=!this.always_show_labels}SceneToClient(t){this.PV.multiplyVec2(t,t),t.x=(t.x+1)*this.canvas.clientWidth/2,t.y=(1-t.y)*this.canvas.clientHeight/2}ClientToScene(t){const e=this.canvas.getBoundingClientRect();t.x=2*(t.x-e.left)/e.width-1,t.y=2*(t.y-e.top)/e.height-1,t.y*=-1,this.PV_inv.multiplyVec2(t,t)}renderGraph(){const t=this.view_configuration;this.drawn_nodes.forEach(e=>{t.node_renderer_per_group[e.group].updateObject(e)}),this.drawn_links.forEach(e=>{t.link_renderer.updateObject(e)}),t.link_renderer.sortObjects(),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),t.link_renderer.render(this.PV),Object.keys(t.node_renderer_per_group).forEach(e=>{t.node_renderer_per_group[e].render(this.PV)}),this.context2D.drawImage(this.gl_canvas,0,0,this.canvas.width,this.canvas.height)}drawLabels(){const t=this.view_configuration.label_font_size,e=(this.view_configuration.label_painter,new s.default),n=this.drawn_nodes.filter(t=>this.always_show_labels||!t.is_hidden&&(t.is_toggled||t.is_selected||t.is_hovered||t.selected_adjacent_vertex_count>0));n.forEach(i=>{e.x=0,e.y=0,n.forEach(t=>{const n=t.position.x-i.position.x,s=t.position.y-i.position.y,r=Math.sqrt(n*n+s*s);r>0&&(e.x+=n/r,e.y+=s/r)});const s=e.y/e.x;e.x>0&&s>1||e.x<0&&s<-1?(e.x=0,e.y=1):s<=1&&s>-1?(e.y=0,e.x>0?e.x=1:e.x=-1):(e.x>0&&s<-1||e.x<0&&s>1)&&(e.x=0,e.y=-1);const r=-e.x,o=-e.y;e.y=i.position.y+o*i.size,e.x=i.position.x+r*i.size,this.SceneToClient(e);const a=this.context2D.measureText(i.label).width+10;e.x+=r*(a/2),e.y-=o*t,this.drawLabel(i.label,{x:e.x,y:e.y},"#000000",t,5,"#FFFFFF",!0)})}drawLabel(t,e,n,i,s,r,a){this.context2D.font=i+"px sans-serif";const l=this.context2D.measureText(t).width,h=l+2*s,u=i+2*s;this.context2D.fillStyle=o.color(r).css(),this.context2D.fillRect(e.x-h/2,e.y-u/2,h,u),this.context2D.fillStyle=o.color(n).css(),this.context2D.fillText(t,e.x-l/2,e.y+s),a&&this.context2D.strokeRect(e.x-h/2,e.y-u/2,h,u)}drawAABBs(){var t=new s.default,e=new s.default;this.graph_view.quad_tree.each(n=>{t.x=n.x,t.y=n.y,e.x=n.x+n.width,e.y=n.y+n.height,this.SceneToClient(t),this.SceneToClient(e),this.context2D.strokeRect(t.x,t.y,e.x-t.x,e.y-t.y)})}drawCursor(){var t=new s.default(this.cursor_pos_Scene.xy);this.SceneToClient(t),this.context2D.fillRect(t.x-2.5,t.y-2.5,5,5)}static resizeCanvasFramebuffer(t,e,n){t.width===e&&t.height===n||(t.width=e,t.height=n)}}a.dScale=1.25,a.samples_count=2,a.draw_aabb=!1},"./src/CanvasManager/InputManager.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"InputManager",function(){return s});var i=n("./modified_modules/tsm/tsm.ts");class s{constructor(){this.hovered_objects=[],this.cursor_pos=new i.vec2([0,0]),this.old_cursor_pos=new i.vec2([0,0]),this.cursor_offset=new i.vec2([0,0])}bindCanvas(t,e){this.canvas=t,document.onmousedown=this.onMouseDown.bind(this),document.onmouseup=this.onMouseUp.bind(this),document.onmousemove=this.onMouseMove.bind(this),this.canvas.onwheel=this.onCanvasScroll.bind(this),this.canvas.ondblclick=this.onDblCLick.bind(this),this.object_detector=e}bindScene(t){this.scene=t}onMouseDown(t){const e=this.canvas.getBoundingClientRect();t.clientX>e.left&&t.clientX<e.right&&t.clientY>e.top&&t.clientY<e.bottom&&(this.old_cursor_pos.xy=[t.clientX,t.clientY],this.cursor_pos.xy=this.old_cursor_pos.xy,this.mouse_moved=!1,this.mouse_pressed=!0)}onMouseUp(t){this.mouse_pressed&&this.hovered_objects.length>0&&(this.mouse_moved?this.hovered_objects[0].onDragEnd&&this.hovered_objects[0].onDragEnd(this.hovered_objects[0]):this.hovered_objects[0].onClick&&this.hovered_objects[0].onClick(this.hovered_objects[0],t)),this.mouse_moved=!1,this.mouse_pressed=!1}onMouseMove(t){const e=this.canvas.width/this.canvas.height;if(this.cursor_pos.x=t.clientX,this.cursor_pos.y=t.clientY,this.mouse_pressed)this.cursor_offset.x=2*(this.cursor_pos.x-this.old_cursor_pos.x)*s.mouse_sensitivity*e/this.canvas.width,this.cursor_offset.y=-2*(this.cursor_pos.y-this.old_cursor_pos.y)*s.mouse_sensitivity/this.canvas.height,this.hovered_objects.length>0&&this.hovered_objects[0].onDrag?this.hovered_objects[0].onDrag(this.hovered_objects[0],this.cursor_offset):0==this.hovered_objects.length&&this.scene.onDrag&&this.scene.onDrag(this.scene,this.cursor_offset),this.old_cursor_pos.x=this.cursor_pos.x,this.old_cursor_pos.y=this.cursor_pos.y,this.mouse_moved=!0;else{const t=this.object_detector(this.cursor_pos);this.hovered_objects.filter(e=>-1==t.indexOf(e)&&e.onLeave).forEach(t=>t.onLeave(t)),t.filter(t=>-1==this.hovered_objects.indexOf(t)&&t.onEnter).forEach(t=>t.onEnter(t)),this.hovered_objects=t}}onDblCLick(t){this.hovered_objects.length>0&&this.hovered_objects[0].onDblClick&&this.hovered_objects[0].onDblClick(this.hovered_objects[0],t)}onCanvasScroll(t){this.scene.onZoom&&this.scene.onZoom(this.scene,t.deltaY/-100,this.cursor_pos)}}s.mouse_sensitivity=1},"./src/GUI.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"GUI",function(){return v});var i=n("./node_modules/split.js/split.js"),s=n("./src/CanvasManager/CanvasManager.ts"),r=n("./src/@types/Graph.ts"),o=n("./src/@types/GUI.ts"),a=n("./node_modules/chroma.ts/dist/index.es.js"),l=n("./src/@types/Color.ts"),h=r.GraphControlling.getFirstState,u=r.GraphControlling.calculateState;const c=o.id_prefix+"_graph_view",d=o.id_prefix+"_canvas",g=o.id_prefix+"_rotate_bar",p=o.id_prefix+"_state_bar",f=o.id_prefix+"_state_stub",m=o.id_prefix+"_state_stub_btn",_=o.id_prefix+"_tabs";class v{constructor(t){this.canvas_manager=null,this.out_controller=t}build(t,e,n){this.gui_configuration=e,this.translator=n,t.innerHTML=`\n        <aside id=${c} class="split split-horizontal">\n            <div id=${g} class="ui-slider-handle">\n                <div id=${g}_handle class="ui-slider-handle"></div>\n            </div>\n            <canvas id=${d} tabindex=0></canvas>\n            \n            <div id=${p} style="position: relative">\n                 <div id=${p}_line></div>\n                 <div id=${p}_labels></div>\n                 <div id=${f} class="scivi_state_line_curtain scivi_state_line_curtain_bg">\n                    <div id=${m} class="scivi_state_line_curtain_lbl">\n                        ${this.translator.apply("LOC_STATECALCULATED")}\n                    </div>\n                </div>\n            </div>\n        </aside>`;const s=document.getElementById(f);if(s.style.display="flex",s.style.flexDirection="column",s.style.justifyContent="center",s.style.alignItems="center",document.getElementById(m).onclick=(()=>{v.hideStateBarStub();const t=$("#"+p+"_line").slider("option","value"),e=Object.values(this.bound_graph.states)[t||0];this.setState(e)}),v.hideStateBarStub(),Object.keys(e).length>0){const s=document.createElement("aside");s.className="split split-horizontal",s.id=_;const r=document.createElement("ul");s.appendChild(r),Object.keys(e).forEach(t=>{const e=document.createElement("li"),i="#"+t;e.innerHTML=`<a id=${o.id_prefix+t+"_link"} href=${i}>${n.apply(i)}</a>`,r.appendChild(e)}),Object.keys(e).forEach(t=>{const e=document.createElement("div");e.id=t,s.appendChild(e)}),t.appendChild(s),i(["#"+c,"#"+_],{gutterSize:8,cursor:"col-resize",sizes:[55,45],onDrag:()=>this.canvas_manager.update()}),$("#"+_).tabs({heightStyle:"fill"})}this.initGraphViewPanel(),Object.keys(e).forEach(t=>{const i=document.getElementById(t);e[t].build(i,this.TabsController.bind(this),n)}),document.body.onresize=(()=>this.canvas_manager.update())}bindGraph(t,e){Object.keys(t.states).length>0&&(this.bound_graph=t,Object.keys(t.states).length>1&&this.fillStateBar(),this.view_configuration=e,this.setState(h(t)),this.gui_configuration.calculator_tab&&this.gui_configuration.calculator_tab.fill(t))}initGraphViewPanel(){const t=document.getElementById(c);t.style.display="flex",t.style.flexDirection="column";const e=document.getElementById(g);e.style.marginTop="0.5rem",e.style.marginBottom="0.5rem",e.style.marginLeft="2rem",e.style.marginRight="2rem";const n=$("#"+g+"_handle");$("#"+g).slider({min:-180,max:180,value:0,step:5,slide:(t,e)=>{const i=e.value||0;n.text(`${i}`)},create:()=>n.text("0")});const i=document.getElementById(d);i.style.border="solid white 1px",i.style.flex="1 1 auto",i.oncontextmenu=function(t){t.preventDefault(),t.stopPropagation()},this.canvas_manager=new s.CanvasManager(i,this.CanvasManagerController.bind(this))}fillStateBar(){const t=Object.keys(this.bound_graph.states).length,e=100/t,n=document.getElementById(p+"_line");n.style.marginTop="0.5rem",n.style.marginRight=`${e/2}%`,n.style.marginLeft=`${e/2}%`,$("#"+p+"_line").slider({min:0,max:t-1,value:0,step:1,slide:(t,e)=>{const n=Object.values(this.bound_graph.states)[e.value||0];this.setState(n)}});const i=document.getElementById(p+"_labels");Object.keys(this.bound_graph.states).forEach(t=>{const n=document.createElement("div");n.style.display="inline-block",n.style.textAlign="center",n.innerHTML=`<span>|</span><br/><label>${t}</label>`,n.classList.add("scivi_fsgraph_stateline_label"),n.style.width=`${e}%`,i.appendChild(n)})}static showStateBarStub(){document.getElementById(f).style.display="flex"}static hideStateBarStub(){document.getElementById(f).style.display="none"}async CanvasManagerController(t,e){switch(t){case"OnToggleOnNode":this.gui_configuration.node_info_tab&&this.gui_configuration.node_info_tab.fill({graph:this.active_state,node:e.node});break;case"OnToggleOffNode":this.gui_configuration.node_info_tab&&this.gui_configuration.node_info_tab.clear();break;case"OnSelectNode":this.gui_configuration.node_list_tab&&this.gui_configuration.node_list_tab.onSelectedNode(e.node);break;case"OnDeselectNode":this.gui_configuration.node_list_tab&&this.gui_configuration.node_list_tab.onDeselectedNode(e.node)}}async TabsController(t,e){switch(t){case"layout":this.canvas_manager.layoutGraph(e.builder);break;case"SelectNode":this.canvas_manager.SelectNode(e.node);break;case"DeselectNode":this.canvas_manager.DeselectNode(e.node);break;case"ShowNode":this.canvas_manager.ShowNode(e.node);break;case"HideNode":this.canvas_manager.HideNode(e.node);break;case"FilterNodes":this.canvas_manager.setNodeWeightFilter(e.min,e.max);break;case"FilterLinks":this.canvas_manager.setLinkWeightFilter(e.min,e.max);break;case"SetNodeSizeRange":this.canvas_manager.setNodeSizeRange(e.min,e.max);break;case"SetLinkSizeRange":this.canvas_manager.setLinkSizeRange(e.min,e.max);break;case"SetNodeAlpha":Object.keys(this.view_configuration.node_colors_per_group).forEach(t=>{const n=this.view_configuration.node_colors_per_group[t],i=a.color(n).alpha(e.alpha);this.view_configuration.node_colors_per_group[t]=i.hex("rgba")}),this.canvas_manager.updateViewConfiguration();break;case"GraphClusterized":{const t=this.active_state.meta.groups_count,e={},n=Object(l.createColorsForGraphView)(t,1),i={};for(let s=0;s<t;s++)e[s]=n[s],i[s]=this.view_configuration.node_renderer_per_group[0];this.view_configuration.node_colors_per_group=e,this.view_configuration.node_renderer_per_group=i,this.setState(this.active_state)}break;case"SavePNG":{const t=document.getElementById(d);var n=document.createElement("a");n.download="graph.png",n.href=t.toDataURL(),n.click()}break;case"ToggleLabelsShowing":this.canvas_manager.toggleLabelsShowing();break;case"SetLabelFontSize":break;case"CalcState":{const t=e.expr,n=u(this.bound_graph,t);this.setState(n),v.showStateBarStub()}break;default:console.log("unknown event: ",t,e)}this.canvas_manager.update()}setState(t){this.canvas_manager.bindGraph(t,this.view_configuration),this.active_state=t,this.gui_configuration.node_list_tab&&this.gui_configuration.node_list_tab.fill(this.active_state),this.gui_configuration.filters_tab&&this.gui_configuration.filters_tab.fill(this.active_state),this.gui_configuration.settings_tab&&this.gui_configuration.settings_tab.fill(this.active_state),this.gui_configuration.about_graph_tab&&this.gui_configuration.about_graph_tab.fill(this.active_state),this.canvas_manager.update()}}},"./src/GraphSerializer.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"GraphSerializer",function(){return h});var i=n("./src/@types/Graph.ts"),s=n("./node_modules/ngraph.graph/index.js"),r=n.n(s),o=i.GraphControlling.EmptyMeta,a=i.GraphControlling.updateGraphMeta,l=i.GraphControlling.updateStateMeta;class h{fromJSON(t){let e={states:{},meta:Object.assign({},o)};const n=t.states;if(null!=n)for(let t of n){const n=t.label;e.states[n]=h.fillState(n,t)}else e.states[0]=h.fillState("0",t);return a(e),e}static fillState(t,e){const n={label:t,graph:r()(),meta:Object.assign({},o)};n.graph.beginUpdate();const i=e.nodes,s=e.edges;for(let t of i){const e=t.id,i=t.group?t.group:0;let s={label:t.label?t.label:"#no_label",group:i,norm_weight:0};Object.keys(t).forEach(e=>{"id"!=e&&"group"!=e&&"label"!=e&&(s[e]=t[e])}),n.graph.addNode(e,s)}for(let t of s){const e=t.source,i=t.target;let s={norm_weight:0};Object.keys(t).forEach(e=>{"source"!=e&&"target"!=e&&(s[e]=t[e])}),n.graph.addLink(e,i,s)}return n.graph.endUpdate(),l(n),n}}h.default_group_index=0},"./src/LayoutBuilders/LayoutBuilder_Circle.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"LayoutBuilder_Circle",function(){return i});class i{constructor(t){this.ranges=t}layout(t,e){const n=this.ranges.R.value;if(this.ranges.use_cluster_splitting.value){const e=Object.keys(t.node_groups).sort((e,n)=>t.node_groups[n].length-t.node_groups[e].length),s=n/e.length;let r=n;e.forEach(e=>{const n=t.node_groups[e];i.layout_cluster(n,r),r-=s})}else i.layout_cluster(t.nodes,n);return t.onNodesReplaced(),!0}getParamsNames(){return["R","use_cluster_splitting"]}setConfiguration(t){this.ranges=t}getConfiguration(){return this.ranges}static layout_cluster(t,e){let n=0;const i=Object.keys(t),s=2*Math.PI/i.length;i.forEach(i=>{const r=t[i];r.position.x=e*Math.cos(n),r.position.y=e*Math.sin(n),n+=s})}}},"./src/LayoutBuilders/LayoutBuilder_FruchtermanReingold.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"LayoutBuilder_FruchtermanReingold",function(){return s});var i=n("./modified_modules/tsm/tsm.ts");class s{constructor(t){this.ranges=t}layout(t,e){const n=e+20,r=this.ranges.iterations_count.value,o=this.ranges.optimal_vertex_distance.value,a=this.ranges.is_bounding.value,l=this.ranges.use_cluster_splitting.value,h=new i.vec2([0,0]),u=Object.keys(t.node_groups);if(l&&u.length>1){const e={};Object.keys(t.links).forEach(n=>{const i=t.links[n];i.from.group==i.to.group&&(e[i.from.group]||(e[i.from.group]=[]),e[i.from.group].push(i))});const i=.75*n;let l=0;const c=2*Math.PI/u.length;u.forEach(d=>{h.x=i*Math.cos(l),h.y=i*Math.sin(l),l+=c;const g=Math.PI*n/u.length,p=o/u.length,f=r/u.length;s.layout_cluster(p,g,f,a,h,t.node_groups[d],e[d])})}else{const e=Object.keys(t.links).map(e=>t.links[e]);s.layout_cluster(o,n,r,a,h,t.nodes,e)}return t.onNodesReplaced(),!0}getParamsNames(){return["iterations_count","optimal_vertex_distance","is_bounding","use_cluster_splitting"]}getConfiguration(){return this.ranges}setConfiguration(t){this.ranges=t}static layout_cluster(t,e,n,s,r,o,a){const l=Object.keys(o).length,h=t*Math.sqrt(e/l);let u=10*Math.sqrt(l);const c=(t,e,n)=>t*t/h,d=(t,e,n)=>h*h/t,g={};Object.keys(o).forEach(t=>{g[t]=new i.vec2([0,0]);const e=h,n=2*Math.PI/l;let s=0;Object.keys(o).forEach(t=>{o[t].position.x=r.x+e*Math.cos(s),o[t].position.y=r.y+e*Math.sin(s),s+=n})});const p=new i.vec2;if(a)for(let t=0;t<n&&u>1e-5;t++)Object.keys(o).forEach(t=>{const e=o[t];Object.keys(o).forEach(n=>{if(t!=n){const s=o[n];i.vec2.difference(e.position,s.position,p);let r=p.length();const a=d(r,e.size,s.size);g[n].x-=p.x/r*a,g[n].y-=p.y/r*a,g[t].x+=p.x/r*a,g[t].y+=p.y/r*a}})}),a.forEach(t=>{const e=t.from,n=t.to;i.vec2.difference(e.position,n.position,p);let s=p.length();const r=Math.min(c(s,e.size,n.size),s/2);g[n.node_logic_model.id].x+=p.x/s*r,g[n.node_logic_model.id].y+=p.y/s*r,g[e.node_logic_model.id].x-=p.x/s*r,g[e.node_logic_model.id].y-=p.y/s*r}),Object.keys(o).forEach(t=>{const n=o[t];let i=g[t].length();i>0&&(n.position.x+=g[t].x/i*Math.min(u,i),n.position.y+=g[t].y/i*Math.min(u,i),s&&(n.position.x=r.x+Math.min(e,Math.max(-e,n.position.x-r.x)),n.position.y=r.y+Math.min(e,Math.max(-e,n.position.y-r.y)))),g[t].x=0,g[t].y=0}),u*=.9}}},"./src/Renderers/CircleNodeRenderer.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"CircleNodeRenderer",function(){return o});var i=n("./src/Renderers/_Utils.ts");const s=8*Float32Array.BYTES_PER_ELEMENT,r=Uint16Array.BYTES_PER_ELEMENT;class o{constructor(){this.default_max_objects_count=64,this.vertex_shader_source="\n        attribute vec2 a_vertexPos;    \n        attribute vec2 a_uv;     \n        attribute vec4 a_color;\n        uniform mat3 u_pv;\n        varying vec2 v_uv;\n        varying vec4 v_color;\n\n        void main(void)\n        {\n            v_color = a_color;\n            v_uv = a_uv;\n            gl_Position = vec4(u_pv * vec3(a_vertexPos, 1), 1);\n        }",this.fragment_shader_source="\n        precision mediump float;\n        varying vec2 v_uv;\n        varying vec4 v_color;\n        const float inEdgeBorderR = 0.85;\n        const float outEdgeBorderR = 0.95;\n        const float maxR = 1.0;\n\n        void main(void) {\n            float d = length(v_uv);\n            vec4 borderColor = vec4(0, 0, 0, 1);\n            if (d < inEdgeBorderR)\n                gl_FragColor = v_color;\n            else if (d < outEdgeBorderR)\n            {\n                float coeff = smoothstep(inEdgeBorderR, outEdgeBorderR, d);\n                gl_FragColor = mix(v_color, borderColor, coeff);\n            }\n            else if (d < maxR)\n            {\n                gl_FragColor = borderColor;\n            }\n            else discard;         \n        }",this.shader_source={vertex_shader:this.vertex_shader_source,fragment_shader:this.fragment_shader_source,attributes:["a_vertexPos","a_color","a_uv"],uniforms:["u_pv"]},this.geometry={vertices:new Float32Array(4*s*this.default_max_objects_count),indices:new Uint16Array(6*r*this.default_max_objects_count),objects_count:0,max_objects_count:this.default_max_objects_count},this.offsets=new Map,this.gl=null,this.program=null,this.objects=[]}render(t){this.gl.useProgram(this.program.program),this.gl.uniformMatrix3fv(this.program.uniforms.u_pv,!1,t.all()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.geometry.vertices,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.vertexAttribPointer(this.program.attributes.a_vertexPos,2,this.gl.FLOAT,!1,s,0),this.gl.enableVertexAttribArray(this.program.attributes.a_uv),this.gl.vertexAttribPointer(this.program.attributes.a_uv,2,this.gl.FLOAT,!1,s,2*Float32Array.BYTES_PER_ELEMENT),this.gl.enableVertexAttribArray(this.program.attributes.a_color),this.gl.vertexAttribPointer(this.program.attributes.a_color,4,this.gl.FLOAT,!1,s,4*Float32Array.BYTES_PER_ELEMENT),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.geometry.indices,this.gl.DYNAMIC_DRAW),this.gl.drawElements(this.gl.TRIANGLES,6*this.geometry.objects_count,this.gl.UNSIGNED_SHORT,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.disableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.disableVertexAttribArray(this.program.attributes.a_uv),this.gl.disableVertexAttribArray(this.program.attributes.a_color)}bindContext(t,e){this.program&&(this.gl.deleteProgram(this.program.program),this.gl.deleteBuffer(this.ibo),this.gl.deleteBuffer(this.vbo)),this.gl=t,this.ibo=t.createBuffer(),this.vbo=t.createBuffer(),this.program=e.compile(t,this.shader_source)}addObject(t){if(this.geometry.objects_count==this.geometry.max_objects_count){const t=this.geometry;t.vertices=Object(i.resizeFloat32Array)(2*t.vertices.length,t.vertices),t.indices=Object(i.resizeUint16Array)(2*t.indices.length,t.indices),t.max_objects_count*=2}const e=t;if(!this.offsets.has(e)){const n=this.geometry.objects_count;this.offsets.set(e,n);const i=o.makeVerticesArray(e),s=o.makeIndicesArray(4*n);this.geometry.vertices.set(i,32*n),this.geometry.indices.set(s,6*n),this.objects.push(t),this.geometry.objects_count++}}clearObjects(){this.offsets.clear(),this.geometry.objects_count=0,this.objects=[]}deleteObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),n=this.geometry.objects_count-1;if(t!=n&&(this.offsets.set(this.objects[n],t),this.objects[t]=this.objects[n],this.geometry.vertices.copyWithin(32*t,32*n,32*n+32)),this.offsets.delete(e),this.objects.pop(),this.geometry.objects_count--,this.geometry.objects_count>this.default_max_objects_count&&this.geometry.objects_count<=this.geometry.max_objects_count/2){const t=this.geometry;t.vertices=Object(i.resizeFloat32Array)(t.vertices.length/2,t.vertices),t.indices=Object(i.resizeUint16Array)(t.indices.length/2,t.indices),t.max_objects_count/=2}}}updateObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),n=o.makeVerticesArray(e);this.geometry.vertices.set(n,32*t)}}sortObjects(){}static makeVerticesArray(t){const e=t.color.gl(),n=t.size;return[t.position.x-n,t.position.y-n,-1,-1,e[0],e[1],e[2],e[3],t.position.x+n,t.position.y-n,1,-1,e[0],e[1],e[2],e[3],t.position.x+n,t.position.y+n,1,1,e[0],e[1],e[2],e[3],t.position.x-n,t.position.y+n,-1,1,e[0],e[1],e[2],e[3]]}static makeIndicesArray(t){return[t,1+t,2+t,t,2+t,3+t]}}},"./src/Renderers/OrientedStraightLinkRenderer.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"OrientedStraightLinkRenderer",function(){return o});var i=n("./src/Renderers/_Utils.ts");const s=6*Float32Array.BYTES_PER_ELEMENT,r=Uint16Array.BYTES_PER_ELEMENT;class o{constructor(){this.default_max_objects_count=64,this.vertex_shader_source="\n        attribute vec2 a_vertexPos;\n        attribute vec4 a_color;\n        uniform mat3 u_pv;\n        varying vec4 v_color;\n\n        void main(void)\n        {\n            v_color = a_color;\n            gl_Position = vec4(u_pv * vec3(a_vertexPos, 1), 1);\n        }",this.fragment_shader_source="\n        precision mediump float;\n        varying vec4 v_color;\n\n        void main(void) {\n            gl_FragColor = v_color;\n        }",this.shader_source={vertex_shader:this.vertex_shader_source,fragment_shader:this.fragment_shader_source,attributes:["a_vertexPos","a_color"],uniforms:["u_pv"]},this.geometry={vertices:new Float32Array(7*s*this.default_max_objects_count),indices:new Uint16Array(9*r*this.default_max_objects_count),objects_count:0,max_objects_count:this.default_max_objects_count},this.offsets=new Map,this.objects=[]}bindContext(t,e){this.program&&(this.gl.deleteProgram(this.program.program),this.gl.deleteBuffer(this.ibo),this.gl.deleteBuffer(this.vbo)),this.gl=t,this.ibo=t.createBuffer(),this.vbo=t.createBuffer(),this.program=e.compile(t,this.shader_source)}render(t){this.gl.enableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.enableVertexAttribArray(this.program.attributes.a_color),this.gl.useProgram(this.program.program),this.gl.uniformMatrix3fv(this.program.uniforms.u_pv,!1,t.all()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.geometry.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.geometry.indices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.program.attributes.a_vertexPos,2,this.gl.FLOAT,!1,s,0),this.gl.vertexAttribPointer(this.program.attributes.a_color,4,this.gl.FLOAT,!1,s,2*Float32Array.BYTES_PER_ELEMENT),this.gl.drawElements(this.gl.TRIANGLES,9*this.geometry.objects_count,this.gl.UNSIGNED_SHORT,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.disableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.disableVertexAttribArray(this.program.attributes.a_color)}addObject(t){if(this.geometry.objects_count==this.geometry.max_objects_count){const t=this.geometry;t.vertices=Object(i.resizeFloat32Array)(2*t.vertices.length,t.vertices),t.indices=Object(i.resizeUint16Array)(2*t.indices.length,t.indices),t.max_objects_count*=2}const e=t,n=this.geometry.objects_count;this.offsets.set(e,n),this.objects.push(e);const s=o.makeVerticesArray(e),r=o.makeIndicesArray(7*n);this.geometry.vertices.set(s,42*n),this.geometry.indices.set(r,9*n),this.geometry.objects_count++}clearObjects(){this.offsets.clear(),this.geometry.objects_count=0,this.objects=[]}deleteObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),n=this.geometry.objects_count-1;if(t!=n&&(this.offsets.set(this.objects[n],t),this.objects[t]=this.objects[n],this.geometry.vertices.copyWithin(42*t,42*n,42*n+42)),this.offsets.delete(e),this.objects.pop(),this.geometry.objects_count--,this.geometry.objects_count>this.default_max_objects_count&&this.geometry.objects_count<=this.geometry.max_objects_count/2){const t=this.geometry;t.vertices=Object(i.resizeFloat32Array)(t.vertices.length/2,t.vertices),t.indices=Object(i.resizeUint16Array)(t.indices.length/2,t.indices),t.max_objects_count/=2}}}updateObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),n=o.makeVerticesArray(e);this.geometry.vertices.set(n,42*t)}}sortObjects(){const t=[...this.objects];t.sort((t,e)=>t.zOrder-e.zOrder);const e=new Float32Array(this.geometry.vertices);for(let n=0;n<this.objects.length;n++){const i=t[n],s=this.offsets.get(i);for(let t=0;t<42;t++)e[42*n+t]=this.geometry.vertices[42*s+t];this.offsets.set(i,n)}this.geometry.vertices=e,this.objects=t}static makeVerticesArray(t){const e=t.from,n=t.to,i=n.position.y-e.position.y,s=n.position.x-e.position.x,r=Math.sqrt(i*i+s*s),o=s/r,a=i/r,l=o*t.size,h=a*t.size;let u=t.painter(e.color.gl()),c=t.painter(n.color.gl());t.is_emphasized&&(u[3]=1,c[3]=1);const d=n.size+5*t.size;return[e.position.x+e.size*o-h,e.position.y+e.size*a+l,u[0],u[1],u[2],u[3],e.position.x+e.size*o+h,e.position.y+e.size*a-l,u[0],u[1],u[2],u[3],n.position.x-d*o+h,n.position.y-d*a-l,c[0],c[1],c[2],c[3],n.position.x-d*o-h,n.position.y-d*a+l,c[0],c[1],c[2],c[3],n.position.x-n.size*o,n.position.y-n.size*a,c[0],c[1],c[2],c[3],n.position.x-d*o-4*h,n.position.y-d*a+4*l,c[0],c[1],c[2],c[3],n.position.x-d*o+4*h,n.position.y-d*a-4*l,c[0],c[1],c[2],c[3]]}static makeIndicesArray(t){return[t,1+t,2+t,t,2+t,3+t,t+4,t+5,t+6]}}},"./src/Renderers/StraightLinkRenderer.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"StraightLinkRenderer",function(){return o});var i=n("./src/Renderers/_Utils.ts");const s=6*Float32Array.BYTES_PER_ELEMENT,r=Uint16Array.BYTES_PER_ELEMENT;class o{constructor(){this.default_max_objects_count=64,this.vertex_shader_source="\n        attribute vec2 a_vertexPos;\n        attribute vec4 a_color;\n        uniform mat3 u_pv;\n        varying vec4 v_color;\n\n        void main(void)\n        {\n            v_color = a_color;\n            gl_Position = vec4(u_pv * vec3(a_vertexPos, 1), 1);\n        }",this.fragment_shader_source="\n        precision mediump float;\n        varying vec4 v_color;\n\n        void main(void) {\n            gl_FragColor = v_color;\n        }",this.shader_source={vertex_shader:this.vertex_shader_source,fragment_shader:this.fragment_shader_source,attributes:["a_vertexPos","a_color"],uniforms:["u_pv"]},this.geometry={vertices:new Float32Array(4*s*this.default_max_objects_count),indices:new Uint16Array(6*r*this.default_max_objects_count),objects_count:0,max_objects_count:this.default_max_objects_count},this.offsets=new Map,this.geometry.vertices.fill(0),this.objects=[]}bindContext(t,e){this.program&&(this.gl.deleteProgram(this.program.program),this.gl.deleteBuffer(this.ibo),this.gl.deleteBuffer(this.vbo)),this.gl=t,this.ibo=t.createBuffer(),this.vbo=t.createBuffer(),this.program=e.compile(t,this.shader_source)}render(t){this.gl.enableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.enableVertexAttribArray(this.program.attributes.a_color),this.gl.useProgram(this.program.program),this.gl.uniformMatrix3fv(this.program.uniforms.u_pv,!1,t.all()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.geometry.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.geometry.indices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.program.attributes.a_vertexPos,2,this.gl.FLOAT,!1,s,0),this.gl.vertexAttribPointer(this.program.attributes.a_color,4,this.gl.FLOAT,!1,s,2*Float32Array.BYTES_PER_ELEMENT),this.gl.drawElements(this.gl.TRIANGLES,6*this.geometry.objects_count,this.gl.UNSIGNED_SHORT,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.disableVertexAttribArray(this.program.attributes.a_vertexPos),this.gl.disableVertexAttribArray(this.program.attributes.a_color)}addObject(t){if(this.geometry.objects_count==this.geometry.max_objects_count){const t=this.geometry;t.vertices=Object(i.resizeFloat32Array)(2*t.vertices.length,t.vertices),t.indices=Object(i.resizeUint16Array)(2*t.indices.length,t.indices),t.max_objects_count*=2}const e=t,n=this.geometry.objects_count;this.offsets.set(e,n);const s=o.makeVerticesArray(e),r=o.makeIndicesArray(4*n);this.geometry.vertices.set(s,24*n),this.geometry.indices.set(r,6*n),this.geometry.objects_count=this.objects.push(e)}clearObjects(){this.offsets.clear(),this.geometry.objects_count=0,this.objects=[]}deleteObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),n=this.geometry.objects_count-1;if(t!=n&&(this.offsets.set(this.objects[n],t),this.objects[t]=this.objects[n],this.geometry.vertices.copyWithin(24*t,24*n,24*n+24)),this.offsets.delete(e),this.objects.pop(),this.geometry.objects_count--,this.geometry.objects_count>this.default_max_objects_count&&this.geometry.objects_count<=this.geometry.max_objects_count/2){const t=this.geometry;t.vertices=Object(i.resizeFloat32Array)(t.vertices.length/2,t.vertices),t.indices=Object(i.resizeUint16Array)(t.indices.length/2,t.indices),t.max_objects_count/=2}}}updateObject(t){const e=t;if(this.offsets.has(e)){const t=this.offsets.get(e),n=o.makeVerticesArray(e);this.geometry.vertices.set(n,24*t)}}sortObjects(){const t=[...this.objects];t.sort((t,e)=>t.zOrder-e.zOrder);const e=new Float32Array(this.geometry.vertices);for(let n=0;n<this.objects.length;n++){const i=t[n],s=this.offsets.get(i);for(let t=0;t<24;t++)e[24*n+t]=this.geometry.vertices[24*s+t];this.offsets.set(i,n)}this.geometry.vertices=e,this.objects=t}static makeVerticesArray(t){const e=t.from,n=t.to,i=n.position.y-e.position.y,s=n.position.x-e.position.x,r=Math.sqrt(i*i+s*s),o=i/r,a=s/r*t.size,l=o*t.size;let h=t.painter(e.color.gl()),u=t.painter(n.color.gl());return t.is_emphasized&&(h[3]=1,u[3]=1),[e.position.x-l,e.position.y+a,h[0],h[1],h[2],h[3],e.position.x+l,e.position.y-a,h[0],h[1],h[2],h[3],n.position.x+l,n.position.y-a,u[0],u[1],u[2],u[3],n.position.x-l,n.position.y+a,u[0],u[1],u[2],u[3]]}static makeIndicesArray(t){return[t,1+t,2+t,t,2+t,3+t]}}},"./src/Renderers/_ShaderCompiler.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"ShaderCompiler_default",function(){return s});class i{compile(t,e){const n=t.createShader(t.VERTEX_SHADER);t.shaderSource(n,e.vertex_shader),t.compileShader(n);let s=t.getShaderParameter(n,t.COMPILE_STATUS);if(!s)return alert(t.getShaderInfoLog(n)),null;const r=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(r,e.fragment_shader),t.compileShader(r),!(s=t.getShaderParameter(r,t.COMPILE_STATUS)))return t.deleteShader(n),alert(t.getShaderInfoLog(r)),null;const o=t.createProgram();return t.attachShader(o,n),t.attachShader(o,r),t.linkProgram(o),(s=t.getProgramParameter(o,t.LINK_STATUS))?{program:o,attributes:i.getAttributeLocations(t,o,e.attributes),uniforms:i.getUniformLocations(t,o,e.uniforms)}:null}static getAttributeLocations(t,e,n){let i={};for(let s=0;s<n.length;++s){let r=n[s],o=-1;if(-1===(o=t.getAttribLocation(e,r)))throw new Error("Program doesn't have required attribute: "+r);i[n[s]]=o}return i}static getUniformLocations(t,e,n){let i={};for(let s=0;s<n.length;++s){let r=n[s];{let o=t.getUniformLocation(e,r);if(null===o)throw new Error("Program doesn't have required uniform: "+r);i[n[s]]=o}}return i}}const s=new i},"./src/Renderers/_Utils.ts":function(t,e,n){"use strict";function i(t,e){let n=new Float32Array(t);if(t>e.length)n.set(e,0);else for(let i=0;i<t;++i)n[i]=e[i];return n}function s(t,e){let n=new Uint16Array(t);if(t>e.length)n.set(e,0);else for(let i=0;i<t;++i)n[i]=e[i];return n}n.r(e),n.d(e,"resizeFloat32Array",function(){return i}),n.d(e,"resizeUint16Array",function(){return s})},"./src/Tabs/AboutGraphTab.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"AboutGraphTab",function(){return l});var i=n("./src/@types/GUI.ts");const s=i.id_prefix+"_about_tab_graph_name",r=i.id_prefix+"_about_tab_nodes_count_metric",o=i.id_prefix+"_about_tab_links_count_metric",a=i.id_prefix+"_about_tab_groups_count_metric";class l{constructor(t){this.container=null,this.controller=null,this.translator=null}build(t,e,n){this.container=t,this.controller=e,this.translator=n,this.container.style.height="100%",this.clear()}clear(){this.container.innerHTML=`\n            <h3 id=${s}>no graph</h3>\n            <h3>${this.translator.apply("#metrics")}</h3>\n            <ul>\n                <li style="list-style-type: none">${this.translator.apply("#groups_count")}: <span id=${a}></span></li>\n                <li style="list-style-type: none">${this.translator.apply("#nodes_count")}: <span id=${r}></span></li>\n                <li style="list-style-type: none">${this.translator.apply("#links_count")}: <span id=${o}></span></li>\n                \n            </ul>\n        `}fill(t){const e=t;document.getElementById(s).innerText=`::${e.label}`,document.getElementById(r).innerText=String(e.meta.nodes_count),document.getElementById(o).innerText=String(e.meta.links_count),document.getElementById(a).innerText=String(e.meta.groups_count)}}},"./src/Tabs/CalculatorTab.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"StateCalculatorOperand",function(){return i}),n.d(e,"CalculatorTab",function(){return o});var i,s=n("./src/@types/GUI.ts");!function(t){t.UNION="UNION",t.INTERSECT="INTERSECT",t.DIFF="DIFF",t.SYMDIFF="SYMDIFF"}(i||(i={}));const r=s.id_prefix+"_calculator_tab_expression";class o{build(t,e,n){this.container=t,this.controller=e,this.translator=n,this.container.style.height="100%";const i=document.createElement("div");i.id=r,i.style.marginBottom="1rem",this.container.appendChild(i),i.appendChild(document.createElement("br"));const s=document.createElement("button");s.className="scivi_button",s.innerText=this.translator.apply("LOC_ADDOPERAND"),this.container.appendChild(s),s.onclick=this.addOperand.bind(this);const a=document.createElement("button");a.className="scivi_button",a.innerText=this.translator.apply("LOC_CALCULATE"),this.container.appendChild(a),a.onclick=(()=>this.controller("CalcState",{expr:o.buildExpression(i)}));const l=document.createElement("button");l.className="scivi_button",l.innerText=this.translator.apply("LOC_CLEANCALC"),this.container.appendChild(l),l.onclick=this.initExpression.bind(this)}clear(){}fill(t){const e=t;this.states=Object.keys(e.states),this.operators={},Object.keys(i).forEach(t=>{this.operators[t]=this.translator.apply(`#${t}`)}),this.initExpression()}initExpression(){const t=document.getElementById(r);t.innerHTML="",t.appendChild(o.createOperandCombo(this.states)),t.appendChild(o.createOperatorCombo(this.operators)),t.appendChild(o.createOperandCombo(this.states)),t.appendChild(document.createElement("br"))}addOperand(){const t=document.getElementById(r);t.appendChild(o.createOperatorCombo(this.operators)),t.appendChild(o.createOperandCombo(this.states)),t.appendChild(document.createElement("br"))}static createOperandCombo(t){const e=document.createElement("select");return t.forEach(t=>{const n=document.createElement("option");n.innerText=t,n.value=t,e.appendChild(n)}),e}static createOperatorCombo(t){const e=document.createElement("select");return Object.keys(t).forEach(n=>{const i=document.createElement("option");i.innerText=t[n],i.value=n,e.appendChild(i)}),e}static buildExpression(t){return Array.from(t.getElementsByTagName("select")).map(t=>t.value)}}},"./src/Tabs/FiltersTab.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"FiltersTab",function(){return c});var i=n("./src/@types/GUI.ts"),s=n("./src/@types/Param.ts");const r=i.id_prefix+"_filters_tab_node_threshold_max",o=i.id_prefix+"_filters_tab_node_threshold_min",a=i.id_prefix+"_filters_tab_node_threshold_slider",l=i.id_prefix+"_filters_tab_link_threshold_max",h=i.id_prefix+"_filters_tab_link_threshold_min",u=i.id_prefix+"_filters_tab_link_threshold_slider";class c{constructor(t){this.container=null,this.controller=null,this.translator=null,this.min_node_weight=null,this.max_node_weight=null,this.min_link_weight=null,this.max_link_weight=null}build(t,e,n){this.container=t,this.controller=e,this.translator=n,this.container.style.height="100%";{const t=document.createElement("div");{const e=document.createElement("p");e.innerHTML=`${n.apply("LOC_NODE_THRESHOLD")}\n                               <input type="number" id="${o}" size="10" onkeydown="size=value.length||10">\n                                \n                                <input type="number" id="${r}" size="10" onkeydown="size=value.length||10">`,t.appendChild(e)}const e=document.createElement("div");e.id=a,t.appendChild(e),this.container.appendChild(t)}{const t=document.createElement("div");{const e=document.createElement("p");e.innerHTML=`${n.apply("LOC_LINK_THRESHOLD")}\n                               <input type="number" id="${h}">\n                                \n                                <input type="number" id="${l}">`,t.appendChild(e)}const e=document.createElement("div");e.id=u,t.appendChild(e),this.container.appendChild(t)}}clear(){this.min_node_weight=new s.ScalarParam(0,1),this.max_node_weight=new s.ScalarParam(0,1),this.min_link_weight=new s.ScalarParam(0,1),this.max_link_weight=new s.ScalarParam(0,1),this.UpdateRanges()}fill(t){const e=t;if(e.meta.node_weight_range){const t=e.meta.node_weight_range,n=(t.max-t.min)/e.graph.getNodesCount();this.min_node_weight=new s.ScalarParam(t.min,t.max,t.min,n),this.max_node_weight=new s.ScalarParam(t.min,t.max,t.max,n)}if(e.meta.link_weight_range){const t=e.meta.link_weight_range,n=(t.max-t.min)/e.graph.getLinksCount();this.min_link_weight=new s.ScalarParam(t.min,t.max,t.min,n),this.max_link_weight=new s.ScalarParam(t.min,t.max,t.max,n)}this.UpdateRanges()}UpdateRanges(){{const t=document.getElementById(o);this.min_node_weight?(t.min=String(this.min_node_weight.range.min),t.max=String(this.min_node_weight.range.max),t.step=String(this.min_node_weight.range.step),t.value=String(this.min_node_weight.value)):t.disabled=!0;const e=document.getElementById(r);if(this.max_node_weight?(e.min=String(this.max_node_weight.range.min),e.max=String(this.max_node_weight.range.max),e.step=String(this.max_node_weight.range.step),e.value=String(this.max_node_weight.value)):e.disabled=!0,!t.disabled&&!e.disabled){const n=$("#"+a);t.onchange=(()=>{this.min_node_weight.value=parseFloat(t.value),n.slider({values:[this.min_node_weight.value,this.max_node_weight.value]}),this.controller("FilterNodes",{min:this.min_node_weight.value,max:this.max_node_weight.value})}),e.onchange=(()=>{this.max_node_weight.value=parseFloat(e.value),n.slider({values:[this.min_node_weight.value,this.max_node_weight.value]}),this.controller("FilterNodes",{min:this.min_node_weight.value,max:this.max_node_weight.value})}),n.slider({range:!0,min:this.min_node_weight.range.min,max:this.max_node_weight.range.max,step:this.min_node_weight.range.step,values:[this.min_node_weight.value,this.max_node_weight.value],slide:(n,i)=>{this.min_node_weight.value=i.values[0],this.max_node_weight.value=i.values[1],t.value=String(this.min_node_weight.value),e.value=String(this.max_node_weight.value),this.controller("FilterNodes",{min:this.min_node_weight.value,max:this.max_node_weight.value})}})}}{const t=document.getElementById(h);this.min_link_weight?(t.min=String(this.min_link_weight.range.min),t.max=String(this.min_link_weight.range.max),t.step=String(this.min_link_weight.range.step),t.value=String(this.min_link_weight.value)):t.disabled=!0;const e=document.getElementById(l);this.max_link_weight?(e.min=String(this.max_link_weight.range.min),e.max=String(this.max_link_weight.range.max),e.step=String(this.max_link_weight.range.step),e.value=String(this.max_link_weight.value)):e.disabled=!0;const n=$("#"+u);t.disabled||e.disabled||(t.onchange=(()=>{this.min_link_weight.value=parseFloat(t.value),n.slider({values:[this.min_link_weight.value,this.max_link_weight.value]}),this.controller("FilterLinks",{min:this.min_link_weight.value,max:this.max_link_weight.value})}),e.onchange=(()=>{this.max_link_weight.value=parseFloat(e.value),n.slider({values:[this.min_link_weight.value,this.max_link_weight.value]}),this.controller("FilterLinks",{min:this.min_link_weight.value,max:this.max_link_weight.value})}),n.slider({range:!0,min:this.min_link_weight.range.min,max:this.max_link_weight.range.max,step:this.min_link_weight.range.step,values:[this.min_link_weight.value,this.max_link_weight.value],slide:(n,i)=>{this.min_link_weight.value=i.values[0],this.max_link_weight.value=i.values[1],t.value=String(this.min_link_weight.value),e.value=String(this.max_link_weight.value),this.controller("FilterLinks",{min:this.min_link_weight.value,max:this.max_link_weight.value})}}))}}}},"./src/Tabs/NodeInfoTab.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"NodeInfoTab",function(){return i});class i{constructor(t){this.container=null,this.controller=null,this.translator=null}build(t,e,n){this.container=t,this.controller=e,this.translator=n,this.container.style.height="100%",this.clear()}clear(){this.container.innerHTML=`<p>${this.translator.apply("LOC_NO_SELECTED_NODE")}</p>`}fill(t){const e=t.graph,n=t.node;this.container.innerHTML="";const i=document.createElement("div");{const t=document.createElement("input");t.type="text",t.style.fontWeight="bold",t.style.width="300px",t.style.marginRight="5px";const e=document.createElement("button");e.className="scivi_button",e.innerText=this.translator.apply("LOC_CHANGE"),e.onclick=(e=>this.controller("ChangeNodeName",{node_id:n.id,new_name:t.value})),i.appendChild(t),i.appendChild(e)}{const t=document.createElement("ul");t.style.listStyleType="disc",n.data&&Object.keys(n.data).forEach(e=>{const i=document.createElement("li");i.innerText=`${e}: ${n.data[e]}`,t.appendChild(i)}),i.appendChild(t)}const s=document.createElement("div");s.innerHTML=`<label>${this.translator.apply("#out_links_text")}</label>`;{const t=document.createElement("ul");t.style.listStyleType="disc",n.links.filter(t=>t.fromId==n.id).forEach(n=>{const i=document.createElement("li");i.innerText=`${e.graph.getNode(n.toId).data.label}`,t.appendChild(i)}),s.appendChild(t)}this.container.appendChild(i),this.container.appendChild(s)}}},"./src/Tabs/NodeListTab.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"NodeListTab",function(){return l});var i,s=n("./src/@types/GUI.ts");!function(t){t[t.NoFilter=0]="NoFilter",t[t.SubstringFilter=1]="SubstringFilter",t[t.StringFilter=2]="StringFilter",t[t.RegExpFilter=3]="RegExpFilter"}(i||(i={}));const r=s.id_prefix+"_node_list_tab_filter_panel",o=s.id_prefix+"_node_list_tab_header",a=s.id_prefix+"_node_list_tab_content";class l{constructor(t){this.container=null,this.controller=null,this.translator=null,this.bound_graph=null,this.filter_string=""}build(t,e,n){this.container=t,this.controller=e,this.translator=n,this.container.style.height="100%";const i=document.createElement("div");i.id=r;{const t=document.createElement("button");t.className="scivi_button",t.innerText=n.apply("LOC_NOT"),t.onclick=(()=>{this.m_not=!this.m_not,this.m_not?t.classList.add("pushed"):t.classList.remove("pushed"),this.updateList()}),i.appendChild(t)}{const t=document.createElement("input");t.type="text",t.style.marginRight="5px",t.width=200,t.oninput=(()=>{this.filter_string=t.value,this.updateList()}),i.appendChild(t)}{const t=document.createElement("button");t.className="scivi_button",t.innerText=n.apply("LOC_FINDSTRING"),t.onclick=(()=>{}),i.appendChild(t)}{const t=document.createElement("button");t.className="scivi_button",t.innerText=n.apply("LOC_FINDREGEXP"),t.onclick=(()=>{}),i.appendChild(t)}this.container.appendChild(i);const s=document.createElement("div");s.id=o,s.style.marginTop="5px";{const t=document.createElement("div"),e=document.createElement("span");e.innerText=n.apply("LOC_VISIBLE"),e.style.textAlign="center",e.style.width="auto",e.style.display="inline-block";const i=document.createElement("span");i.innerText=n.apply("LOC_SELECTED"),i.style.textAlign="center",i.style.width="auto",i.style.display="inline-block",i.style.marginLeft="10px",t.appendChild(e),t.appendChild(i),s.appendChild(t)}{const t=document.createElement("button");t.innerText=this.translator.apply("LOC_ALL"),t.className="scivi_button",t.style.width="auto",t.style.textAlign="center",t.onclick=this.ShowAllFilteredNodes;const e=document.createElement("button");e.innerText=this.translator.apply("LOC_NONE"),e.className="scivi_button",e.style.width="auto",e.style.textAlign="center",e.onclick=this.HideAllFilteredNodes,s.appendChild(t),s.appendChild(e)}{const t=document.createElement("button");t.innerText=this.translator.apply("LOC_ALL"),t.className="scivi_button",t.style.width="auto",t.style.textAlign="center",t.style.marginLeft="17px",t.onclick=this.SelectAllFilteredNodes;const e=document.createElement("button");e.innerText=this.translator.apply("LOC_NONE"),e.className="scivi_button",e.style.width="auto",e.style.textAlign="center",e.onclick=this.DeselectAllFilteredNodes,s.appendChild(t),s.appendChild(e)}this.container.appendChild(s);const l=document.createElement("div");l.id=a,this.container.appendChild(l),this.clear()}clear(){document.getElementById(a).innerHTML=`<p>${this.translator.apply("LOC_NO_GRAPH")}</p>`,this.bound_graph=null}fill(t){this.bound_graph=t,this.updateList()}onSelectedNode(t){document.getElementById("node_info"+t.id).getElementsByTagName("input")[1].checked=!0}onDeselectedNode(t){document.getElementById("node_info"+t.id).getElementsByTagName("input")[1].checked=!1}updateList(){if(this.bound_graph){const t=document.getElementById(a);t.innerHTML="";const e=this.filter_string.length>0;this.bound_graph.graph.forEachNode(n=>(e&&!this.matchStr(n.data.label,this.filter_string,i.SubstringFilter)||this.postNodeInfo(t,n),!1))}}matchStr(t,e,n){if(null===e||0===e.length)return!0;switch(n){case i.NoFilter:return!0;case i.SubstringFilter:return this.m_not?-1===t.indexOf(e):-1!==t.indexOf(e);case i.StringFilter:return this.m_not?t!==e:t===e;case i.RegExpFilter:return this.m_not?null===t.match(e):null!==t.match(e)}return!1}postNodeInfo(t,e){const n=document.createElement("li");n.id="node_info"+e.id,n.style.listStyleType="none";const i=document.createElement("input");i.type="checkbox",i.style.marginLeft="18px",i.checked=!0,i.onclick=(()=>{i.checked?this.controller("ShowNode",{node:e}):this.controller("HideNode",{node:e})});const s=document.createElement("input");s.type="checkbox",s.style.marginLeft="55px",s.style.marginRight="18px",s.onclick=(()=>{s.checked?this.controller("SelectNode",{node:e}):this.controller("DeselectNode",{node:e})});const r=document.createElement("span");return r.style.fontWeight="normal",r.innerText=e.data.label,n.appendChild(i),n.appendChild(s),n.appendChild(r),t.appendChild(n),!1}ShowAllFilteredNodes(){const t=document.getElementById(a);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[0];e.checked=!0,e.onclick.apply(e)})}HideAllFilteredNodes(){const t=document.getElementById(a);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[0];e.checked=!1,e.onclick.apply(e)})}SelectAllFilteredNodes(){const t=document.getElementById(a);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[1];e.checked=!0,e.onclick.apply(e)})}DeselectAllFilteredNodes(){const t=document.getElementById(a);[].forEach.call(t.children,t=>{const e=t.getElementsByTagName("input")[1];e.checked=!1,e.onclick.apply(e)})}}},"./src/Tabs/SettingsTab.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"SettingsTab",function(){return w});var i=n("./src/@types/GUI.ts"),s=n("./src/@types/Param.ts"),r=n("./src/@types/Graph.ts").GraphControlling.clusterize;const o=i.id_prefix+"_settings_tab_node_alpha_label",a=i.id_prefix+"_settings_tab_node_alpha_slider",l=i.id_prefix+"_settings_tab_link_alpha_label",h=i.id_prefix+"_settings_tab_link_alpha_slider",u=i.id_prefix+"_settings_tab_node_size_label",c=i.id_prefix+"_settings_tab_node_size_slider",d=i.id_prefix+"_settings_tab_link_size_label",g=i.id_prefix+"_settings_tab_link_size_slider",p=i.id_prefix+"_settings_tab_node_font_size_input",f=i.id_prefix+"_settings_tab_always_show_label_input",m=i.id_prefix+"_settings_tab_layout_builder_selector",_=i.id_prefix+"_settings_tab_layout_builder_configuration",v=i.id_prefix+"_settings_tab_build_layout_button",y=i.id_prefix+"_settings_tab_fit_to_screen_button",b=i.id_prefix+"_settings_tab_calc_modularity_button",x=i.id_prefix+"_settings_tab_graph_export_button";class w{constructor(t){this.container=null,this.controller=null,this.translator=null,t?(this.layouts=t.Layouts,this.view_config=t.view_config):(this.layouts=null,this.view_config=null)}build(t,e,n){this.container=t,this.controller=e,this.translator=n,this.container.style.height="100%";const i=document.createElement("div");{const t=document.createElement("div");{const e=document.createElement("div");e.innerHTML=`${n.apply("LOC_PASSIVETEXTALPHA")}`;const i=document.createElement("span");i.id=o,e.appendChild(i);const s=document.createElement("div");s.id=a,s.style.margin="10px",t.appendChild(e),t.appendChild(s)}const e=document.createElement("div");{const t=document.createElement("div");t.innerHTML=`${n.apply("LOC_PASSIVEEDGEALPHA")}`;const i=document.createElement("span");i.id=l,t.appendChild(i);const s=document.createElement("div");s.id=h,s.style.margin="10px",e.appendChild(t),e.appendChild(s)}i.appendChild(t),i.appendChild(e)}this.container.appendChild(i),E(this.container),$("#"+a).slider({min:0,max:1,step:.01,value:1,slide:(t,n)=>{const i=n.value||0;document.getElementById(o).innerText=String(i),e("SetNodeAlpha",{alpha:i})},create:()=>document.getElementById(o).innerText="1"}),$("#"+h).slider({min:0,max:1,step:.01,value:1,slide:(t,n)=>{const i=n.value||0;document.getElementById(l).innerText=String(i),e("SetLinkAlpha",{alpha:i})},create:()=>document.getElementById(l).innerText="1"});const r=document.createElement("div");{const t=document.createElement("div");{const e=document.createElement("div");e.innerHTML=`${n.apply("LOC_NODE_SIZE_TEXT")}`;const i=document.createElement("span");i.id=u,e.appendChild(i);const s=document.createElement("div");s.id=c,s.style.margin="10px",t.appendChild(e),t.appendChild(s)}const e=document.createElement("div");{const t=document.createElement("div");t.innerHTML=`${n.apply("LOC_LINK_SIZE_TEXT")}`;const i=document.createElement("span");i.id=d,t.appendChild(i);const s=document.createElement("div");s.id=g,s.style.margin="10px",e.appendChild(t),e.appendChild(s)}r.appendChild(t),r.appendChild(e)}this.container.appendChild(r),E(this.container);{const t={min:this.view_config.min_node_size,max:this.view_config.max_node_size};$("#"+c).slider({range:!0,min:t.min,max:t.max,step:.01,values:[t.min,t.max],slide:(t,e)=>{const n=e.values[0],i=e.values[1];document.getElementById(u).innerText=`[${n.toFixed(2)}  ${i.toFixed(2)}]`,this.controller("SetNodeSizeRange",{min:n,max:i})},create:()=>{document.getElementById(u).innerText=`[${t.min.toFixed(2)}  ${t.max.toFixed(2)}]`}})}{const t={min:this.view_config.min_link_size,max:this.view_config.max_link_size};$("#"+g).slider({range:!0,min:t.min,max:t.max,step:.01,values:[t.min,t.max],slide:(t,e)=>{const n=e.values[0],i=e.values[1];document.getElementById(d).innerText=`[${n.toFixed(2)}  ${i.toFixed(2)}]`,this.controller("SetLinkSizeRange",{min:n,max:i})},create:()=>{document.getElementById(d).innerText=`[${t.min.toFixed(2)}  ${t.max.toFixed(2)}]`}})}const w=document.createElement("ul");w.style.display="flex",w.style.flexDirection="column",w.style.padding="0";{const t=document.createElement("li");t.style.listStyleType="none",t.style.display="flex",t.style.flexDirection="row";{const e=document.createElement("div");e.style.display="flex",e.style.flexDirection="row",e.style.justifyContent="space-between",e.style.flex="1";const i=document.createElement("span");i.innerText=n.apply("LOC_NODEFONT");const s=document.createElement("input");s.id=p,s.style.width="70px",s.type="number",s.min="5",s.max="50",s.value="24",s.required=!0,e.appendChild(i),e.appendChild(s),t.appendChild(e)}const e=document.createElement("button");e.className="scivi_button",e.innerText=n.apply("LOC_APPLY"),e.style.marginLeft="10px",e.onclick=(()=>{const t=document.getElementById(p);this.controller("SetLabelFontSize",{font_size:parseInt(t.value)})}),t.appendChild(e),w.appendChild(t)}{const t=document.createElement("li");t.style.listStyleType="none";const i=document.createElement("span");i.innerText=`${n.apply("#always_show_labels")}:`;const s=document.createElement("input");s.id=f,s.type="checkbox",s.value="false",s.onclick=(()=>e("ToggleLabelsShowing",null)),t.appendChild(i),t.appendChild(s),w.appendChild(t)}if(this.container.appendChild(w),E(this.container),Object.keys(this.layouts).length>0){const t=document.createElement("div");{const e=document.createElement("select");e.id=m,e.name=m;const i=document.createElement("ul");i.id=_,i.style.margin="10px 10px",e.onchange=(()=>{i.innerHTML="";const t=this.layouts[e.value].getConfiguration();t&&Object.keys(t).forEach(e=>{const n=t[e],r=n.range,o=document.createElement("li");o.style.listStyleType="none",o.innerHTML=`${this.translator.apply("#"+e+"_text")}: `;const a=document.createElement("input");a.className="layout_input",a.id=e,n instanceof s.BooleanParam?(a.type="checkbox",a.checked=n.value):(a.type="number",a.max=String(r.max),a.min=String(r.min),a.step=String(r.step),a.value=String(r.default)),o.appendChild(a),i.appendChild(o)})});const r=document.createElement("button");r.id=v,r.innerText=n.apply("LOC_BUILD_LAYOUT"),r.className="scivi_button",r.onclick=(()=>{const t=this.layouts[e.value].getConfiguration();Object.keys(t).forEach(e=>{const n=document.getElementById(e);switch(t[e].type){case s.ParamType.NUMBER:t[e].value=parseFloat(n.value);break;case s.ParamType.BOOLEAN:t[e].value=n.checked}}),this.controller("layout",{builder:this.layouts[e.value]})}),t.appendChild(e),t.appendChild(i),t.appendChild(r)}this.container.appendChild(t),E(this.container),this.fillLayouts()}const S=document.createElement("div");{const t=document.createElement("button");t.className="scivi_button",t.innerText=n.apply("LOC_FIT_TO_SCREEN"),t.id=y;const e=document.createElement("button");e.className="scivi_button",e.innerText=n.apply("LOC_CALC_MODULARITY"),e.id=b;const i=document.createElement("button");i.className="scivi_button",i.innerText=n.apply("LOC_SAVE_GRAPH"),i.id=x;const s=document.createElement("button");s.className="scivi_button",s.innerText=n.apply("#save_as_png"),s.onclick=(()=>this.controller("SavePNG",null)),S.appendChild(t),S.appendChild(e),S.appendChild(i),S.appendChild(s)}this.container.appendChild(S),E(this.container);const k=document.createElement("button");k.className="scivi_button",k.innerText=n.apply("LOC_HELP"),this.container.appendChild(k)}clear(){}fill(t){const e=t;document.getElementById(b).onclick=(()=>{r(e),this.controller("GraphClusterized",null)})}fillLayouts(){const t=document.getElementById(m);document.getElementById(_);Object.keys(this.layouts).forEach(e=>{const n=document.createElement("option");n.value=e,n.innerText=this.translator.apply("#"+e),e==Object.keys(this.layouts)[0]&&(n.selected=!0),t.appendChild(n)})}}function E(t){t.appendChild(document.createElement("br")),t.appendChild(document.createElement("hr")),t.appendChild(document.createElement("br"))}},"./src/Translator.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"Translator",function(){return s}),n.d(e,"getOrCreateTranslatorInstance",function(){return o});var i=n("./node_modules/node-polyglot/index.js");class s{constructor(t="ru"){this._locale=t,this._instance=new i({allowMissing:!1,locale:t})}extend(t){return this._instance.extend(t[this._locale]),this}apply(t){return this._instance.t(t)}}let r;function o(t=""){return r||(r=new s(t)),r}},"./src/index.ts":function(t,e,n){"use strict";n.r(e),n.d(e,"getParameterByName",function(){return v});var i=n("./src/Translator.ts");n.d(e,"Translator",function(){return i.Translator}),n.d(e,"getOrCreateTranslatorInstance",function(){return i.getOrCreateTranslatorInstance});var s=n("./src/GUI.ts");n.d(e,"GUI",function(){return s.GUI});var r=n("./src/GraphSerializer.ts");n.d(e,"GraphSerializer",function(){return r.GraphSerializer});var o=n("./src/Renderers/CircleNodeRenderer.ts");n.d(e,"CircleNodeRenderer",function(){return o.CircleNodeRenderer});var a=n("./src/Renderers/OrientedStraightLinkRenderer.ts");n.d(e,"OrientedStraightLinkRenderer",function(){return a.OrientedStraightLinkRenderer});var l=n("./src/Renderers/StraightLinkRenderer.ts");n.d(e,"StraightLinkRenderer",function(){return l.StraightLinkRenderer});var h=n("./src/LayoutBuilders/LayoutBuilder_Circle.ts");n.d(e,"LayoutBuilder_Circle",function(){return h.LayoutBuilder_Circle});var u=n("./src/LayoutBuilders/LayoutBuilder_FruchtermanReingold.ts");n.d(e,"LayoutBuilder_FruchtermanReingold",function(){return u.LayoutBuilder_FruchtermanReingold});var c=n("./src/Tabs/NodeInfoTab.ts");n.d(e,"NodeInfoTab",function(){return c.NodeInfoTab});var d=n("./src/Tabs/NodeListTab.ts");n.d(e,"NodeListTab",function(){return d.NodeListTab});var g=n("./src/Tabs/SettingsTab.ts");n.d(e,"SettingsTab",function(){return g.SettingsTab});var p=n("./src/Tabs/FiltersTab.ts");n.d(e,"FiltersTab",function(){return p.FiltersTab});var f=n("./src/Tabs/CalculatorTab.ts");n.d(e,"StateCalculatorOperand",function(){return f.StateCalculatorOperand}),n.d(e,"CalculatorTab",function(){return f.CalculatorTab});var m=n("./src/Tabs/AboutGraphTab.ts");n.d(e,"AboutGraphTab",function(){return m.AboutGraphTab});var _=n("./src/@types/Param.ts");function v(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp(`[?&]${t}(=([^&#]*)|&|#|$)`).exec(e);if(n)return n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):""}n.d(e,"ParamType",function(){return _.ParamType}),n.d(e,"Param",function(){return _.Param}),n.d(e,"ScalarParam",function(){return _.ScalarParam}),n.d(e,"BooleanParam",function(){return _.BooleanParam})}});