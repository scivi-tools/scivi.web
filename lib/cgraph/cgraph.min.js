(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.CGraph=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var SciViCGraph;(function(SciViCGraph){var Calculator=function(){function Calculator(m_renderer,m_container){this.m_renderer=m_renderer;this.m_container=m_container;this.m_exprDiv=null;this.m_operands=null;this.m_operations=null}Calculator.prototype.addFirstOperation=function(){this.m_operands=[];this.m_operations=[];var expr=$("<div>");expr.append(this.createOperandCombo());expr.append(this.createOperationCombo());expr.append(this.createOperandCombo());this.m_exprDiv.append(expr)};Calculator.prototype.addOperand=function(){var expr=$("<div>");expr.append(this.createOperationCombo());expr.append(this.createOperandCombo());this.m_exprDiv.append(expr)};Calculator.prototype.clean=function(){this.m_exprDiv.empty();this.addFirstOperation()};Calculator.prototype.stateFullName=function(stateKey){var indices=stateKey.split("|");var result="";for(var i=0,n=indices.length;i<n;++i){var ind=parseInt(indices[i]);result+=this.m_renderer.states.stateLines[i][ind];if(i<n-1)result+=" → "}return result};Calculator.prototype.createOperandCombo=function(){var _this=this;var combo=$('<select id="combo">');Object.keys(this.m_renderer.states.data).forEach(function(dataKey){if(dataKey!=="calculated")$("<option>",{value:dataKey,text:_this.stateFullName(dataKey)}).appendTo(combo)});this.m_operands.push(combo);return combo};Calculator.prototype.createOperationCombo=function(){var combo=$('<select id="combo">');$("<option>",{value:Calculator.m_opIntersect,text:this.m_renderer.localizer["LOC_OPINTERSECT"]}).appendTo(combo);$("<option>",{value:Calculator.m_opDiff,text:this.m_renderer.localizer["LOC_OPDIFF"]}).appendTo(combo);$("<option>",{value:Calculator.m_opSymDiff,text:this.m_renderer.localizer["LOC_OPSYMDIFF"]}).appendTo(combo);$("<option>",{value:Calculator.m_opUnion,text:this.m_renderer.localizer["LOC_OPUNION"]}).appendTo(combo);$("<option>",{value:Calculator.m_opUnionAdd,text:this.m_renderer.localizer["LOC_OPSUM"]}).appendTo(combo);this.m_operations.push(combo);return combo};Calculator.prototype.getState=function(stateKey){return this.m_renderer.states.data[stateKey]};Calculator.prototype.findCorrespondingNode=function(node,nodes){if(node){for(var i=0,n=nodes.length;i<n;++i){if(nodes[i].label===node.label)return nodes[i]}}return null};Calculator.prototype.findCorrespondingEdge=function(src,dst,edges){if(src&&dst){for(var i=0,n=edges.length;i<n;++i){if(edges[i].source.label===src.label&&edges[i].target.label===dst.label)return edges[i]}}return null};Calculator.prototype.stateUnion=function(stateA,stateB,shouldAdd){var _this=this;var resultNodes=[];stateA.nodes.forEach(function(node){resultNodes.push(node.clone())});stateB.nodes.forEach(function(node){var corrNode=_this.findCorrespondingNode(node,resultNodes);if(corrNode)corrNode.custom["weight"]=shouldAdd?corrNode.weight+node.weight:Math.max(corrNode.weight,node.weight);else resultNodes.push(node.clone(resultNodes.length))});var resultEdges=[];stateA.edges.forEach(function(edge){var src=_this.findCorrespondingNode(edge.source,resultNodes);var dst=_this.findCorrespondingNode(edge.target,resultNodes);resultEdges.push(new SciViCGraph.Edge(src,dst,edge.weight,null))});stateB.edges.forEach(function(edge){var src=_this.findCorrespondingNode(edge.source,resultNodes);var dst=_this.findCorrespondingNode(edge.target,resultNodes);var corrEdge=_this.findCorrespondingEdge(src,dst,resultEdges);if(corrEdge)corrEdge.weight=shouldAdd?corrEdge.weight+edge.weight:Math.max(corrEdge.weight,edge.weight);else resultEdges.push(new SciViCGraph.Edge(src,dst,edge.weight,null))});return new SciViCGraph.GraphData(resultNodes,resultEdges)};Calculator.prototype.stateIntersect=function(stateA,stateB){var _this=this;var resultNodes=[];stateA.nodes.forEach(function(node){var corrNode=_this.findCorrespondingNode(node,stateB.nodes);if(corrNode){var newNode=node.clone();newNode.custom["weight"]=Math.min(node.weight,corrNode.weight);resultNodes.push(newNode)}});var resultEdges=[];stateA.edges.forEach(function(edge){var src=_this.findCorrespondingNode(edge.source,resultNodes);var dst=_this.findCorrespondingNode(edge.target,resultNodes);var corrEdge=_this.findCorrespondingEdge(src,dst,stateB.edges);if(corrEdge)resultEdges.push(new SciViCGraph.Edge(src,dst,Math.min(edge.weight,corrEdge.weight),null))});return new SciViCGraph.GraphData(resultNodes,resultEdges)};Calculator.prototype.stateDiff=function(stateA,stateB){var _this=this;var resultNodes=[];stateA.nodes.forEach(function(node){var newNode=node.clone();var corrNode=_this.findCorrespondingNode(node,stateB.nodes);if(corrNode)newNode.custom["weight"]=Math.max(newNode.weight-corrNode.weight,0);resultNodes.push(newNode)});var resultEdges=[];stateA.edges.forEach(function(edge){var src=_this.findCorrespondingNode(edge.source,resultNodes);var dst=_this.findCorrespondingNode(edge.target,resultNodes);var corrEdge=_this.findCorrespondingEdge(src,dst,stateB.edges);if(!corrEdge)resultEdges.push(new SciViCGraph.Edge(src,dst,edge.weight,null))});return new SciViCGraph.GraphData(resultNodes,resultEdges)};Calculator.prototype.stateSymDiff=function(stateA,stateB){return this.stateDiff(this.stateUnion(stateA,stateB,false),this.stateIntersect(stateA,stateB))};Calculator.prototype.calculate=function(){var result=this.getState(this.m_operands[0].val());for(var i=0,n=this.m_operations.length;i<n;++i){switch(this.m_operations[i].val()){case Calculator.m_opUnion:result=this.stateUnion(result,this.getState(this.m_operands[i+1].val()),false);break;case Calculator.m_opIntersect:result=this.stateIntersect(result,this.getState(this.m_operands[i+1].val()));break;case Calculator.m_opDiff:result=this.stateDiff(result,this.getState(this.m_operands[i+1].val()));break;case Calculator.m_opSymDiff:result=this.stateSymDiff(result,this.getState(this.m_operands[i+1].val()));break;case Calculator.m_opUnionAdd:result=this.stateUnion(result,this.getState(this.m_operands[i+1].val()),true);break}}this.m_renderer.states.data["calculated"]=result;this.m_renderer.changeCurrentStateToCalculated()};Calculator.prototype.build=function(){var _this=this;if(this.m_container){this.m_exprDiv=$("<div>");$(this.m_container).append(this.m_exprDiv);var br=$("<br>");$(this.m_container).append(br);this.addFirstOperation();var addOpBtn=$("<div>").attr({class:"scivi_button"});addOpBtn.html(this.m_renderer.localizer["LOC_ADDOPERAND"]);addOpBtn.click(function(){_this.addOperand()});$(this.m_container).append(addOpBtn);var calcBtn=$("<div>").attr({class:"scivi_button"});calcBtn.html(this.m_renderer.localizer["LOC_CALCULATE"]);calcBtn.click(function(){_this.calculate()});$(this.m_container).append(calcBtn);var cleanBtn=$("<div>").attr({class:"scivi_button"});cleanBtn.html(this.m_renderer.localizer["LOC_CLEANCALC"]);cleanBtn.click(function(){_this.clean()});$(this.m_container).append(cleanBtn)}};Calculator.m_opUnion="0";Calculator.m_opIntersect="1";Calculator.m_opDiff="2";Calculator.m_opSymDiff="3";Calculator.m_opUnionAdd="4";return Calculator}();SciViCGraph.Calculator=Calculator})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var Classifier=function(){function Classifier(m_tree,getKlass){this.m_tree=m_tree;this.getKlass=getKlass}Classifier.prototype.repeatStr=function(str,n){var result="";for(var i=0;i<n;++i)result+=str;return result};Classifier.prototype.findNodeByKlass=function(root,klass,steps){if(root["klass"]===klass)return root;else{++steps[0];if(root["children"]){var children=root["children"];for(var i=0,n=children.length;i<n;++i){var result=this.findNodeByKlass(children[i],klass,steps);if(result)return result}}return null}};Classifier.prototype.stepsToKlass=function(klass){var steps=[0];this.findNodeByKlass(this.m_tree,klass,steps);return steps[0]};Classifier.prototype.buildTreeLevels=function(root,levels,depth,hueFrom,hueTo){if(levels.length<depth)levels.push([]);levels[depth-1].push(root);root["klasses"]=[];if(root["klass"]!==undefined)root["klasses"].push(root["klass"]);if(!root["color"]){root["color"]=SciViCGraph.Color.hsv2rgb([levels[depth-1].length%2?(hueFrom+hueTo)/2:360-(hueFrom+hueTo)/2,depth%2?40:80,levels[depth-1].length%2?60:90])}if(!root["textColor"]){root["textColor"]=SciViCGraph.Color.maxContrast(root["color"])}if(root["children"]){var children=root["children"];var hStep=(hueTo-hueFrom)/children.length;for(var i=0,n=children.length;i<n;++i){var hF=hueFrom+i*hStep;var hT=hF+hStep;var chKlasses=this.buildTreeLevels(children[i],levels,depth+1,hF,hT);root["klasses"]=root["klasses"].concat(chKlasses)}}return root["klasses"]};Classifier.prototype.buildTreeStructure=function(root,depth){var result;var isLeaf=!root["children"]||root["children"].length===0;if(root["name"]){if(root["klass"]){if(isLeaf)result="<li data-id='"+root["klass"]+"'>"+this.repeatStr("-",depth)+root["name"]+"</li>";else{result="<li data-id='-1'>"+this.repeatStr("-",depth)+root["name"]+"</li>";result+="<li data-id='"+root["klass"]+"'>"+this.repeatStr("-",depth+1)+root["name"]+"</li>"}}else{result="<li data-id='-1'>"+this.repeatStr("-",depth)+root["name"]+"</li>"}}else{--depth}if(!isLeaf){var children=root["children"];for(var i=0,n=children.length;i<n;++i)result+=this.buildTreeStructure(children[i],depth+1)}return result};Classifier.prototype.sortNodes=function(nodes){var _this=this;nodes.sort(function(n1,n2){var c=_this.stepsToKlass(_this.getKlass(n1))-_this.stepsToKlass(_this.getKlass(n2));if(c===0)return n1.label.localeCompare(n2.label);else return c})};Classifier.prototype.generateScaleLevels=function(){var treeLevels=[];this.buildTreeLevels(this.m_tree,treeLevels,1,0,360);var result=[];var _loop_1=function(i){var klasses=[];var names=[];var colors=[];var textColors=[];treeLevels[i].forEach(function(treeNode){klasses.push(treeNode["klasses"].sort(function(x1,x2){return x1-x2}));names.push(treeNode["name"]);colors.push(treeNode["color"]);textColors.push(treeNode["textColor"])});result.push(new SciViCGraph.DiscreteScale(klasses,colors,textColors,names,this_1.getKlass))};var this_1=this;for(var i=treeLevels.length-1;i>0;--i){_loop_1(i)}return result};Classifier.prototype.initTreeView=function(treeView,svRenderer){var _this=this;if(!treeView)return;var div=$("<div>",{class:"hummingbird-treeview-converter","data-height":"500px"});div.html(this.buildTreeStructure(this.m_tree,0));treeView.appendChild(div[0]);$.fn.hummingbird.convert();$("#treeview").hummingbird();$("#treeview").on("CheckUncheckDone",function(){var list={id:[],dataid:[],text:[]};$("#treeview").hummingbird("getChecked",{list:list,onlyEndNodes:false});var klasses=[];list["dataid"].forEach(function(klass){klasses.push(parseInt(klass))});klasses.sort(function(x1,x2){return x1-x2});Object.keys(svRenderer.states.data).forEach(function(dataKey){var data=svRenderer.states.data[dataKey];data.excludeUnselected(klasses,_this.getKlass)});svRenderer.updateNodeKlasses()})};return Classifier}();SciViCGraph.Classifier=Classifier})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var Color=function(){function Color(){}Color.rgb2hsv=function(rgb){var result=[0,0,0];var r=rgb>>16&255;var g=rgb>>8&255;var b=rgb&255;r/=255;g/=255;b/=255;var mm=Math.max(r,g,b);var m=Math.min(r,g,b);var c=mm-m;if(c===0)result[0]=0;else if(mm===r)result[0]=(g-b)/c%6;else if(mm===g)result[0]=(b-r)/c+2;else result[0]=(r-g)/c+4;result[0]*=60;if(result[0]<0)result[0]+=360;result[2]=mm;if(result[2]===0)result[1]=0;else result[1]=c/result[2];result[1]*=100;result[2]*=100;return result};Color.hsv2rgb=function(hsv){if(hsv[0]<0)hsv[0]=0;if(hsv[1]<0)hsv[1]=0;if(hsv[2]<0)hsv[2]=0;if(hsv[0]>=360)hsv[0]=359;if(hsv[1]>100)hsv[1]=100;if(hsv[2]>100)hsv[2]=100;hsv[0]/=60;hsv[1]/=100;hsv[2]/=100;var c=hsv[1]*hsv[2];var x=c*(1-Math.abs(hsv[0]%2-1));var r=0;var g=0;var b=0;if(hsv[0]>=0&&hsv[0]<1){r=c;g=x}else if(hsv[0]>=1&&hsv[0]<2){r=x;g=c}else if(hsv[0]>=2&&hsv[0]<3){g=c;b=x}else if(hsv[0]>=3&&hsv[0]<4){g=x;b=c}else if(hsv[0]>=4&&hsv[0]<5){r=x;b=c}else{r=c;b=x}var m=hsv[2]-c;r=Math.round((r+m)*255);g=Math.round((g+m)*255);b=Math.round((b+m)*255);return r<<16|g<<8|b};Color.srgb2rgb=function(c){return c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4)};Color.maxContrast=function(rgb){var r=Color.srgb2rgb((rgb>>16&255)/255);var g=Color.srgb2rgb((rgb>>8&255)/255);var b=Color.srgb2rgb((rgb&255)/255);return.2126*r+.7152*g+.0722*b>=.3?0:16777215};return Color}();SciViCGraph.Color=Color})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var Curve=function(_super){__extends(Curve,_super);function Curve(){var _this=_super.call(this)||this;_this.m_colors=[];_this.m_arrowThicknesses=[];return _this}Curve.prototype.addVertex=function(vertices,px,py,nx,ny,wIn,wOut,r,g,b,a){var dx=nx*wIn;var dy=ny*wIn;vertices.push(px-dx,py-dy,r,g,b,a);vertices.push(px+dx,py+dy,r,g,b,a);dx=nx*wOut;dy=ny*wOut;vertices.push(px-dx,py-dy,0,0,0,0);vertices.push(px+dx,py+dy,0,0,0,0)};Curve.prototype.buildLine=function(graphicsData,webGLData,fromColor,toColor,alpha,arrowThickness){graphicsData.points=graphicsData.shape.points.slice();var points=graphicsData.points;if(points.length===0)return;var vertices=webGLData.points;var indices=webGLData.indices;var length=points.length/2;var indexCount=points.length;var indexStart=vertices.length/6;var feather=1;var widthIn=graphicsData.lineWidth/2;var widthOut=widthIn+feather;var p1x=0;var p1y=0;var p2x=0;var p2y=0;var p3x=0;var p3y=0;var totalLength=0;for(var i=0;i<length-1;++i){p1x=points[i*2]-points[(i+1)*2];p1y=points[i*2+1]-points[(i+1)*2+1];totalLength+=Math.sqrt(p1x*p1x+p1y*p1y)}var rFrom=(fromColor>>16&255)*alpha/255;var gFrom=(fromColor>>8&255)*alpha/255;var bFrom=(fromColor&255)*alpha/255;var rTo=(toColor>>16&255)*alpha/255;var gTo=(toColor>>8&255)*alpha/255;var bTo=(toColor&255)*alpha/255;var r=rFrom;var g=gFrom;var b=bFrom;var t=0;var n1x=0;var n1y=0;var n2x=0;var n2y=0;var n3x=0;var n3y=0;var d=0;var nLen=0;var currentLength=0;for(var i=0;i<length;++i){if(i===0){p1x=points[0];p1y=points[1];p2x=points[0];p2y=points[1];p3x=points[2];p3y=points[3];r=rFrom;g=gFrom;b=bFrom}else if(i===length-1){p1x=points[(i-1)*2];p1y=points[(i-1)*2+1];p2x=points[i*2];p2y=points[i*2+1];p3x=points[i*2];p3y=points[i*2+1];r=rTo;g=gTo;b=bTo}else{p1x=points[(i-1)*2];p1y=points[(i-1)*2+1];p2x=points[i*2];p2y=points[i*2+1];p3x=points[(i+1)*2];p3y=points[(i+1)*2+1];t=currentLength/totalLength;r=rFrom+t*(rTo-rFrom);g=gFrom+t*(gTo-gFrom);b=bFrom+t*(bTo-bFrom)}if(arrowThickness>0){if(i===length-2){widthIn=arrowThickness/2;widthOut=widthIn+feather}else if(i===length-1){widthIn=0;widthOut=feather}}n1x=-(p2y-p1y);n1y=p2x-p1x;n2x=-(p3y-p2y);n2y=p3x-p2x;nLen=Math.sqrt(n1x*n1x+n1y*n1y);if(nLen<.1){nLen=Math.sqrt(n2x*n2x+n2y*n2y);if(nLen<.1){continue}else{n2x/=nLen;n2y/=nLen;n1x=n2x;n1y=n2y}}else{n1x/=nLen;n1y/=nLen;var l=Math.sqrt(n2x*n2x+n2y*n2y);if(l<.1){n2x=n1x;n2y=n1y}else{nLen=l;n2x/=nLen;n2y/=nLen}}currentLength+=nLen;d=n1x*n2x+n1y*n2y;if(d<-.5){n3x=n1x-n2x;n3y=n1y-n2y}else{n3x=n1x+n2x;n3y=n1y+n2y}nLen=Math.sqrt(n3x*n3x+n3y*n3y);n3x/=nLen;n3y/=nLen;d=n1x*n3x+n1y*n3y;this.addVertex(vertices,p2x,p2y,n3x,n3y,widthIn/d,widthOut/d,r,g,b,alpha);if(i<length-1){indices.push(indexStart+2);indices.push(indexStart+6);indices.push(indexStart+0);indices.push(indexStart+0);indices.push(indexStart+6);indices.push(indexStart+4);indices.push(indexStart+0);indices.push(indexStart+4);indices.push(indexStart+1);indices.push(indexStart+1);indices.push(indexStart+4);indices.push(indexStart+5);indices.push(indexStart+1);indices.push(indexStart+5);indices.push(indexStart+3);indices.push(indexStart+3);indices.push(indexStart+5);indices.push(indexStart+7);indexStart+=4}}};Curve.prototype.updateGraphics=function(uid,gl,renderer){var webGL=this._webGL[uid];var graphicsRenderer=renderer.plugins.graphics;if(!webGL)webGL=this._webGL[uid]={lastIndex:0,data:[],gl:gl,clearDirty:-1,dirty:-1};webGL.dirty=this.dirty;if(this.clearDirty!==webGL.clearDirty){webGL.clearDirty=this.clearDirty;webGL.data.forEach(function(webGLData){graphicsRenderer.graphicsDataPool.push(webGLData)});webGL.data.length=0;webGL.lastIndex=0}var webGLData=void 0;for(var i=webGL.lastIndex;i<this.graphicsData.length;++i){this.buildLine(this.graphicsData[i],graphicsRenderer.getWebGLData(webGL,0),this.m_colors[i].from,this.m_colors[i].to,this.m_colors[i].alpha,this.m_arrowThicknesses[i]);webGL.lastIndex++}renderer.bindVao(null);webGL.data.forEach(function(webGLData){if(webGLData.dirty)webGLData.upload()})};Curve.prototype._renderWebGL=function(renderer){var _this=this;renderer.setObjectRenderer(renderer.plugins.graphics);var gl=renderer.gl;var uid=renderer.plugins.graphics.CONTEXT_UID;var webGLData=void 0;var webGL=this._webGL[uid];if(!webGL||this.dirty!==webGL.dirty){this.updateGraphics(uid,gl,renderer);webGL=this._webGL[uid]}var shader=renderer.plugins.graphics.primitiveShader;renderer.bindShader(shader);renderer.state.setBlendMode(this.blendMode);webGL.data.forEach(function(webGLData){var shaderTemp=webGLData.shader;renderer.bindShader(shaderTemp);shaderTemp.uniforms.translationMatrix=_this.transform.worldTransform.toArray(true);shaderTemp.uniforms.tint=[1,1,1];shaderTemp.uniforms.alpha=_this.worldAlpha;renderer.bindVao(webGLData.vao);webGLData.vao.draw(gl.TRIANGLES,webGLData.indices.length)})};Curve.prototype.distance=function(x1,y1,x2,y2){var x=x2-x1;var y=y2-y1;return Math.sqrt(x*x+y*y)};Curve.prototype.quadraticCurveLength=function(fromX,fromY,cpX,cpY,toX,toY){var eps=.001;var ax=fromX-2*cpX+toX;var ay=fromY-2*cpY+toY;var bx=2*cpX-2*fromX;var by=2*cpY-2*fromY;var a=4*(ax*ax+ay*ay);if(Math.abs(a)<eps)return this.distance(fromX,fromY,toX,toY);var b=4*(ax*bx+ay*by);var c=bx*bx+by*by;var s=2*Math.sqrt(a+b+c);var a2=Math.sqrt(a);var a32=2*a*a2;var c2=2*Math.sqrt(c);var ba=b/a2;var l1=2*a2+ba+s;var l2=ba+c2;if(Math.abs(l2)<eps)return this.distance(fromX,fromY,toX,toY);var l3=l1/l2;if(l3<0||Math.abs(l3)<eps)return this.distance(fromX,fromY,toX,toY);return(a32*s+a2*b*(s-c2)+(4*c*a-b*b)*Math.log(l3))/(4*a32)};Curve.prototype.bezierCurveLength=function(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY){var n=10;var result=0;var t=0;var t2=0;var t3=0;var nt=0;var nt2=0;var nt3=0;var x=0;var y=0;var dx=0;var dy=0;var prevX=fromX;var prevY=fromY;for(var i=1;i<=n;++i){t=i/n;t2=t*t;t3=t2*t;nt=1-t;nt2=nt*nt;nt3=nt2*nt;x=nt3*fromX+3*nt2*t*cpX+3*nt*t2*cpX2+t3*toX;y=nt3*fromY+3*nt2*t*cpY+3*nt*t2*cpY2+t3*toY;dx=prevX-x;dy=prevY-y;prevX=x;prevY=y;result+=Math.sqrt(dx*dx+dy*dy)}return result};Curve.prototype.segmentsCount=function(length){var result=Math.ceil(length/10);if(result<8)result=8;else if(result>2048)result=2048;return result};Curve.prototype.quadraticCurveWithArrowTo=function(cpX,cpY,toX,toY,arrowLength,arrowThickness){if(this.currentPath){if(this.currentPath.shape.points.length===0)this.currentPath.shape.points=[0,0]}else{this.moveTo(0,0)}var points=this.currentPath.shape.points;var xa=0;var ya=0;if(points.length===0)this.moveTo(0,0);var fromX=points[points.length-2];var fromY=points[points.length-1];var n=this.segmentsCount(this.quadraticCurveLength(fromX,fromY,cpX,cpY,toX,toY));var corrToX=toX;var corrToY=toY;var capArrow=arrowLength>0&&arrowThickness>0;if(capArrow){xa=cpX-toX;ya=cpY-toY;var l=arrowLength/Math.sqrt(xa*xa+ya*ya);corrToX+=xa*l;corrToY+=ya*l}for(var i=1;i<=n;++i){var j=i/n;xa=fromX+(cpX-fromX)*j;ya=fromY+(cpY-fromY)*j;points.push(xa+(cpX+(corrToX-cpX)*j-xa)*j,ya+(cpY+(corrToY-cpY)*j-ya)*j)}if(capArrow){var n_1=points.length;points.push(points[n_1-2],points[n_1-1]);points.push(toX,toY)}this.dirty++;this.m_arrowThicknesses.push(arrowThickness);return this};Curve.prototype.arc=function(cx,cy,radius,startAngle,endAngle,anticlockwise){if(anticlockwise===void 0){anticlockwise=false}if(startAngle===endAngle)return this;if(!anticlockwise&&endAngle<=startAngle)endAngle+=Math.PI*2;else if(anticlockwise&&startAngle<=endAngle)startAngle+=Math.PI*2;var sweep=endAngle-startAngle;var segs=this.segmentsCount(Math.abs(sweep)*radius);if(sweep===0)return this;var startX=cx+Math.cos(startAngle)*radius;var startY=cy+Math.sin(startAngle)*radius;var points=this.currentPath?this.currentPath.shape.points:null;if(points){if(points[points.length-2]!==startX||points[points.length-1]!==startY)points.push(startX,startY)}else{this.moveTo(startX,startY);points=this.currentPath.shape.points}var theta=sweep/(segs*2);var theta2=theta*2;var cTheta=Math.cos(theta);var sTheta=Math.sin(theta);var segMinus=segs-1;var remainder=segMinus%1/segMinus;for(var i=0;i<=segMinus;++i){var real=i+remainder*i;var angle=theta+startAngle+theta2*real;var c=Math.cos(angle);var s=-Math.sin(angle);points.push((cTheta*c+sTheta*s)*radius+cx,(cTheta*-s+sTheta*c)*radius+cy)}this.dirty++;return this};Curve.prototype.bezier=function(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY,n,path){if(path===void 0){path=[]}var dt=0;var dt2=0;var dt3=0;var t2=0;var t3=0;path.push(fromX,fromY);for(var i=1,j=0;i<=n;++i){j=i/n;dt=1-j;dt2=dt*dt;dt3=dt2*dt;t2=j*j;t3=t2*j;path.push(dt3*fromX+3*dt2*j*cpX+3*dt*t2*cpX2+t3*toX,dt3*fromY+3*dt2*j*cpY+3*dt*t2*cpY2+t3*toY)}return path};Curve.prototype.bezierCurveWithArrowTo=function(cpX,cpY,cpX2,cpY2,toX,toY,arrowLength,arrowThickness){if(this.currentPath){if(this.currentPath.shape.points.length===0)this.currentPath.shape.points=[0,0]}else{this.moveTo(0,0)}var points=this.currentPath.shape.points;var fromX=points[points.length-2];var fromY=points[points.length-1];points.length-=2;var n=this.segmentsCount(this.bezierCurveLength(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY));var corrToX=toX;var corrToY=toY;var capArrow=arrowLength>0&&arrowThickness>0;if(capArrow){var xa=cpX2-toX;var ya=cpY2-toY;var l=arrowLength/Math.sqrt(xa*xa+ya*ya);corrToX+=xa*l;corrToY+=ya*l}this.bezier(fromX,fromY,cpX,cpY,cpX2,cpY2,corrToX,corrToY,n,points);if(capArrow){var n_2=points.length;points.push(points[n_2-2],points[n_2-1]);points.push(toX,toY)}this.dirty++;this.m_arrowThicknesses.push(arrowThickness);return this};Curve.prototype.addColor=function(c){this.m_colors.push(c)};Curve.prototype.bringToFront=function(){var p=this.parent;if(p){p.removeChild(this);p.addChild(this)}};Curve.prototype.bringToBack=function(){var p=this.parent;if(p){p.removeChild(this);p.addChildAt(this,0)}};return Curve}(PIXI.Graphics);SciViCGraph.Curve=Curve})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var Edge=function(){function Edge(source,target,weight,tooltip){this.source=source;this.target=target;this.weight=weight;this.tooltip=tooltip;this.m_fromColor=0;this.m_toColor=0;this.m_alpha=0;this.m_batch=null;this.m_glow=null;this.m_highlight=undefined;this.m_visible=true;this.m_thickness=0;this.m_glowThickness=0;this.m_cursorPos={x:0,y:0};this.m_isDirected=false;this.m_enableLoop=false}Edge.prototype.passiveColor=function(rgb){var hsv=SciViCGraph.Color.rgb2hsv(rgb);hsv[1]=10;hsv[2]=90;return SciViCGraph.Color.hsv2rgb(hsv)};Edge.prototype.setBatch=function(batch){this.m_batch=batch};Edge.prototype.setNeedsUpdate=function(){this.m_batch.setNeedsUpdate()};Object.defineProperty(Edge.prototype,"highlight",{get:function(){return this.m_highlight},set:function(hl){if(hl!==this.m_highlight){this.m_highlight=hl;var fromColor=this.source?this.source.groupColor:Edge.m_detachedColor;var toColor=this.target?this.target.groupColor:Edge.m_detachedColor;switch(this.m_highlight){case SciViCGraph.HighlightType.None:{this.m_fromColor=this.passiveColor(fromColor);this.m_toColor=this.passiveColor(toColor);this.m_alpha=Edge.passiveEdgeAlpha;this.m_batch.sendToBack();break}case SciViCGraph.HighlightType.Hover:case SciViCGraph.HighlightType.Selection:case SciViCGraph.HighlightType.Multiselect:{this.m_fromColor=fromColor;this.m_toColor=toColor;this.m_alpha=Edge.m_hoveredEdgeAlpha;this.m_batch.sendToFront();break}}this.m_batch.setNeedsUpdate()}},enumerable:true,configurable:true});Object.defineProperty(Edge.prototype,"visible",{get:function(){return this.m_visible},set:function(v){if(v!==this.m_visible){this.m_visible=v;this.m_batch.setNeedsUpdate()}},enumerable:true,configurable:true});Object.defineProperty(Edge.prototype,"fromColor",{get:function(){return this.m_fromColor},enumerable:true,configurable:true});Object.defineProperty(Edge.prototype,"toColor",{get:function(){return this.m_toColor},enumerable:true,configurable:true});Object.defineProperty(Edge.prototype,"alpha",{get:function(){return this.m_alpha},enumerable:true,configurable:true});Object.defineProperty(Edge.prototype,"thickness",{get:function(){return this.m_thickness},set:function(th){this.m_thickness=th},enumerable:true,configurable:true});Object.defineProperty(Edge.prototype,"isDirected",{get:function(){return this.m_isDirected},set:function(d){this.m_isDirected=d},enumerable:true,configurable:true});Edge.prototype.invalidate=function(wipeInternals){this.m_highlight=undefined;if(wipeInternals)this.m_glow=null};Object.defineProperty(Edge.prototype,"isGlowing",{set:function(g){if(this.m_batch){if(g&&this.m_glow&&this.m_glowThickness!==this.m_thickness){this.m_glow.parent.removeChild(this.m_glow);this.m_glow=null}if(this.m_glow){this.m_glow.visible=g;if(g)this.m_glow.bringToFront()}else{this.m_glow=this.m_batch.createGlow(this);this.m_glowThickness=this.m_thickness}}},enumerable:true,configurable:true});Edge.prototype.minMaxCP=function(cp){var minCP={x:cp[0].x,y:cp[0].y};var maxCP={x:cp[0].x,y:cp[0].y};for(var i=1,n=cp.length;i<n;++i){if(cp[i].x<minCP.x)minCP.x=cp[i].x;if(cp[i].y<minCP.y)minCP.y=cp[i].y;if(cp[i].x>maxCP.x)maxCP.x=cp[i].x;if(cp[i].y>maxCP.y)maxCP.y=cp[i].y}return[minCP,maxCP]};Edge.prototype.hitTestWithBBox=function(p,cp){var mm=this.minMaxCP(cp);var minC={x:mm[0].x-this.m_thickness,y:mm[0].y-this.m_thickness};var maxC={x:mm[1].x+this.m_thickness,y:mm[1].y+this.m_thickness};return p.x>=minC.x&&p.x<=maxC.x&&p.y>=minC.y&&p.y<=maxC.y};Edge.prototype.distanceToQuadCurve=function(p,c1,c2,c3){if(this.isDirected){var xa=c2.x-c3.x;var ya=c2.y-c3.y;var l=Edge.maxThickness/Math.sqrt(xa*xa+ya*ya);var corrTo={x:c3.x+xa*l,y:c3.y+ya*l};var curveDist=SciViCGraph.Geometry.distanceToQuadCurve(p,c1,c2,corrTo);var arrowDist=SciViCGraph.Geometry.distanceToLineSegment(p,corrTo,c3);return Math.min(curveDist,arrowDist)}else{return SciViCGraph.Geometry.distanceToQuadCurve(p,c1,c2,c3)}};Edge.prototype.distanceToBezierCurve=function(p,c1,c2,c3,c4){if(this.isDirected){var xa=c3.x-c4.x;var ya=c3.y-c4.y;var l=Edge.maxThickness/Math.sqrt(xa*xa+ya*ya);var corrTo={x:c4.x+xa*l,y:c4.y+ya*l};var curveDist=SciViCGraph.Geometry.distanceToBezierCurve(p,c1,c2,c3,corrTo);var arrowDist=SciViCGraph.Geometry.distanceToLineSegment(p,corrTo,c4);return Math.min(curveDist,arrowDist)}else{return SciViCGraph.Geometry.distanceToBezierCurve(p,c1,c2,c3,c4)}};Edge.prototype.hitTestWithCurve=function(p,cp){if(cp.length===3)return this.distanceToQuadCurve(p,cp[0],cp[1],cp[2])<=this.m_thickness;else return this.distanceToBezierCurve(p,cp[0],cp[1],cp[2],cp[3])<=this.m_thickness};Edge.prototype.hitTest=function(x,y){var p={x:x,y:y};var cp=this.controlPoints();return this.hitTestWithBBox(p,cp)&&this.hitTestWithCurve(p,cp)};Edge.prototype.freeCP=function(a,b){var m={x:(a.x+b.x)/2,y:(a.y+b.y)/2};var distAM=SciViCGraph.Geometry.distance(a,m);var distAO=Math.sqrt(a.x*a.x+a.y*a.y);if(distAO<.001)return{x:0,y:0};var distAC=distAO*distAM*distAM/(a.x*(a.x-m.x)+a.y*(a.y-m.y));if(distAC<0)distAC=0;else if(distAC>distAO)distAC=distAO;return{x:a.x*(1-distAC/distAO),y:a.y*(1-distAC/distAO)}};Edge.prototype.controlPoints=function(){if(this.source===null){var c1={x:this.m_cursorPos.x,y:this.m_cursorPos.y};var c2={x:0,y:0};var c3={x:this.target.x,y:this.target.y};return[c1,c2,c3]}else if(this.target===null){var c1={x:this.source.x,y:this.source.y};var c3={x:this.m_cursorPos.x,y:this.m_cursorPos.y};var c2=this.freeCP(c1,c3);return[c1,c2,c3]}else if(this.source===this.target){var c1={x:this.source.x,y:this.source.y};var x1=0;var y1=0;var x2=c1.x/2;var y2=c1.y/2;var c2={x:x1+y2,y:y1-x2};var c3={x:x1-y2,y:y1+x2};return[c1,c2,c3,c1]}else{var c1={x:this.source.x,y:this.source.y};var c2={x:0,y:0};var c3={x:this.target.x,y:this.target.y};return[c1,c2,c3]}};Edge.prototype.setCursorPos=function(p,r){if(this.m_enableLoop){var l=Math.sqrt(p.x*p.x+p.y*p.y);if(l>r){var a=r/l;p.x*=a;p.y*=a}}this.m_cursorPos=p};Edge.prototype.assignTarget=function(tg){if(tg===this.source)this.target=this.m_enableLoop?tg:null;else{this.m_enableLoop=true;this.target=tg}};Edge.passiveEdgeAlpha=.5;Edge.m_hoveredEdgeAlpha=1;Edge.m_selectedEdgeAlpha=1;Edge.m_detachedColor=16711680;Edge.minThickness=1.5;Edge.maxThickness=10;return Edge}();SciViCGraph.Edge=Edge})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var EdgeBatch=function(_super){__extends(EdgeBatch,_super);function EdgeBatch(){var _this=_super.call(this)||this;_this.m_edges=[];_this.m_needsUpdate=false;_this.m_move=0;return _this}EdgeBatch.prototype.drawCurve=function(curve,cp,thickness,fromColor,toColor,alpha,arrow,arrowLength,arrowThickness){if(!arrow)arrowLength=arrowThickness=0;curve.lineStyle(thickness,0,1);curve.addColor({from:fromColor,to:toColor,alpha:alpha});curve.moveTo(cp[0].x,cp[0].y);if(cp.length===3)curve.quadraticCurveWithArrowTo(cp[1].x,cp[1].y,cp[2].x,cp[2].y,arrowLength,arrowThickness);else curve.bezierCurveWithArrowTo(cp[1].x,cp[1].y,cp[2].x,cp[2].y,cp[3].x,cp[3].y,arrowLength,arrowThickness)};EdgeBatch.prototype.update=function(){var _this=this;var p=this.parent;this.clear();this.m_colors=[];this.m_arrowThicknesses=[];this.m_edges.forEach(function(edge){if(edge.visible){if(p.edgeWeight.max>p.edgeWeight.min){edge.thickness=SciViCGraph.Edge.minThickness+(SciViCGraph.Edge.maxThickness-SciViCGraph.Edge.minThickness)/(p.edgeWeight.max-p.edgeWeight.min)*(edge.weight-p.edgeWeight.min)}else{edge.thickness=(SciViCGraph.Edge.minThickness+SciViCGraph.Edge.maxThickness)/2}var arrowSize=Math.pow(edge.thickness*210,1/2.5);_this.drawCurve(_this,edge.controlPoints(),edge.thickness,edge.fromColor,edge.toColor,edge.alpha,edge.isDirected,arrowSize,arrowSize)}});if(this.m_move>0)this.bringToFront();else if(this.m_move<0)this.bringToBack();this.m_move=0};EdgeBatch.prototype.addEdge=function(edge){this.m_edges.push(edge);edge.setBatch(this);this.m_needsUpdate=true};EdgeBatch.prototype.setNeedsUpdate=function(){this.m_needsUpdate=true};EdgeBatch.prototype.sendToFront=function(){this.m_move=1};EdgeBatch.prototype.sendToBack=function(){this.m_move=-1};EdgeBatch.prototype.prepare=function(){if(this.m_needsUpdate){this.update();this.m_needsUpdate=false;return true}else{return false}};EdgeBatch.prototype.createGlow=function(edge){var result=new SciViCGraph.Curve;this.parent.addChild(result);var arrowSize=Math.pow(edge.thickness*210,1/2.5);this.drawCurve(result,edge.controlPoints(),edge.thickness*2,16711680,16711680,.5,edge.isDirected,arrowSize*1.15,arrowSize*1.65);return result};Object.defineProperty(EdgeBatch.prototype,"isFull",{get:function(){return this.m_edges.length===10},enumerable:true,configurable:true});return EdgeBatch}(SciViCGraph.Curve);SciViCGraph.EdgeBatch=EdgeBatch})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var EqualizerItem=function(){function EqualizerItem(m_renderer,segment,m_ringIndex){this.m_renderer=m_renderer;this.m_ringIndex=m_ringIndex;this.m_highlight=segment.doCopy();this.calcWeights();this.addInterface()}EqualizerItem.prototype.setWeights=function(nodeW,edgeW){this.m_nodeWeight=nodeW;this.m_edgeWeight=edgeW;this.m_nodeFilterSlider.setValues(this.m_nodeWeight);this.m_edgeFilterSlider.setValues(this.m_edgeWeight)};EqualizerItem.prototype.matchesRanges=function(nodeW,edgeW){return nodeW.min===this.m_nodeWeight.min&&nodeW.max===this.m_nodeWeight.max&&edgeW.min===this.m_edgeWeight.min&&edgeW.max===this.m_edgeWeight.max};EqualizerItem.prototype.containsNode=function(node){return this.m_highlight.containsAngle(node.rotation)};EqualizerItem.prototype.calcWeights=function(){var _this=this;this.m_nodeWeight={min:undefined,max:undefined};this.m_edgeWeight={min:undefined,max:undefined};Object.keys(this.m_renderer.states.data).forEach(function(dataKey){var data=_this.m_renderer.states.data[dataKey];for(var i=0,n=data.nodes.length;i<n;++i){if(_this.containsNode(data.nodes[i])){if(_this.m_nodeWeight.min===undefined||_this.m_nodeWeight.min>data.nodes[i].weight)_this.m_nodeWeight.min=data.nodes[i].weight;if(_this.m_nodeWeight.max===undefined||_this.m_nodeWeight.max<data.nodes[i].weight)_this.m_nodeWeight.max=data.nodes[i].weight}}for(var i=0,n=data.edges.length;i<n;++i){if(_this.containsNode(data.edges[i].target)||_this.containsNode(data.edges[i].source)){if(_this.m_edgeWeight.min===undefined||_this.m_edgeWeight.min>data.edges[i].weight)_this.m_edgeWeight.min=data.edges[i].weight;if(_this.m_edgeWeight.max===undefined||_this.m_edgeWeight.max<data.edges[i].weight)_this.m_edgeWeight.max=data.edges[i].weight}}});if(this.m_nodeWeight.min===undefined)this.m_nodeWeight.min=0;if(this.m_nodeWeight.max===undefined)this.m_nodeWeight.max=0;if(this.m_edgeWeight.min===undefined)this.m_edgeWeight.min=0;if(this.m_edgeWeight.max===undefined)this.m_edgeWeight.max=0};EqualizerItem.prototype.addInterface=function(){var _this=this;this.m_hash=this.m_highlight.fromAngle.toString().replace(".","-")+"_"+this.m_highlight.toAngle.toString().replace(".","-")+"_"+this.m_highlight.radius.toString().replace(".","-");var nodeFilterSliderID="scivi_node_treshold_"+this.m_hash;var edgeFilterSliderID="scivi_edge_treshold_"+this.m_hash;this.m_div=$("<div>",{id:"scivi_equalizer_item_"+this.m_hash});this.m_div.html("<div><div align='center'><div style='background-color: "+SciViCGraph.color2string(this.m_highlight.color)+"; color: "+SciViCGraph.color2string(this.m_highlight.textColor)+"; border-radius: 10px; margin-bottom: 10px; display: inline-block; width: 90%;'><b>"+this.m_highlight.name+"</b></div><div class='scivi_remove' id='scivi_equalizer_remove_"+this.m_hash+"'>X</div></div>"+"<div id='"+nodeFilterSliderID+"'></div><div id='"+edgeFilterSliderID+"'></div>"+"<hr/><br/>");$("#scivi_equalizer").append(this.m_div);this.m_nodeFilterSlider=new SciViCGraph.FilterSlider("#"+nodeFilterSliderID,this.m_renderer.localizer["LOC_NODES"],this.m_nodeWeight.min,this.m_nodeWeight.max,this.m_nodeWeight.min,this.m_nodeWeight.max,this.m_renderer.maxNumberOfNodes*2,function(fromVal,toVal){_this.changeNodesTreshold(fromVal,toVal)});this.m_edgeFilterSlider=new SciViCGraph.FilterSlider("#"+edgeFilterSliderID,this.m_renderer.localizer["LOC_EDGES"],this.m_edgeWeight.min,this.m_edgeWeight.max,this.m_edgeWeight.min,this.m_edgeWeight.max,this.m_renderer.maxNumberOfEdges*2,function(fromVal,toVal){_this.changeEdgesTreshold(fromVal,toVal)});$("#scivi_equalizer_remove_"+this.m_hash).click(function(){_this.m_div.remove();_this.m_renderer.removeEqualizerItem(_this)});if($("#scivi_cgraph_tabs").length)$("#scivi_cgraph_tabs").tabs("option","active",3);$("#scivi_equalizer_item_"+this.m_hash)[0].scrollIntoView()};EqualizerItem.prototype.changeNodesTreshold=function(fromVal,toVal){this.m_nodeWeight.min=fromVal;this.m_nodeWeight.max=toVal;this.m_renderer.updateNodesVisibility()};EqualizerItem.prototype.changeEdgesTreshold=function(fromVal,toVal){this.m_edgeWeight.min=fromVal;this.m_edgeWeight.max=toVal;this.m_renderer.updateEdgesVisibility()};EqualizerItem.prototype.matches=function(segment){return this.m_highlight.matches(segment)};EqualizerItem.prototype.harakiri=function(){this.m_div.remove()};EqualizerItem.prototype.hidesNode=function(node){return this.containsNode(node)&&(node.weight<this.m_nodeWeight.min||node.weight>this.m_nodeWeight.max)};EqualizerItem.prototype.hidesEdge=function(edge){return(this.containsNode(edge.source)||this.containsNode(edge.target))&&(edge.weight<this.m_edgeWeight.min||edge.weight>this.m_edgeWeight.max)};EqualizerItem.prototype.dumpFilterCode=function(fc){fc.push({ringIndex:this.m_ringIndex,segmentHash:this.m_highlight.segmentHash,nodes:this.m_nodeWeight,edges:this.m_edgeWeight})};return EqualizerItem}();SciViCGraph.EqualizerItem=EqualizerItem})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var FilterSlider=function(){function FilterSlider(divID,label,minVal,maxVal,curFromVal,curToVal,numberOfTicks,cb){var _this=this;var fromFieldID=divID+"_from";var toFieldID=divID+"_to";var div=$(divID);var fromField=$("<input>").attr({type:"number",id:fromFieldID,min:minVal,max:maxVal,step:"any",value:curFromVal});var toField=$("<input>").attr({type:"number",id:toFieldID,min:minVal,max:maxVal,step:"any",value:curToVal});var sliderID=divID+"_slider";this.m_slider=$("<div>").css("margin","10px 10px 10px 5px");if(numberOfTicks<=0)numberOfTicks=1;var step=Math.abs(maxVal-minVal)/numberOfTicks;if(step===0)step=1;this.m_slider.slider({min:minVal,max:maxVal,range:true,values:[curFromVal,curToVal],step:step,slide:function(event,ui){if(ui.value===ui.values[0]){curFromVal=ui.values[0];fromField.val(curFromVal)}else{curToVal=ui.values[1];toField.val(curToVal)}cb(curFromVal,curToVal)}});fromField.change(function(){var fv=parseFloat(fromField.val());if(isNaN(fv)){fv=curFromVal;fromField.val(fv)}if(fv>curToVal){fv=curFromVal;fromField.val(fv)}curFromVal=fv;_this.m_slider.slider("values",0,curFromVal);cb(curFromVal,curToVal)});toField.change(function(){var tv=parseFloat(toField.val());if(isNaN(tv)){tv=curToVal;toField.val(tv)}if(curFromVal>tv){tv=curToVal;toField.val(tv)}curToVal=tv;_this.m_slider.slider("values",1,curToVal);cb(curFromVal,curToVal)});div.append(label+" ");div.append(fromField);div.append(" — ");div.append(toField);div.append(this.m_slider)}FilterSlider.prototype.setValues=function(v){this.m_slider.slider("values",0,v.min);this.m_slider.slider("values",1,v.max)};return FilterSlider}();SciViCGraph.FilterSlider=FilterSlider})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var FiltersManager=function(){function FiltersManager(m_renderer,m_filters){this.m_renderer=m_renderer;this.m_filters=m_filters;this.m_nodeWeight={min:undefined,max:undefined};this.m_edgeWeight={min:undefined,max:undefined};this.m_equalizer=[];this.m_edgeFilterSlider=null;this.m_nodeFilterSlider=null;this.m_maxNumberOfNodes=0;this.m_maxNumberOfEdges=0}Object.defineProperty(FiltersManager.prototype,"nodeWeight",{get:function(){return this.m_nodeWeight},enumerable:true,configurable:true});Object.defineProperty(FiltersManager.prototype,"edgeWeight",{get:function(){return this.m_edgeWeight},enumerable:true,configurable:true});Object.defineProperty(FiltersManager.prototype,"maxNumberOfNodes",{get:function(){return this.m_maxNumberOfNodes},enumerable:true,configurable:true});Object.defineProperty(FiltersManager.prototype,"maxNumberOfEdges",{get:function(){return this.m_maxNumberOfEdges},enumerable:true,configurable:true});Object.defineProperty(FiltersManager.prototype,"equalizer",{get:function(){return this.m_equalizer},enumerable:true,configurable:true});FiltersManager.prototype.calcWeights=function(){var _this=this;this.m_nodeWeight={min:undefined,max:undefined};this.m_edgeWeight={min:undefined,max:undefined};this.m_maxNumberOfNodes=0;this.m_maxNumberOfEdges=0;Object.keys(this.m_renderer.states.data).forEach(function(dataKey){var data=_this.m_renderer.states.data[dataKey];var nc=data.nodes.length;var ec=data.edges.length;var angleStep=2*Math.PI/nc;if(nc>_this.m_maxNumberOfNodes)_this.m_maxNumberOfNodes=nc;if(ec>_this.m_maxNumberOfEdges)_this.m_maxNumberOfEdges=ec;for(var i=0;i<nc;++i){if(_this.m_nodeWeight.min===undefined||_this.m_nodeWeight.min>data.nodes[i].weight)_this.m_nodeWeight.min=data.nodes[i].weight;if(_this.m_nodeWeight.max===undefined||_this.m_nodeWeight.max<data.nodes[i].weight)_this.m_nodeWeight.max=data.nodes[i].weight;data.nodes[i].rotation=i*angleStep}for(var i=0;i<ec;++i){if(_this.m_edgeWeight.min===undefined||_this.m_edgeWeight.min>data.edges[i].weight)_this.m_edgeWeight.min=data.edges[i].weight;if(_this.m_edgeWeight.max===undefined||_this.m_edgeWeight.max<data.edges[i].weight)_this.m_edgeWeight.max=data.edges[i].weight}});if(this.m_nodeWeight.min===undefined)this.m_nodeWeight.min=0;if(this.m_nodeWeight.max===undefined)this.m_nodeWeight.max=0;if(this.m_edgeWeight.min===undefined)this.m_edgeWeight.min=0;if(this.m_edgeWeight.max===undefined)this.m_edgeWeight.max=0};FiltersManager.prototype.initFilters=function(){var _this=this;if(!this.m_filters)return;this.m_equalizer=[];this.m_filters.innerHTML="<div style='margin: 5px 0px 5px 0px;'>"+this.m_renderer.localizer["LOC_FILTER_SET"]+"<div class='scivi_dropdown'><input type='text' id='scivi_filter_set_name' disabled/><select id='scivi_filter_sets'></select></div>"+"<div class='scivi_button' id='scivi_add_filter_set'>"+this.m_renderer.localizer["LOC_ADD_FILTER_SET"]+"</div>"+"<div class='scivi_button' id='scivi_rem_filter_set'>"+this.m_renderer.localizer["LOC_REM_FILTER_SET"]+"</div>"+"<div class='scivi_button' id='scivi_save_filter_set'>"+this.m_renderer.localizer["LOC_SAVE_FILTER_SET"]+"</div>"+"</div><hr/><br/>"+"<div id='scivi_node_treshold'></div><div id='scivi_edge_treshold'></div><hr/><br/>"+"<div id='scivi_equalizer'></div>";this.m_nodeFilterSlider=new SciViCGraph.FilterSlider("#scivi_node_treshold",this.m_renderer.localizer["LOC_NODETHRESHOLD"],this.m_nodeWeight.min,this.m_nodeWeight.max,this.m_nodeWeight.min,this.m_nodeWeight.max,this.m_maxNumberOfNodes*2,function(fromVal,toVal){_this.changeNodeTreshold(fromVal,toVal)});this.m_edgeFilterSlider=new SciViCGraph.FilterSlider("#scivi_edge_treshold",this.m_renderer.localizer["LOC_EDGETHRESHOLD"],this.m_edgeWeight.min,this.m_edgeWeight.max,this.m_edgeWeight.min,this.m_edgeWeight.max,this.m_maxNumberOfEdges*2,function(fromVal,toVal){_this.changeEdgeTreshold(fromVal,toVal)});$("#scivi_add_filter_set").click(function(){var fs=$("#scivi_filter_sets");var i=fs.children("option").length;var k="Filter set "+(i+1);var fj=JSON.parse(JSON.stringify(_this.dumpFilterSet()));var fk="scivi_filter_set_"+i;var fn=$("#scivi_filter_set_name");fs.append($("<option>",{value:i,text:k,id:fk}));fs.val(i);fn.val(k);$("#"+fk).data("fcode",fj);fn.prop("disabled",false);fn.select()});$("#scivi_rem_filter_set").click(function(){var fi=$("#scivi_filter_set_"+$("#scivi_filter_sets").val());var fn=$("#scivi_filter_set_name");if(fi.length>0){fi.remove();fi=$("#scivi_filter_set_"+$("#scivi_filter_sets").val());if(fi.length>0){fn.val(fi.text());fn.prop("disabled",false)}else{fn.val("");fn.prop("disabled",true)}}});$("#scivi_save_filter_set").click(function(){_this.saveFilterSet()});$("#scivi_filter_sets").change(function(){var fi=$("#scivi_filter_set_"+$("#scivi_filter_sets").val());var fn=$("#scivi_filter_set_name");fn.val(fi.text());fn.prop("disabled",false);_this.applyFilterSet(JSON.parse(JSON.stringify(fi.data("fcode"))))});var filterSetName=$("#scivi_filter_set_name");filterSetName.change(function(){var fi=$("#scivi_filter_set_"+$("#scivi_filter_sets").val());if(fi.length>0)fi.text($("#scivi_filter_set_name").val());else $("#scivi_filter_set_name").val("")});filterSetName.keypress(function(e){if(e.which==13)filterSetName.blur()})};FiltersManager.prototype.changeEdgeTreshold=function(fromVal,toVal){this.m_edgeWeight.min=fromVal;this.m_edgeWeight.max=toVal;this.m_renderer.updateEdgesVisibility()};FiltersManager.prototype.changeNodeTreshold=function(fromVal,toVal){this.m_nodeWeight.min=fromVal;this.m_nodeWeight.max=toVal;this.m_renderer.updateNodesVisibility()};FiltersManager.prototype.validateCurrentFilterSet=function(){this.enableFilterSetName(this.currentFilterSetValid())};FiltersManager.prototype.enableFilterSetName=function(enabled){var fn=$("#scivi_filter_set_name");if(enabled){fn.prop("disabled",false)}else{var n=$("#scivi_filter_sets").children("option").length;$("#scivi_filter_sets").val(-1);if(n==0)fn.val("");else fn.val(this.m_renderer.localizer["LOC_FILTER_SET_AVAILABLE"]+n);fn.prop("disabled",true)}};FiltersManager.prototype.currentFilterSetValid=function(){var fi=$("#scivi_filter_set_"+$("#scivi_filter_sets").val());if(fi.length>0){var fj=fi.data("fcode");if(fj.main.nodes.min!==this.m_nodeWeight.min||fj.main.nodes.max!==this.m_nodeWeight.max||fj.main.edges.min!==this.m_edgeWeight.min||fj.main.edges.max!==this.m_edgeWeight.max)return false;for(var i=0,n=this.m_renderer.scaleLevels.length;i<n;++i){if(this.m_renderer.scaleLevels[i].id!==fj.scaleLevelsOrder[i])return false}if(this.m_equalizer.length!==fj.equalizer.length)return false;for(var i=0,n=this.m_equalizer.length;i<n;++i){if(!this.m_equalizer[i].matchesRanges(fj.equalizer[i].nodes,fj.equalizer[i].edges))return false}return true}return false};FiltersManager.prototype.dumpFilterSet=function(){var scaleLevelsOrder=[];this.m_renderer.scaleLevels.forEach(function(sl){scaleLevelsOrder.push(sl.id)});var equalizer=[];this.m_equalizer.forEach(function(eq){eq.dumpFilterCode(equalizer)});return{name:null,main:{nodes:this.m_nodeWeight,edges:this.m_edgeWeight},scaleLevelsOrder:scaleLevelsOrder,equalizer:equalizer}};FiltersManager.prototype.applyFilterSet=function(fj){var _this=this;this.m_nodeWeight=fj.main.nodes;this.m_edgeWeight=fj.main.edges;this.m_nodeFilterSlider.setValues(this.m_nodeWeight);this.m_edgeFilterSlider.setValues(this.m_edgeWeight);this.m_renderer.reorderScaleLevels(fj.scaleLevelsOrder);this.m_equalizer.forEach(function(eq){eq.harakiri()});this.m_equalizer=[];fj.equalizer.forEach(function(eq){var ei=new SciViCGraph.EqualizerItem(_this.m_renderer,_this.m_renderer.ringScales[eq.ringIndex].segmentByHash(eq.segmentHash),eq.ringIndex);ei.setWeights(eq.nodes,eq.edges);_this.m_equalizer.push(ei)});this.m_renderer.updateNodesVisibility()};FiltersManager.prototype.saveFilterSet=function(){var f=[];$("#scivi_filter_sets").children().each(function(i,el){var fi=$(el);var fj=fi.data("fcode");fj.name=fi.text();f.push(fj)});if(f.length>0)this.m_renderer.downloadFile("filterSet.json",JSON.stringify(f))};FiltersManager.prototype.loadFilterSet=function(filterSet){var fs=$("#scivi_filter_sets");fs.empty();filterSet.forEach(function(fj,i){var fk="scivi_filter_set_"+i;fs.append($("<option>",{value:i,text:fj.name,id:fk}));$("#"+fk).data("fcode",fj)});this.enableFilterSetName(false)};return FiltersManager}();SciViCGraph.FiltersManager=FiltersManager})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var Geometry=function(){function Geometry(){}Geometry.solveCubicEq=function(a,b,c,d){if(Math.abs(a)>Geometry.EPSILON){var z=a;a=b/z;b=c/z;c=d/z;var p=b-a*a/3;var q=a*(2*a*a-9*b)/27+c;var p3=p*p*p;var D=q*q+4*p3/27;var offset=-a/3;if(D>Geometry.EPSILON){z=Math.sqrt(D);var u=(-q+z)/2;var v=(-q-z)/2;u=u>=0?Math.pow(u,1/3):-Math.pow(-u,1/3);v=v>=0?Math.pow(v,1/3):-Math.pow(-v,1/3);return[u+v+offset]}else if(D<-Geometry.EPSILON){var u=2*Math.sqrt(-p/3);var v=Math.acos(-Math.sqrt(-27/p3)*q/2)/3;return[u*Math.cos(v)+offset,u*Math.cos(v+2*Math.PI/3)+offset,u*Math.cos(v+4*Math.PI/3)+offset]}else{var u=0;if(q<0)u=Math.pow(-q/2,1/3);else u=-Math.pow(q/2,1/3);return[2*u+offset,-u+offset]}}else{a=b;b=c;c=d;if(Math.abs(a)<=Geometry.EPSILON){if(Math.abs(b)<=Geometry.EPSILON)return[];else return[-c/b]}var D=b*b-4*a*c;if(D<=-Geometry.EPSILON)return[];if(D>Geometry.EPSILON){D=Math.sqrt(D);return[(-b-D)/(2*a),(-b+D)/(2*a)]}else if(D<-Geometry.EPSILON){return[]}else{return[-b/(2*a)]}}};Geometry.distance=function(p1,p2){var pp={x:p1.x-p2.x,y:p1.y-p2.y};return Math.sqrt(pp.x*pp.x+pp.y*pp.y)};Geometry.quadCurve=function(t,c1,c2,c3){var nt=1-t;var a=nt*nt;var b=2*t*nt;var c=t*t;return{x:a*c1.x+b*c2.x+c*c3.x,y:a*c1.y+b*c2.y+c*c3.y}};Geometry.distanceToQuadCurve=function(p,c1,c2,c3){var _this=this;var pos={x:c1.x-p.x,y:c1.y-p.y};var tA={x:c2.x-c1.x,y:c2.y-c1.y};var tB={x:c1.x-2*c2.x+c3.x,y:c1.y-2*c2.y+c3.y};var a=tB.x*tB.x+tB.y*tB.y;var b=3*(tA.x*tB.x+tA.y*tB.y);var c=2*(tA.x*tA.x+tA.y*tA.y)+pos.x*tB.x+pos.y*tB.y;var d=pos.x*tA.x+pos.y*tA.y;var sol=this.solveCubicEq(a,b,c,d);var dist=0;var result=Number.MAX_VALUE;var d1=this.distance(p,c1);var d2=this.distance(p,c3);sol.forEach(function(t){if(t>=0&&t<=1){dist=_this.distance(p,_this.quadCurve(t,c1,c2,c3));if(dist<result)result=dist}});if(d1<result)result=d1;if(d2<result)result=d2;return result};Geometry.distanceToLineSegment=function(p,c1,c2){var a=p.x-c1.x;var b=p.y-c1.y;var c=c2.x-c1.x;var d=c2.y-c1.y;var dot=a*c+b*d;var lenSq=c*c+d*d;var param=-1;var xx=0;var yy=0;if(lenSq!==0)param=dot/lenSq;if(param<0){xx=c1.x;yy=c1.y}else if(param>1){xx=c2.x;yy=c2.y}else{xx=c1.x+param*c;yy=c1.y+param*d}var dx=p.x-xx;var dy=p.y-yy;return Math.sqrt(dx*dx+dy*dy)};Geometry.distanceToBezierCurve=function(p,c1,c2,c3,c4){var n=10;var result=this.distance(p,c1);var t=0;var t2=0;var t3=0;var nt=0;var nt2=0;var nt3=0;var x=0;var y=0;var dx=0;var dy=0;var prevX=c1.x;var prevY=c1.y;var dist=0;for(var i=1;i<=n;++i){t=i/n;t2=t*t;t3=t2*t;nt=1-t;nt2=nt*nt;nt3=nt2*nt;x=nt3*c1.x+3*nt2*t*c2.x+3*nt*t2*c3.x+t3*c4.x;y=nt3*c1.y+3*nt2*t*c2.y+3*nt*t2*c3.y+t3*c4.y;dist=this.distanceToLineSegment(p,{x:prevX,y:prevY},{x:x,y:y});prevX=x;prevY=y;if(dist<result)result=dist}return result};Geometry.sortedArrayIncludesValue=function(arr,val){var s=0;var e=arr.length-1;while(true){var c=Math.floor((s+e)/2);if(c===s)return val===arr[s]||val===arr[e];else if(val<arr[c])e=c;else if(val>arr[c])s=c;else return true}};Geometry.EPSILON=1e-6;return Geometry}();SciViCGraph.Geometry=Geometry})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var Node=function(_super){__extends(Node,_super);function Node(m_dict){var _this=_super.call(this)||this;_this.m_dict=m_dict;var histColor=_this.m_dict["histColor"]===undefined?16763701:SciViCGraph.string2color(_this.m_dict["histColor"]);_this.m_column=new PIXI.Graphics;_this.m_column.beginFill(histColor,1);_this.addChild(_this.m_column);_this.m_text=new PIXI.Text(_this.label);_this.m_text.style=new PIXI.TextStyle({fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif",fontSize:"24px",wordWrapWidth:200});_this.addChild(_this.m_text);_this.m_marker=new PIXI.Graphics;_this.m_marker.visible=false;_this.addChild(_this.m_marker);_this.m_markerRect={x:0,y:0,w:0,h:0};_this.m_highlight=undefined;_this.m_needsUpdate=false;_this.m_highlightSet=false;_this.m_isShown=true;_this.m_listLabel=null;_this.m_cbInput=null;_this.m_selInput=null;_this.m_hoveredEdge=null;_this.m_selectedEdge=null;_this.m_multiselected=false;_this.m_customColor=null;return _this}Object.defineProperty(Node.prototype,"id",{get:function(){return this.m_dict["id"]},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"label",{get:function(){return this.m_dict["label"]},set:function(lbl){this.m_dict["label"]=lbl},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"groupID",{get:function(){return this.m_dict["group"]!==undefined?this.m_dict["group"]:0},set:function(gID){this.m_dict["group"]=gID},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"weight",{get:function(){return this.m_dict["weight"]!==undefined?this.m_dict["weight"]:0},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"date",{get:function(){if(this.m_dict["date"]===undefined)return null;else if(typeof this.m_dict["date"].getMonth!=="function")this.m_dict["date"]=new Date(this.m_dict["date"]);return this.m_dict["date"]},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"custom",{get:function(){return this.m_dict},enumerable:true,configurable:true});Node.prototype.clone=function(newID){var dict=JSON.parse(JSON.stringify(this.m_dict));if(newID!==undefined)dict["id"]=newID;return new Node(dict)};Node.prototype.postInfo=function(){var _this=this;if(!this.m_info)return;var header=document.createElement("div");var name=document.createElement("input");name.type="text";name.value=this.label;name.style.fontWeight="bold";name.style.width="300px";name.style.marginRight="5px";var changeName=document.createElement("div");changeName.className="scivi_button";changeName.innerHTML=this.m_svRenderer.localizer["LOC_CHANGE"];changeName.onclick=function(){_this.label=name.value;_this.m_svRenderer.updateNodeNames()};header.appendChild(name);header.appendChild(changeName);var customPropList="";for(var prop in this.m_dict){if(prop!=="id"&&prop!=="label"&&prop!=="group"&&prop!=="date"&&prop!=="metadata")customPropList+="<li>"+prop+": "+this.m_dict[prop]+"</li>";else if(prop==="date")customPropList+="<li>"+prop+": "+this.date.toLocaleDateString()+"</li>"}if(customPropList.length>0){var customProps=document.createElement("div");customProps.innerHTML=this.m_svRenderer.localizer["LOC_NODE_DATA"]+":<ul>"+customPropList+"</ul>";header.appendChild(customProps)}var colorLabel=document.createElement("span");colorLabel.innerHTML=this.m_svRenderer.localizer["LOC_GROUP"]+": "+(this.groupID+1)+". "+this.m_svRenderer.localizer["LOC_COLOR"]+":&nbsp;";var cl=SciViCGraph.color2string(this.groupColor);var colorWrapper=document.createElement("div");colorWrapper.innerHTML="&nbsp;";colorWrapper.className="scivi_color_wrapper";colorWrapper.style.backgroundColor=cl;var colorInput=this.m_svRenderer.createColorPicker({parent:colorWrapper,color:cl,alpha:false,onDone:function(color){var c=color.hex.substring(0,7);colorWrapper.style.backgroundColor=c;_this.m_svRenderer.changeActiveGroupColor(c)}});var qZoomIn=null;if(this.m_svRenderer.canQuasiZoomIn()){qZoomIn=document.createElement("div");qZoomIn.className="scivi_button";qZoomIn.innerHTML=this.m_svRenderer.localizer["LOC_ENTERGROUP"];qZoomIn.onclick=function(){_this.m_svRenderer.quasiZoomIn(_this.groupID);_this.m_svRenderer.clearChartSelection()}}var qZoomOut=null;if(this.m_svRenderer.canQuasiZoomOut()){qZoomOut=document.createElement("div");qZoomOut.className="scivi_button";qZoomOut.innerHTML=this.m_svRenderer.localizer["LOC_LEAVEGROUP"];qZoomOut.onclick=function(){_this.m_svRenderer.quasiZoomOut();_this.m_svRenderer.clearChartSelection()}}var nodesList=null;if(this.m_edges.length>0){nodesList=document.createElement("div");var connList_1="<div>"+this.m_svRenderer.localizer["LOC_LINKEDNODES"]+"</div><ul>";this.m_edges.forEach(function(edge){if(edge.visible){if(edge.target!==_this)connList_1+="<li>"+edge.target.label+"</li>";else connList_1+="<li>"+edge.source.label+"</li>"}});connList_1+="</ul>";nodesList.innerHTML=connList_1}var md=null;if(this.m_dict["metadata"]!==undefined){md=document.createElement("div");md.innerHTML=this.m_dict["metadata"]}while(this.m_info.firstChild)this.m_info.removeChild(this.m_info.firstChild);this.m_info.appendChild(header);this.m_info.appendChild(colorLabel);this.m_info.appendChild(colorWrapper);if(qZoomIn)this.m_info.appendChild(qZoomIn);if(qZoomOut)this.m_info.appendChild(qZoomOut);if(md){var dvd1=document.createElement("div");dvd1.innerHTML="<hr/>";var dvd2=document.createElement("div");dvd2.innerHTML="<hr/>";this.m_info.appendChild(dvd1);this.m_info.appendChild(md);this.m_info.appendChild(dvd2)}if(nodesList)this.m_info.appendChild(nodesList)};Node.prototype.postListItem=function(list){var _this=this;this.m_cbInput=document.createElement("input");this.m_cbInput.type="checkbox";this.m_cbInput.checked=this.m_isShown;this.m_cbInput.style.marginLeft="18px";this.m_cbInput.onchange=function(){_this.isShown=_this.m_cbInput.checked;_this.m_svRenderer.updateNodesVisibility()};this.m_selInput=document.createElement("input");this.m_selInput.type="checkbox";this.m_selInput.checked=this.m_multiselected;this.m_selInput.style.marginLeft="55px";this.m_selInput.style.marginRight="18px";this.m_selInput.onchange=function(){_this.m_svRenderer.multiselectNode(_this)};this.m_listLabel=document.createElement("span");this.m_listLabel.innerHTML=this.label;this.m_listLabel.onmouseover=function(){if(_this.m_isShown)_this.m_svRenderer.hoverNode(_this)};this.m_listLabel.onmouseout=function(){if(_this.m_isShown)_this.m_svRenderer.hoverNode(null)};this.m_listLabel.onclick=function(){if(_this.m_isShown)_this.m_svRenderer.selectNode(_this)};var itm=document.createElement("div");itm.appendChild(this.m_cbInput);itm.appendChild(this.m_selInput);itm.appendChild(this.m_listLabel);list.appendChild(itm)};Object.defineProperty(Node.prototype,"highlight",{get:function(){return this.m_highlight},set:function(hl){if(hl!==this.m_highlight){this.m_highlight=hl;this.color=this.groupColor;switch(this.m_highlight){case SciViCGraph.HighlightType.None:{this.m_text.style.fontWeight="normal";this.m_text.text=this.label;if(this.m_listLabel){this.m_listLabel.style.fontWeight="normal";this.m_listLabel.innerHTML=this.label}this.alpha=Node.passiveTextAlpha;this.m_marker.visible=false;break}case SciViCGraph.HighlightType.Hover:{this.m_text.style.fontWeight="normal";this.m_text.text=this.label;if(this.m_listLabel){this.m_listLabel.style.fontWeight="normal";this.m_listLabel.innerHTML=this.label}this.alpha=Node.m_hoveredTextAlpha;this.m_marker.visible=false;break}case SciViCGraph.HighlightType.Selection:{this.m_text.style.fontWeight="bold";this.m_text.text="[-"+this.label+"-]";if(this.m_listLabel){this.m_listLabel.style.fontWeight="bold";this.m_listLabel.innerHTML="[-"+this.label+"-]"}this.alpha=Node.m_selectedTextAlpha;this.m_marker.visible=false;break}case SciViCGraph.HighlightType.Multiselect:{this.m_text.style.fontWeight="normal";this.m_text.text=this.label;if(this.m_listLabel){this.m_listLabel.style.fontWeight="normal";this.m_listLabel.innerHTML=this.label}this.alpha=Node.m_hoveredTextAlpha;this.m_marker.visible=true;break}}this.m_needsUpdate=true}this.m_highlightSet=true},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"highlightSet",{get:function(){return this.m_highlightSet},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"groupColor",{get:function(){return this.m_customColor===null?this.parent.colors[this.groupID]:this.m_customColor},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"isShown",{get:function(){return this.m_isShown},set:function(shown){this.m_isShown=shown;if(this.m_cbInput)this.m_cbInput.checked=shown;if(!this.m_isShown){this.m_listLabel.style.fontWeight="normal";this.m_listLabel.innerHTML=this.label}},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"color",{set:function(newColor){this.m_text.style.fill=SciViCGraph.color2string(newColor);this.m_marker.beginFill(newColor,1);this.m_marker.clear();this.m_marker.drawRect(this.m_markerRect.x,this.m_markerRect.y,this.m_markerRect.w,this.m_markerRect.h)},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"info",{set:function(newInfo){this.m_info=newInfo},enumerable:true,configurable:true});Node.prototype.addEdge=function(edge){this.m_edges.push(edge);var batch=null;if(this.m_edgeBatches.length===0||this.m_edgeBatches[this.m_edgeBatches.length-1].isFull){batch=new SciViCGraph.EdgeBatch;this.m_edgeBatches.push(batch)}else{batch=this.m_edgeBatches[this.m_edgeBatches.length-1]}batch.addEdge(edge)};Node.prototype.clearEdges=function(){this.m_edges=[];this.m_edgeBatches=[]};Object.defineProperty(Node.prototype,"edges",{get:function(){return this.m_edges},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"edgeBatches",{get:function(){return this.m_edgeBatches},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"svRenderer",{set:function(newSVRenderer){this.m_svRenderer=newSVRenderer},enumerable:true,configurable:true});Node.prototype.prepare=function(){if(!this.m_highlightSet)this.highlight=SciViCGraph.HighlightType.None;var result=this.m_needsUpdate;this.m_highlightSet=false;this.m_needsUpdate=false;return result};Node.prototype.invalidate=function(wipeInternals){this.m_highlight=undefined;this.m_highlightSet=false;this.m_edges.forEach(function(edge){if(edge.visible)edge.invalidate(wipeInternals)})};Node.prototype.setAnchor=function(x,y,maxHeight){var p=this.parent;var w=Node.m_columnMinHeight+(maxHeight-Node.m_columnMinHeight)/(p.nodeWeight.max-p.nodeWeight.min)*(this.weight-p.nodeWeight.min);var s=this.scale.x>0?1:-1;this.m_column.clear();this.m_column.drawRect(-w*x,-this.m_text.height*y,w,this.m_text.height);this.m_text.anchor.set(x,y);this.m_markerRect.w=Node.m_textPadding*.8;this.m_markerRect.h=this.m_text.height*.5;this.m_markerRect.x=-Node.m_textPadding*x+(Node.m_textPadding-this.m_markerRect.w)*(1-x);this.m_markerRect.y=-this.m_markerRect.h*y;this.m_text.position.set(Node.m_textPadding*s,0)};Node.prototype.setHighlightForEdgesAndTargetNodes=function(hl){this.m_edges.forEach(function(edge){if(edge.visible){edge.highlight=hl;if(!edge.target.highlightSet)edge.target.highlight=hl}})};Node.prototype.setHighlightForEdges=function(hl){if(hl===SciViCGraph.HighlightType.None){if(this.m_selectedEdge){this.m_selectedEdge.isGlowing=false;this.m_selectedEdge=null}}this.m_edges.forEach(function(edge){if(edge.visible)edge.highlight=hl})};Node.prototype.labelSize=function(normalize){var w=0;var h=0;if(this.m_text.style.fontWeight==="normal"||!normalize){w=this.m_text.width;h=this.m_text.height}else{this.m_text.style.fontWeight="normal";this.m_text.text=this.label;w=this.m_text.width;h=this.m_text.height;this.m_text.style.fontWeight="bold";this.m_text.text="[-"+this.label+"-]"}return{width:w/2+Node.m_textPadding,height:h/2-5}};Object.defineProperty(Node.prototype,"wordWrap",{set:function(ww){this.m_text.style.wordWrap=this.m_text.text.indexOf(" ")!==-1&&ww},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"fontSize",{get:function(){return parseInt(this.m_text.style.fontSize)},set:function(fs){this.m_text.style.fontSize=fs+"px"},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"align",{set:function(a){this.m_text.style.align=a},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"multiselected",{get:function(){return this.m_multiselected},set:function(ms){this.m_multiselected=ms;if(this.m_selInput)this.m_selInput.checked=ms},enumerable:true,configurable:true});Object.defineProperty(Node.prototype,"customColor",{get:function(){return this.m_customColor},set:function(c){this.m_customColor=c},enumerable:true,configurable:true});Node.prototype.getEdgeByPosition=function(x,y,s){if(isNaN(x)||isNaN(y))return null;var d=x*x+y*y;var r=this.m_svRenderer.radius;var inRing=r*r*s*s;if(d<inRing){for(var i=this.m_edges.length-1;i>=0;--i){if(this.m_edges[i].visible&&this.m_edges[i].hitTest(x/s,y/s))return this.m_edges[i]}}return null};Node.prototype.handleCursorMove=function(x,y,s,gx,gy){var hoveredEdge=this.getEdgeByPosition(x,y,s);var offset=20;if(hoveredEdge){if(this.m_hoveredEdge!==hoveredEdge){if(this.m_hoveredEdge&&this.m_hoveredEdge!==this.m_selectedEdge)this.m_hoveredEdge.isGlowing=false;this.m_hoveredEdge=hoveredEdge;this.m_hoveredEdge.isGlowing=true;if(this.m_hoveredEdge.tooltip)$(".scivi_graph_tooltip").html(this.m_hoveredEdge.tooltip);else $(".scivi_graph_tooltip").html(this.m_hoveredEdge.weight.toString());$(".scivi_graph_tooltip").css({top:gy,left:gx+offset});$(".scivi_graph_tooltip").stop(true);$(".scivi_graph_tooltip").fadeIn(100);$(".scivi_graph_tooltip")[0]["host"]=this;return true}$(".scivi_graph_tooltip").css({top:gy,left:gx+offset,position:"absolute"});return false}else{if(this.m_hoveredEdge){if(this.m_hoveredEdge!==this.m_selectedEdge)this.m_hoveredEdge.isGlowing=false;this.m_hoveredEdge=null;if($(".scivi_graph_tooltip")[0]["host"]===this){$(".scivi_graph_tooltip").stop(true);$(".scivi_graph_tooltip").fadeOut(100)}return true}}return false};Node.prototype.handleClick=function(){var result=false;if(this.m_hoveredEdge){if(this.m_selectedEdge===this.m_hoveredEdge)this.m_selectedEdge=null;else{if(this.m_selectedEdge){this.m_selectedEdge.isGlowing=false;result=true}this.m_selectedEdge=this.m_hoveredEdge}}else{if(this.m_selectedEdge){this.m_selectedEdge.isGlowing=false;this.m_selectedEdge=null;result=true}}return result};Object.defineProperty(Node.prototype,"selectedEdge",{get:function(){return this.m_selectedEdge},enumerable:true,configurable:true});Node.prototype.deleteSelectedEdge=function(){this.m_selectedEdge=null;this.m_hoveredEdge=null;if($(".scivi_graph_tooltip")[0]["host"]===this){$(".scivi_graph_tooltip").stop(true);$(".scivi_graph_tooltip").fadeOut(100)}};Node.prototype.positionHash=function(){return this.x+":"+this.y};Node.passiveTextAlpha=1;Node.m_hoveredTextAlpha=1;Node.m_selectedTextAlpha=1;Node.m_columnMinHeight=2;Node.m_textPadding=15;return Node}(PIXI.Sprite);SciViCGraph.Node=Node})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var NodeBorder=function(_super){__extends(NodeBorder,_super);function NodeBorder(){var _this=_super.call(this)||this;_this.addColor({from:16595968,to:16595968,alpha:1});return _this}NodeBorder.prototype.showForNode=function(node){if(node===null)this.visible=false;else{this.position=node.position;this.rotation=node.rotation;var size=node.labelSize(false);size.width+=NodeBorder.m_thickness;size.height+=NodeBorder.m_thickness;var x=0;var y=-size.height/2;this.visible=true;this.clear();this.lineStyle(3,0,1);this.moveTo(x,y);this.lineTo(x+size.width,y);this.lineTo(x+size.width,y+size.height);this.lineTo(x+NodeBorder.m_thickness/2,y+size.height);this.lineTo(x+NodeBorder.m_thickness/2,y)}};NodeBorder.m_thickness=3;return NodeBorder}(SciViCGraph.Curve);SciViCGraph.NodeBorder=NodeBorder})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var NodePlaceHolder=function(_super){__extends(NodePlaceHolder,_super);function NodePlaceHolder(inRaduis,outRadius){var _this=_super.call(this)||this;_this.lineStyle(3,0,1);_this.addColor({from:16595968,to:16595968,alpha:1});_this.moveTo(inRaduis,0);_this.lineTo(outRadius,0);return _this}return NodePlaceHolder}(SciViCGraph.Curve);SciViCGraph.NodePlaceHolder=NodePlaceHolder})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var ListFilterType;(function(ListFilterType){ListFilterType[ListFilterType["NoFilter"]=0]="NoFilter";ListFilterType[ListFilterType["SubstringFilter"]=1]="SubstringFilter";ListFilterType[ListFilterType["StringFilter"]=2]="StringFilter";ListFilterType[ListFilterType["RegExpFilter"]=3]="RegExpFilter"})(ListFilterType||(ListFilterType={}));var NodesList=function(){function NodesList(m_list){this.m_list=m_list;this.m_listDiv=null;this.m_nodes=null;this.m_listedNodes=null;this.m_not=false}NodesList.prototype.matchStr=function(str,pattern,type){if(pattern===null||pattern.length===0)return true;else{switch(type){case ListFilterType.NoFilter:return true;case ListFilterType.SubstringFilter:if(this.m_not)return str.indexOf(pattern)===-1;else return str.indexOf(pattern)!==-1;case ListFilterType.StringFilter:if(this.m_not)return str!==pattern;else return str===pattern;case ListFilterType.RegExpFilter:if(this.m_not)return str.match(pattern)===null;else return str.match(pattern)!==null}}return false};NodesList.prototype.populate=function(pattern,type){var _this=this;this.m_listDiv.empty();this.m_listedNodes=[];this.m_nodes.forEach(function(node){if(_this.matchStr(node.label,pattern,type)){node.postListItem(_this.m_listDiv.get(0));_this.m_listedNodes.push(node)}})};NodesList.prototype.buildList=function(nodes,renderer){var _this=this;this.m_nodes=nodes;while(this.m_list.firstChild)this.m_list.removeChild(this.m_list.firstChild);var div1=$("<div>");var notBtn=$("<div>").attr({class:"scivi_button"});notBtn.html(renderer.localizer["LOC_NOT"]);notBtn.click(function(){notBtn.toggleClass("pushed");_this.m_not=!_this.m_not;_this.populate(filter.val(),ListFilterType.SubstringFilter)});div1.append(notBtn);var filter=$("<input/>").attr({type:"text"}).css("margin-right","5px");filter.width("200px");filter.on("input",function(){_this.populate(filter.val(),ListFilterType.SubstringFilter)});div1.append(filter);var str=$("<div>").attr({class:"scivi_button"});str.html(renderer.localizer["LOC_FINDSTRING"]);str.click(function(){_this.populate(filter.val(),ListFilterType.StringFilter)});div1.append(str);var regexp=$("<div>").attr({class:"scivi_button"});regexp.html(renderer.localizer["LOC_FINDREGEXP"]);regexp.click(function(){_this.populate(filter.val(),ListFilterType.RegExpFilter)});div1.append(regexp);var div2=$("<div>").css("margin-top","5px");var cap=$("<div>");var vis=$("<div>").css("text-align","center").css("width","50px").css("display","inline-block").html(renderer.localizer["LOC_VISIBLE"]);var sel=$("<div>").css("text-align","center").css("width","70px").css("margin-left","10px").css("display","inline-block").html(renderer.localizer["LOC_SELECTED"]);cap.append(vis);cap.append(sel);div2.append(cap);var showAll=$("<div>").css("width","10px").css("text-align","center").attr({class:"scivi_button"});showAll.html(renderer.localizer["LOC_ALL"]);showAll.click(function(){_this.m_listedNodes.forEach(function(node){node.isShown=true});renderer.updateNodesVisibility()});div2.append(showAll);var hideAll=$("<div>").css("width","10px").css("text-align","center").attr({class:"scivi_button"});hideAll.html(renderer.localizer["LOC_NONE"]);hideAll.click(function(){_this.m_listedNodes.forEach(function(node){node.isShown=false});renderer.updateNodesVisibility()});div2.append(hideAll);var selAll=$("<div>").css("width","10px").css("margin-left","17px").css("text-align","center").attr({class:"scivi_button"});selAll.html(renderer.localizer["LOC_ALL"]);selAll.click(function(){_this.m_listedNodes.forEach(function(node){renderer.addToMultiselection(node)});renderer.render(false,true)});div2.append(selAll);var deselAll=$("<div>").css("width","10px").css("text-align","center").attr({class:"scivi_button"});deselAll.html(renderer.localizer["LOC_NONE"]);deselAll.click(function(){_this.m_listedNodes.forEach(function(node){renderer.removeFromMultiselection(node)});renderer.render(false,true)});div2.append(deselAll);this.m_listDiv=$("<div>");this.m_list.appendChild(div1.get(0));this.m_list.appendChild(div2.get(0));this.m_list.appendChild(this.m_listDiv.get(0));this.populate(null,ListFilterType.NoFilter)};return NodesList}();SciViCGraph.NodesList=NodesList})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var GraphStates=function(){function GraphStates(){this.stateLines=[];this.data={};this.dynamicSource=undefined}Object.defineProperty(GraphStates.prototype,"hasStates",{get:function(){return this.stateLines.length>0},enumerable:true,configurable:true});Object.defineProperty(GraphStates.prototype,"isDynamic",{get:function(){return this.dynamicSource!==undefined},enumerable:true,configurable:true});return GraphStates}();SciViCGraph.GraphStates=GraphStates;var GraphData=function(){function GraphData(nodes,edges){this.nodes=nodes;this.edges=edges;this.m_shadowNodes=this.nodes;this.m_shadowEdges=this.edges}GraphData.prototype.excludeUnselected=function(selectedKlasses,getKlass){var _this=this;this.nodes=[];this.m_shadowNodes.forEach(function(node){if(SciViCGraph.Geometry.sortedArrayIncludesValue(selectedKlasses,getKlass(node)))_this.nodes.push(node)});this.edges=[];this.m_shadowEdges.forEach(function(edge){if(SciViCGraph.Geometry.sortedArrayIncludesValue(selectedKlasses,getKlass(edge.source))&&SciViCGraph.Geometry.sortedArrayIncludesValue(selectedKlasses,getKlass(edge.target)))_this.edges.push(edge)})};return GraphData}();SciViCGraph.GraphData=GraphData;var IJsonFormat=function(){function IJsonFormat(){}return IJsonFormat}();SciViCGraph.IJsonFormat=IJsonFormat;var IJsonStatesFormat=function(){function IJsonStatesFormat(){}return IJsonStatesFormat}();SciViCGraph.IJsonStatesFormat=IJsonStatesFormat;var IJsonStatesHierarchyFormat=function(){function IJsonStatesHierarchyFormat(){}return IJsonStatesHierarchyFormat}();SciViCGraph.IJsonStatesHierarchyFormat=IJsonStatesHierarchyFormat;var IJsonDynamicSourceFormat=function(){function IJsonDynamicSourceFormat(){}return IJsonDynamicSourceFormat}();SciViCGraph.IJsonDynamicSourceFormat=IJsonDynamicSourceFormat;var Parser=function(){function Parser(jsonData){this.m_nodes=[];this.m_edges=[];this.processNodes(jsonData.nodes);this.processEdges(jsonData.edges)}Parser.prototype.processNodes=function(nodes){var _this=this;nodes.forEach(function(node){_this.m_nodes[node.id]=new SciViCGraph.Node(node)})};Parser.prototype.processEdges=function(edges){var _this=this;edges.forEach(function(edge){var tt=edge.tooltip!==undefined?edge.tooltip:null;_this.m_edges.push(new SciViCGraph.Edge(_this.m_nodes[edge.source],_this.m_nodes[edge.target],edge.weight,tt))})};Object.defineProperty(Parser.prototype,"graphData",{get:function(){var nodes=[];for(var key in this.m_nodes)nodes.push(this.m_nodes[key]);return new GraphData(nodes,this.m_edges)},enumerable:true,configurable:true});Object.defineProperty(Parser.prototype,"graphStates",{get:function(){var result=new GraphStates;result.data["0"]=this.graphData;return result},enumerable:true,configurable:true});return Parser}();SciViCGraph.Parser=Parser;var StatesParser=function(){function StatesParser(jsonData){var _this=this;this.m_states=new GraphStates;this.m_states.stateLines.push([]);jsonData.states.forEach(function(state,index){var parser=new Parser(state);_this.m_states.stateLines[0].push(state.label);_this.m_states.data[index.toString()]=parser.graphData})}Object.defineProperty(StatesParser.prototype,"graphStates",{get:function(){return this.m_states},enumerable:true,configurable:true});return StatesParser}();SciViCGraph.StatesParser=StatesParser;var HierarchicalStatesParser=function(){function HierarchicalStatesParser(jsonData){this.m_states=new GraphStates;this.m_states.stateLines=jsonData.stateLines;for(var key in jsonData.states){if(jsonData.states.hasOwnProperty(key)){var parser=new Parser(jsonData.states[key]);this.m_states.data[key]=parser.graphData}}}Object.defineProperty(HierarchicalStatesParser.prototype,"graphStates",{get:function(){return this.m_states},enumerable:true,configurable:true});return HierarchicalStatesParser}();SciViCGraph.HierarchicalStatesParser=HierarchicalStatesParser;var DynamicStatesParser=function(){function DynamicStatesParser(jsonData){this.m_states=new GraphStates;this.m_states.stateLines=jsonData.stateLines;this.m_states.dynamicSource=jsonData}Object.defineProperty(DynamicStatesParser.prototype,"graphStates",{get:function(){return this.m_states},enumerable:true,configurable:true});return DynamicStatesParser}();SciViCGraph.DynamicStatesParser=DynamicStatesParser})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var HighlightType;(function(HighlightType){HighlightType[HighlightType["None"]=0]="None";HighlightType[HighlightType["Hover"]=1]="Hover";HighlightType[HighlightType["Selection"]=2]="Selection";HighlightType[HighlightType["Multiselect"]=3]="Multiselect"})(HighlightType=SciViCGraph.HighlightType||(SciViCGraph.HighlightType={}));function color2string(c){return"#"+(c>>20&15).toString(16)+(c>>16&15).toString(16)+(c>>12&15).toString(16)+(c>>8&15).toString(16)+(c>>4&15).toString(16)+(c&15).toString(16)}SciViCGraph.color2string=color2string;function string2color(s){if(s.length!==7)return 0;var result=0;s=s.toLowerCase();var zCode="0".charCodeAt(0);var nCode=zCode+9;var aCode="a".charCodeAt(0);var fCode=aCode+5;for(var i=1;i<s.length;++i){var c=s.charCodeAt(i);if(c>=zCode&&c<=nCode)c-=zCode;else if(c>=aCode&&c<=fCode)c-=aCode-10;else return 0;result|=c<<4*(s.length-i-1)}return result}SciViCGraph.string2color=string2color;var Renderer=function(){function Renderer(m_view,m_info,m_listForNodes,m_settings,m_filters,m_stats,m_stateline,m_treeView,m_calculator,m_localizer){this.m_view=m_view;this.m_info=m_info;this.m_listForNodes=m_listForNodes;this.m_settings=m_settings;this.m_filters=m_filters;this.m_stats=m_stats;this.m_stateline=m_stateline;this.m_treeView=m_treeView;this.m_calculator=m_calculator;this.m_localizer=m_localizer;this.m_scaleLevels=null;this.m_applicableScaleLevelsCount=0;this.m_classifier=null;this.m_ringScales=null;this.m_zoomTimerID=null;this.m_statesStack=null;this.m_edgeBatches=null;this.m_transientEdgeBatch=null;this.m_transientEdge=null;this.m_transientEdgeSource=null;this.m_nodesFontSize=24;this.m_ringScaleFontSize=36;this.m_currentStateKey=null;this.m_draggedNodeIndex=-1;this.m_nodePlaceHolder=null;this.m_nodeBorder=null;this.m_renderingCache=null;this.m_cursorPos={x:undefined,y:undefined};this.m_draggedRingIndex=-1;this.m_ringPlaceHolder=null;this.m_ringBorder=null;this.m_ringSegmentFilterBothEnds=true;this.m_ringScaleWithSegmentSelected=null;this.m_colorPicker=null;this.m_modularityFilters=[];this.m_stateLineNav=new SciViCGraph.StateLineNavigator(this,this.m_stateline);this.m_stateCalc=new SciViCGraph.Calculator(this,this.m_calculator);this.m_filtersManager=new SciViCGraph.FiltersManager(this,this.m_filters);this.m_edgesEditMode=false;this.m_createDirectedEdges=false;var tooltip=document.createElement("div");tooltip.className="scivi_graph_tooltip";m_view.parentElement.parentElement.appendChild(tooltip);$(".scivi_graph_tooltip").hide(0);this.clearSelected()}Renderer.prototype.setInput=function(states,colors){this.m_states=states;this.m_colors=colors;if(this.m_states.hasStates){this.m_currentStateKey="";for(var i=0,n=this.m_states.stateLines.length;i<n;++i){this.m_currentStateKey+="0";if(i<n-1)this.m_currentStateKey+="|"}}else{this.m_currentStateKey="0"}};Renderer.prototype.setColorPicker=function(cp){this.m_colorPicker=cp};Renderer.prototype.addModularityFilter=function(mf){this.m_modularityFilters.push(mf)};Renderer.prototype.createColorPicker=function(options){return new this.m_colorPicker(options)};Renderer.prototype.run=function(){var settings={transparent:false,antialias:false,resolution:window.devicePixelRatio,autoResize:true,roundPixels:false,backgroundColor:16777215};this.m_renderer=PIXI.autoDetectRenderer(this.m_view.offsetWidth,this.m_view.offsetHeight,settings);this.m_view.appendChild(this.m_renderer.view);this.m_renderer["plugins"]["interaction"]["moveWhenInside"]=true;if(this.m_listForNodes)this.m_nodesList=new SciViCGraph.NodesList(this.m_listForNodes);if(this.m_stats)this.m_statistics=new SciViCGraph.Stats(this.m_stats,this);if(this.m_states.isDynamic)this.currentData();this.init()};Renderer.prototype.currentData=function(){if(this.m_states.isDynamic){if(!this.m_states.data["current"]){var parser=new SciViCGraph.Parser(this.m_states.dynamicSource.stateGetter(this.m_currentStateKey));this.m_states.data["current"]=parser.graphData}return this.m_states.data["current"]}else{return this.m_states.data[this.m_currentStateKey]}};Object.defineProperty(Renderer.prototype,"states",{get:function(){return this.m_states},enumerable:true,configurable:true});Object.defineProperty(Renderer.prototype,"currentStateKey",{get:function(){return this.m_currentStateKey},enumerable:true,configurable:true});Renderer.prototype.createStage=function(){this.m_stage=new SciViCGraph.Scene(this.m_colors,this.m_filtersManager.edgeWeight,this.m_filtersManager.nodeWeight);this.m_renderingCache=new SciViCGraph.RenderingCache(this.m_stage,this.m_renderer)};Renderer.prototype.createGraph=function(shouldFit){this.checkRingScaleApplicability();this.calcMaxTextLength();this.createRingScale();this.createNodes();this.createEdges();if(shouldFit)this.fitScale();this.createCache();if(this.m_nodesList)this.m_nodesList.buildList(this.currentData().nodes,this)};Renderer.prototype.init=function(){this.m_filtersManager.calcWeights();this.createStage();this.m_hoveredNode=null;this.m_selectedNode=null;this.m_highlightedGroup=undefined;this.m_clickCaught=false;this.m_clicked=false;this.m_mousePressed=false;this.m_panning=false;this.m_panPrevX=0;this.m_panPrevY=0;this.createGraph(true);this.filterNodes();this.filterEdges();this.initInterface();this.updateRenderingCache(true);this.m_renderingCache.transit()};Renderer.prototype.reinit=function(animated,shouldFit){var _this=this;var restorePos=!shouldFit&&this.m_renderingCache!==null&&this.m_renderingCache.isValid;var x=0;var y=0;var s=1;if(restorePos){x=this.m_renderingCache.x;y=this.m_renderingCache.y;s=this.m_stage.scale.x}this.createStage();if(this.m_selectedNode!==null)this.m_selectedNode=this.getNodeByID(this.m_selectedNode.id);this.currentData().nodes.forEach(function(node){node.fontSize=_this.m_nodesFontSize});this.m_nodePlaceHolder=null;this.m_nodeBorder=null;this.m_ringPlaceHolder=null;this.m_ringBorder=null;if(restorePos)this.m_stage.scale.set(s,s);this.createGraph(shouldFit);if(restorePos){this.m_renderingCache.x=x;this.m_renderingCache.y=y}this.currentData().nodes.forEach(function(node){node.invalidate(true)});this.filterNodes();this.filterEdges();if(animated){this.updateRenderingCache(true);this.m_renderingCache.transit()}else{this.render(true,true)}if(this.m_selectedNode!==null)this.m_selectedNode.postInfo()};Renderer.prototype.getNodeByID=function(id){var nodes=this.currentData().nodes;for(var i=0,n=nodes.length;i<n;++i){if(nodes[i].id===id)return nodes[i]}return null};Renderer.prototype.getAngularIndex=function(x,y){var a=Math.atan2(y,x);if(a<0)a+=2*Math.PI;var index=Math.round(a*this.currentData().nodes.length/(2*Math.PI));if(index<0||index>=this.currentData().nodes.length)index=0;return index};Renderer.prototype.getNodeIndexByPosition=function(x,y,s,isInRing){var d=x*x+y*y;var r=this.m_radius;s*=s;var inRing=r*r*s;r+=this.m_maxTextLength;var outRing=r*r*s;if(isInRing)isInRing[0]=d<inRing;if(d>inRing&&d<outRing){return this.getAngularIndex(x,y)}return-1};Renderer.prototype.getNodeByPosition=function(x,y,s,isInRing){var index=this.getNodeIndexByPosition(x,y,s,isInRing);return index>=0?this.currentData().nodes[index]:null};Renderer.prototype.getRingIndexByPosition=function(x,y,s,radius){if(this.m_ringScales){var n=this.m_ringScales.length;for(var i=0;i<n;++i){if(this.m_ringScales[i].hitWithPoint(x,y,s)){if(radius)radius[0]=this.m_ringScales[i].radius+this.m_ringScales[i].width/2;return i}}if(radius&&n>1){var r=this.m_ringScales[0].radius*s;var i=0;if(x*x+y*y>r*r){radius[0]=this.m_ringScales[i].radius+this.m_ringScales[i].width/2;--i}else{i=this.m_ringScales.length-1;radius[0]=this.m_ringScales[i].radius-this.m_ringScales[i].width/2;++i}return i}}return-1};Renderer.prototype.clearSelected=function(){if(this.m_selectedNode){this.m_selectedNode.handleCursorMove(NaN,NaN,NaN,NaN,NaN);this.m_selectedNode.handleClick()}this.m_selectedNode=null;if(this.m_info){while(this.m_info.firstChild)this.m_info.removeChild(this.m_info.firstChild);var dv=document.createElement("div");dv.innerHTML=this.m_localizer["LOC_SELSTUB"];this.m_info.appendChild(dv)}if(this.m_multiselectedNodes){this.m_multiselectedNodes.forEach(function(node){node.multiselected=false})}this.m_multiselectedNodes=[]};Renderer.prototype.initInterface=function(){var _this=this;window.addEventListener("resize",function(){_this.reshape()});var updateZoom=function(){var x=_this.m_renderingCache.x;var y=_this.m_renderingCache.y;var s=_this.m_renderingCache.currentScale();_this.m_stage.scale.set(s,s);_this.createCache();_this.m_renderingCache.x=x;_this.m_renderingCache.y=y;_this.render(true,true)};var onWheel=function(e){e=e||window.event;var rect=e.target.getBoundingClientRect();var x=e.clientX-rect.left;var y=e.clientY-rect.top;var delta=e.deltaY||e.detail||e.wheelDelta;if(delta!==undefined){if(_this.m_zoomTimerID!==null)clearTimeout(_this.m_zoomTimerID);var d=1.05;var s=_this.m_renderingCache.scale*(delta>0?1/d:d);var minS=.1/_this.m_stage.scale.x;var maxS=1/_this.m_stage.scale.x;if(s<minS)s=minS;else if(s>maxS)s=maxS;var ds=1-s/_this.m_renderingCache.scale;var dx=(x-_this.m_renderingCache.x)*ds;var dy=(y-_this.m_renderingCache.y)*ds;_this.m_renderingCache.scale=s;_this.m_renderingCache.x+=dx;_this.m_renderingCache.y+=dy;_this.render(true,false);_this.m_zoomTimerID=setTimeout(updateZoom,60)}};var onMouseMove=function(e){e=e||window.event;var rect=e.target.getBoundingClientRect();var x=e.clientX-rect.left;var y=e.clientY-rect.top;_this.m_cursorPos.x=x;_this.m_cursorPos.y=y;if(_this.m_mousePressed){if(_this.m_edgesEditMode&&_this.m_transientEdgeSource){_this.createTransientEdgeWithSourceNode(_this.m_transientEdgeSource);if(_this.m_selectedNode!==_this.m_transientEdgeSource)_this.selectNode(_this.m_transientEdgeSource);_this.m_transientEdgeSource=null}if(_this.m_edgesEditMode&&_this.m_transientEdgeBatch){_this.changeTransientEdge()}else if(_this.m_draggedNodeIndex!==-1){_this.dragNode(x,y)}else if(_this.m_draggedRingIndex!==-1){_this.dragRing(x,y)}else{_this.panGraph(x,y)}}else{if(!_this.m_edgesEditMode&&_this.m_transientEdgeBatch)_this.changeTransientEdge();else if(e.buttons===0)_this.hoverGraph(x,y)}};var onMouseOut=function(){_this.m_hoveredNode=null;var f=false;if(_this.m_ringScales){_this.m_ringScales.forEach(function(rs){var rsf=rs.dropHighlight();if(rsf)_this.contextMenuEnabled=false;f=f||rsf})}if(_this.m_draggedNodeIndex!==-1){_this.stopDragNode();f=true}if(_this.m_draggedRingIndex!==-1){_this.stopDragRing();f=true}_this.m_transientEdgeSource=null;_this.dropTransientEdge();_this.m_mousePressed=false;_this.m_panning=false;_this.render(f,true)};var onMouseDown=function(e){e=e||window.event;var rect=e.target.getBoundingClientRect();var x=e.clientX-rect.left;var y=e.clientY-rect.top;_this.m_mousePressed=true;_this.m_panning=false;if(!_this.startDragNode(x,y)&&!_this.startDragRing(x,y)){_this.m_panPrevX=x;_this.m_panPrevY=y}};var onMouseUp=function(e){if(_this.m_mousePressed){_this.m_mousePressed=false;if(!_this.m_panning){e=e||window.event;var rect=e.target.getBoundingClientRect();var x=e.clientX-rect.left;var y=e.clientY-rect.top;if(!_this.dropNode(x,y)&&!_this.dropRing(x,y)){_this.m_clickCaught=true;var isInRing=[false];var dx=x-_this.m_renderingCache.x;var dy=y-_this.m_renderingCache.y;var s=_this.m_renderingCache.currentScale();var node=_this.getNodeByPosition(dx,dy,s,isInRing);var shouldSelectNode=!isInRing[0]&&!_this.m_transientEdgeBatch&&!(e.altKey&&node==_this.m_selectedNode);if(shouldSelectNode){if(e.shiftKey)_this.multiselectNode(node);else _this.selectNode(node)}if(node){if(!_this.m_transientEdgeBatch){if(e.altKey){_this.createTransientEdgeWithSourceNode(node)}}else{_this.commitTransientEdge()}}else{_this.dropTransientEdge();if(e.shiftKey){_this.m_ringSegmentFilterBothEnds=false;_this.selectRingSegment()}else if(e.altKey){_this.m_ringSegmentFilterBothEnds=true;_this.selectRingSegment()}_this.selectEdge()}}}_this.m_panning=false}};this.m_view.onmousemove=onMouseMove;this.m_view.onmouseout=onMouseOut;this.m_view.onmousedown=onMouseDown;this.m_view.onmouseup=onMouseUp;this.m_view.onwheel=onWheel;$.contextMenu({selector:"#"+this.m_view.id,items:{add:{name:this.m_localizer["LOC_RING_FILTER_ADD"],callback:function(key,opt){_this.addEqualizerItem()}},arcs:{name:this.m_localizer["LOC_RING_FILTER_ARCS_GROUP"],items:{single:{name:this.m_localizer["LOC_RING_FILTER_ARCS_GROUP_SINGLE"],callback:function(key,opt){_this.m_ringSegmentFilterBothEnds=false;_this.selectRingSegment()}},both:{name:this.m_localizer["LOC_RING_FILTER_ARCS_GROUP_BOTH"],callback:function(key,opt){_this.m_ringSegmentFilterBothEnds=true;_this.selectRingSegment()}}}},paint:{name:this.m_localizer["LOC_RING_PAINT_NODES"],callback:function(key,opt){_this.paintNodesByRingSegment()}}}});this.contextMenuEnabled=false;if(this.m_settings){this.m_settings.innerHTML="<div>"+this.m_localizer["LOC_PASSIVETEXTALPHA"]+"&nbsp;<span id='scivi_node_alpha'>"+SciViCGraph.Node.passiveTextAlpha.toString()+"</span></div>"+"<div id='scivi_node_alpha_slider' style='margin: 10px 10px 10px 5px'></div>"+"<div>"+this.m_localizer["LOC_PASSIVEEDGEALPHA"]+"&nbsp;<span id='scivi_edge_alpha'>"+SciViCGraph.Edge.passiveEdgeAlpha.toString()+"</span></div>"+"<div id='scivi_edge_alpha_slider' style='margin: 10px 10px 10px 5px'></div><br/><hr/><br/>"+"<table><tr><td>"+"<table>"+"<tr><td>"+this.m_localizer["LOC_NODEFONT"]+"</td><td><input id='scivi_nodes_font' style='width:50px' type='number' min='"+Renderer.m_minFontSize.toString()+"' max='"+Renderer.m_maxFontSize.toString()+"' value='"+this.m_nodesFontSize.toString()+"' required/></td></tr>"+"<tr><td>"+this.m_localizer["LOC_RINGFONT"]+"</td><td><input id='scivi_ring_font' style='width:50px' type='number' min='"+Renderer.m_minFontSize.toString()+"' max='"+Renderer.m_maxFontSize.toString()+"' value='"+this.m_ringScaleFontSize.toString()+"' required/></td></tr>"+"</table>"+"</td><td>"+"<div id='scivi_apply_fonts' class='scivi_button'>"+this.m_localizer["LOC_APPLY"]+"</div>"+"</td></tr></table><br/><hr/><br/>"+"<div id='scivi_fit_to_screen' class='scivi_button'>"+this.m_localizer["LOC_FIT_TO_SCREEN"]+"</div>"+"<div id='scivi_sort_by_ring' class='scivi_button'>"+this.m_localizer["LOC_SORT_BY_RING"]+"</div>"+"<div id='scivi_calc_modularity' class='scivi_button'>"+this.m_localizer["LOC_CALC_MODULARITY"]+"</div>"+"<div id='scivi_save_graph' class='scivi_button'>"+this.m_localizer["LOC_SAVE_GRAPH"]+"</div>"+"<br/><br/><hr/><br/><div>"+"<span><input id='scivi_edge_edit' type='checkbox' value='"+(this.edgesEditMode?"checked":"")+"'/><span>"+this.m_localizer["LOC_EDGE_EDIT"]+"</span></span>"+"&nbsp;&nbsp;&nbsp;&nbsp;"+"<span><input id='scivi_create_directed_edges' type='checkbox' value='"+(this.createDirectedEdges?"checked":"")+"'/><span>"+this.m_localizer["LOC_CREATE_DIRECTED_EDGES"]+"</span></span>"+"</div>"+"<br/><hr/><br/><div class='scivi_button' onclick='window.location.href = \""+this.m_localizer["LOC_HELPLOC"]+"\"'>"+this.m_localizer["LOC_HELP"]+"</div>";$("#scivi_node_alpha_slider").slider({min:0,max:1,range:false,value:SciViCGraph.Node.passiveTextAlpha,step:.1,slide:function(event,ui){_this.changeNodeAlpha(ui.value)}});$("#scivi_edge_alpha_slider").slider({min:0,max:1,range:false,value:SciViCGraph.Edge.passiveEdgeAlpha,step:.1,slide:function(event,ui){_this.changeEdgeAlpha(ui.value)}});var nodesFSInput_1=$("#scivi_nodes_font")[0];var ringFSInput_1=$("#scivi_ring_font")[0];$("#scivi_apply_fonts").click(function(){var nodesFS=parseFloat(nodesFSInput_1.value);var ringFS=parseFloat(ringFSInput_1.value);if(!isNaN(nodesFS)&&!isNaN(ringFS)&&nodesFS>=Renderer.m_minFontSize&&nodesFS<=Renderer.m_maxFontSize&&nodesFS===Math.round(nodesFS)&&ringFS>=Renderer.m_minFontSize&&ringFS<=Renderer.m_maxFontSize&&ringFS===Math.round(ringFS)){_this.m_nodesFontSize=nodesFS;_this.m_ringScaleFontSize=ringFS;_this.reinit(false,false)}});$("#scivi_fit_to_screen").click(function(){_this.fitScale();_this.createCache();_this.render(true,true)});$("#scivi_sort_by_ring").click(function(){_this.sortNodesByRingScale(false);_this.reinit(false,false)});$("#scivi_calc_modularity").click(function(){_this.m_modularityFilters[0].detectClusters(_this.currentData());_this.reinit(false,false)});$("#scivi_save_graph").click(function(){_this.saveGraph()});$("#scivi_edge_edit").change(function(){_this.edgesEditMode=!_this.edgesEditMode});$("#scivi_create_directed_edges").change(function(){_this.createDirectedEdges=!_this.createDirectedEdges})}this.m_filtersManager.initFilters();this.m_stateLineNav.build();if(this.m_states.hasStates)this.m_stateCalc.build();$(document).keyup(function(e){switch(e.keyCode){case 27:_this.m_draggedNodeIndex=-1;_this.dropNode(0,0);_this.m_draggedRingIndex=-1;_this.dropRing(0,0);_this.m_panning=true;_this.m_mousePressed=false;if(_this.m_cursorPos.x!==undefined&&_this.m_cursorPos.y!==undefined)_this.hoverGraph(_this.m_cursorPos.x,_this.m_cursorPos.y);_this.dropTransientEdge();break;case 46:case 8:_this.deleteSelectedEdge();break;case 72:if(_this.m_selectedNode){_this.m_selectedNode.isShown=false;_this.updateNodesVisibility()}break}});if(this.m_classifier)this.m_classifier.initTreeView(this.m_treeView,this)};Renderer.prototype.calcMaxTextLength=function(){var _this=this;this.m_maxTextLength=0;var maxTextHeight=0;var n=0;Object.keys(this.m_states.data).forEach(function(dataKey){var data=_this.m_states.data[dataKey];if(data.nodes.length>n)n=data.nodes.length});var ww=n<40;Object.keys(this.m_states.data).forEach(function(dataKey){var data=_this.m_states.data[dataKey];data.nodes.forEach(function(node){node.wordWrap=ww;var s=node.labelSize(true);if(s.width>_this.m_maxTextLength)_this.m_maxTextLength=s.width;if(s.height>maxTextHeight)maxTextHeight=s.height})});if(this.m_maxTextLength<50)this.m_maxTextLength=50;this.m_maxTextLength+=20;this.m_radius=Math.max(n*maxTextHeight,1500)/(2*Math.PI);var rsWidth=this.m_scaleLevels?Renderer.m_ringScaleWidth*this.m_applicableScaleLevelsCount:0;this.m_totalRadius=this.m_radius+this.m_maxTextLength+rsWidth};Renderer.prototype.fitScale=function(){var aaPadding=3;var radius=Math.min(this.m_view.offsetWidth,this.m_view.offsetHeight-aaPadding)/2;var s=radius/this.m_totalRadius;if(s>1)s=1;this.m_stage.scale.set(s,s)};Renderer.prototype.createNodes=function(){var _this=this;var angleStep=2*Math.PI/this.currentData().nodes.length;var a1=Math.PI/2;var a2=3*a1;this.currentData().nodes.forEach(function(node,i){var x=_this.m_radius*Math.cos(i*angleStep);var y=_this.m_radius*Math.sin(i*angleStep);_this.m_stage.addChild(node);node.position.set(x,y);node.rotation=i*angleStep;if(node.rotation>a1&&node.rotation<a2){node.scale.set(-.5,-.5);node.setAnchor(1,.5,_this.m_maxTextLength);node.align="right"}else{node.scale.set(.5,.5);node.setAnchor(0,.5,_this.m_maxTextLength);node.align="left"}node.highlight=HighlightType.None;node.info=_this.m_info;node.svRenderer=_this})};Renderer.prototype.createEdges=function(){var _this=this;this.currentData().nodes.forEach(function(node){node.clearEdges()});this.currentData().edges.forEach(function(edge){edge.source.addEdge(edge)});this.m_edgeBatches=[];this.currentData().nodes.forEach(function(node){node.edgeBatches.forEach(function(batch){_this.m_stage.addChild(batch);_this.m_edgeBatches.push(batch)})});this.currentData().edges.forEach(function(edge){edge.highlight=HighlightType.None})};Renderer.prototype.checkRingScaleApplicability=function(){var _this=this;this.m_applicableScaleLevelsCount=0;if(this.m_scaleLevels!==null&&this.m_scaleLevels.length>0){this.m_scaleLevels.forEach(function(scale){if(scale.checkApplicability(_this.currentData().nodes))++_this.m_applicableScaleLevelsCount})}};Renderer.prototype.createRingScale=function(){if(this.m_applicableScaleLevelsCount===0){this.m_ringScaleWithSegmentSelected=null;this.m_ringScales=[];return}var angleStep=2*Math.PI/this.currentData().nodes.length;var radius=this.m_radius+this.m_maxTextLength+(this.m_applicableScaleLevelsCount-.5)*Renderer.m_ringScaleWidth;var selectedRS=this.m_ringScaleWithSegmentSelected;this.m_ringScaleWithSegmentSelected=null;this.m_ringScales=[];var _loop_2=function(i){var scale=this_2.m_scaleLevels[i];if(!scale.applicable)return"continue";var segment={from:undefined,id:undefined,nodeID:undefined};var rs=new SciViCGraph.RingScale(this_2.m_radius,radius,Renderer.m_ringScaleWidth,this_2.m_ringScaleFontSize,this_2.m_view);this_2.m_stage.addChild(rs);this_2.m_ringScales.push(rs);this_2.currentData().nodes.forEach(function(node,i){var stepID=scale.classifyNode(node);if(stepID!==segment.id){var a=(i-.5)*angleStep;if(segment.id!==undefined){rs.addSegment(segment.from,a,scale.getColor(segment.id),scale.getTextColor(segment.id),scale.getName(segment.id),segment.nodeID.toString()+"|"+node.id.toString())}segment.from=a;segment.id=stepID;segment.nodeID=node.id}});if(segment.id!==undefined){rs.addSegment(segment.from,2*Math.PI-.5*angleStep,scale.getColor(segment.id),scale.getTextColor(segment.id),scale.getName(segment.id),segment.nodeID.toString()+"|"+this_2.currentData().nodes[this_2.currentData().nodes.length-1].id.toString())}if(selectedRS&&!this_2.m_ringScaleWithSegmentSelected){rs.copySelection(selectedRS);if(rs.segmentSelected)this_2.m_ringScaleWithSegmentSelected=rs}radius-=Renderer.m_ringScaleWidth};var this_2=this;for(var i=this.m_scaleLevels.length-1;i>=0;--i){_loop_2(i)}};Renderer.prototype.createCache=function(){this.m_renderingCache.init(this.m_totalRadius,this.m_view.offsetWidth,this.m_view.offsetHeight)};Renderer.prototype.updateRenderingCache=function(force){var _this=this;var needsRender=force;if(this.m_clicked&&!this.m_clickCaught)this.clearSelected();this.m_clicked=false;this.m_clickCaught=false;if(this.m_selectedNode!==null){this.m_selectedNode.highlight=HighlightType.Selection;this.m_selectedNode.setHighlightForEdgesAndTargetNodes(HighlightType.Hover)}if(this.m_hoveredNode!==null&&this.m_selectedNode!==this.m_hoveredNode){this.m_hoveredNode.highlight=HighlightType.Hover;this.m_hoveredNode.setHighlightForEdgesAndTargetNodes(HighlightType.Hover)}this.m_multiselectedNodes.forEach(function(node){if(node.visible&&node!==_this.m_selectedNode){node.highlight=HighlightType.Multiselect;node.setHighlightForEdgesAndTargetNodes(HighlightType.Hover)}});this.currentData().nodes.forEach(function(node){if(node.visible){if(node!==_this.m_selectedNode&&node!==_this.m_hoveredNode&&!node.multiselected){node.setHighlightForEdges(HighlightType.None);if(_this.m_highlightedGroup!==undefined&&node.groupID===_this.m_highlightedGroup)node.highlight=HighlightType.Hover}var nr=node.prepare();needsRender=needsRender||nr}});this.m_edgeBatches.forEach(function(batch){var nr=batch.prepare();needsRender=needsRender||nr});if(this.m_transientEdgeBatch){var nr=this.m_transientEdgeBatch.prepare();needsRender=needsRender||nr}if(needsRender)this.m_renderingCache.update();return needsRender};Renderer.prototype.render=function(force,updateCache){if(updateCache)force=this.updateRenderingCache(force);if(force)this.m_renderingCache.render()};Renderer.prototype.reshape=function(){this.m_renderer.resize(this.m_view.offsetWidth,this.m_view.offsetHeight);this.m_stateLineNav.updateStateLineLabels();this.render(true,true)};Renderer.prototype.changeActiveGroupColor=function(newColor){if(this.m_selectedNode){var focusGroup=this.m_selectedNode.groupID;this.m_stage.colors[focusGroup]=string2color(newColor);this.reinit(false,false)}};Renderer.prototype.changeGroupColor=function(focusGroup,newColor){this.m_stage.colors[focusGroup]=string2color(newColor);this.reinit(false,false)};Renderer.prototype.quasiZoomIn=function(groupID){var _this=this;var newStates=new SciViCGraph.GraphStates;Object.keys(this.m_states.data).forEach(function(dataKey){var data=_this.m_states.data[dataKey];var newNodes=[];data.nodes.forEach(function(node){if(node.groupID===groupID)newNodes.push(node)});var newEdges=[];data.edges.forEach(function(edge){if(edge.source.groupID===groupID&&edge.target.groupID===groupID)newEdges.push(edge)});newStates.data[dataKey]=new SciViCGraph.GraphData(newNodes,newEdges)});if(this.m_statesStack===null)this.m_statesStack=[];this.m_statesStack.push(this.m_states);this.m_states=newStates;this.reinit(true,false)};Renderer.prototype.quasiZoomOut=function(){this.m_states=this.m_statesStack.pop();this.reinit(true,false)};Renderer.prototype.canQuasiZoomIn=function(){return this.m_statesStack===null||this.m_statesStack.length===0};Renderer.prototype.canQuasiZoomOut=function(){return this.m_statesStack!==null&&this.m_statesStack.length>0};Renderer.prototype.highlightGroup=function(groupID){this.m_highlightedGroup=groupID;this.render(false,true)};Renderer.prototype.clearChartSelection=function(){this.m_statistics.clearSelection()};Renderer.prototype.isEdgeVisibleByRingSegment=function(edge){if(this.m_ringScaleWithSegmentSelected){if(this.m_ringSegmentFilterBothEnds){for(var i=0,n=this.m_ringScales.length;i<n;++i){if(this.m_ringScales[i].nodeInSelectedSegment(edge.source)&&this.m_ringScales[i].nodeInSelectedSegment(edge.target))return true}}else{for(var i=0,n=this.m_ringScales.length;i<n;++i){if(this.m_ringScales[i].nodeInSelectedSegment(edge.source)||this.m_ringScales[i].nodeInSelectedSegment(edge.target))return true}}return false}return true};Renderer.prototype.isEdgeVisibleByEqualizer=function(edge){for(var i=0,n=this.m_filtersManager.equalizer.length;i<n;++i){if(this.m_filtersManager.equalizer[i].hidesEdge(edge))return false}return true};Renderer.prototype.isNodeVisibleByEqualizer=function(node){for(var i=0,n=this.m_filtersManager.equalizer.length;i<n;++i){if(this.m_filtersManager.equalizer[i].hidesNode(node))return false}return true};Renderer.prototype.filterEdges=function(){var _this=this;var result=false;var cnt=0;var w=0;var rmin=this.m_filtersManager.edgeWeight.min;var rmax=this.m_filtersManager.edgeWeight.max;this.currentData().edges.forEach(function(edge){var rv=edge.weight;var vis=edge.source.visible&&edge.target.visible&&rv>=rmin&&rv<=rmax&&_this.isEdgeVisibleByRingSegment(edge)&&_this.isEdgeVisibleByEqualizer(edge);if(vis!==edge.visible){edge.visible=vis;result=true;if(edge.source===_this.m_selectedNode||edge.target===_this.m_selectedNode)_this.m_selectedNode.postInfo()}if(edge.visible){edge.setNeedsUpdate();++cnt;w+=edge.weight}});if(this.m_statistics)this.m_statistics.updateEdgesStat(cnt,w);return result};Renderer.prototype.filterNodes=function(){var _this=this;var result=false;var cnt=0;var w=0;var rmin=this.m_filtersManager.nodeWeight.min;var rmax=this.m_filtersManager.nodeWeight.max;this.currentData().nodes.forEach(function(node){var rv=node.weight;var vis=node.isShown&&rv>=rmin&&rv<=rmax&&_this.isNodeVisibleByEqualizer(node);if(vis!==node.visible){node.visible=vis;result=true;if(node===_this.m_selectedNode)_this.m_clicked=true}if(node.visible){++cnt;w+=node.weight}});if(this.m_statistics){this.m_statistics.buildChart(this.currentData().nodes,this.m_stage.colors);this.m_statistics.updateNodesStat(cnt,w)}return result};Renderer.prototype.changeNodeAlpha=function(value){$("#scivi_node_alpha").text(value);SciViCGraph.Node.passiveTextAlpha=value;this.currentData().nodes.forEach(function(node){node.invalidate(false)});this.render(true,true)};Renderer.prototype.changeEdgeAlpha=function(value){$("#scivi_edge_alpha").text(value);SciViCGraph.Edge.passiveEdgeAlpha=value;this.currentData().nodes.forEach(function(node){node.invalidate(false)});this.render(true,true)};Object.defineProperty(Renderer.prototype,"scaleLevels",{get:function(){return this.m_scaleLevels},set:function(s){this.m_scaleLevels=s;if(this.m_scaleLevels){this.m_scaleLevels.forEach(function(sl,i){sl.id=i})}},enumerable:true,configurable:true});Object.defineProperty(Renderer.prototype,"ringScales",{get:function(){return this.m_ringScales},enumerable:true,configurable:true});Renderer.prototype.reorderScaleLevels=function(order){var _this=this;var s=[];order.forEach(function(i){s.push(_this.scaleLevels[i])});this.m_scaleLevels=s;this.sortNodesByRingScale(true)};Object.defineProperty(Renderer.prototype,"classifier",{get:function(){return this.m_classifier},set:function(c){this.m_classifier=c},enumerable:true,configurable:true});Renderer.prototype.smartCmp=function(x1,x2){var x1num=/^\d+(\.\d+)?$/.test(x1);var x2num=/^\d+(\.\d+)?$/.test(x2);if(x1num&&x2num){var x1f=parseFloat(x1);var x2f=parseFloat(x2);if(x1f<x2f)return-1;else if(x1f>x2f)return 1;else return 0}else{if(x1<x2)return-1;else if(x1==x2)return 0;else return 1}};Renderer.prototype.sortNodesByRingScale=function(sortAllStates){var _this=this;if(this.m_scaleLevels.length>0){var sorter_1=function(x1,x2){for(var i=_this.m_scaleLevels.length-1;i>=0;--i){var v1_1=_this.m_scaleLevels[i].getStepID(x1);var v2_1=_this.m_scaleLevels[i].getStepID(x2);if(v1_1<v2_1)return-1;else if(v1_1>v2_1)return 1}var v1=_this.m_scaleLevels[0].getValue(x1);var v2=_this.m_scaleLevels[0].getValue(x2);if(v1<v2)return-1;else if(v1>v2)return 1;else return _this.smartCmp(x1.label,x2.label)};if(sortAllStates){Object.keys(this.m_states.data).forEach(function(dataKey){var data=_this.m_states.data[dataKey];data.nodes.sort(sorter_1)})}else{this.currentData().nodes.sort(sorter_1)}}};Renderer.prototype.hoverNode=function(node){this.m_hoveredNode=node;this.render(false,true)};Renderer.prototype.selectNode=function(node){if(node===null||node===this.m_selectedNode)this.clearSelected();else{this.m_selectedNode=node;this.m_selectedNode.postInfo()}this.render(false,true)};Renderer.prototype.multiselectNode=function(node){if(node===null)this.clearSelected();else{if(!this.removeFromMultiselection(node))this.addToMultiselection(node)}this.render(false,true)};Renderer.prototype.addToMultiselection=function(node){if(!node.multiselected){node.multiselected=true;this.m_multiselectedNodes.push(node)}};Renderer.prototype.removeFromMultiselection=function(node){if(node.multiselected){for(var i=0,n=this.m_multiselectedNodes.length;i<n;++i){if(this.m_multiselectedNodes[i]===node){node.multiselected=false;this.m_multiselectedNodes.splice(i,1);return true}}}return false};Renderer.prototype.selectRingSegment=function(){var _this=this;var f1=false;this.m_ringScaleWithSegmentSelected=null;if(this.m_ringScales){this.m_ringScales.forEach(function(rs){var rsf=rs.handleSelection();f1=f1||rsf;if(rs.segmentSelected)_this.m_ringScaleWithSegmentSelected=rs})}var f2=this.filterEdges();this.render(f1||f2,true)};Renderer.prototype.paintNodesByRingSegment=function(){var activeRS=null;var needsUpdate=false;if(this.m_ringScales){for(var i=0,n=this.m_ringScales.length;i<n;++i){activeRS=this.m_ringScales[i].contextSegment;if(activeRS)break}}if(activeRS){this.currentData().nodes.forEach(function(node){if(activeRS.containsAngle(node.rotation)){node.customColor=activeRS.color;needsUpdate=true}})}if(needsUpdate){this.currentData().nodes.forEach(function(node){node.invalidate(false)});this.render(true,true)}};Renderer.prototype.addEqualizerItem=function(){if(this.m_ringScales){for(var i=0,n=this.m_ringScales.length;i<n;++i){var segm=this.m_ringScales[i].contextSegment;if(segm){var needsCreate=true;for(var j=0,m=this.m_filtersManager.equalizer.length;j<m;++j){if(this.m_filtersManager.equalizer[j].matches(segm)){needsCreate=false;break}}if(needsCreate)this.m_filtersManager.equalizer.push(new SciViCGraph.EqualizerItem(this,segm,i));break}}}};Renderer.prototype.removeEqualizerItem=function(item){var idx=this.m_filtersManager.equalizer.indexOf(item);if(idx>-1){this.m_filtersManager.equalizer.splice(idx,1);this.updateNodesVisibility()}};Renderer.prototype.updateNodesVisibility=function(){var r1=this.filterNodes();var r2=this.filterEdges();if(r1||r2)this.render(true,true);this.m_filtersManager.validateCurrentFilterSet()};Renderer.prototype.updateEdgesVisibility=function(){if(this.filterEdges())this.render(true,true);this.m_filtersManager.validateCurrentFilterSet()};Renderer.prototype.showAllNodes=function(show){this.currentData().nodes.forEach(function(node){node.isShown=show});this.updateNodesVisibility()};Renderer.prototype.updateNodeNames=function(){this.reinit(false,false)};Renderer.prototype.updateNodeKlasses=function(){this.m_filtersManager.calcWeights();this.reinit(false,true)};Object.defineProperty(Renderer.prototype,"radius",{get:function(){return this.m_radius},enumerable:true,configurable:true});Object.defineProperty(Renderer.prototype,"localizer",{get:function(){return this.m_localizer},enumerable:true,configurable:true});Renderer.prototype.changeCurrentState=function(cs){if(this.m_states.isDynamic){this.m_states.data["current"]=null;this.m_currentStateKey=cs;this.currentData();this.m_filtersManager.calcWeights();this.m_stage.nodeWeight=this.m_filtersManager.nodeWeight;this.m_stage.edgeWeight=this.m_filtersManager.edgeWeight;this.m_filtersManager.initFilters()}else{this.m_currentStateKey=cs}this.reinit(false,false)};Renderer.prototype.changeCurrentStateToCalculated=function(){this.m_currentStateKey="calculated";this.m_filtersManager.calcWeights();this.m_stage.nodeWeight=this.m_filtersManager.nodeWeight;this.m_stage.edgeWeight=this.m_filtersManager.edgeWeight;this.m_filtersManager.initFilters();this.sortNodesByRingScale(false);this.m_stateLineNav.curtain();this.reinit(false,false)};Renderer.prototype.panGraph=function(x,y){var dx=x-this.m_panPrevX;var dy=y-this.m_panPrevY;var r=this.m_radius/2;this.m_panPrevX=x;this.m_panPrevY=y;this.m_renderingCache.x+=dx;this.m_renderingCache.y+=dy;if(this.m_renderingCache.x<-r)this.m_renderingCache.x=-r;else if(this.m_renderingCache.x>this.m_view.offsetWidth+r)this.m_renderingCache.x=this.m_view.offsetWidth+r;if(this.m_renderingCache.y<-r)this.m_renderingCache.y=-r;else if(this.m_renderingCache.y>this.m_view.offsetHeight+r)this.m_renderingCache.y=this.m_view.offsetHeight+r;this.render(true,false);this.m_panning=true};Renderer.prototype.hoverGraph=function(x,y){var lx=x-this.m_renderingCache.x;var ly=y-this.m_renderingCache.y;var s=this.m_renderingCache.currentScale();this.m_hoveredNode=this.getNodeByPosition(lx,ly,s);var f1=false;if(this.m_selectedNode)f1=this.m_selectedNode.handleCursorMove(lx,ly,s,x,y);var f2=false;var m=false;if(this.m_ringScales){this.m_ringScales.forEach(function(rs){var rsf=rs.handleCursorMove(lx,ly,s,x,y);m=m||rs.highlightedSegment!==null;f2=f2||rsf})}this.contextMenuEnabled=m;this.render(f1||f2,true)};Renderer.prototype.createTransientEdgeWithSourceNode=function(node){this.m_transientEdgeBatch=new SciViCGraph.EdgeBatch;this.m_transientEdge=new SciViCGraph.Edge(node,node,1,null);this.m_transientEdgeBatch.addEdge(this.m_transientEdge);this.m_transientEdge.highlight=HighlightType.Hover;this.m_transientEdge.isDirected=this.m_createDirectedEdges;this.m_stage.addChild(this.m_transientEdgeBatch);this.render(true,true)};Renderer.prototype.changeTransientEdge=function(){if(this.m_transientEdgeBatch){var lx=this.m_cursorPos.x-this.m_renderingCache.x;var ly=this.m_cursorPos.y-this.m_renderingCache.y;var s=this.m_renderingCache.currentScale();var node=this.getNodeByPosition(lx,ly,s);this.m_transientEdge.assignTarget(node);this.m_transientEdge.setCursorPos({x:lx/s,y:ly/s},this.m_radius);this.m_transientEdge.invalidate(false);this.m_transientEdge.highlight=HighlightType.Hover;this.render(true,true)}};Renderer.prototype.commitTransientEdge=function(){if(this.m_transientEdgeBatch){var needsReinit=this.m_transientEdge.target!==null;if(needsReinit){this.currentData().edges.push(this.m_transientEdge);if(!this.createDirectedEdges&&this.m_transientEdge.source!==this.m_transientEdge.target)this.currentData().edges.push(new SciViCGraph.Edge(this.m_transientEdge.target,this.m_transientEdge.source,1,null))}this.m_stage.removeChild(this.m_transientEdgeBatch);this.m_transientEdge=null;this.m_transientEdgeBatch=null;if(needsReinit){this.m_filtersManager.calcWeights();this.reinit(false,false)}else{this.render(true,true)}}};Renderer.prototype.dropTransientEdge=function(){if(this.m_transientEdgeBatch){this.m_stage.removeChild(this.m_transientEdgeBatch);this.m_transientEdge=null;this.m_transientEdgeBatch=null;this.render(true,true)}};Renderer.prototype.selectEdge=function(){if(this.m_selectedNode){if(this.m_selectedNode.handleClick())this.render(true,true)}};Renderer.prototype.deleteSelectedEdge=function(){if(this.m_selectedNode&&this.m_selectedNode.selectedEdge){var d=this.currentData();var n=d.edges.length;var i=0;for(;i<n;++i){if(d.edges[i]===this.m_selectedNode.selectedEdge)break}if(i<n){d.edges.splice(i,1);this.m_selectedNode.deleteSelectedEdge();this.reinit(false,false);if(this.m_cursorPos.x!==undefined&&this.m_cursorPos.y!==undefined)this.hoverGraph(this.m_cursorPos.x,this.m_cursorPos.y)}}};Renderer.prototype.startDragNode=function(x,y){var lx=x-this.m_renderingCache.x;var ly=y-this.m_renderingCache.y;var s=this.m_renderingCache.currentScale();if(this.m_edgesEditMode){this.m_transientEdgeSource=this.getNodeByPosition(lx,ly,s);return this.m_transientEdgeSource!==null}else{this.m_draggedNodeIndex=this.getNodeIndexByPosition(lx,ly,s);if(this.m_draggedNodeIndex>=0){if(this.m_nodeBorder===null){this.m_nodeBorder=new SciViCGraph.NodeBorder;this.m_stage.addChild(this.m_nodeBorder)}this.m_nodeBorder.showForNode(this.currentData().nodes[this.m_draggedNodeIndex]);this.render(true,true);return true}}return false};Renderer.prototype.dragNode=function(x,y){var offset=20;if(this.m_nodePlaceHolder&&this.m_nodePlaceHolder.visible){$(".scivi_graph_tooltip").css({top:y,left:x+offset,position:"absolute"})}else{var draggingNode=this.currentData().nodes[this.m_draggedNodeIndex];$(".scivi_graph_tooltip").html(draggingNode.label);$(".scivi_graph_tooltip").css({top:y,left:x+offset});$(".scivi_graph_tooltip").stop(true);$(".scivi_graph_tooltip").fadeIn(100);$(".scivi_graph_tooltip")[0]["host"]=this;if(!this.m_nodePlaceHolder){this.m_nodePlaceHolder=new SciViCGraph.NodePlaceHolder(this.m_radius,this.m_radius+this.m_maxTextLength);this.m_stage.addChild(this.m_nodePlaceHolder)}this.m_nodePlaceHolder.visible=true}var lx=x-this.m_renderingCache.x;var ly=y-this.m_renderingCache.y;var idx=this.getAngularIndex(lx,ly);var a=(idx-.5)*(2*Math.PI/this.currentData().nodes.length);if(this.m_nodePlaceHolder.rotation!==a){this.m_nodePlaceHolder.rotation=a;this.render(true,true)}};Renderer.prototype.dropNode=function(x,y){var result=false;var needsReinit=false;if(this.m_draggedNodeIndex!==-1&&this.m_nodePlaceHolder&&this.m_nodePlaceHolder.visible){var n=this.currentData().nodes.length;var lx=x-this.m_renderingCache.x;var ly=y-this.m_renderingCache.y;var idx=this.getAngularIndex(lx,ly);if(idx>this.m_draggedNodeIndex)--idx;else if(idx==0&&this.m_draggedNodeIndex>n/2)idx=n-1;if(idx!==this.m_draggedNodeIndex){var dNode=this.currentData().nodes[this.m_draggedNodeIndex];this.currentData().nodes.splice(this.m_draggedNodeIndex,1);this.currentData().nodes.splice(idx,0,dNode);needsReinit=true}result=true}this.stopDragNode();if(needsReinit)this.reinit(false,false);else this.render(true,true);return result};Renderer.prototype.stopDragNode=function(){if(this.m_nodePlaceHolder)this.m_nodePlaceHolder.visible=false;if($(".scivi_graph_tooltip")[0]["host"]===this){$(".scivi_graph_tooltip").stop(true);$(".scivi_graph_tooltip").fadeOut(100)}this.m_draggedNodeIndex=-1;if(this.m_nodeBorder)this.m_nodeBorder.showForNode(null)};Renderer.prototype.startDragRing=function(x,y){var lx=x-this.m_renderingCache.x;var ly=y-this.m_renderingCache.y;var s=this.m_renderingCache.currentScale();this.m_draggedRingIndex=this.getRingIndexByPosition(lx,ly,s);if(this.m_draggedRingIndex>=0){if(this.m_ringBorder===null){this.m_ringBorder=new SciViCGraph.RingBorder;this.m_stage.addChild(this.m_ringBorder)}var draggingRing=this.m_ringScales[this.m_draggedRingIndex];this.m_ringBorder.showForRing(draggingRing);this.render(true,true);return true}return false};Renderer.prototype.dragRing=function(x,y){if(!this.m_ringPlaceHolder){this.m_ringPlaceHolder=new SciViCGraph.RingPlaceHolder;this.m_stage.addChild(this.m_ringPlaceHolder)}var r=[0];var lx=x-this.m_renderingCache.x;var ly=y-this.m_renderingCache.y;var s=this.m_renderingCache.currentScale();var idx=this.getRingIndexByPosition(lx,ly,s,r);if(this.m_ringPlaceHolder.showForRing(r[0])){this.m_ringScales[this.m_draggedRingIndex].dropHighlight();this.render(true,true)}};Renderer.prototype.dropRing=function(x,y){var result=false;var needsReinit=false;if(this.m_draggedRingIndex!==-1&&this.m_ringPlaceHolder&&this.m_ringPlaceHolder.visible){var r=[0];var lx=x-this.m_renderingCache.x;var ly=y-this.m_renderingCache.y;var s=this.m_renderingCache.currentScale();var idx=this.getRingIndexByPosition(lx,ly,s,r);if(this.m_draggedRingIndex-idx>0||this.m_draggedRingIndex-idx<-1){if(idx>this.m_draggedRingIndex)--idx;if(idx<0)idx=0;else if(idx===this.m_scaleLevels.length)idx=this.m_scaleLevels.length-1;var i1=this.m_scaleLevels.length-this.m_draggedRingIndex-1;var i2=this.m_scaleLevels.length-idx-1;var dScaleLevel=this.m_scaleLevels[i1];this.m_scaleLevels.splice(i1,1);this.m_scaleLevels.splice(i2,0,dScaleLevel);needsReinit=true}result=true}this.stopDragRing();if(needsReinit)this.reinit(false,false);else this.render(true,true);this.hoverGraph(x,y);return result};Renderer.prototype.stopDragRing=function(){if(this.m_ringPlaceHolder)this.m_ringPlaceHolder.showForRing(-1);this.m_draggedRingIndex=-1;if(this.m_ringBorder)this.m_ringBorder.showForRing(null)};Object.defineProperty(Renderer.prototype,"contextMenuEnabled",{set:function(enabled){$("#"+this.m_view.id).contextMenu(enabled)},enumerable:true,configurable:true});Renderer.prototype.downloadFile=function(filename,content){var element=document.createElement("a");element.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(content));element.setAttribute("download",filename);element.style.display="none";document.body.appendChild(element);element.click();document.body.removeChild(element)};Object.defineProperty(Renderer.prototype,"maxNumberOfNodes",{get:function(){return this.m_filtersManager.maxNumberOfNodes},enumerable:true,configurable:true});Object.defineProperty(Renderer.prototype,"maxNumberOfEdges",{get:function(){return this.m_filtersManager.maxNumberOfEdges},enumerable:true,configurable:true});Renderer.prototype.saveGraph=function(){var filename=prompt("Enter name of file to save","graph.csv");if(!filename)return;if(filename.indexOf(".")===-1)filename+=".csv";var n=0;var nodeIndices={};this.currentData().nodes.forEach(function(node){if(node.visible){nodeIndices[node.positionHash()]=n;++n}});var sMap=[];for(var i=0,m=n+1;i<m;++i){var line=[];for(var j=0,k=n+2;j<k;++j)line.push("");sMap.push(line)}var index=0;this.currentData().nodes.forEach(function(node){if(node.visible){var index_1=nodeIndices[node.positionHash()]+1;sMap[0][index_1]='"'+node.label+'"';sMap[index_1][0]='"'+node.label+'"';sMap[index_1][n+1]=node.weight}});sMap[0][n+1]="Weight";this.currentData().edges.forEach(function(edge){if(edge.visible&&edge.source.visible&&edge.target.visible){sMap[nodeIndices[edge.source.positionHash()]+1][nodeIndices[edge.target.positionHash()]+1]=edge.weight}});var csv="";sMap.forEach(function(line){csv+=line.join(",")+"\n"});this.downloadFile(filename,csv)};Renderer.prototype.selectGraphState=function(stateName){this.m_stateLineNav.selectState(stateName)};Renderer.prototype.loadFilterSet=function(filterSet){this.m_filtersManager.loadFilterSet(filterSet)};Object.defineProperty(Renderer.prototype,"edgesEditMode",{get:function(){return this.m_edgesEditMode},set:function(eem){this.m_edgesEditMode=eem;$("#scivi_edge_edit").prop("checked",eem)},enumerable:true,configurable:true});Object.defineProperty(Renderer.prototype,"createDirectedEdges",{get:function(){return this.m_createDirectedEdges},set:function(cde){this.m_createDirectedEdges=cde;$("#scivi_create_directed_edges").prop("checked",cde)},enumerable:true,configurable:true});Renderer.m_ringScaleWidth=30;Renderer.m_minFontSize=5;Renderer.m_maxFontSize=50;return Renderer}();SciViCGraph.Renderer=Renderer})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var RenderingCache=function(){function RenderingCache(m_stage,m_renderer){var _this=this;this.m_stage=m_stage;this.m_renderer=m_renderer;this.m_cache=null;this.m_displayer=null;this.m_transition=new PIXI.Filter(this.vCode(),this.fCode());this.m_transition.enabled=false;this.m_transition.apply=function(filterManager,input,output,clear){_this.m_transition.uniforms.dimensions[0]=input.sourceFrame.width;_this.m_transition.uniforms.dimensions[1]=input.sourceFrame.height;filterManager.applyFilter(_this.m_transition,input,output,clear)};this.m_timeStamp=0}RenderingCache.prototype.vCode=function(){return""+"uniform mat3 projectionMatrix;\n"+"attribute vec2 aVertexPosition;\n"+"attribute vec2 aTextureCoord;\n"+"varying vec2 vTextureCoord;\n"+"void main(void)\n"+"{\n"+"    vTextureCoord = aTextureCoord;\n"+"    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n"+"}\n"};RenderingCache.prototype.fCode=function(){return""+"precision highp float;\n"+"precision lowp int;\n"+"uniform sampler2D uSampler;\n"+"uniform vec4 filterArea;\n"+"uniform vec2 dimensions;\n"+"uniform float uFactor;\n"+"varying vec2 vTextureCoord;\n"+"vec2 map(vec2 uv)\n"+"{\n"+"    return uv * filterArea.xy / dimensions;\n"+"}\n"+"vec2 unmap(vec2 uv)\n"+"{\n"+"    return uv * dimensions / filterArea.xy;\n"+"}\n"+"vec3 rgb2hsv(vec3 c)\n"+"{\n"+"    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n"+"    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n"+"    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n"+"    float d = q.x - min(q.w, q.y);\n"+"    float e = 1.0e-10;\n"+"    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n"+"}\n"+"vec3 hsv2rgb(vec3 c)\n"+"{\n"+"    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n"+"    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n"+"    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n"+"}\n"+"float shockwave(float d, float t)\n"+"{\n"+"    const float len = 0.1;\n"+"    const float phase = 10.0;\n"+"    const float strength = 0.8;\n"+"    float diff = d - t;\n"+"    float powDiff = 1.0 - pow(abs(diff * phase), strength);\n"+"    return diff * powDiff * step(d, t + len) * step(t - len, d);\n"+"}\n"+"vec4 vignet(float d, float t)\n"+"{\n"+"    const float feather = 0.08;\n"+"    return vec4(1.0, 1.0, 1.0, smoothstep(1.0, 0.0, clamp((d - t) / feather, 0.0, 1.0)));\n"+"}\n"+"void main()\n"+"{\n"+"    const vec2 center = vec2(0.5, 0.5);\n"+"    const float specStrength = 10.0;\n"+"    vec2 texCoord = map(vTextureCoord);\n"+"    float d = distance(texCoord, center);\n"+"    float t = uFactor * 0.5;\n"+"    float sw = shockwave(d, t);\n"+"    float ssw = abs(sw * specStrength);\n"+"    vec2 offset = normalize(texCoord - center);\n"+"    vec4 mask = vignet(d, t);\n"+"    vec4 color = texture2D(uSampler, unmap(texCoord + offset * sw));\n"+"    vec3 hsv = rgb2hsv(color.rgb);\n"+"    hsv.yz = clamp(hsv.yz + vec2(ssw), 0.0, 1.0);\n"+"    color = vec4(hsv2rgb(hsv), clamp(color.a + ssw, 0.0, 1.0) * (1.0 - step(color.a, 0.0)));\n"+"    gl_FragColor = color * mask;\n"+"}\n"};RenderingCache.prototype.renderTransition=function(){var _this=this;var t=Date.now();var delta=(t-this.m_timeStamp)/1e3;var speed=1/RenderingCache.m_transitionDuration;this.m_transition.uniforms.uFactor+=speed*delta;this.m_timeStamp=t;if(this.m_transition.uniforms.uFactor<1.3){this.render();requestAnimationFrame(function(){_this.renderTransition()})}else{this.m_transition.enabled=false;this.render()}};RenderingCache.prototype.init=function(radius,screenWidth,screenHeight){var s=(radius+4)*this.m_stage.scale.x*2;this.m_cache=PIXI.RenderTexture.create(s,s,PIXI.SCALE_MODES.LINEAR,2);this.m_displayer=new PIXI.Sprite(this.m_cache);s=s/2;this.m_stage.position.set(s,s);this.m_displayer.position.set(screenWidth/2,screenHeight/2);this.m_displayer.anchor.set(.5,.5);this.m_transition.resolution=window.devicePixelRatio;this.m_displayer.filters=[this.m_transition]};RenderingCache.prototype.update=function(){this.m_renderer.render(this.m_stage,this.m_cache)};RenderingCache.prototype.render=function(){this.m_renderer.render(this.m_displayer)};RenderingCache.prototype.transit=function(){this.m_transition.uniforms.uFactor=0;this.m_transition.enabled=true;this.m_timeStamp=Date.now();this.renderTransition()};RenderingCache.prototype.currentScale=function(){return this.m_stage.scale.x*this.m_displayer.scale.x};Object.defineProperty(RenderingCache.prototype,"isValid",{get:function(){return this.m_displayer!==null},enumerable:true,configurable:true});Object.defineProperty(RenderingCache.prototype,"x",{get:function(){return this.m_displayer.position.x},set:function(value){this.m_displayer.position.x=value},enumerable:true,configurable:true});Object.defineProperty(RenderingCache.prototype,"y",{get:function(){return this.m_displayer.position.y},set:function(value){this.m_displayer.position.y=value},enumerable:true,configurable:true});Object.defineProperty(RenderingCache.prototype,"scale",{get:function(){return this.m_displayer.scale.x},set:function(value){this.m_displayer.scale.set(value,value)},enumerable:true,configurable:true});RenderingCache.m_transitionDuration=1;return RenderingCache}();SciViCGraph.RenderingCache=RenderingCache})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var RingBorder=function(_super){__extends(RingBorder,_super);function RingBorder(){var _this=_super.call(this)||this;_this.addColor({from:16595968,to:16595968,alpha:.5});return _this}RingBorder.prototype.showForRing=function(ring){if(ring===null)this.visible=false;else{this.clear();this.lineStyle(ring.width,0,1);this.arc(0,0,ring.radius,0,2*Math.PI+.001,false);this.visible=true}};return RingBorder}(SciViCGraph.Curve);SciViCGraph.RingBorder=RingBorder})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var RingPlaceHolder=function(_super){__extends(RingPlaceHolder,_super);function RingPlaceHolder(){var _this=_super.call(this)||this;_this.addColor({from:16595968,to:16595968,alpha:1});_this.m_radius=-1;return _this}RingPlaceHolder.prototype.showForRing=function(radius){if(radius!==this.m_radius){this.m_radius=radius;if(radius===-1){this.visible=false}else{this.visible=true;this.clear();this.lineStyle(6,0,1);this.arc(0,0,radius,0,2*Math.PI+.001,false)}return true}return false};return RingPlaceHolder}(SciViCGraph.Curve);SciViCGraph.RingPlaceHolder=RingPlaceHolder})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var RingScale=function(_super){__extends(RingScale,_super);function RingScale(m_inRadius,m_outRadius,m_width,m_fontSize,m_container){var _this=_super.call(this)||this;_this.m_inRadius=m_inRadius;_this.m_outRadius=m_outRadius;_this.m_width=m_width;_this.m_fontSize=m_fontSize;_this.m_container=m_container;_this.m_highlights=[];_this.m_highlightedSegment=-1;_this.m_selections=[];_this.m_selectedSegment=-1;_this.m_names=[];_this.m_contextSegment=-1;_this.m_hashedSegmentIndices={};return _this}RingScale.prototype.addSegment=function(from,to,color,textColor,name,sHash){var c={from:color,to:color,alpha:1};var as=Math.sin(from);var ac=Math.cos(from);var r=this.m_outRadius+this.m_width/2;this.lineStyle(1,0,1);this.m_colors.push(c);this.moveTo(this.m_inRadius*ac,this.m_inRadius*as);this.lineTo(r*ac,r*as);this.moveTo(this.m_outRadius*ac,this.m_outRadius*as);this.lineStyle(this.m_width,0,1);this.m_colors.push(c);this.arc(0,0,this.m_outRadius,from,to,false);var letterLen=this.m_fontSize/2;var arcLen=this.m_outRadius*(to-from);var n=Math.min(name.length,Math.floor(arcLen/letterLen));var textLen=letterLen*n;var aStep=letterLen/this.m_outRadius;var phi=(to+from)/2;var flipFlop=phi>=Math.PI;for(var i=0;i<n;++i){var a=phi;if(flipFlop)a+=i*aStep-aStep*n*.5+aStep*.75;else a-=i*aStep-aStep*n*.5+aStep*.25;this.addText(name.charAt(i),a,flipFlop,this.m_outRadius,textColor)}r=this.m_outRadius-this.m_width/2;var hl=new SciViCGraph.RingScaleSegment(from,to,r-this.m_inRadius,(r+this.m_inRadius)/2,color,.1,name,textColor,sHash);this.addChild(hl);this.m_highlights.push(hl);var sl=new SciViCGraph.RingScaleSegment(from,to,this.m_width,this.m_outRadius,16595968,.5,name,textColor,sHash);this.addChild(sl);this.m_hashedSegmentIndices[sHash]=this.m_selections.length;this.m_selections.push(sl);this.m_names.push(name)};RingScale.prototype.hitWithPoint=function(x,y,s){var r=x*x+y*y;var w=this.m_width/2;var inRing=this.m_outRadius-w;var outRing=this.m_outRadius+w;s*=s;return r>inRing*inRing*s&&r<outRing*outRing*s};RingScale.prototype.handleCursorMove=function(x,y,s,gx,gy){var offset=20;if(this.hitWithPoint(x,y,s)){var a=Math.atan2(y,x);if(a<0)a+=2*Math.PI;for(var i=0,n=this.m_highlights.length;i<n;++i){if(this.m_highlights[i].containsAngle(a)){if(i!==this.m_highlightedSegment){if(this.m_highlightedSegment!==-1&&this.m_selectedSegment!==this.m_highlightedSegment)this.m_highlights[this.m_highlightedSegment].visible=false;this.m_highlightedSegment=i;this.m_contextSegment=i;this.m_highlights[i].visible=true;if(this.m_names[i].length>0){$(".scivi_graph_tooltip").html(this.m_names[i]);$(".scivi_graph_tooltip").css({top:gy,left:gx+offset});$(".scivi_graph_tooltip").stop(true);$(".scivi_graph_tooltip").fadeIn(100);$(".scivi_graph_tooltip")[0]["host"]=this}else{$(".scivi_graph_tooltip").stop(true);$(".scivi_graph_tooltip").fadeOut(100)}return true}$(".scivi_graph_tooltip").css({top:gy,left:gx+offset,position:"absolute"});return false}}}else{this.m_contextSegment=-1;return this.dropHighlight()}return false};RingScale.prototype.dropHighlight=function(){if(this.m_highlightedSegment!==-1){if(this.m_selectedSegment!==this.m_highlightedSegment)this.m_highlights[this.m_highlightedSegment].visible=false;this.m_highlightedSegment=-1;if($(".scivi_graph_tooltip")[0]["host"]===this){$(".scivi_graph_tooltip").stop(true);$(".scivi_graph_tooltip").fadeOut(100)}return true}return false};RingScale.prototype.handleSelection=function(){var result=false;if(this.m_selectedSegment!==-1){if(this.m_selectedSegment!==this.m_contextSegment)this.m_highlights[this.m_selectedSegment].visible=false;this.m_selections[this.m_selectedSegment].visible=false;result=true}if(this.m_highlightedSegment===this.m_selectedSegment&&this.m_highlightedSegment!==-1)this.m_selectedSegment=-1;else{this.m_selectedSegment=this.m_contextSegment;if(this.m_selectedSegment!==-1){this.m_selections[this.m_selectedSegment].visible=true;this.m_highlights[this.m_selectedSegment].visible=true;result=true}}return result};RingScale.prototype.addText=function(label,a,flipFlop,r,textColor){var text=new PIXI.Text(label);text.style=new PIXI.TextStyle({fontFamily:"Lucida Console, Monaco, monospace",fontSize:this.m_fontSize.toString()+"px",fontWeight:"bold",fill:SciViCGraph.color2string(textColor)});text.position.set(r*Math.cos(a),r*Math.sin(a));text.rotation=a-Math.PI/2;if(flipFlop){text.scale.set(-.5,-.5);text.anchor.set(1,.5)}else{text.scale.set(.5,.5);text.anchor.set(0,.5)}this.addChild(text)};RingScale.prototype.nodeInSelectedSegment=function(node){return this.m_selectedSegment!==-1&&this.m_selections[this.m_selectedSegment].containsAngle(node.rotation)};RingScale.prototype.copySelection=function(rs){var slSegment=rs.selectedSegment;if(slSegment){var idx=this.m_hashedSegmentIndices[slSegment.segmentHash];if(idx!==undefined){this.m_selectedSegment=idx;this.m_highlightedSegment=idx;this.m_selections[this.m_selectedSegment].visible=true;this.m_highlights[this.m_highlightedSegment].visible=true}}};Object.defineProperty(RingScale.prototype,"radius",{get:function(){return this.m_outRadius},enumerable:true,configurable:true});Object.defineProperty(RingScale.prototype,"width",{get:function(){return this.m_width},enumerable:true,configurable:true});Object.defineProperty(RingScale.prototype,"segmentSelected",{get:function(){return this.m_selectedSegment!==-1},enumerable:true,configurable:true});Object.defineProperty(RingScale.prototype,"highlightedSegment",{get:function(){return this.m_highlightedSegment===-1?null:this.m_highlights[this.m_highlightedSegment]},enumerable:true,configurable:true});Object.defineProperty(RingScale.prototype,"selectedSegment",{get:function(){return this.m_selectedSegment===-1?null:this.m_selections[this.m_selectedSegment]},enumerable:true,configurable:true});Object.defineProperty(RingScale.prototype,"contextSegment",{get:function(){return this.m_contextSegment===-1?null:this.m_highlights[this.m_contextSegment]},enumerable:true,configurable:true});RingScale.prototype.segmentByHash=function(h){return this.m_highlights[this.m_hashedSegmentIndices[h]]};return RingScale}(SciViCGraph.Curve);SciViCGraph.RingScale=RingScale})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var RingScaleSegment=function(_super){__extends(RingScaleSegment,_super);function RingScaleSegment(m_from,m_to,m_width,m_radius,m_color,m_alpha,m_name,m_textColor,m_hash){var _this=_super.call(this)||this;_this.m_from=m_from;_this.m_to=m_to;_this.m_width=m_width;_this.m_radius=m_radius;_this.m_color=m_color;_this.m_alpha=m_alpha;_this.m_name=m_name;_this.m_textColor=m_textColor;_this.m_hash=m_hash;_this.lineStyle(_this.m_width,0,1);_this.m_colors.push({from:_this.m_color,to:_this.m_color,alpha:_this.m_alpha});_this.arc(0,0,_this.m_radius,_this.m_from,_this.m_to,false);_this.visible=false;return _this}RingScaleSegment.prototype.containsAngle=function(angle){if(angle<0)angle+=2*Math.PI;if(this.m_from<0){if(this.m_to<0)angle-=2*Math.PI;else return angle-2*Math.PI>=this.m_from||angle<this.m_to}return angle>=this.m_from&&angle<this.m_to};Object.defineProperty(RingScaleSegment.prototype,"fromAngle",{get:function(){return this.m_from},enumerable:true,configurable:true});Object.defineProperty(RingScaleSegment.prototype,"toAngle",{get:function(){return this.m_to},enumerable:true,configurable:true});Object.defineProperty(RingScaleSegment.prototype,"radius",{get:function(){return this.m_radius},enumerable:true,configurable:true});Object.defineProperty(RingScaleSegment.prototype,"color",{get:function(){return this.m_color},enumerable:true,configurable:true});Object.defineProperty(RingScaleSegment.prototype,"name",{get:function(){return this.m_name},enumerable:true,configurable:true});Object.defineProperty(RingScaleSegment.prototype,"textColor",{get:function(){return this.m_textColor},enumerable:true,configurable:true});Object.defineProperty(RingScaleSegment.prototype,"segmentHash",{get:function(){return this.m_hash},enumerable:true,configurable:true});RingScaleSegment.prototype.matches=function(segment){return this.m_from===segment.fromAngle&&this.m_to===segment.toAngle&&this.m_radius===segment.radius};RingScaleSegment.prototype.doCopy=function(){return new RingScaleSegment(this.m_from,this.m_to,this.m_width,this.m_radius,this.m_color,this.m_alpha,this.m_name,this.m_textColor,this.m_hash)};return RingScaleSegment}(SciViCGraph.Curve);SciViCGraph.RingScaleSegment=RingScaleSegment})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var Scale=function(){function Scale(m_steps,m_colors,m_textColors,m_names,getValue){this.m_steps=m_steps;this.m_colors=m_colors;this.m_textColors=m_textColors;this.m_names=m_names;this.getValue=getValue;this.m_applicable=true;this.m_id=-1}Scale.prototype.checkApplicability=function(nodes){this.m_applicable=false;for(var i=0,n=nodes.length;i<n;++i){if(this.classifyNode(nodes[i])!==undefined){this.m_applicable=true;break}}return this.m_applicable};Object.defineProperty(Scale.prototype,"applicable",{get:function(){return this.m_applicable},enumerable:true,configurable:true});Scale.prototype.classifyNode=function(node){return this.getStepID(node)};Scale.prototype.getStepID=function(node){var n=this.m_steps.length;var i=0;for(;i<n;++i){if(this.getValue(node)<this.m_steps[i])break}return i};Scale.prototype.getName=function(id){return this.m_names[id]};Scale.prototype.getColor=function(id){return this.m_colors[id%this.m_colors.length]};Scale.prototype.getTextColor=function(id){return this.m_textColors[id%this.m_textColors.length]};Object.defineProperty(Scale.prototype,"id",{get:function(){return this.m_id},set:function(i){this.m_id=i},enumerable:true,configurable:true});return Scale}();SciViCGraph.Scale=Scale;var DiscreteScale=function(_super){__extends(DiscreteScale,_super);function DiscreteScale(){return _super!==null&&_super.apply(this,arguments)||this}DiscreteScale.prototype.getStepID=function(node){var v=this.getValue(node);for(var i=0,n=this.m_steps.length;i<n;++i){if(SciViCGraph.Geometry.sortedArrayIncludesValue(this.m_steps[i],v))return i}return undefined};return DiscreteScale}(Scale);SciViCGraph.DiscreteScale=DiscreteScale})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var Scene=function(_super){__extends(Scene,_super);function Scene(colors,edgeWeight,nodeWeight){var _this=_super.call(this)||this;_this.colors=colors;_this.edgeWeight=edgeWeight;_this.nodeWeight=nodeWeight;return _this}return Scene}(PIXI.Container);SciViCGraph.Scene=Scene})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var StateLineNavigator=function(){function StateLineNavigator(m_renderer,m_container){this.m_renderer=m_renderer;this.m_container=m_container;this.m_curtain=null;this.m_currentKeyIndices=null;this.m_sliders=null}StateLineNavigator.prototype.extractIndexFromKey=function(key,stateLineIndex){return parseInt(key.split("|")[stateLineIndex])};StateLineNavigator.prototype.changeCurrentState=function(stateLineIndex,stateIndex){this.m_currentKeyIndices[stateLineIndex]=stateIndex;this.m_renderer.changeCurrentState(this.m_currentKeyIndices.join("|"))};StateLineNavigator.prototype.createStateLine=function(labels,stateLineIndex){var _this=this;var strIndex=stateLineIndex.toString();var keyIndex=this.extractIndexFromKey(this.m_renderer.currentStateKey,stateLineIndex);this.m_currentKeyIndices[stateLineIndex]=keyIndex;var result=$("<div/>");result.css("width","100%");result.css("height","50px");var line=$("<div/>");line.attr("id","scivi_stateline_slider_"+strIndex);line.attr("class","scivi_stateline");line.css("width","100%");line.slider({value:keyIndex,min:0,max:labels.length-1,step:1,slide:function(event,ui){_this.changeCurrentState(stateLineIndex,ui.value)}}).each(function(){var n=labels.length-1;for(var i=0;i<=n;++i){var el=$("<label class='scivi_stateline_label scivi_stateline_label_"+strIndex+"'><span style='color: #c5c5c5;'>|</span><br/>"+labels[i]+"</label>");el.css("left",i/n*100+"%");line.append(el)}});this.m_sliders.push(line);result.append(line);return result};StateLineNavigator.prototype.build=function(){var _this=this;if(this.m_container){this.m_currentKeyIndices=[];this.m_sliders=[];this.m_renderer.states.stateLines.forEach(function(){_this.m_currentKeyIndices.push(0)});this.m_renderer.states.stateLines.forEach(function(sl,index){$(_this.m_container).append(_this.createStateLine(sl,index))});this.updateStateLineLabels()}};StateLineNavigator.prototype.updateStateLineLabels=function(){var _this=this;if(this.m_container){var m_1=0;for(var i=0,n=this.m_renderer.states.stateLines.length;i<n;++i){if(this.m_renderer.states.stateLines[i].length>m_1)m_1=this.m_renderer.states.stateLines[i].length}m_1=this.m_container.clientWidth/m_1;var p=m_1/2+"px";$("#scivi_cgraph_stateline").css("padding-left",p);$("#scivi_cgraph_stateline").css("padding-right",p);this.m_renderer.states.stateLines.forEach(function(sl,index){var sel=".scivi_stateline_label_"+index.toString();var w=(_this.m_container.clientWidth-m_1)/sl.length;if(w<30)w=30;else if(w>m_1)w=m_1;$(sel).css("width",w+"px");$(sel).css("margin-left",-w*.5+"px")})}};StateLineNavigator.prototype.curtain=function(){var _this=this;if(!this.m_curtain){this.m_curtain=$("<div class='scivi_state_line_curtain'>");var bg=$("<div class='scivi_state_line_curtain_bg'>");var lbl=$("<div class='scivi_state_line_curtain_lbl'>");lbl.html(this.m_renderer.localizer["LOC_STATECALCULATED"]);lbl.click(function(){_this.m_curtain.detach();_this.m_renderer.changeCurrentState(_this.m_currentKeyIndices.join("|"))});bg.append(lbl);this.m_curtain.append(bg)}$(this.m_container).append(this.m_curtain)};StateLineNavigator.prototype.selectState=function(name){if(this.m_container){for(var i=0,n=this.m_renderer.states.stateLines.length;i<n;++i){var line=this.m_renderer.states.stateLines[i];for(var j=0,m=line.length;j<m;++j){var stateName=line[j];if(stateName.substring(0,name.length)===name){this.m_sliders[i].slider("value",j);this.changeCurrentState(i,j);break}}}}};return StateLineNavigator}();SciViCGraph.StateLineNavigator=StateLineNavigator})(SciViCGraph||(SciViCGraph={}));var SciViCGraph;(function(SciViCGraph){var Stats=function(){function Stats(m_stats,m_svRenderer){var _this=this;this.m_stats=m_stats;this.m_svRenderer=m_svRenderer;this.m_chart=null;Chart.defaults.global.tooltips.backgroundColor="rgba(254, 254, 255, 0.9)";Chart.defaults.global.tooltips.titleFontColor="#000";Chart.defaults.global.tooltips.bodyFontColor="#000";Chart.defaults.global.tooltips.borderColor="rgba(51, 51, 51, 1)",Chart.defaults.global.tooltips.cornerRadius=5;Chart.defaults.global.tooltips.borderWidth=1;Chart.defaults.global.tooltips.multiKeyBackground="#000";Chart.defaults.global.hover.onHover=function(event,points){_this.chartHovered(points)};Chart.defaults.global.onClick=function(event,points){_this.chartClicked(points)};Chart.defaults.global.maintainAspectRatio=false;this.m_data={datasets:[],labels:[]};this.m_nodes=null;this.m_tooltip=null;this.m_list=null;this.m_graphStat=null;this.m_nodesCount=0;this.m_nodesWeight=0;this.m_edgesCount=0;this.m_edgesWeight=0;this.m_clInput=null;this.m_clWrapper=null;this.m_selectedGroupIndex=-1}Stats.prototype.color2rgb=function(c){return"rgb("+(c>>16&255)+", "+(c>>8&255)+", "+(c&255)+")"};Stats.prototype.rgbString2color=function(rgb){var arr=rgb.split("(")[1].split(")")[0].split(",");var result=arr.map(function(x){x=parseInt(x).toString(16);return x.length===1?"0"+x:x});return"#"+result.join("")};Stats.prototype.color2RGBString=function(c){return this.color2rgb(SciViCGraph.string2color(c))};Stats.prototype.countGroupContent=function(nodes){this.m_nodes=nodes;var result=[];this.m_nodes.forEach(function(node){if(node.visible){var n=node.groupID-result.length;for(var i=n;i>=0;--i)result.push(0);result[node.groupID]++}});return result};Stats.prototype.convertColors=function(colors,n){var result=[];for(var i=0;i<n;++i)result.push(this.color2rgb(colors[i]));return result};Stats.prototype.generateGroupNames=function(n){var result=[];for(var i=1;i<=n;++i)result.push(this.m_svRenderer.localizer["LOC_GROUP"]+" "+i);return result};Stats.prototype.chartHovered=function(points){this.m_svRenderer.highlightGroup(points.length>0?points[0]._index:undefined)};Stats.prototype.chartClicked=function(points){var _this=this;if(points.length>0){this.m_selectedGroupIndex=points[0]._index;var clLabel=document.createElement("span");clLabel.innerHTML=this.m_svRenderer.localizer["LOC_GROUP"]+": "+(this.m_selectedGroupIndex+1)+". "+this.m_svRenderer.localizer["LOC_COLOR"]+":&nbsp;";var cl=this.rgbString2color(points[0]._view.backgroundColor);this.m_clWrapper=document.createElement("div");this.m_clWrapper.innerHTML="&nbsp;";this.m_clWrapper.className="scivi_color_wrapper";this.m_clWrapper.style.backgroundColor=cl;this.m_clInput=this.m_svRenderer.createColorPicker({parent:this.m_clWrapper,color:cl,alpha:false,onDone:function(color){var c=color.hex.substring(0,7);_this.m_clWrapper.style.backgroundColor=c;_this.m_svRenderer.changeGroupColor(_this.m_selectedGroupIndex,c);points[0]._view.backgroundColor=_this.color2RGBString(c)}});var qZoomIn=null;if(this.m_svRenderer.canQuasiZoomIn()){qZoomIn=document.createElement("div");qZoomIn.className="scivi_button";qZoomIn.innerHTML=this.m_svRenderer.localizer["LOC_ENTERGROUP"];qZoomIn.onclick=function(){_this.m_svRenderer.quasiZoomIn(_this.m_selectedGroupIndex);_this.chartClicked(points)}}var qZoomOut=null;if(this.m_svRenderer.canQuasiZoomOut()){qZoomOut=document.createElement("div");qZoomOut.className="scivi_button";qZoomOut.innerHTML=this.m_svRenderer.localizer["LOC_LEAVEGROUP"];qZoomOut.onclick=function(){_this.m_svRenderer.quasiZoomOut();_this.clearSelection()}}var listHolder=document.createElement("div");this.m_svRenderer.clearSelected();var list_1="<ul>";this.m_nodes.forEach(function(node){if(node.visible&&node.groupID===points[0]._index){list_1+="<li>"+node.label+"</li>";_this.m_svRenderer.addToMultiselection(node)}});list_1+="</ul>";listHolder.innerHTML=list_1;this.m_svRenderer.render(false,true);while(this.m_list.firstChild)this.m_list.removeChild(this.m_list.firstChild);this.m_list.appendChild(clLabel);this.m_list.appendChild(this.m_clWrapper);if(qZoomIn)this.m_list.appendChild(qZoomIn);if(qZoomOut)this.m_list.appendChild(qZoomOut);this.m_list.appendChild(listHolder)}else{this.clearSelection()}};Stats.prototype.clearSelection=function(){var hint=document.createElement("div");hint.innerHTML=this.m_svRenderer.localizer["LOC_STATSTUB"];while(this.m_list.firstChild)this.m_list.removeChild(this.m_list.firstChild);this.m_list.appendChild(hint);this.m_clInput=null;this.m_clWrapper=null;this.m_selectedGroupIndex=-1;this.m_svRenderer.clearSelected();this.m_svRenderer.render(false,true)};Stats.prototype.chartCaption=function(n){return this.m_svRenderer.localizer["LOC_STATCAPTION"]+n+")"};Stats.prototype.buildChart=function(nodes,colors){var data=this.countGroupContent(nodes);this.m_data.datasets=[{data:data,backgroundColor:this.convertColors(colors,data.length)}];this.m_data.labels=this.generateGroupNames(data.length);if(this.m_selectedGroupIndex>=0){var c=SciViCGraph.color2string(colors[this.m_selectedGroupIndex]);this.m_clWrapper.style.backgroundColor=c;this.m_clInput.setColor(c,true)}if(this.m_chart){this.clearSelection();this.m_chart.config.options.title.text=this.chartCaption(data.length);this.m_chart.update()}else{var cvs=document.createElement("canvas");var divChart=document.createElement("div");this.m_graphStat=document.createElement("div");this.m_list=document.createElement("div");divChart.style.height="300px";divChart.style.textAlign="center";divChart.style.maxHeight="300px";divChart.style.minHeight="300px";divChart.appendChild(cvs);this.clearSelection();this.m_stats.appendChild(this.m_graphStat);this.m_stats.appendChild(divChart);this.m_stats.appendChild(this.m_list);var ctx=cvs.getContext("2d");var config={type:"pie",data:this.m_data,options:{responsive:true,title:{display:true,text:this.chartCaption(data.length)},legend:{display:false},cutoutPercentage:50}};this.m_chart=new Chart(ctx,config)}};Stats.prototype.updateStats=function(){this.m_graphStat.innerHTML=this.m_svRenderer.localizer["LOC_GRAPHSTAT"]+" "+this.m_svRenderer.localizer["LOC_NODES"]+" "+this.m_nodesCount+" ( "+this.m_svRenderer.localizer["LOC_SUMWEIGHT"]+" "+this.m_nodesWeight+"); "+this.m_svRenderer.localizer["LOC_EDGES"]+" "+this.m_edgesCount+" ( "+this.m_svRenderer.localizer["LOC_SUMWEIGHT"]+" "+this.m_edgesWeight+")"};Stats.prototype.updateNodesStat=function(count,weight){this.m_nodesCount=count;this.m_nodesWeight=weight;this.updateStats()};Stats.prototype.updateEdgesStat=function(count,weight){this.m_edgesCount=count;this.m_edgesWeight=weight;this.updateStats()};return Stats}();SciViCGraph.Stats=Stats})(SciViCGraph||(SciViCGraph={}));module.exports=SciViCGraph},{}],2:[function(require,module,exports){var Louvain={detectClusters:function(data){function createCommunityGraph(ngraph){var nodeCount=ngraph.getNodesCount();var weight=0;var nodes=[];var indexLookup=new Map;ngraph.forEachNode(function(node){initNode(node.id)});ngraph.forEachLink(function(link){var fromIdx=getNodeIdFromNgraph(link.fromId);var toIdx=getNodeIdFromNgraph(link.toId);var weight=getWeight(link.data);var fromNode=nodes[fromIdx];var toNode=nodes[toIdx];if(fromIdx===toIdx){fromNode.selfLoopsCount+=weight;fromNode.weightedDegree+=weight}else{addNeighbour(fromNode,toIdx,weight);addNeighbour(toNode,fromIdx,weight);fromNode.weightedDegree+=weight;toNode.weightedDegree+=weight}});weight=computeTotalWeight();return{nodeCount:nodeCount,weight:weight,forEachNeigbour:forEachNeigbour,getWeightedDegree:getWeightedDegree,getSelfLoopsCount:getSelfLoopsCount,getNodeIdFromNgraph:getNodeIdFromNgraph};function getNodeIdFromNgraph(id){var idx=indexLookup.get(id);if(idx===undefined)throw new Error("Unknown node id: "+id);return idx}function addNeighbour(node,id,weight){var info={id:id,weight:weight};if(!node.neighbours)node.neighbours=[info];else node.neighbours.push(info)}function forEachNeigbour(nodeId,cb){var node=getNode(nodeId);if(!node.neighbours)return;for(var i=0;i<node.neighbours.length;++i){var info=node.neighbours[i];cb(info.id,info.weight)}}function computeTotalWeight(){var weight=0;for(var i=0;i<nodeCount;++i){weight+=getWeightedDegree(i)}return weight}function getSelfLoopsCount(nodeId){return getNode(nodeId).selfLoopsCount}function getWeightedDegree(nodeId){return getNode(nodeId).weightedDegree}function getNode(nodeId){var node=nodes[nodeId];if(!node)throw new Error("cannot find node with id: "+nodeId);return node}function initNode(id){var node={selfLoopsCount:0,weightedDegree:0,neighbours:null};var idx=nodes.length;indexLookup.set(id,idx);nodes.push(node);return idx}}function getWeight(data){if(!data)return 1;if(typeof data==="number")return data;if(typeof data.weight==="number")return data.weight;return 1}function createCommunity(graph){var graphWeight=graph.weight;var nodeCount=graph.nodeCount;var totalLinksWeight=new Float32Array(nodeCount);var internalLinksWeight=new Float32Array(nodeCount);var nodeToCommunity=new Uint32Array(nodeCount);for(var i=0;i<nodeCount;++i){nodeToCommunity[i]=i;totalLinksWeight[i]=graph.getWeightedDegree(i);internalLinksWeight[i]=graph.getSelfLoopsCount(i)}return{modularity:modularity,optimizeModularity:optimizeModularity,getClass:getClass};function getClass(id){return nodeToCommunity[id]}function optimizeModularity(){var epsilon=1e-6;var iterator=getRandomNodeIdIterator();var newModularity=modularity();var currentModularity=newModularity;var modularityImproved=false;do{var movesCount=0;currentModularity=newModularity;for(var i=0;i<iterator.length;++i){var node=iterator[i];var nodeCommunity=nodeToCommunity[node];var neigboughingCommunities=getNeighbouringCommunities(node);var sharedLinksWeight=neigboughingCommunities.get(nodeCommunity);removeFromCommunity(node,nodeCommunity,sharedLinksWeight);var weightedDegree=graph.getWeightedDegree(node);var bestCommunity=nodeCommunity;var bestGain=0;neigboughingCommunities.forEach(function(sharedWeight,communityId){var gain=getModularityGain(node,sharedWeight,communityId,weightedDegree);if(gain<=bestGain)return;bestCommunity=communityId;bestGain=gain});var bestSharedWeight=neigboughingCommunities.get(bestCommunity);insertIntoCommunity(node,bestCommunity,bestSharedWeight);if(bestCommunity!==nodeCommunity)movesCount+=1}newModularity=modularity();if(movesCount>0)modularityImproved=true}while(movesCount>0&&newModularity-currentModularity>epsilon);return modularityImproved}function getNeighbouringCommunities(nodeId){var map=new Map;map.set(nodeToCommunity[nodeId],0);graph.forEachNeigbour(nodeId,function(otherNodeId,edgeWeight){var otherCommunity=nodeToCommunity[otherNodeId];var currentValue=map.get(otherCommunity)||0;map.set(otherCommunity,currentValue+edgeWeight)});return map}function getModularityGain(nodeId,sharedWeight,communityId,degree){var totalLinksWeightInThisCommunity=totalLinksWeight[communityId];return sharedWeight-totalLinksWeightInThisCommunity*degree/graphWeight}function removeFromCommunity(nodeId,communityId,sharedLinksWeight){totalLinksWeight[communityId]-=graph.getWeightedDegree(nodeId);internalLinksWeight[communityId]-=2*sharedLinksWeight+graph.getSelfLoopsCount(nodeId);nodeToCommunity[nodeId]=-1}function insertIntoCommunity(nodeId,communityId,sharedLinksWeight){totalLinksWeight[communityId]+=graph.getWeightedDegree(nodeId);internalLinksWeight[communityId]+=2*sharedLinksWeight+graph.getSelfLoopsCount(nodeId);nodeToCommunity[nodeId]=communityId}function modularity(){var result=0;for(var communityId=0;communityId<nodeCount;++communityId){if(totalLinksWeight[communityId]>0){var dw=totalLinksWeight[communityId]/graphWeight;result+=internalLinksWeight[communityId]/graphWeight-dw*dw}}return result}function getRandomNodeIdIterator(){var iterator=[];for(var i=0;i<nodeCount;++i){iterator[i]=i}var nrandom=require("ngraph.random");var seededRandom=nrandom.random(42);var randomIterator=nrandom.randomIterator;randomIterator(iterator,seededRandom).shuffle();return iterator}}function modularity(ngraph){var graph=createCommunityGraph(ngraph);var community=createCommunity(graph);var originalModularity=community.modularity();var nodesMoved=community.optimizeModularity();var newModularity=community.modularity();return{canCoarse:canCoarse,originalModularity:originalModularity,newModularity:newModularity,getClass:getClass};function canCoarse(){return nodesMoved}function getClass(nodeId){var node=graph.getNodeIdFromNgraph(nodeId);return community.getClass(node)}}var create=require("ngraph.graph");var detect=modularity;var graph=create();data.nodes.forEach(function(node){if(node.visible)graph.addNode(node.positionHash(),node)});data.edges.forEach(function(edge){if(edge.visible)graph.addLink(edge.source.positionHash(),edge.target.positionHash())});var clusters=detect(graph);var indices={};var index=0;graph.forEachNode(function(node){var classID=clusters.getClass(node.id);var groupID=indices[classID];if(groupID===undefined){groupID=index++;indices[classID]=groupID}node.data.groupID=groupID})}};module.exports=Louvain},{"ngraph.graph":74,"ngraph.random":75}],3:[function(require,module,exports){"use strict";"use restrict";var INT_BITS=32;exports.INT_BITS=INT_BITS;exports.INT_MAX=2147483647;exports.INT_MIN=-1<<INT_BITS-1;exports.sign=function(v){return(v>0)-(v<0)};exports.abs=function(v){var mask=v>>INT_BITS-1;return(v^mask)-mask};exports.min=function(x,y){return y^(x^y)&-(x<y)};exports.max=function(x,y){return x^(x^y)&-(x<y)};exports.isPow2=function(v){return!(v&v-1)&&!!v};exports.log2=function(v){var r,shift;r=(v>65535)<<4;v>>>=r;shift=(v>255)<<3;v>>>=shift;r|=shift;shift=(v>15)<<2;v>>>=shift;r|=shift;shift=(v>3)<<1;v>>>=shift;r|=shift;return r|v>>1};exports.log10=function(v){return v>=1e9?9:v>=1e8?8:v>=1e7?7:v>=1e6?6:v>=1e5?5:v>=1e4?4:v>=1e3?3:v>=100?2:v>=10?1:0};exports.popCount=function(v){v=v-(v>>>1&1431655765);v=(v&858993459)+(v>>>2&858993459);return(v+(v>>>4)&252645135)*16843009>>>24};function countTrailingZeros(v){var c=32;v&=-v;if(v)c--;if(v&65535)c-=16;if(v&16711935)c-=8;if(v&252645135)c-=4;if(v&858993459)c-=2;if(v&1431655765)c-=1;return c}exports.countTrailingZeros=countTrailingZeros;exports.nextPow2=function(v){v+=v===0;--v;v|=v>>>1;v|=v>>>2;v|=v>>>4;v|=v>>>8;v|=v>>>16;return v+1};exports.prevPow2=function(v){v|=v>>>1;v|=v>>>2;v|=v>>>4;v|=v>>>8;v|=v>>>16;return v-(v>>>1)};exports.parity=function(v){v^=v>>>16;v^=v>>>8;v^=v>>>4;v&=15;return 27030>>>v&1};var REVERSE_TABLE=new Array(256);(function(tab){for(var i=0;i<256;++i){var v=i,r=i,s=7;for(v>>>=1;v;v>>>=1){r<<=1;r|=v&1;--s}tab[i]=r<<s&255}})(REVERSE_TABLE);exports.reverse=function(v){return REVERSE_TABLE[v&255]<<24|REVERSE_TABLE[v>>>8&255]<<16|REVERSE_TABLE[v>>>16&255]<<8|REVERSE_TABLE[v>>>24&255]};exports.interleave2=function(x,y){x&=65535;x=(x|x<<8)&16711935;x=(x|x<<4)&252645135;x=(x|x<<2)&858993459;x=(x|x<<1)&1431655765;y&=65535;y=(y|y<<8)&16711935;y=(y|y<<4)&252645135;y=(y|y<<2)&858993459;y=(y|y<<1)&1431655765;return x|y<<1};exports.deinterleave2=function(v,n){v=v>>>n&1431655765;v=(v|v>>>1)&858993459;v=(v|v>>>2)&252645135;v=(v|v>>>4)&16711935;v=(v|v>>>16)&65535;return v<<16>>16};exports.interleave3=function(x,y,z){x&=1023;x=(x|x<<16)&4278190335;x=(x|x<<8)&251719695;x=(x|x<<4)&3272356035;x=(x|x<<2)&1227133513;y&=1023;y=(y|y<<16)&4278190335;y=(y|y<<8)&251719695;y=(y|y<<4)&3272356035;y=(y|y<<2)&1227133513;x|=y<<1;z&=1023;z=(z|z<<16)&4278190335;z=(z|z<<8)&251719695;z=(z|z<<4)&3272356035;z=(z|z<<2)&1227133513;return x|z<<2};exports.deinterleave3=function(v,n){v=v>>>n&1227133513;v=(v|v>>>2)&3272356035;v=(v|v>>>4)&251719695;v=(v|v>>>8)&4278190335;v=(v|v>>>16)&1023;return v<<22>>22};exports.nextCombination=function(v){var t=v|v-1;return t+1|(~t&-~t)-1>>>countTrailingZeros(v)+1}},{}],4:[function(require,module,exports){var Chart=require("./core/core")();Chart.helpers=require("./helpers/index");require("./core/core.helpers")(Chart);Chart.defaults=require("./core/core.defaults");Chart.Element=require("./core/core.element");Chart.elements=require("./elements/index");Chart.Interaction=require("./core/core.interaction");Chart.layouts=require("./core/core.layouts");Chart.platform=require("./platforms/platform");Chart.plugins=require("./core/core.plugins");Chart.Ticks=require("./core/core.ticks");require("./core/core.animation")(Chart);require("./core/core.controller")(Chart);require("./core/core.datasetController")(Chart);require("./core/core.scaleService")(Chart);require("./core/core.scale")(Chart);require("./core/core.tooltip")(Chart);require("./scales/scale.linearbase")(Chart);require("./scales/scale.category")(Chart);require("./scales/scale.linear")(Chart);require("./scales/scale.logarithmic")(Chart);require("./scales/scale.radialLinear")(Chart);require("./scales/scale.time")(Chart);require("./controllers/controller.bar")(Chart);require("./controllers/controller.bubble")(Chart);require("./controllers/controller.doughnut")(Chart);require("./controllers/controller.line")(Chart);require("./controllers/controller.polarArea")(Chart);require("./controllers/controller.radar")(Chart);require("./controllers/controller.scatter")(Chart);require("./charts/Chart.Bar")(Chart);require("./charts/Chart.Bubble")(Chart);require("./charts/Chart.Doughnut")(Chart);require("./charts/Chart.Line")(Chart);require("./charts/Chart.PolarArea")(Chart);require("./charts/Chart.Radar")(Chart);require("./charts/Chart.Scatter")(Chart);var plugins=require("./plugins");for(var k in plugins){if(plugins.hasOwnProperty(k)){Chart.plugins.register(plugins[k])}}Chart.platform.initialize();module.exports=Chart;if(typeof window!=="undefined"){window.Chart=Chart}Chart.Legend=plugins.legend._element;Chart.Title=plugins.title._element;Chart.pluginService=Chart.plugins;Chart.PluginBase=Chart.Element.extend({});Chart.canvasHelpers=Chart.helpers.canvas;Chart.layoutService=Chart.layouts},{"./charts/Chart.Bar":5,"./charts/Chart.Bubble":6,"./charts/Chart.Doughnut":7,"./charts/Chart.Line":8,"./charts/Chart.PolarArea":9,"./charts/Chart.Radar":10,"./charts/Chart.Scatter":11,"./controllers/controller.bar":12,"./controllers/controller.bubble":13,"./controllers/controller.doughnut":14,"./controllers/controller.line":15,"./controllers/controller.polarArea":16,"./controllers/controller.radar":17,"./controllers/controller.scatter":18,"./core/core":26,"./core/core.animation":19,"./core/core.controller":20,"./core/core.datasetController":21,"./core/core.defaults":22,"./core/core.element":23,"./core/core.helpers":24,"./core/core.interaction":25,"./core/core.layouts":27,"./core/core.plugins":28,"./core/core.scale":29,"./core/core.scaleService":30,"./core/core.ticks":31,"./core/core.tooltip":32,"./elements/index":37,"./helpers/index":42,"./platforms/platform":45,"./plugins":46,"./scales/scale.category":50,"./scales/scale.linear":51,"./scales/scale.linearbase":52,"./scales/scale.logarithmic":53,"./scales/scale.radialLinear":54,"./scales/scale.time":55}],5:[function(require,module,exports){"use strict";module.exports=function(Chart){Chart.Bar=function(context,config){config.type="bar";return new Chart(context,config)}}},{}],6:[function(require,module,exports){"use strict";module.exports=function(Chart){Chart.Bubble=function(context,config){config.type="bubble";return new Chart(context,config)}}},{}],7:[function(require,module,exports){"use strict";module.exports=function(Chart){Chart.Doughnut=function(context,config){config.type="doughnut";return new Chart(context,config)}}},{}],8:[function(require,module,exports){"use strict";module.exports=function(Chart){Chart.Line=function(context,config){config.type="line";return new Chart(context,config)}}},{}],9:[function(require,module,exports){"use strict";module.exports=function(Chart){Chart.PolarArea=function(context,config){config.type="polarArea";return new Chart(context,config)}}},{}],10:[function(require,module,exports){"use strict";module.exports=function(Chart){Chart.Radar=function(context,config){config.type="radar";return new Chart(context,config)}}},{}],11:[function(require,module,exports){"use strict";module.exports=function(Chart){Chart.Scatter=function(context,config){config.type="scatter";return new Chart(context,config)}}},{}],12:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var elements=require("../elements/index");var helpers=require("../helpers/index");defaults._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,offset:true,gridLines:{offsetGridLines:true}}],yAxes:[{type:"linear"}]}});defaults._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{position:"left",type:"category",categoryPercentage:.8,barPercentage:.9,offset:true,gridLines:{offsetGridLines:true}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{callbacks:{title:function(item,data){var title="";if(item.length>0){if(item[0].yLabel){title=item[0].yLabel}else if(data.labels.length>0&&item[0].index<data.labels.length){title=data.labels[item[0].index]}}return title},label:function(item,data){var datasetLabel=data.datasets[item.datasetIndex].label||"";return datasetLabel+": "+item.xLabel}},mode:"index",axis:"y"}});function computeMinSampleSize(scale,pixels){var min=scale.isHorizontal()?scale.width:scale.height;var ticks=scale.getTicks();var prev,curr,i,ilen;for(i=1,ilen=pixels.length;i<ilen;++i){min=Math.min(min,pixels[i]-pixels[i-1])}for(i=0,ilen=ticks.length;i<ilen;++i){curr=scale.getPixelForTick(i);min=i>0?Math.min(min,curr-prev):min;prev=curr}return min}function computeFitCategoryTraits(index,ruler,options){var thickness=options.barThickness;var count=ruler.stackCount;var curr=ruler.pixels[index];var size,ratio;if(helpers.isNullOrUndef(thickness)){size=ruler.min*options.categoryPercentage;ratio=options.barPercentage}else{size=thickness*count;ratio=1}return{chunk:size/count,ratio:ratio,start:curr-size/2}}function computeFlexCategoryTraits(index,ruler,options){var pixels=ruler.pixels;var curr=pixels[index];var prev=index>0?pixels[index-1]:null;var next=index<pixels.length-1?pixels[index+1]:null;var percent=options.categoryPercentage;var start,size;if(prev===null){prev=curr-(next===null?ruler.end-curr:next-curr)}if(next===null){next=curr+curr-prev}start=curr-(curr-prev)/2*percent;size=(next-prev)/2*percent;return{chunk:size/ruler.stackCount,ratio:options.barPercentage,start:start}}module.exports=function(Chart){Chart.controllers.bar=Chart.DatasetController.extend({dataElementType:elements.Rectangle,initialize:function(){var me=this;var meta;Chart.DatasetController.prototype.initialize.apply(me,arguments);meta=me.getMeta();meta.stack=me.getDataset().stack;meta.bar=true},update:function(reset){var me=this;var rects=me.getMeta().data;var i,ilen;me._ruler=me.getRuler();for(i=0,ilen=rects.length;i<ilen;++i){me.updateElement(rects[i],i,reset)}},updateElement:function(rectangle,index,reset){var me=this;var chart=me.chart;var meta=me.getMeta();var dataset=me.getDataset();var custom=rectangle.custom||{};var rectangleOptions=chart.options.elements.rectangle;rectangle._xScale=me.getScaleForId(meta.xAxisID);rectangle._yScale=me.getScaleForId(meta.yAxisID);rectangle._datasetIndex=me.index;rectangle._index=index;rectangle._model={datasetLabel:dataset.label,label:chart.data.labels[index],borderSkipped:custom.borderSkipped?custom.borderSkipped:rectangleOptions.borderSkipped,backgroundColor:custom.backgroundColor?custom.backgroundColor:helpers.valueAtIndexOrDefault(dataset.backgroundColor,index,rectangleOptions.backgroundColor),borderColor:custom.borderColor?custom.borderColor:helpers.valueAtIndexOrDefault(dataset.borderColor,index,rectangleOptions.borderColor),borderWidth:custom.borderWidth?custom.borderWidth:helpers.valueAtIndexOrDefault(dataset.borderWidth,index,rectangleOptions.borderWidth)};me.updateElementGeometry(rectangle,index,reset);rectangle.pivot()},updateElementGeometry:function(rectangle,index,reset){var me=this;var model=rectangle._model;var vscale=me.getValueScale();var base=vscale.getBasePixel();var horizontal=vscale.isHorizontal();var ruler=me._ruler||me.getRuler();var vpixels=me.calculateBarValuePixels(me.index,index);var ipixels=me.calculateBarIndexPixels(me.index,index,ruler);model.horizontal=horizontal;model.base=reset?base:vpixels.base;model.x=horizontal?reset?base:vpixels.head:ipixels.center;model.y=horizontal?ipixels.center:reset?base:vpixels.head;model.height=horizontal?ipixels.size:undefined;model.width=horizontal?undefined:ipixels.size},getValueScaleId:function(){return this.getMeta().yAxisID},getIndexScaleId:function(){return this.getMeta().xAxisID},getValueScale:function(){return this.getScaleForId(this.getValueScaleId())},getIndexScale:function(){return this.getScaleForId(this.getIndexScaleId())},_getStacks:function(last){var me=this;var chart=me.chart;var scale=me.getIndexScale();var stacked=scale.options.stacked;var ilen=last===undefined?chart.data.datasets.length:last+1;var stacks=[];var i,meta;for(i=0;i<ilen;++i){meta=chart.getDatasetMeta(i);if(meta.bar&&chart.isDatasetVisible(i)&&(stacked===false||stacked===true&&stacks.indexOf(meta.stack)===-1||stacked===undefined&&(meta.stack===undefined||stacks.indexOf(meta.stack)===-1))){stacks.push(meta.stack)}}return stacks},getStackCount:function(){return this._getStacks().length},getStackIndex:function(datasetIndex,name){var stacks=this._getStacks(datasetIndex);var index=name!==undefined?stacks.indexOf(name):-1;return index===-1?stacks.length-1:index},getRuler:function(){var me=this;var scale=me.getIndexScale();var stackCount=me.getStackCount();var datasetIndex=me.index;var isHorizontal=scale.isHorizontal();var start=isHorizontal?scale.left:scale.top;var end=start+(isHorizontal?scale.width:scale.height);var pixels=[];var i,ilen,min;for(i=0,ilen=me.getMeta().data.length;i<ilen;++i){pixels.push(scale.getPixelForValue(null,i,datasetIndex))}min=helpers.isNullOrUndef(scale.options.barThickness)?computeMinSampleSize(scale,pixels):-1;return{min:min,pixels:pixels,start:start,end:end,stackCount:stackCount,scale:scale}},calculateBarValuePixels:function(datasetIndex,index){var me=this;var chart=me.chart;var meta=me.getMeta();var scale=me.getValueScale();var datasets=chart.data.datasets;var value=scale.getRightValue(datasets[datasetIndex].data[index]);var stacked=scale.options.stacked;var stack=meta.stack;var start=0;var i,imeta,ivalue,base,head,size;if(stacked||stacked===undefined&&stack!==undefined){for(i=0;i<datasetIndex;++i){imeta=chart.getDatasetMeta(i);if(imeta.bar&&imeta.stack===stack&&imeta.controller.getValueScaleId()===scale.id&&chart.isDatasetVisible(i)){ivalue=scale.getRightValue(datasets[i].data[index]);if(value<0&&ivalue<0||value>=0&&ivalue>0){start+=ivalue}}}}base=scale.getPixelForValue(start);head=scale.getPixelForValue(start+value);size=(head-base)/2;return{size:size,base:base,head:head,center:head+size/2}},calculateBarIndexPixels:function(datasetIndex,index,ruler){var me=this;var options=ruler.scale.options;var range=options.barThickness==="flex"?computeFlexCategoryTraits(index,ruler,options):computeFitCategoryTraits(index,ruler,options);var stackIndex=me.getStackIndex(datasetIndex,me.getMeta().stack);var center=range.start+range.chunk*stackIndex+range.chunk/2;var size=Math.min(helpers.valueOrDefault(options.maxBarThickness,Infinity),range.chunk*range.ratio);return{base:center-size/2,head:center+size/2,center:center,size:size}},draw:function(){var me=this;var chart=me.chart;var scale=me.getValueScale();var rects=me.getMeta().data;var dataset=me.getDataset();var ilen=rects.length;var i=0;helpers.canvas.clipArea(chart.ctx,chart.chartArea);for(;i<ilen;++i){if(!isNaN(scale.getRightValue(dataset.data[i]))){rects[i].draw()}}helpers.canvas.unclipArea(chart.ctx)},setHoverStyle:function(rectangle){var dataset=this.chart.data.datasets[rectangle._datasetIndex];var index=rectangle._index;var custom=rectangle.custom||{};var model=rectangle._model;model.backgroundColor=custom.hoverBackgroundColor?custom.hoverBackgroundColor:helpers.valueAtIndexOrDefault(dataset.hoverBackgroundColor,index,helpers.getHoverColor(model.backgroundColor));model.borderColor=custom.hoverBorderColor?custom.hoverBorderColor:helpers.valueAtIndexOrDefault(dataset.hoverBorderColor,index,helpers.getHoverColor(model.borderColor));model.borderWidth=custom.hoverBorderWidth?custom.hoverBorderWidth:helpers.valueAtIndexOrDefault(dataset.hoverBorderWidth,index,model.borderWidth)},removeHoverStyle:function(rectangle){var dataset=this.chart.data.datasets[rectangle._datasetIndex];var index=rectangle._index;var custom=rectangle.custom||{};var model=rectangle._model;var rectangleElementOptions=this.chart.options.elements.rectangle;model.backgroundColor=custom.backgroundColor?custom.backgroundColor:helpers.valueAtIndexOrDefault(dataset.backgroundColor,index,rectangleElementOptions.backgroundColor);model.borderColor=custom.borderColor?custom.borderColor:helpers.valueAtIndexOrDefault(dataset.borderColor,index,rectangleElementOptions.borderColor);model.borderWidth=custom.borderWidth?custom.borderWidth:helpers.valueAtIndexOrDefault(dataset.borderWidth,index,rectangleElementOptions.borderWidth)}});Chart.controllers.horizontalBar=Chart.controllers.bar.extend({getValueScaleId:function(){return this.getMeta().xAxisID},getIndexScaleId:function(){return this.getMeta().yAxisID}})}},{"../core/core.defaults":22,"../elements/index":37,"../helpers/index":42}],13:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var elements=require("../elements/index");var helpers=require("../helpers/index");defaults._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(item,data){var datasetLabel=data.datasets[item.datasetIndex].label||"";var dataPoint=data.datasets[item.datasetIndex].data[item.index];return datasetLabel+": ("+item.xLabel+", "+item.yLabel+", "+dataPoint.r+")"}}}});module.exports=function(Chart){Chart.controllers.bubble=Chart.DatasetController.extend({dataElementType:elements.Point,update:function(reset){var me=this;var meta=me.getMeta();var points=meta.data;helpers.each(points,function(point,index){me.updateElement(point,index,reset)})},updateElement:function(point,index,reset){var me=this;var meta=me.getMeta();var custom=point.custom||{};var xScale=me.getScaleForId(meta.xAxisID);var yScale=me.getScaleForId(meta.yAxisID);var options=me._resolveElementOptions(point,index);var data=me.getDataset().data[index];var dsIndex=me.index;var x=reset?xScale.getPixelForDecimal(.5):xScale.getPixelForValue(typeof data==="object"?data:NaN,index,dsIndex);var y=reset?yScale.getBasePixel():yScale.getPixelForValue(data,index,dsIndex);point._xScale=xScale;point._yScale=yScale;point._options=options;point._datasetIndex=dsIndex;point._index=index;point._model={backgroundColor:options.backgroundColor,borderColor:options.borderColor,borderWidth:options.borderWidth,hitRadius:options.hitRadius,pointStyle:options.pointStyle,radius:reset?0:options.radius,skip:custom.skip||isNaN(x)||isNaN(y),x:x,y:y};point.pivot()},setHoverStyle:function(point){var model=point._model;var options=point._options;model.backgroundColor=helpers.valueOrDefault(options.hoverBackgroundColor,helpers.getHoverColor(options.backgroundColor));model.borderColor=helpers.valueOrDefault(options.hoverBorderColor,helpers.getHoverColor(options.borderColor));model.borderWidth=helpers.valueOrDefault(options.hoverBorderWidth,options.borderWidth);model.radius=options.radius+options.hoverRadius},removeHoverStyle:function(point){var model=point._model;var options=point._options;model.backgroundColor=options.backgroundColor;model.borderColor=options.borderColor;model.borderWidth=options.borderWidth;model.radius=options.radius},_resolveElementOptions:function(point,index){var me=this;var chart=me.chart;var datasets=chart.data.datasets;var dataset=datasets[me.index];var custom=point.custom||{};var options=chart.options.elements.point;var resolve=helpers.options.resolve;var data=dataset.data[index];var values={};var i,ilen,key;var context={chart:chart,dataIndex:index,dataset:dataset,datasetIndex:me.index};var keys=["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle"];for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];values[key]=resolve([custom[key],dataset[key],options[key]],context,index)}values.radius=resolve([custom.radius,data?data.r:undefined,dataset.radius,options.radius],context,index);return values}})}},{"../core/core.defaults":22,"../elements/index":37,"../helpers/index":42}],14:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var elements=require("../elements/index");var helpers=require("../helpers/index");defaults._set("doughnut",{animation:{animateRotate:true,animateScale:false},hover:{mode:"single"},legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');var data=chart.data;var datasets=data.datasets;var labels=data.labels;if(datasets.length){for(var i=0;i<datasets[0].data.length;++i){text.push('<li><span style="background-color:'+datasets[0].backgroundColor[i]+'"></span>');if(labels[i]){text.push(labels[i])}text.push("</li>")}}text.push("</ul>");return text.join("")},legend:{labels:{generateLabels:function(chart){var data=chart.data;if(data.labels.length&&data.datasets.length){return data.labels.map(function(label,i){var meta=chart.getDatasetMeta(0);var ds=data.datasets[0];var arc=meta.data[i];var custom=arc&&arc.custom||{};var valueAtIndexOrDefault=helpers.valueAtIndexOrDefault;var arcOpts=chart.options.elements.arc;var fill=custom.backgroundColor?custom.backgroundColor:valueAtIndexOrDefault(ds.backgroundColor,i,arcOpts.backgroundColor);var stroke=custom.borderColor?custom.borderColor:valueAtIndexOrDefault(ds.borderColor,i,arcOpts.borderColor);var bw=custom.borderWidth?custom.borderWidth:valueAtIndexOrDefault(ds.borderWidth,i,arcOpts.borderWidth);return{text:label,fillStyle:fill,strokeStyle:stroke,lineWidth:bw,hidden:isNaN(ds.data[i])||meta.data[i].hidden,index:i}})}return[]}},onClick:function(e,legendItem){var index=legendItem.index;var chart=this.chart;var i,ilen,meta;for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i){meta=chart.getDatasetMeta(i);if(meta.data[index]){meta.data[index].hidden=!meta.data[index].hidden}}chart.update()}},cutoutPercentage:50,rotation:Math.PI*-.5,circumference:Math.PI*2,tooltips:{callbacks:{title:function(){return""},label:function(tooltipItem,data){var dataLabel=data.labels[tooltipItem.index];var value=": "+data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];if(helpers.isArray(dataLabel)){dataLabel=dataLabel.slice();dataLabel[0]+=value}else{dataLabel+=value}return dataLabel}}}});defaults._set("pie",helpers.clone(defaults.doughnut));defaults._set("pie",{cutoutPercentage:0});module.exports=function(Chart){Chart.controllers.doughnut=Chart.controllers.pie=Chart.DatasetController.extend({dataElementType:elements.Arc,linkScales:helpers.noop,getRingIndex:function(datasetIndex){var ringIndex=0;for(var j=0;j<datasetIndex;++j){if(this.chart.isDatasetVisible(j)){++ringIndex}}return ringIndex},update:function(reset){var me=this;var chart=me.chart;var chartArea=chart.chartArea;var opts=chart.options;var arcOpts=opts.elements.arc;var availableWidth=chartArea.right-chartArea.left-arcOpts.borderWidth;var availableHeight=chartArea.bottom-chartArea.top-arcOpts.borderWidth;var minSize=Math.min(availableWidth,availableHeight);var offset={x:0,y:0};var meta=me.getMeta();var cutoutPercentage=opts.cutoutPercentage;var circumference=opts.circumference;if(circumference<Math.PI*2){var startAngle=opts.rotation%(Math.PI*2);startAngle+=Math.PI*2*(startAngle>=Math.PI?-1:startAngle<-Math.PI?1:0);var endAngle=startAngle+circumference;var start={x:Math.cos(startAngle),y:Math.sin(startAngle)};var end={x:Math.cos(endAngle),y:Math.sin(endAngle)};var contains0=startAngle<=0&&endAngle>=0||startAngle<=Math.PI*2&&Math.PI*2<=endAngle;var contains90=startAngle<=Math.PI*.5&&Math.PI*.5<=endAngle||startAngle<=Math.PI*2.5&&Math.PI*2.5<=endAngle;var contains180=startAngle<=-Math.PI&&-Math.PI<=endAngle||startAngle<=Math.PI&&Math.PI<=endAngle;var contains270=startAngle<=-Math.PI*.5&&-Math.PI*.5<=endAngle||startAngle<=Math.PI*1.5&&Math.PI*1.5<=endAngle;var cutout=cutoutPercentage/100;var min={x:contains180?-1:Math.min(start.x*(start.x<0?1:cutout),end.x*(end.x<0?1:cutout)),y:contains270?-1:Math.min(start.y*(start.y<0?1:cutout),end.y*(end.y<0?1:cutout))};var max={x:contains0?1:Math.max(start.x*(start.x>0?1:cutout),end.x*(end.x>0?1:cutout)),y:contains90?1:Math.max(start.y*(start.y>0?1:cutout),end.y*(end.y>0?1:cutout))};var size={width:(max.x-min.x)*.5,height:(max.y-min.y)*.5};minSize=Math.min(availableWidth/size.width,availableHeight/size.height);offset={x:(max.x+min.x)*-.5,y:(max.y+min.y)*-.5}}chart.borderWidth=me.getMaxBorderWidth(meta.data);chart.outerRadius=Math.max((minSize-chart.borderWidth)/2,0);chart.innerRadius=Math.max(cutoutPercentage?chart.outerRadius/100*cutoutPercentage:0,0);chart.radiusLength=(chart.outerRadius-chart.innerRadius)/chart.getVisibleDatasetCount();chart.offsetX=offset.x*chart.outerRadius;chart.offsetY=offset.y*chart.outerRadius;meta.total=me.calculateTotal();me.outerRadius=chart.outerRadius-chart.radiusLength*me.getRingIndex(me.index);me.innerRadius=Math.max(me.outerRadius-chart.radiusLength,0);helpers.each(meta.data,function(arc,index){me.updateElement(arc,index,reset)})},updateElement:function(arc,index,reset){var me=this;var chart=me.chart;var chartArea=chart.chartArea;var opts=chart.options;var animationOpts=opts.animation;var centerX=(chartArea.left+chartArea.right)/2;var centerY=(chartArea.top+chartArea.bottom)/2;var startAngle=opts.rotation;var endAngle=opts.rotation;var dataset=me.getDataset();var circumference=reset&&animationOpts.animateRotate?0:arc.hidden?0:me.calculateCircumference(dataset.data[index])*(opts.circumference/(2*Math.PI));var innerRadius=reset&&animationOpts.animateScale?0:me.innerRadius;var outerRadius=reset&&animationOpts.animateScale?0:me.outerRadius;var valueAtIndexOrDefault=helpers.valueAtIndexOrDefault;helpers.extend(arc,{_datasetIndex:me.index,_index:index,_model:{x:centerX+chart.offsetX,y:centerY+chart.offsetY,startAngle:startAngle,endAngle:endAngle,circumference:circumference,outerRadius:outerRadius,innerRadius:innerRadius,label:valueAtIndexOrDefault(dataset.label,index,chart.data.labels[index])}});var model=arc._model;this.removeHoverStyle(arc);if(!reset||!animationOpts.animateRotate){if(index===0){model.startAngle=opts.rotation}else{model.startAngle=me.getMeta().data[index-1]._model.endAngle}model.endAngle=model.startAngle+model.circumference}arc.pivot()},removeHoverStyle:function(arc){Chart.DatasetController.prototype.removeHoverStyle.call(this,arc,this.chart.options.elements.arc)},calculateTotal:function(){var dataset=this.getDataset();var meta=this.getMeta();var total=0;var value;helpers.each(meta.data,function(element,index){value=dataset.data[index];if(!isNaN(value)&&!element.hidden){total+=Math.abs(value)}});return total},calculateCircumference:function(value){var total=this.getMeta().total;if(total>0&&!isNaN(value)){return Math.PI*2*(Math.abs(value)/total)}return 0},getMaxBorderWidth:function(arcs){var max=0;var index=this.index;var length=arcs.length;var borderWidth;var hoverWidth;for(var i=0;i<length;i++){borderWidth=arcs[i]._model?arcs[i]._model.borderWidth:0;hoverWidth=arcs[i]._chart?arcs[i]._chart.config.data.datasets[index].hoverBorderWidth:0;max=borderWidth>max?borderWidth:max;max=hoverWidth>max?hoverWidth:max}return max}})}},{"../core/core.defaults":22,"../elements/index":37,"../helpers/index":42}],15:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var elements=require("../elements/index");var helpers=require("../helpers/index");defaults._set("line",{showLines:true,spanGaps:false,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});module.exports=function(Chart){function lineEnabled(dataset,options){return helpers.valueOrDefault(dataset.showLine,options.showLines)}Chart.controllers.line=Chart.DatasetController.extend({datasetElementType:elements.Line,dataElementType:elements.Point,update:function(reset){var me=this;var meta=me.getMeta();var line=meta.dataset;var points=meta.data||[];var options=me.chart.options;var lineElementOptions=options.elements.line;var scale=me.getScaleForId(meta.yAxisID);var i,ilen,custom;var dataset=me.getDataset();var showLine=lineEnabled(dataset,options);if(showLine){custom=line.custom||{};if(dataset.tension!==undefined&&dataset.lineTension===undefined){dataset.lineTension=dataset.tension}line._scale=scale;line._datasetIndex=me.index;line._children=points;line._model={spanGaps:dataset.spanGaps?dataset.spanGaps:options.spanGaps,tension:custom.tension?custom.tension:helpers.valueOrDefault(dataset.lineTension,lineElementOptions.tension),backgroundColor:custom.backgroundColor?custom.backgroundColor:dataset.backgroundColor||lineElementOptions.backgroundColor,borderWidth:custom.borderWidth?custom.borderWidth:dataset.borderWidth||lineElementOptions.borderWidth,borderColor:custom.borderColor?custom.borderColor:dataset.borderColor||lineElementOptions.borderColor,borderCapStyle:custom.borderCapStyle?custom.borderCapStyle:dataset.borderCapStyle||lineElementOptions.borderCapStyle,borderDash:custom.borderDash?custom.borderDash:dataset.borderDash||lineElementOptions.borderDash,borderDashOffset:custom.borderDashOffset?custom.borderDashOffset:dataset.borderDashOffset||lineElementOptions.borderDashOffset,borderJoinStyle:custom.borderJoinStyle?custom.borderJoinStyle:dataset.borderJoinStyle||lineElementOptions.borderJoinStyle,fill:custom.fill?custom.fill:dataset.fill!==undefined?dataset.fill:lineElementOptions.fill,steppedLine:custom.steppedLine?custom.steppedLine:helpers.valueOrDefault(dataset.steppedLine,lineElementOptions.stepped),cubicInterpolationMode:custom.cubicInterpolationMode?custom.cubicInterpolationMode:helpers.valueOrDefault(dataset.cubicInterpolationMode,lineElementOptions.cubicInterpolationMode)};line.pivot()}for(i=0,ilen=points.length;i<ilen;++i){me.updateElement(points[i],i,reset)}if(showLine&&line._model.tension!==0){me.updateBezierControlPoints()}for(i=0,ilen=points.length;i<ilen;++i){points[i].pivot()}},getPointBackgroundColor:function(point,index){var backgroundColor=this.chart.options.elements.point.backgroundColor;var dataset=this.getDataset();var custom=point.custom||{};if(custom.backgroundColor){backgroundColor=custom.backgroundColor}else if(dataset.pointBackgroundColor){backgroundColor=helpers.valueAtIndexOrDefault(dataset.pointBackgroundColor,index,backgroundColor)}else if(dataset.backgroundColor){backgroundColor=dataset.backgroundColor}return backgroundColor},getPointBorderColor:function(point,index){var borderColor=this.chart.options.elements.point.borderColor;var dataset=this.getDataset();var custom=point.custom||{};if(custom.borderColor){borderColor=custom.borderColor}else if(dataset.pointBorderColor){borderColor=helpers.valueAtIndexOrDefault(dataset.pointBorderColor,index,borderColor)}else if(dataset.borderColor){borderColor=dataset.borderColor}return borderColor},getPointBorderWidth:function(point,index){var borderWidth=this.chart.options.elements.point.borderWidth;var dataset=this.getDataset();var custom=point.custom||{};if(!isNaN(custom.borderWidth)){borderWidth=custom.borderWidth}else if(!isNaN(dataset.pointBorderWidth)||helpers.isArray(dataset.pointBorderWidth)){borderWidth=helpers.valueAtIndexOrDefault(dataset.pointBorderWidth,index,borderWidth)}else if(!isNaN(dataset.borderWidth)){borderWidth=dataset.borderWidth}return borderWidth},updateElement:function(point,index,reset){var me=this;var meta=me.getMeta();var custom=point.custom||{};var dataset=me.getDataset();var datasetIndex=me.index;var value=dataset.data[index];var yScale=me.getScaleForId(meta.yAxisID);var xScale=me.getScaleForId(meta.xAxisID);var pointOptions=me.chart.options.elements.point;var x,y;if(dataset.radius!==undefined&&dataset.pointRadius===undefined){dataset.pointRadius=dataset.radius}if(dataset.hitRadius!==undefined&&dataset.pointHitRadius===undefined){dataset.pointHitRadius=dataset.hitRadius}x=xScale.getPixelForValue(typeof value==="object"?value:NaN,index,datasetIndex);y=reset?yScale.getBasePixel():me.calculatePointY(value,index,datasetIndex);point._xScale=xScale;point._yScale=yScale;point._datasetIndex=datasetIndex;point._index=index;point._model={x:x,y:y,skip:custom.skip||isNaN(x)||isNaN(y),radius:custom.radius||helpers.valueAtIndexOrDefault(dataset.pointRadius,index,pointOptions.radius),pointStyle:custom.pointStyle||helpers.valueAtIndexOrDefault(dataset.pointStyle,index,pointOptions.pointStyle),backgroundColor:me.getPointBackgroundColor(point,index),borderColor:me.getPointBorderColor(point,index),borderWidth:me.getPointBorderWidth(point,index),tension:meta.dataset._model?meta.dataset._model.tension:0,steppedLine:meta.dataset._model?meta.dataset._model.steppedLine:false,hitRadius:custom.hitRadius||helpers.valueAtIndexOrDefault(dataset.pointHitRadius,index,pointOptions.hitRadius)}},calculatePointY:function(value,index,datasetIndex){var me=this;var chart=me.chart;var meta=me.getMeta();var yScale=me.getScaleForId(meta.yAxisID);var sumPos=0;var sumNeg=0;var i,ds,dsMeta;if(yScale.options.stacked){for(i=0;i<datasetIndex;i++){ds=chart.data.datasets[i];dsMeta=chart.getDatasetMeta(i);if(dsMeta.type==="line"&&dsMeta.yAxisID===yScale.id&&chart.isDatasetVisible(i)){var stackedRightValue=Number(yScale.getRightValue(ds.data[index]));if(stackedRightValue<0){sumNeg+=stackedRightValue||0}else{sumPos+=stackedRightValue||0}}}var rightValue=Number(yScale.getRightValue(value));if(rightValue<0){return yScale.getPixelForValue(sumNeg+rightValue)}return yScale.getPixelForValue(sumPos+rightValue)}return yScale.getPixelForValue(value)},updateBezierControlPoints:function(){var me=this;var meta=me.getMeta();var area=me.chart.chartArea;var points=meta.data||[];var i,ilen,point,model,controlPoints;if(meta.dataset._model.spanGaps){points=points.filter(function(pt){return!pt._model.skip})}function capControlPoint(pt,min,max){return Math.max(Math.min(pt,max),min)}if(meta.dataset._model.cubicInterpolationMode==="monotone"){helpers.splineCurveMonotone(points)}else{for(i=0,ilen=points.length;i<ilen;++i){point=points[i];model=point._model;controlPoints=helpers.splineCurve(helpers.previousItem(points,i)._model,model,helpers.nextItem(points,i)._model,meta.dataset._model.tension);model.controlPointPreviousX=controlPoints.previous.x;model.controlPointPreviousY=controlPoints.previous.y;model.controlPointNextX=controlPoints.next.x;model.controlPointNextY=controlPoints.next.y}}if(me.chart.options.elements.line.capBezierPoints){for(i=0,ilen=points.length;i<ilen;++i){model=points[i]._model;model.controlPointPreviousX=capControlPoint(model.controlPointPreviousX,area.left,area.right);model.controlPointPreviousY=capControlPoint(model.controlPointPreviousY,area.top,area.bottom);model.controlPointNextX=capControlPoint(model.controlPointNextX,area.left,area.right);model.controlPointNextY=capControlPoint(model.controlPointNextY,area.top,area.bottom)}}},draw:function(){var me=this;var chart=me.chart;var meta=me.getMeta();var points=meta.data||[];var area=chart.chartArea;var ilen=points.length;var i=0;helpers.canvas.clipArea(chart.ctx,area);if(lineEnabled(me.getDataset(),chart.options)){meta.dataset.draw()}helpers.canvas.unclipArea(chart.ctx);for(;i<ilen;++i){points[i].draw(area)}},setHoverStyle:function(point){var dataset=this.chart.data.datasets[point._datasetIndex];var index=point._index;var custom=point.custom||{};var model=point._model;model.radius=custom.hoverRadius||helpers.valueAtIndexOrDefault(dataset.pointHoverRadius,index,this.chart.options.elements.point.hoverRadius);model.backgroundColor=custom.hoverBackgroundColor||helpers.valueAtIndexOrDefault(dataset.pointHoverBackgroundColor,index,helpers.getHoverColor(model.backgroundColor));model.borderColor=custom.hoverBorderColor||helpers.valueAtIndexOrDefault(dataset.pointHoverBorderColor,index,helpers.getHoverColor(model.borderColor));model.borderWidth=custom.hoverBorderWidth||helpers.valueAtIndexOrDefault(dataset.pointHoverBorderWidth,index,model.borderWidth)},removeHoverStyle:function(point){var me=this;var dataset=me.chart.data.datasets[point._datasetIndex];var index=point._index;var custom=point.custom||{};var model=point._model;if(dataset.radius!==undefined&&dataset.pointRadius===undefined){dataset.pointRadius=dataset.radius}model.radius=custom.radius||helpers.valueAtIndexOrDefault(dataset.pointRadius,index,me.chart.options.elements.point.radius);model.backgroundColor=me.getPointBackgroundColor(point,index);model.borderColor=me.getPointBorderColor(point,index);model.borderWidth=me.getPointBorderWidth(point,index)}})}},{"../core/core.defaults":22,"../elements/index":37,"../helpers/index":42}],16:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var elements=require("../elements/index");var helpers=require("../helpers/index");defaults._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:false},gridLines:{circular:true},pointLabels:{display:false},ticks:{beginAtZero:true}},animation:{animateRotate:true,animateScale:true},startAngle:-.5*Math.PI,legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');var data=chart.data;var datasets=data.datasets;var labels=data.labels;if(datasets.length){for(var i=0;i<datasets[0].data.length;++i){text.push('<li><span style="background-color:'+datasets[0].backgroundColor[i]+'"></span>');if(labels[i]){text.push(labels[i])}text.push("</li>")}}text.push("</ul>");return text.join("")},legend:{labels:{generateLabels:function(chart){var data=chart.data;if(data.labels.length&&data.datasets.length){return data.labels.map(function(label,i){var meta=chart.getDatasetMeta(0);var ds=data.datasets[0];var arc=meta.data[i];var custom=arc.custom||{};var valueAtIndexOrDefault=helpers.valueAtIndexOrDefault;var arcOpts=chart.options.elements.arc;var fill=custom.backgroundColor?custom.backgroundColor:valueAtIndexOrDefault(ds.backgroundColor,i,arcOpts.backgroundColor);var stroke=custom.borderColor?custom.borderColor:valueAtIndexOrDefault(ds.borderColor,i,arcOpts.borderColor);var bw=custom.borderWidth?custom.borderWidth:valueAtIndexOrDefault(ds.borderWidth,i,arcOpts.borderWidth);return{text:label,fillStyle:fill,strokeStyle:stroke,lineWidth:bw,hidden:isNaN(ds.data[i])||meta.data[i].hidden,index:i}})}return[]}},onClick:function(e,legendItem){var index=legendItem.index;var chart=this.chart;var i,ilen,meta;for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i){meta=chart.getDatasetMeta(i);meta.data[index].hidden=!meta.data[index].hidden}chart.update()}},tooltips:{callbacks:{title:function(){return""},label:function(item,data){return data.labels[item.index]+": "+item.yLabel}}}});module.exports=function(Chart){Chart.controllers.polarArea=Chart.DatasetController.extend({dataElementType:elements.Arc,linkScales:helpers.noop,update:function(reset){var me=this;var chart=me.chart;var chartArea=chart.chartArea;var meta=me.getMeta();var opts=chart.options;var arcOpts=opts.elements.arc;var minSize=Math.min(chartArea.right-chartArea.left,chartArea.bottom-chartArea.top);chart.outerRadius=Math.max((minSize-arcOpts.borderWidth/2)/2,0);chart.innerRadius=Math.max(opts.cutoutPercentage?chart.outerRadius/100*opts.cutoutPercentage:1,0);chart.radiusLength=(chart.outerRadius-chart.innerRadius)/chart.getVisibleDatasetCount();me.outerRadius=chart.outerRadius-chart.radiusLength*me.index;me.innerRadius=me.outerRadius-chart.radiusLength;meta.count=me.countVisibleElements();helpers.each(meta.data,function(arc,index){me.updateElement(arc,index,reset)})},updateElement:function(arc,index,reset){var me=this;var chart=me.chart;var dataset=me.getDataset();var opts=chart.options;var animationOpts=opts.animation;var scale=chart.scale;var labels=chart.data.labels;var circumference=me.calculateCircumference(dataset.data[index]);var centerX=scale.xCenter;var centerY=scale.yCenter;var visibleCount=0;var meta=me.getMeta();for(var i=0;i<index;++i){if(!isNaN(dataset.data[i])&&!meta.data[i].hidden){++visibleCount}}var datasetStartAngle=opts.startAngle;var distance=arc.hidden?0:scale.getDistanceFromCenterForValue(dataset.data[index]);var startAngle=datasetStartAngle+circumference*visibleCount;var endAngle=startAngle+(arc.hidden?0:circumference);var resetRadius=animationOpts.animateScale?0:scale.getDistanceFromCenterForValue(dataset.data[index]);helpers.extend(arc,{_datasetIndex:me.index,_index:index,_scale:scale,_model:{x:centerX,y:centerY,innerRadius:0,outerRadius:reset?resetRadius:distance,startAngle:reset&&animationOpts.animateRotate?datasetStartAngle:startAngle,endAngle:reset&&animationOpts.animateRotate?datasetStartAngle:endAngle,label:helpers.valueAtIndexOrDefault(labels,index,labels[index])}});me.removeHoverStyle(arc);arc.pivot()},removeHoverStyle:function(arc){Chart.DatasetController.prototype.removeHoverStyle.call(this,arc,this.chart.options.elements.arc)},countVisibleElements:function(){var dataset=this.getDataset();var meta=this.getMeta();var count=0;helpers.each(meta.data,function(element,index){if(!isNaN(dataset.data[index])&&!element.hidden){count++}});return count},calculateCircumference:function(value){var count=this.getMeta().count;if(count>0&&!isNaN(value)){return 2*Math.PI/count}return 0}})}},{"../core/core.defaults":22,"../elements/index":37,"../helpers/index":42}],17:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var elements=require("../elements/index");var helpers=require("../helpers/index");defaults._set("radar",{scale:{type:"radialLinear"},elements:{line:{tension:0}}});module.exports=function(Chart){Chart.controllers.radar=Chart.DatasetController.extend({datasetElementType:elements.Line,dataElementType:elements.Point,linkScales:helpers.noop,update:function(reset){var me=this;var meta=me.getMeta();var line=meta.dataset;var points=meta.data;var custom=line.custom||{};var dataset=me.getDataset();var lineElementOptions=me.chart.options.elements.line;var scale=me.chart.scale;if(dataset.tension!==undefined&&dataset.lineTension===undefined){dataset.lineTension=dataset.tension}helpers.extend(meta.dataset,{_datasetIndex:me.index,_scale:scale,_children:points,_loop:true,_model:{tension:custom.tension?custom.tension:helpers.valueOrDefault(dataset.lineTension,lineElementOptions.tension),backgroundColor:custom.backgroundColor?custom.backgroundColor:dataset.backgroundColor||lineElementOptions.backgroundColor,borderWidth:custom.borderWidth?custom.borderWidth:dataset.borderWidth||lineElementOptions.borderWidth,borderColor:custom.borderColor?custom.borderColor:dataset.borderColor||lineElementOptions.borderColor,fill:custom.fill?custom.fill:dataset.fill!==undefined?dataset.fill:lineElementOptions.fill,borderCapStyle:custom.borderCapStyle?custom.borderCapStyle:dataset.borderCapStyle||lineElementOptions.borderCapStyle,borderDash:custom.borderDash?custom.borderDash:dataset.borderDash||lineElementOptions.borderDash,borderDashOffset:custom.borderDashOffset?custom.borderDashOffset:dataset.borderDashOffset||lineElementOptions.borderDashOffset,borderJoinStyle:custom.borderJoinStyle?custom.borderJoinStyle:dataset.borderJoinStyle||lineElementOptions.borderJoinStyle}});meta.dataset.pivot();helpers.each(points,function(point,index){me.updateElement(point,index,reset)},me);me.updateBezierControlPoints()},updateElement:function(point,index,reset){var me=this;var custom=point.custom||{};var dataset=me.getDataset();var scale=me.chart.scale;var pointElementOptions=me.chart.options.elements.point;var pointPosition=scale.getPointPositionForValue(index,dataset.data[index]);if(dataset.radius!==undefined&&dataset.pointRadius===undefined){dataset.pointRadius=dataset.radius}if(dataset.hitRadius!==undefined&&dataset.pointHitRadius===undefined){dataset.pointHitRadius=dataset.hitRadius}helpers.extend(point,{_datasetIndex:me.index,_index:index,_scale:scale,_model:{x:reset?scale.xCenter:pointPosition.x,y:reset?scale.yCenter:pointPosition.y,tension:custom.tension?custom.tension:helpers.valueOrDefault(dataset.lineTension,me.chart.options.elements.line.tension),radius:custom.radius?custom.radius:helpers.valueAtIndexOrDefault(dataset.pointRadius,index,pointElementOptions.radius),backgroundColor:custom.backgroundColor?custom.backgroundColor:helpers.valueAtIndexOrDefault(dataset.pointBackgroundColor,index,pointElementOptions.backgroundColor),borderColor:custom.borderColor?custom.borderColor:helpers.valueAtIndexOrDefault(dataset.pointBorderColor,index,pointElementOptions.borderColor),borderWidth:custom.borderWidth?custom.borderWidth:helpers.valueAtIndexOrDefault(dataset.pointBorderWidth,index,pointElementOptions.borderWidth),pointStyle:custom.pointStyle?custom.pointStyle:helpers.valueAtIndexOrDefault(dataset.pointStyle,index,pointElementOptions.pointStyle),hitRadius:custom.hitRadius?custom.hitRadius:helpers.valueAtIndexOrDefault(dataset.pointHitRadius,index,pointElementOptions.hitRadius)}});point._model.skip=custom.skip?custom.skip:isNaN(point._model.x)||isNaN(point._model.y)},updateBezierControlPoints:function(){var chartArea=this.chart.chartArea;var meta=this.getMeta();helpers.each(meta.data,function(point,index){var model=point._model;var controlPoints=helpers.splineCurve(helpers.previousItem(meta.data,index,true)._model,model,helpers.nextItem(meta.data,index,true)._model,model.tension);model.controlPointPreviousX=Math.max(Math.min(controlPoints.previous.x,chartArea.right),chartArea.left);model.controlPointPreviousY=Math.max(Math.min(controlPoints.previous.y,chartArea.bottom),chartArea.top);model.controlPointNextX=Math.max(Math.min(controlPoints.next.x,chartArea.right),chartArea.left);model.controlPointNextY=Math.max(Math.min(controlPoints.next.y,chartArea.bottom),chartArea.top);point.pivot()})},setHoverStyle:function(point){var dataset=this.chart.data.datasets[point._datasetIndex];var custom=point.custom||{};var index=point._index;var model=point._model;model.radius=custom.hoverRadius?custom.hoverRadius:helpers.valueAtIndexOrDefault(dataset.pointHoverRadius,index,this.chart.options.elements.point.hoverRadius);model.backgroundColor=custom.hoverBackgroundColor?custom.hoverBackgroundColor:helpers.valueAtIndexOrDefault(dataset.pointHoverBackgroundColor,index,helpers.getHoverColor(model.backgroundColor));model.borderColor=custom.hoverBorderColor?custom.hoverBorderColor:helpers.valueAtIndexOrDefault(dataset.pointHoverBorderColor,index,helpers.getHoverColor(model.borderColor));model.borderWidth=custom.hoverBorderWidth?custom.hoverBorderWidth:helpers.valueAtIndexOrDefault(dataset.pointHoverBorderWidth,index,model.borderWidth)},removeHoverStyle:function(point){var dataset=this.chart.data.datasets[point._datasetIndex];var custom=point.custom||{};var index=point._index;var model=point._model;var pointElementOptions=this.chart.options.elements.point;model.radius=custom.radius?custom.radius:helpers.valueAtIndexOrDefault(dataset.pointRadius,index,pointElementOptions.radius);model.backgroundColor=custom.backgroundColor?custom.backgroundColor:helpers.valueAtIndexOrDefault(dataset.pointBackgroundColor,index,pointElementOptions.backgroundColor);model.borderColor=custom.borderColor?custom.borderColor:helpers.valueAtIndexOrDefault(dataset.pointBorderColor,index,pointElementOptions.borderColor);model.borderWidth=custom.borderWidth?custom.borderWidth:helpers.valueAtIndexOrDefault(dataset.pointBorderWidth,index,pointElementOptions.borderWidth)}})}},{"../core/core.defaults":22,"../elements/index":37,"../helpers/index":42}],18:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");defaults._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},showLines:false,tooltips:{callbacks:{title:function(){return""},label:function(item){return"("+item.xLabel+", "+item.yLabel+")"}}}});module.exports=function(Chart){Chart.controllers.scatter=Chart.controllers.line}},{"../core/core.defaults":22}],19:[function(require,module,exports){"use strict";var defaults=require("./core.defaults");var Element=require("./core.element");var helpers=require("../helpers/index");defaults._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:helpers.noop,onComplete:helpers.noop}});module.exports=function(Chart){Chart.Animation=Element.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null});Chart.animationService={frameDuration:17,animations:[],dropFrames:0,request:null,addAnimation:function(chart,animation,duration,lazy){var animations=this.animations;var i,ilen;animation.chart=chart;if(!lazy){chart.animating=true}for(i=0,ilen=animations.length;i<ilen;++i){if(animations[i].chart===chart){animations[i]=animation;return}}animations.push(animation);if(animations.length===1){this.requestAnimationFrame()}},cancelAnimation:function(chart){var index=helpers.findIndex(this.animations,function(animation){return animation.chart===chart});if(index!==-1){this.animations.splice(index,1);chart.animating=false}},requestAnimationFrame:function(){var me=this;if(me.request===null){me.request=helpers.requestAnimFrame.call(window,function(){me.request=null;me.startDigest()})}},startDigest:function(){var me=this;var startTime=Date.now();var framesToDrop=0;if(me.dropFrames>1){framesToDrop=Math.floor(me.dropFrames);me.dropFrames=me.dropFrames%1}me.advance(1+framesToDrop);var endTime=Date.now();me.dropFrames+=(endTime-startTime)/me.frameDuration;if(me.animations.length>0){me.requestAnimationFrame()}},advance:function(count){var animations=this.animations;var animation,chart;var i=0;while(i<animations.length){animation=animations[i];chart=animation.chart;animation.currentStep=(animation.currentStep||0)+count;animation.currentStep=Math.min(animation.currentStep,animation.numSteps);helpers.callback(animation.render,[chart,animation],chart);helpers.callback(animation.onAnimationProgress,[animation],chart);if(animation.currentStep>=animation.numSteps){helpers.callback(animation.onAnimationComplete,[animation],chart);chart.animating=false;animations.splice(i,1)}else{++i}}}};Object.defineProperty(Chart.Animation.prototype,"animationObject",{get:function(){return this}});Object.defineProperty(Chart.Animation.prototype,"chartInstance",{get:function(){return this.chart},set:function(value){this.chart=value}})}},{"../helpers/index":42,"./core.defaults":22,"./core.element":23}],20:[function(require,module,exports){"use strict";var defaults=require("./core.defaults");var helpers=require("../helpers/index");var Interaction=require("./core.interaction");var layouts=require("./core.layouts");var platform=require("../platforms/platform");var plugins=require("./core.plugins");module.exports=function(Chart){Chart.types={};Chart.instances={};Chart.controllers={};function initConfig(config){config=config||{};var data=config.data=config.data||{};data.datasets=data.datasets||[];data.labels=data.labels||[];config.options=helpers.configMerge(defaults.global,defaults[config.type],config.options||{});return config}function updateConfig(chart){var newOptions=chart.options;helpers.each(chart.scales,function(scale){layouts.removeBox(chart,scale)});newOptions=helpers.configMerge(Chart.defaults.global,Chart.defaults[chart.config.type],newOptions);chart.options=chart.config.options=newOptions;chart.ensureScalesHaveIDs();chart.buildOrUpdateScales();chart.tooltip._options=newOptions.tooltips;chart.tooltip.initialize()}function positionIsHorizontal(position){return position==="top"||position==="bottom"}helpers.extend(Chart.prototype,{construct:function(item,config){var me=this;config=initConfig(config);var context=platform.acquireContext(item,config);var canvas=context&&context.canvas;var height=canvas&&canvas.height;var width=canvas&&canvas.width;me.id=helpers.uid();me.ctx=context;me.canvas=canvas;me.config=config;me.width=width;me.height=height;me.aspectRatio=height?width/height:null;me.options=config.options;me._bufferedRender=false;me.chart=me;me.controller=me;Chart.instances[me.id]=me;Object.defineProperty(me,"data",{get:function(){return me.config.data},set:function(value){me.config.data=value}});if(!context||!canvas){console.error("Failed to create chart: can't acquire context from the given item");return}me.initialize();me.update()},initialize:function(){var me=this;plugins.notify(me,"beforeInit");helpers.retinaScale(me,me.options.devicePixelRatio);me.bindEvents();if(me.options.responsive){me.resize(true)}me.ensureScalesHaveIDs();me.buildOrUpdateScales();me.initToolTip();plugins.notify(me,"afterInit");return me},clear:function(){helpers.canvas.clear(this);return this},stop:function(){Chart.animationService.cancelAnimation(this);return this},resize:function(silent){var me=this;var options=me.options;var canvas=me.canvas;var aspectRatio=options.maintainAspectRatio&&me.aspectRatio||null;var newWidth=Math.max(0,Math.floor(helpers.getMaximumWidth(canvas)));var newHeight=Math.max(0,Math.floor(aspectRatio?newWidth/aspectRatio:helpers.getMaximumHeight(canvas)));if(me.width===newWidth&&me.height===newHeight){return}canvas.width=me.width=newWidth;canvas.height=me.height=newHeight;canvas.style.width=newWidth+"px";canvas.style.height=newHeight+"px";helpers.retinaScale(me,options.devicePixelRatio);if(!silent){var newSize={width:newWidth,height:newHeight};plugins.notify(me,"resize",[newSize]);if(me.options.onResize){me.options.onResize(me,newSize)}me.stop();me.update(me.options.responsiveAnimationDuration)}},ensureScalesHaveIDs:function(){var options=this.options;var scalesOptions=options.scales||{};var scaleOptions=options.scale;helpers.each(scalesOptions.xAxes,function(xAxisOptions,index){xAxisOptions.id=xAxisOptions.id||"x-axis-"+index});helpers.each(scalesOptions.yAxes,function(yAxisOptions,index){yAxisOptions.id=yAxisOptions.id||"y-axis-"+index});if(scaleOptions){scaleOptions.id=scaleOptions.id||"scale"}},buildOrUpdateScales:function(){var me=this;var options=me.options;var scales=me.scales||{};var items=[];var updated=Object.keys(scales).reduce(function(obj,id){obj[id]=false;return obj},{});if(options.scales){items=items.concat((options.scales.xAxes||[]).map(function(xAxisOptions){return{options:xAxisOptions,dtype:"category",dposition:"bottom"}}),(options.scales.yAxes||[]).map(function(yAxisOptions){return{options:yAxisOptions,dtype:"linear",dposition:"left"}}))}if(options.scale){items.push({options:options.scale,dtype:"radialLinear",isDefault:true,dposition:"chartArea"})}helpers.each(items,function(item){var scaleOptions=item.options;var id=scaleOptions.id;var scaleType=helpers.valueOrDefault(scaleOptions.type,item.dtype);if(positionIsHorizontal(scaleOptions.position)!==positionIsHorizontal(item.dposition)){scaleOptions.position=item.dposition}updated[id]=true;var scale=null;if(id in scales&&scales[id].type===scaleType){scale=scales[id];scale.options=scaleOptions;scale.ctx=me.ctx;scale.chart=me}else{var scaleClass=Chart.scaleService.getScaleConstructor(scaleType);if(!scaleClass){return}scale=new scaleClass({id:id,type:scaleType,options:scaleOptions,ctx:me.ctx,chart:me});scales[scale.id]=scale}scale.mergeTicksOptions();if(item.isDefault){me.scale=scale}});helpers.each(updated,function(hasUpdated,id){if(!hasUpdated){delete scales[id]}});me.scales=scales;Chart.scaleService.addScalesToLayout(this)},buildOrUpdateControllers:function(){var me=this;var types=[];var newControllers=[];helpers.each(me.data.datasets,function(dataset,datasetIndex){var meta=me.getDatasetMeta(datasetIndex);var type=dataset.type||me.config.type;if(meta.type&&meta.type!==type){me.destroyDatasetMeta(datasetIndex);meta=me.getDatasetMeta(datasetIndex)}meta.type=type;types.push(meta.type);if(meta.controller){meta.controller.updateIndex(datasetIndex);meta.controller.linkScales()}else{var ControllerClass=Chart.controllers[meta.type];if(ControllerClass===undefined){throw new Error('"'+meta.type+'" is not a chart type.')}meta.controller=new ControllerClass(me,datasetIndex);newControllers.push(meta.controller)}},me);return newControllers},resetElements:function(){var me=this;helpers.each(me.data.datasets,function(dataset,datasetIndex){me.getDatasetMeta(datasetIndex).controller.reset()},me)},reset:function(){this.resetElements();this.tooltip.initialize()},update:function(config){var me=this;if(!config||typeof config!=="object"){config={duration:config,lazy:arguments[1]}}updateConfig(me);plugins._invalidate(me);if(plugins.notify(me,"beforeUpdate")===false){return}me.tooltip._data=me.data;var newControllers=me.buildOrUpdateControllers();helpers.each(me.data.datasets,function(dataset,datasetIndex){me.getDatasetMeta(datasetIndex).controller.buildOrUpdateElements()},me);me.updateLayout();if(me.options.animation&&me.options.animation.duration){helpers.each(newControllers,function(controller){controller.reset()})}me.updateDatasets();me.tooltip.initialize();me.lastActive=[];plugins.notify(me,"afterUpdate");if(me._bufferedRender){me._bufferedRequest={duration:config.duration,easing:config.easing,lazy:config.lazy}}else{me.render(config)}},updateLayout:function(){var me=this;if(plugins.notify(me,"beforeLayout")===false){return}layouts.update(this,this.width,this.height);plugins.notify(me,"afterScaleUpdate");plugins.notify(me,"afterLayout")},updateDatasets:function(){var me=this;if(plugins.notify(me,"beforeDatasetsUpdate")===false){return}for(var i=0,ilen=me.data.datasets.length;i<ilen;++i){me.updateDataset(i)}plugins.notify(me,"afterDatasetsUpdate")},updateDataset:function(index){var me=this;var meta=me.getDatasetMeta(index);var args={meta:meta,index:index};if(plugins.notify(me,"beforeDatasetUpdate",[args])===false){return}meta.controller.update();plugins.notify(me,"afterDatasetUpdate",[args])},render:function(config){var me=this;if(!config||typeof config!=="object"){config={duration:config,lazy:arguments[1]}}var duration=config.duration;var lazy=config.lazy;if(plugins.notify(me,"beforeRender")===false){return}var animationOptions=me.options.animation;var onComplete=function(animation){plugins.notify(me,"afterRender");helpers.callback(animationOptions&&animationOptions.onComplete,[animation],me)};if(animationOptions&&(typeof duration!=="undefined"&&duration!==0||typeof duration==="undefined"&&animationOptions.duration!==0)){var animation=new Chart.Animation({numSteps:(duration||animationOptions.duration)/16.66,easing:config.easing||animationOptions.easing,render:function(chart,animationObject){var easingFunction=helpers.easing.effects[animationObject.easing];var currentStep=animationObject.currentStep;var stepDecimal=currentStep/animationObject.numSteps;chart.draw(easingFunction(stepDecimal),stepDecimal,currentStep)},onAnimationProgress:animationOptions.onProgress,onAnimationComplete:onComplete});Chart.animationService.addAnimation(me,animation,duration,lazy)}else{me.draw();onComplete(new Chart.Animation({numSteps:0,chart:me}))}return me},draw:function(easingValue){var me=this;me.clear();if(helpers.isNullOrUndef(easingValue)){easingValue=1}me.transition(easingValue);if(plugins.notify(me,"beforeDraw",[easingValue])===false){return}helpers.each(me.boxes,function(box){box.draw(me.chartArea)},me);if(me.scale){me.scale.draw()}me.drawDatasets(easingValue);me._drawTooltip(easingValue);plugins.notify(me,"afterDraw",[easingValue])},transition:function(easingValue){var me=this;for(var i=0,ilen=(me.data.datasets||[]).length;i<ilen;++i){if(me.isDatasetVisible(i)){me.getDatasetMeta(i).controller.transition(easingValue)}}me.tooltip.transition(easingValue)},drawDatasets:function(easingValue){var me=this;if(plugins.notify(me,"beforeDatasetsDraw",[easingValue])===false){return}for(var i=(me.data.datasets||[]).length-1;i>=0;--i){if(me.isDatasetVisible(i)){me.drawDataset(i,easingValue)}}plugins.notify(me,"afterDatasetsDraw",[easingValue])},drawDataset:function(index,easingValue){var me=this;var meta=me.getDatasetMeta(index);var args={meta:meta,index:index,easingValue:easingValue};if(plugins.notify(me,"beforeDatasetDraw",[args])===false){return}meta.controller.draw(easingValue);plugins.notify(me,"afterDatasetDraw",[args])},_drawTooltip:function(easingValue){var me=this;var tooltip=me.tooltip;var args={tooltip:tooltip,easingValue:easingValue};if(plugins.notify(me,"beforeTooltipDraw",[args])===false){return}tooltip.draw();plugins.notify(me,"afterTooltipDraw",[args])},getElementAtEvent:function(e){return Interaction.modes.single(this,e)},getElementsAtEvent:function(e){return Interaction.modes.label(this,e,{intersect:true})},getElementsAtXAxis:function(e){return Interaction.modes["x-axis"](this,e,{intersect:true})},getElementsAtEventForMode:function(e,mode,options){var method=Interaction.modes[mode];if(typeof method==="function"){return method(this,e,options)}return[]},getDatasetAtEvent:function(e){return Interaction.modes.dataset(this,e,{intersect:true})},getDatasetMeta:function(datasetIndex){var me=this;var dataset=me.data.datasets[datasetIndex];if(!dataset._meta){dataset._meta={}}var meta=dataset._meta[me.id];if(!meta){meta=dataset._meta[me.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}}return meta},getVisibleDatasetCount:function(){var count=0;for(var i=0,ilen=this.data.datasets.length;i<ilen;++i){if(this.isDatasetVisible(i)){count++}}return count},isDatasetVisible:function(datasetIndex){var meta=this.getDatasetMeta(datasetIndex);return typeof meta.hidden==="boolean"?!meta.hidden:!this.data.datasets[datasetIndex].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(datasetIndex){var id=this.id;var dataset=this.data.datasets[datasetIndex];var meta=dataset._meta&&dataset._meta[id];if(meta){meta.controller.destroy();delete dataset._meta[id]}},destroy:function(){var me=this;var canvas=me.canvas;var i,ilen;me.stop();for(i=0,ilen=me.data.datasets.length;i<ilen;++i){me.destroyDatasetMeta(i)}if(canvas){me.unbindEvents();helpers.canvas.clear(me);platform.releaseContext(me.ctx);me.canvas=null;me.ctx=null}plugins.notify(me,"destroy");delete Chart.instances[me.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var me=this;me.tooltip=new Chart.Tooltip({_chart:me,_chartInstance:me,_data:me.data,_options:me.options.tooltips},me)},bindEvents:function(){var me=this;var listeners=me._listeners={};var listener=function(){me.eventHandler.apply(me,arguments)};helpers.each(me.options.events,function(type){platform.addEventListener(me,type,listener);listeners[type]=listener});if(me.options.responsive){listener=function(){me.resize()};platform.addEventListener(me,"resize",listener);listeners.resize=listener}},unbindEvents:function(){var me=this;var listeners=me._listeners;if(!listeners){return}delete me._listeners;helpers.each(listeners,function(listener,type){platform.removeEventListener(me,type,listener)})},updateHoverStyle:function(elements,mode,enabled){var method=enabled?"setHoverStyle":"removeHoverStyle";var element,i,ilen;for(i=0,ilen=elements.length;i<ilen;++i){element=elements[i];if(element){this.getDatasetMeta(element._datasetIndex).controller[method](element)}}},eventHandler:function(e){var me=this;var tooltip=me.tooltip;if(plugins.notify(me,"beforeEvent",[e])===false){return}me._bufferedRender=true;me._bufferedRequest=null;var changed=me.handleEvent(e);if(tooltip){changed=tooltip._start?tooltip.handleEvent(e):changed|tooltip.handleEvent(e)}plugins.notify(me,"afterEvent",[e]);var bufferedRequest=me._bufferedRequest;if(bufferedRequest){me.render(bufferedRequest)}else if(changed&&!me.animating){me.stop();me.render(me.options.hover.animationDuration,true)}me._bufferedRender=false;me._bufferedRequest=null;return me},handleEvent:function(e){var me=this;var options=me.options||{};var hoverOptions=options.hover;var changed=false;me.lastActive=me.lastActive||[];if(e.type==="mouseout"){me.active=[]}else{me.active=me.getElementsAtEventForMode(e,hoverOptions.mode,hoverOptions)}helpers.callback(options.onHover||options.hover.onHover,[e.native,me.active],me);if(e.type==="mouseup"||e.type==="click"){if(options.onClick){options.onClick.call(me,e.native,me.active)}}if(me.lastActive.length){me.updateHoverStyle(me.lastActive,hoverOptions.mode,false)}if(me.active.length&&hoverOptions.mode){me.updateHoverStyle(me.active,hoverOptions.mode,true)}changed=!helpers.arrayEquals(me.active,me.lastActive);me.lastActive=me.active;return changed}});Chart.Controller=Chart}},{"../helpers/index":42,"../platforms/platform":45,"./core.defaults":22,"./core.interaction":25,"./core.layouts":27,"./core.plugins":28}],21:[function(require,module,exports){"use strict";var helpers=require("../helpers/index");module.exports=function(Chart){var arrayEvents=["push","pop","shift","splice","unshift"];function listenArrayEvents(array,listener){if(array._chartjs){array._chartjs.listeners.push(listener);return}Object.defineProperty(array,"_chartjs",{configurable:true,enumerable:false,value:{listeners:[listener]}});arrayEvents.forEach(function(key){var method="onData"+key.charAt(0).toUpperCase()+key.slice(1);var base=array[key];Object.defineProperty(array,key,{configurable:true,enumerable:false,value:function(){var args=Array.prototype.slice.call(arguments);var res=base.apply(this,args);helpers.each(array._chartjs.listeners,function(object){if(typeof object[method]==="function"){object[method].apply(object,args)}});return res}})})}function unlistenArrayEvents(array,listener){var stub=array._chartjs;if(!stub){return}var listeners=stub.listeners;var index=listeners.indexOf(listener);if(index!==-1){listeners.splice(index,1)}if(listeners.length>0){return}arrayEvents.forEach(function(key){delete array[key]});delete array._chartjs}Chart.DatasetController=function(chart,datasetIndex){this.initialize(chart,datasetIndex)};helpers.extend(Chart.DatasetController.prototype,{datasetElementType:null,dataElementType:null,initialize:function(chart,datasetIndex){var me=this;me.chart=chart;me.index=datasetIndex;me.linkScales();me.addElements()},updateIndex:function(datasetIndex){this.index=datasetIndex},linkScales:function(){var me=this;var meta=me.getMeta();var dataset=me.getDataset();if(meta.xAxisID===null||!(meta.xAxisID in me.chart.scales)){meta.xAxisID=dataset.xAxisID||me.chart.options.scales.xAxes[0].id}if(meta.yAxisID===null||!(meta.yAxisID in me.chart.scales)){meta.yAxisID=dataset.yAxisID||me.chart.options.scales.yAxes[0].id}},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(scaleID){return this.chart.scales[scaleID]},reset:function(){this.update(true)},destroy:function(){if(this._data){unlistenArrayEvents(this._data,this)}},createMetaDataset:function(){var me=this;var type=me.datasetElementType;return type&&new type({_chart:me.chart,_datasetIndex:me.index})},createMetaData:function(index){var me=this;var type=me.dataElementType;return type&&new type({_chart:me.chart,_datasetIndex:me.index,_index:index})},addElements:function(){var me=this;var meta=me.getMeta();var data=me.getDataset().data||[];var metaData=meta.data;var i,ilen;for(i=0,ilen=data.length;i<ilen;++i){metaData[i]=metaData[i]||me.createMetaData(i)}meta.dataset=meta.dataset||me.createMetaDataset()},addElementAndReset:function(index){var element=this.createMetaData(index);this.getMeta().data.splice(index,0,element);this.updateElement(element,index,true)},buildOrUpdateElements:function(){var me=this;var dataset=me.getDataset();var data=dataset.data||(dataset.data=[]);if(me._data!==data){if(me._data){unlistenArrayEvents(me._data,me)}listenArrayEvents(data,me);me._data=data}me.resyncElements()},update:helpers.noop,transition:function(easingValue){var meta=this.getMeta();var elements=meta.data||[];var ilen=elements.length;var i=0;for(;i<ilen;++i){elements[i].transition(easingValue)}if(meta.dataset){meta.dataset.transition(easingValue)}},draw:function(){var meta=this.getMeta();var elements=meta.data||[];var ilen=elements.length;var i=0;if(meta.dataset){meta.dataset.draw()}for(;i<ilen;++i){elements[i].draw()}},removeHoverStyle:function(element,elementOpts){var dataset=this.chart.data.datasets[element._datasetIndex];var index=element._index;var custom=element.custom||{};var valueOrDefault=helpers.valueAtIndexOrDefault;var model=element._model;model.backgroundColor=custom.backgroundColor?custom.backgroundColor:valueOrDefault(dataset.backgroundColor,index,elementOpts.backgroundColor);model.borderColor=custom.borderColor?custom.borderColor:valueOrDefault(dataset.borderColor,index,elementOpts.borderColor);model.borderWidth=custom.borderWidth?custom.borderWidth:valueOrDefault(dataset.borderWidth,index,elementOpts.borderWidth)},setHoverStyle:function(element){var dataset=this.chart.data.datasets[element._datasetIndex];var index=element._index;var custom=element.custom||{};var valueOrDefault=helpers.valueAtIndexOrDefault;var getHoverColor=helpers.getHoverColor;var model=element._model;model.backgroundColor=custom.hoverBackgroundColor?custom.hoverBackgroundColor:valueOrDefault(dataset.hoverBackgroundColor,index,getHoverColor(model.backgroundColor));model.borderColor=custom.hoverBorderColor?custom.hoverBorderColor:valueOrDefault(dataset.hoverBorderColor,index,getHoverColor(model.borderColor));model.borderWidth=custom.hoverBorderWidth?custom.hoverBorderWidth:valueOrDefault(dataset.hoverBorderWidth,index,model.borderWidth)},resyncElements:function(){var me=this;var meta=me.getMeta();var data=me.getDataset().data;var numMeta=meta.data.length;var numData=data.length;if(numData<numMeta){meta.data.splice(numData,numMeta-numData)}else if(numData>numMeta){me.insertElements(numMeta,numData-numMeta)}},insertElements:function(start,count){for(var i=0;i<count;++i){this.addElementAndReset(start+i)}},onDataPush:function(){this.insertElements(this.getDataset().data.length-1,arguments.length)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(start,count){this.getMeta().data.splice(start,count);this.insertElements(start,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}});Chart.DatasetController.extend=helpers.inherits}},{"../helpers/index":42}],22:[function(require,module,exports){"use strict";var helpers=require("../helpers/index");module.exports={_set:function(scope,values){return helpers.merge(this[scope]||(this[scope]={}),values)}}},{"../helpers/index":42}],23:[function(require,module,exports){"use strict";var color=require("chartjs-color");var helpers=require("../helpers/index");function interpolate(start,view,model,ease){var keys=Object.keys(model);var i,ilen,key,actual,origin,target,type,c0,c1;for(i=0,ilen=keys.length;i<ilen;++i){key=keys[i];target=model[key];if(!view.hasOwnProperty(key)){view[key]=target}actual=view[key];if(actual===target||key[0]==="_"){continue}if(!start.hasOwnProperty(key)){start[key]=actual}origin=start[key];type=typeof target;if(type===typeof origin){if(type==="string"){c0=color(origin);if(c0.valid){c1=color(target);if(c1.valid){view[key]=c1.mix(c0,ease).rgbString();continue}}}else if(type==="number"&&isFinite(origin)&&isFinite(target)){view[key]=origin+(target-origin)*ease;continue}}view[key]=target}}var Element=function(configuration){helpers.extend(this,configuration);this.initialize.apply(this,arguments)};helpers.extend(Element.prototype,{initialize:function(){this.hidden=false},pivot:function(){var me=this;if(!me._view){me._view=helpers.clone(me._model)}me._start={};return me},transition:function(ease){var me=this;var model=me._model;var start=me._start;var view=me._view;if(!model||ease===1){me._view=model;me._start=null;return me}if(!view){view=me._view={}}if(!start){start=me._start={}}interpolate(start,view,model,ease);return me},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return helpers.isNumber(this._model.x)&&helpers.isNumber(this._model.y)}});Element.extend=helpers.inherits;module.exports=Element},{"../helpers/index":42,"chartjs-color":57}],24:[function(require,module,exports){"use strict";var color=require("chartjs-color");var defaults=require("./core.defaults");var helpers=require("../helpers/index");module.exports=function(Chart){helpers.configMerge=function(){return helpers.merge(helpers.clone(arguments[0]),[].slice.call(arguments,1),{merger:function(key,target,source,options){var tval=target[key]||{};var sval=source[key];if(key==="scales"){target[key]=helpers.scaleMerge(tval,sval)}else if(key==="scale"){target[key]=helpers.merge(tval,[Chart.scaleService.getScaleDefaults(sval.type),sval])}else{helpers._merger(key,target,source,options)}}})};helpers.scaleMerge=function(){return helpers.merge(helpers.clone(arguments[0]),[].slice.call(arguments,1),{merger:function(key,target,source,options){if(key==="xAxes"||key==="yAxes"){var slen=source[key].length;var i,type,scale;if(!target[key]){target[key]=[]}for(i=0;i<slen;++i){scale=source[key][i];type=helpers.valueOrDefault(scale.type,key==="xAxes"?"category":"linear");if(i>=target[key].length){target[key].push({})}if(!target[key][i].type||scale.type&&scale.type!==target[key][i].type){helpers.merge(target[key][i],[Chart.scaleService.getScaleDefaults(type),scale])}else{helpers.merge(target[key][i],scale)}}}else{helpers._merger(key,target,source,options)}}})};helpers.where=function(collection,filterCallback){if(helpers.isArray(collection)&&Array.prototype.filter){return collection.filter(filterCallback)}var filtered=[];helpers.each(collection,function(item){if(filterCallback(item)){filtered.push(item)}});return filtered};helpers.findIndex=Array.prototype.findIndex?function(array,callback,scope){return array.findIndex(callback,scope)}:function(array,callback,scope){scope=scope===undefined?array:scope;for(var i=0,ilen=array.length;i<ilen;++i){if(callback.call(scope,array[i],i,array)){return i}}return-1};helpers.findNextWhere=function(arrayToSearch,filterCallback,startIndex){if(helpers.isNullOrUndef(startIndex)){startIndex=-1}for(var i=startIndex+1;i<arrayToSearch.length;i++){var currentItem=arrayToSearch[i];if(filterCallback(currentItem)){return currentItem}}};helpers.findPreviousWhere=function(arrayToSearch,filterCallback,startIndex){if(helpers.isNullOrUndef(startIndex)){startIndex=arrayToSearch.length}for(var i=startIndex-1;i>=0;i--){var currentItem=arrayToSearch[i];if(filterCallback(currentItem)){return currentItem}}};helpers.isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n)};helpers.almostEquals=function(x,y,epsilon){return Math.abs(x-y)<epsilon};helpers.almostWhole=function(x,epsilon){var rounded=Math.round(x);return rounded-epsilon<x&&rounded+epsilon>x};helpers.max=function(array){return array.reduce(function(max,value){if(!isNaN(value)){return Math.max(max,value)}return max},Number.NEGATIVE_INFINITY)};helpers.min=function(array){return array.reduce(function(min,value){if(!isNaN(value)){return Math.min(min,value)}return min},Number.POSITIVE_INFINITY)};helpers.sign=Math.sign?function(x){return Math.sign(x)}:function(x){x=+x;if(x===0||isNaN(x)){return x}return x>0?1:-1};helpers.log10=Math.log10?function(x){return Math.log10(x)}:function(x){var exponent=Math.log(x)*Math.LOG10E;var powerOf10=Math.round(exponent);var isPowerOf10=x===Math.pow(10,powerOf10);return isPowerOf10?powerOf10:exponent};helpers.toRadians=function(degrees){return degrees*(Math.PI/180)};helpers.toDegrees=function(radians){return radians*(180/Math.PI)};helpers.getAngleFromPoint=function(centrePoint,anglePoint){var distanceFromXCenter=anglePoint.x-centrePoint.x;var distanceFromYCenter=anglePoint.y-centrePoint.y;var radialDistanceFromCenter=Math.sqrt(distanceFromXCenter*distanceFromXCenter+distanceFromYCenter*distanceFromYCenter);var angle=Math.atan2(distanceFromYCenter,distanceFromXCenter);if(angle<-.5*Math.PI){angle+=2*Math.PI}return{angle:angle,distance:radialDistanceFromCenter}};helpers.distanceBetweenPoints=function(pt1,pt2){return Math.sqrt(Math.pow(pt2.x-pt1.x,2)+Math.pow(pt2.y-pt1.y,2))};helpers.aliasPixel=function(pixelWidth){return pixelWidth%2===0?0:.5};helpers.splineCurve=function(firstPoint,middlePoint,afterPoint,t){var previous=firstPoint.skip?middlePoint:firstPoint;var current=middlePoint;var next=afterPoint.skip?middlePoint:afterPoint;var d01=Math.sqrt(Math.pow(current.x-previous.x,2)+Math.pow(current.y-previous.y,2));var d12=Math.sqrt(Math.pow(next.x-current.x,2)+Math.pow(next.y-current.y,2));var s01=d01/(d01+d12);var s12=d12/(d01+d12);s01=isNaN(s01)?0:s01;s12=isNaN(s12)?0:s12;var fa=t*s01;var fb=t*s12;return{previous:{x:current.x-fa*(next.x-previous.x),y:current.y-fa*(next.y-previous.y)},next:{x:current.x+fb*(next.x-previous.x),y:current.y+fb*(next.y-previous.y)}}};helpers.EPSILON=Number.EPSILON||1e-14;helpers.splineCurveMonotone=function(points){var pointsWithTangents=(points||[]).map(function(point){return{model:point._model,deltaK:0,mK:0}});var pointsLen=pointsWithTangents.length;var i,pointBefore,pointCurrent,pointAfter;for(i=0;i<pointsLen;++i){pointCurrent=pointsWithTangents[i];if(pointCurrent.model.skip){continue}pointBefore=i>0?pointsWithTangents[i-1]:null;pointAfter=i<pointsLen-1?pointsWithTangents[i+1]:null;if(pointAfter&&!pointAfter.model.skip){var slopeDeltaX=pointAfter.model.x-pointCurrent.model.x;pointCurrent.deltaK=slopeDeltaX!==0?(pointAfter.model.y-pointCurrent.model.y)/slopeDeltaX:0}if(!pointBefore||pointBefore.model.skip){pointCurrent.mK=pointCurrent.deltaK}else if(!pointAfter||pointAfter.model.skip){pointCurrent.mK=pointBefore.deltaK}else if(this.sign(pointBefore.deltaK)!==this.sign(pointCurrent.deltaK)){pointCurrent.mK=0}else{pointCurrent.mK=(pointBefore.deltaK+pointCurrent.deltaK)/2}}var alphaK,betaK,tauK,squaredMagnitude;for(i=0;i<pointsLen-1;++i){pointCurrent=pointsWithTangents[i];pointAfter=pointsWithTangents[i+1];if(pointCurrent.model.skip||pointAfter.model.skip){continue}if(helpers.almostEquals(pointCurrent.deltaK,0,this.EPSILON)){pointCurrent.mK=pointAfter.mK=0;continue}alphaK=pointCurrent.mK/pointCurrent.deltaK;betaK=pointAfter.mK/pointCurrent.deltaK;squaredMagnitude=Math.pow(alphaK,2)+Math.pow(betaK,2);if(squaredMagnitude<=9){continue}tauK=3/Math.sqrt(squaredMagnitude);pointCurrent.mK=alphaK*tauK*pointCurrent.deltaK;pointAfter.mK=betaK*tauK*pointCurrent.deltaK}var deltaX;for(i=0;i<pointsLen;++i){pointCurrent=pointsWithTangents[i];if(pointCurrent.model.skip){continue}pointBefore=i>0?pointsWithTangents[i-1]:null;pointAfter=i<pointsLen-1?pointsWithTangents[i+1]:null;if(pointBefore&&!pointBefore.model.skip){deltaX=(pointCurrent.model.x-pointBefore.model.x)/3;pointCurrent.model.controlPointPreviousX=pointCurrent.model.x-deltaX;pointCurrent.model.controlPointPreviousY=pointCurrent.model.y-deltaX*pointCurrent.mK}if(pointAfter&&!pointAfter.model.skip){deltaX=(pointAfter.model.x-pointCurrent.model.x)/3;pointCurrent.model.controlPointNextX=pointCurrent.model.x+deltaX;pointCurrent.model.controlPointNextY=pointCurrent.model.y+deltaX*pointCurrent.mK}}};helpers.nextItem=function(collection,index,loop){if(loop){return index>=collection.length-1?collection[0]:collection[index+1]}return index>=collection.length-1?collection[collection.length-1]:collection[index+1]};helpers.previousItem=function(collection,index,loop){if(loop){return index<=0?collection[collection.length-1]:collection[index-1]}return index<=0?collection[0]:collection[index-1]};helpers.niceNum=function(range,round){var exponent=Math.floor(helpers.log10(range));var fraction=range/Math.pow(10,exponent);var niceFraction;if(round){if(fraction<1.5){niceFraction=1}else if(fraction<3){niceFraction=2}else if(fraction<7){niceFraction=5}else{niceFraction=10}}else if(fraction<=1){niceFraction=1}else if(fraction<=2){niceFraction=2}else if(fraction<=5){niceFraction=5}else{niceFraction=10}return niceFraction*Math.pow(10,exponent)};helpers.requestAnimFrame=function(){if(typeof window==="undefined"){return function(callback){callback()}}return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){return window.setTimeout(callback,1e3/60)}}();helpers.getRelativePosition=function(evt,chart){var mouseX,mouseY;var e=evt.originalEvent||evt;var canvas=evt.currentTarget||evt.srcElement;var boundingRect=canvas.getBoundingClientRect();var touches=e.touches;if(touches&&touches.length>0){mouseX=touches[0].clientX;mouseY=touches[0].clientY}else{mouseX=e.clientX;mouseY=e.clientY}var paddingLeft=parseFloat(helpers.getStyle(canvas,"padding-left"));var paddingTop=parseFloat(helpers.getStyle(canvas,"padding-top"));var paddingRight=parseFloat(helpers.getStyle(canvas,"padding-right"));var paddingBottom=parseFloat(helpers.getStyle(canvas,"padding-bottom"));var width=boundingRect.right-boundingRect.left-paddingLeft-paddingRight;var height=boundingRect.bottom-boundingRect.top-paddingTop-paddingBottom;mouseX=Math.round((mouseX-boundingRect.left-paddingLeft)/width*canvas.width/chart.currentDevicePixelRatio);mouseY=Math.round((mouseY-boundingRect.top-paddingTop)/height*canvas.height/chart.currentDevicePixelRatio);return{x:mouseX,y:mouseY}};function parseMaxStyle(styleValue,node,parentProperty){var valueInPixels;if(typeof styleValue==="string"){valueInPixels=parseInt(styleValue,10);if(styleValue.indexOf("%")!==-1){valueInPixels=valueInPixels/100*node.parentNode[parentProperty]}}else{valueInPixels=styleValue}return valueInPixels}function isConstrainedValue(value){return value!==undefined&&value!==null&&value!=="none"}function getConstraintDimension(domNode,maxStyle,percentageProperty){var view=document.defaultView;var parentNode=domNode.parentNode;var constrainedNode=view.getComputedStyle(domNode)[maxStyle];var constrainedContainer=view.getComputedStyle(parentNode)[maxStyle];var hasCNode=isConstrainedValue(constrainedNode);var hasCContainer=isConstrainedValue(constrainedContainer);var infinity=Number.POSITIVE_INFINITY;if(hasCNode||hasCContainer){return Math.min(hasCNode?parseMaxStyle(constrainedNode,domNode,percentageProperty):infinity,hasCContainer?parseMaxStyle(constrainedContainer,parentNode,percentageProperty):infinity)}return"none"}helpers.getConstraintWidth=function(domNode){return getConstraintDimension(domNode,"max-width","clientWidth")};helpers.getConstraintHeight=function(domNode){return getConstraintDimension(domNode,"max-height","clientHeight")};helpers.getMaximumWidth=function(domNode){var container=domNode.parentNode;if(!container){return domNode.clientWidth}var paddingLeft=parseInt(helpers.getStyle(container,"padding-left"),10);var paddingRight=parseInt(helpers.getStyle(container,"padding-right"),10);var w=container.clientWidth-paddingLeft-paddingRight;var cw=helpers.getConstraintWidth(domNode);return isNaN(cw)?w:Math.min(w,cw)};helpers.getMaximumHeight=function(domNode){var container=domNode.parentNode;if(!container){return domNode.clientHeight}var paddingTop=parseInt(helpers.getStyle(container,"padding-top"),10);var paddingBottom=parseInt(helpers.getStyle(container,"padding-bottom"),10);var h=container.clientHeight-paddingTop-paddingBottom;var ch=helpers.getConstraintHeight(domNode);return isNaN(ch)?h:Math.min(h,ch)};helpers.getStyle=function(el,property){return el.currentStyle?el.currentStyle[property]:document.defaultView.getComputedStyle(el,null).getPropertyValue(property)};helpers.retinaScale=function(chart,forceRatio){var pixelRatio=chart.currentDevicePixelRatio=forceRatio||window.devicePixelRatio||1;if(pixelRatio===1){return}var canvas=chart.canvas;var height=chart.height;var width=chart.width;canvas.height=height*pixelRatio;canvas.width=width*pixelRatio;chart.ctx.scale(pixelRatio,pixelRatio);if(!canvas.style.height&&!canvas.style.width){canvas.style.height=height+"px";canvas.style.width=width+"px"}};helpers.fontString=function(pixelSize,fontStyle,fontFamily){return fontStyle+" "+pixelSize+"px "+fontFamily};helpers.longestText=function(ctx,font,arrayOfThings,cache){cache=cache||{};var data=cache.data=cache.data||{};var gc=cache.garbageCollect=cache.garbageCollect||[];if(cache.font!==font){data=cache.data={};gc=cache.garbageCollect=[];cache.font=font}ctx.font=font;var longest=0;helpers.each(arrayOfThings,function(thing){if(thing!==undefined&&thing!==null&&helpers.isArray(thing)!==true){longest=helpers.measureText(ctx,data,gc,longest,thing)}else if(helpers.isArray(thing)){helpers.each(thing,function(nestedThing){if(nestedThing!==undefined&&nestedThing!==null&&!helpers.isArray(nestedThing)){longest=helpers.measureText(ctx,data,gc,longest,nestedThing)}})}});var gcLen=gc.length/2;if(gcLen>arrayOfThings.length){for(var i=0;i<gcLen;i++){delete data[gc[i]]}gc.splice(0,gcLen)}return longest};helpers.measureText=function(ctx,data,gc,longest,string){var textWidth=data[string];if(!textWidth){textWidth=data[string]=ctx.measureText(string).width;gc.push(string)}if(textWidth>longest){longest=textWidth}return longest};helpers.numberOfLabelLines=function(arrayOfThings){var numberOfLines=1;helpers.each(arrayOfThings,function(thing){if(helpers.isArray(thing)){if(thing.length>numberOfLines){numberOfLines=thing.length}}});return numberOfLines};helpers.color=!color?function(value){console.error("Color.js not found!");return value}:function(value){if(value instanceof CanvasGradient){value=defaults.global.defaultColor}return color(value)};helpers.getHoverColor=function(colorValue){return colorValue instanceof CanvasPattern?colorValue:helpers.color(colorValue).saturate(.5).darken(.1).rgbString()}}},{"../helpers/index":42,"./core.defaults":22,"chartjs-color":57}],25:[function(require,module,exports){"use strict";var helpers=require("../helpers/index");function getRelativePosition(e,chart){if(e.native){return{x:e.x,y:e.y}}return helpers.getRelativePosition(e,chart)}function parseVisibleItems(chart,handler){var datasets=chart.data.datasets;var meta,i,j,ilen,jlen;for(i=0,ilen=datasets.length;i<ilen;++i){if(!chart.isDatasetVisible(i)){continue}meta=chart.getDatasetMeta(i);for(j=0,jlen=meta.data.length;j<jlen;++j){var element=meta.data[j];if(!element._view.skip){handler(element)}}}}function getIntersectItems(chart,position){var elements=[];parseVisibleItems(chart,function(element){if(element.inRange(position.x,position.y)){elements.push(element)}});return elements}function getNearestItems(chart,position,intersect,distanceMetric){var minDistance=Number.POSITIVE_INFINITY;var nearestItems=[];parseVisibleItems(chart,function(element){if(intersect&&!element.inRange(position.x,position.y)){return}var center=element.getCenterPoint();var distance=distanceMetric(position,center);if(distance<minDistance){nearestItems=[element];minDistance=distance}else if(distance===minDistance){nearestItems.push(element)}});return nearestItems}function getDistanceMetricForAxis(axis){var useX=axis.indexOf("x")!==-1;var useY=axis.indexOf("y")!==-1;return function(pt1,pt2){var deltaX=useX?Math.abs(pt1.x-pt2.x):0;var deltaY=useY?Math.abs(pt1.y-pt2.y):0;return Math.sqrt(Math.pow(deltaX,2)+Math.pow(deltaY,2))}}function indexMode(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||"x";var distanceMetric=getDistanceMetricForAxis(options.axis);var items=options.intersect?getIntersectItems(chart,position):getNearestItems(chart,position,false,distanceMetric);var elements=[];if(!items.length){return[]}chart.data.datasets.forEach(function(dataset,datasetIndex){if(chart.isDatasetVisible(datasetIndex)){var meta=chart.getDatasetMeta(datasetIndex);var element=meta.data[items[0]._index];if(element&&!element._view.skip){elements.push(element)}}});return elements}module.exports={modes:{single:function(chart,e){var position=getRelativePosition(e,chart);var elements=[];parseVisibleItems(chart,function(element){if(element.inRange(position.x,position.y)){elements.push(element);return elements}});return elements.slice(0,1)},label:indexMode,index:indexMode,dataset:function(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||"xy";var distanceMetric=getDistanceMetricForAxis(options.axis);var items=options.intersect?getIntersectItems(chart,position):getNearestItems(chart,position,false,distanceMetric);if(items.length>0){items=chart.getDatasetMeta(items[0]._datasetIndex).data}return items},"x-axis":function(chart,e){return indexMode(chart,e,{intersect:false})},point:function(chart,e){var position=getRelativePosition(e,chart);return getIntersectItems(chart,position)},nearest:function(chart,e,options){var position=getRelativePosition(e,chart);options.axis=options.axis||"xy";var distanceMetric=getDistanceMetricForAxis(options.axis);var nearestItems=getNearestItems(chart,position,options.intersect,distanceMetric);if(nearestItems.length>1){nearestItems.sort(function(a,b){var sizeA=a.getArea();var sizeB=b.getArea();var ret=sizeA-sizeB;if(ret===0){ret=a._datasetIndex-b._datasetIndex}return ret})}return nearestItems.slice(0,1)},x:function(chart,e,options){var position=getRelativePosition(e,chart);var items=[];var intersectsItem=false;parseVisibleItems(chart,function(element){if(element.inXRange(position.x)){items.push(element)}if(element.inRange(position.x,position.y)){intersectsItem=true}});if(options.intersect&&!intersectsItem){items=[]}return items},y:function(chart,e,options){var position=getRelativePosition(e,chart);var items=[];var intersectsItem=false;parseVisibleItems(chart,function(element){if(element.inYRange(position.y)){items.push(element)}if(element.inRange(position.x,position.y)){intersectsItem=true}});if(options.intersect&&!intersectsItem){items=[]}return items}}}},{"../helpers/index":42}],26:[function(require,module,exports){"use strict";var defaults=require("./core.defaults");defaults._set("global",{responsive:true,responsiveAnimationDuration:0,maintainAspectRatio:true,events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:true,animationDuration:400},onClick:null,defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",showLines:true,elements:{},layout:{padding:{top:0,right:0,bottom:0,left:0}}});module.exports=function(){var Chart=function(item,config){this.construct(item,config);return this};Chart.Chart=Chart;return Chart}},{"./core.defaults":22}],27:[function(require,module,exports){"use strict";var helpers=require("../helpers/index");function filterByPosition(array,position){return helpers.where(array,function(v){return v.position===position})}function sortByWeight(array,reverse){array.forEach(function(v,i){v._tmpIndex_=i;return v});array.sort(function(a,b){var v0=reverse?b:a;var v1=reverse?a:b;return v0.weight===v1.weight?v0._tmpIndex_-v1._tmpIndex_:v0.weight-v1.weight});array.forEach(function(v){delete v._tmpIndex_})}module.exports={defaults:{},addBox:function(chart,item){if(!chart.boxes){chart.boxes=[]}item.fullWidth=item.fullWidth||false;item.position=item.position||"top";item.weight=item.weight||0;chart.boxes.push(item)},removeBox:function(chart,layoutItem){var index=chart.boxes?chart.boxes.indexOf(layoutItem):-1;if(index!==-1){chart.boxes.splice(index,1)}},configure:function(chart,item,options){var props=["fullWidth","position","weight"];var ilen=props.length;var i=0;var prop;for(;i<ilen;++i){prop=props[i];if(options.hasOwnProperty(prop)){item[prop]=options[prop]}}},update:function(chart,width,height){if(!chart){return}var layoutOptions=chart.options.layout||{};var padding=helpers.options.toPadding(layoutOptions.padding);var leftPadding=padding.left;var rightPadding=padding.right;var topPadding=padding.top;var bottomPadding=padding.bottom;var leftBoxes=filterByPosition(chart.boxes,"left");var rightBoxes=filterByPosition(chart.boxes,"right");var topBoxes=filterByPosition(chart.boxes,"top");var bottomBoxes=filterByPosition(chart.boxes,"bottom");var chartAreaBoxes=filterByPosition(chart.boxes,"chartArea");sortByWeight(leftBoxes,true);sortByWeight(rightBoxes,false);sortByWeight(topBoxes,true);sortByWeight(bottomBoxes,false);var chartWidth=width-leftPadding-rightPadding;var chartHeight=height-topPadding-bottomPadding;var chartAreaWidth=chartWidth/2;var chartAreaHeight=chartHeight/2;var verticalBoxWidth=(width-chartAreaWidth)/(leftBoxes.length+rightBoxes.length);var horizontalBoxHeight=(height-chartAreaHeight)/(topBoxes.length+bottomBoxes.length);var maxChartAreaWidth=chartWidth;var maxChartAreaHeight=chartHeight;var minBoxSizes=[];function getMinimumBoxSize(box){var minSize;var isHorizontal=box.isHorizontal();if(isHorizontal){minSize=box.update(box.fullWidth?chartWidth:maxChartAreaWidth,horizontalBoxHeight);maxChartAreaHeight-=minSize.height}else{minSize=box.update(verticalBoxWidth,maxChartAreaHeight);maxChartAreaWidth-=minSize.width}minBoxSizes.push({horizontal:isHorizontal,minSize:minSize,box:box})}helpers.each(leftBoxes.concat(rightBoxes,topBoxes,bottomBoxes),getMinimumBoxSize);var maxHorizontalLeftPadding=0;var maxHorizontalRightPadding=0;var maxVerticalTopPadding=0;var maxVerticalBottomPadding=0;helpers.each(topBoxes.concat(bottomBoxes),function(horizontalBox){if(horizontalBox.getPadding){var boxPadding=horizontalBox.getPadding();maxHorizontalLeftPadding=Math.max(maxHorizontalLeftPadding,boxPadding.left);maxHorizontalRightPadding=Math.max(maxHorizontalRightPadding,boxPadding.right)}});helpers.each(leftBoxes.concat(rightBoxes),function(verticalBox){if(verticalBox.getPadding){var boxPadding=verticalBox.getPadding();maxVerticalTopPadding=Math.max(maxVerticalTopPadding,boxPadding.top);maxVerticalBottomPadding=Math.max(maxVerticalBottomPadding,boxPadding.bottom)}});var totalLeftBoxesWidth=leftPadding;var totalRightBoxesWidth=rightPadding;var totalTopBoxesHeight=topPadding;var totalBottomBoxesHeight=bottomPadding;function fitBox(box){var minBoxSize=helpers.findNextWhere(minBoxSizes,function(minBox){return minBox.box===box});if(minBoxSize){if(box.isHorizontal()){var scaleMargin={left:Math.max(totalLeftBoxesWidth,maxHorizontalLeftPadding),right:Math.max(totalRightBoxesWidth,maxHorizontalRightPadding),top:0,bottom:0};box.update(box.fullWidth?chartWidth:maxChartAreaWidth,chartHeight/2,scaleMargin)}else{box.update(minBoxSize.minSize.width,maxChartAreaHeight)}}}helpers.each(leftBoxes.concat(rightBoxes),fitBox);helpers.each(leftBoxes,function(box){totalLeftBoxesWidth+=box.width});helpers.each(rightBoxes,function(box){totalRightBoxesWidth+=box.width});helpers.each(topBoxes.concat(bottomBoxes),fitBox);helpers.each(topBoxes,function(box){totalTopBoxesHeight+=box.height});helpers.each(bottomBoxes,function(box){totalBottomBoxesHeight+=box.height});function finalFitVerticalBox(box){var minBoxSize=helpers.findNextWhere(minBoxSizes,function(minSize){return minSize.box===box});var scaleMargin={left:0,right:0,top:totalTopBoxesHeight,bottom:totalBottomBoxesHeight};if(minBoxSize){box.update(minBoxSize.minSize.width,maxChartAreaHeight,scaleMargin)}}helpers.each(leftBoxes.concat(rightBoxes),finalFitVerticalBox);totalLeftBoxesWidth=leftPadding;totalRightBoxesWidth=rightPadding;totalTopBoxesHeight=topPadding;totalBottomBoxesHeight=bottomPadding;helpers.each(leftBoxes,function(box){totalLeftBoxesWidth+=box.width});helpers.each(rightBoxes,function(box){totalRightBoxesWidth+=box.width});helpers.each(topBoxes,function(box){totalTopBoxesHeight+=box.height});helpers.each(bottomBoxes,function(box){totalBottomBoxesHeight+=box.height});var leftPaddingAddition=Math.max(maxHorizontalLeftPadding-totalLeftBoxesWidth,0);totalLeftBoxesWidth+=leftPaddingAddition;totalRightBoxesWidth+=Math.max(maxHorizontalRightPadding-totalRightBoxesWidth,0);var topPaddingAddition=Math.max(maxVerticalTopPadding-totalTopBoxesHeight,0);totalTopBoxesHeight+=topPaddingAddition;totalBottomBoxesHeight+=Math.max(maxVerticalBottomPadding-totalBottomBoxesHeight,0);var newMaxChartAreaHeight=height-totalTopBoxesHeight-totalBottomBoxesHeight;var newMaxChartAreaWidth=width-totalLeftBoxesWidth-totalRightBoxesWidth;if(newMaxChartAreaWidth!==maxChartAreaWidth||newMaxChartAreaHeight!==maxChartAreaHeight){helpers.each(leftBoxes,function(box){box.height=newMaxChartAreaHeight});helpers.each(rightBoxes,function(box){box.height=newMaxChartAreaHeight});helpers.each(topBoxes,function(box){if(!box.fullWidth){box.width=newMaxChartAreaWidth}});helpers.each(bottomBoxes,function(box){if(!box.fullWidth){box.width=newMaxChartAreaWidth}});maxChartAreaHeight=newMaxChartAreaHeight;maxChartAreaWidth=newMaxChartAreaWidth}var left=leftPadding+leftPaddingAddition;var top=topPadding+topPaddingAddition;function placeBox(box){if(box.isHorizontal()){box.left=box.fullWidth?leftPadding:totalLeftBoxesWidth;box.right=box.fullWidth?width-rightPadding:totalLeftBoxesWidth+maxChartAreaWidth;box.top=top;box.bottom=top+box.height;top=box.bottom}else{box.left=left;box.right=left+box.width;box.top=totalTopBoxesHeight;box.bottom=totalTopBoxesHeight+maxChartAreaHeight;left=box.right}}helpers.each(leftBoxes.concat(topBoxes),placeBox);left+=maxChartAreaWidth;top+=maxChartAreaHeight;helpers.each(rightBoxes,placeBox);helpers.each(bottomBoxes,placeBox);chart.chartArea={left:totalLeftBoxesWidth,top:totalTopBoxesHeight,right:totalLeftBoxesWidth+maxChartAreaWidth,bottom:totalTopBoxesHeight+maxChartAreaHeight};helpers.each(chartAreaBoxes,function(box){box.left=chart.chartArea.left;box.top=chart.chartArea.top;box.right=chart.chartArea.right;box.bottom=chart.chartArea.bottom;box.update(maxChartAreaWidth,maxChartAreaHeight)})}}},{"../helpers/index":42}],28:[function(require,module,exports){"use strict";var defaults=require("./core.defaults");var helpers=require("../helpers/index");defaults._set("global",{plugins:{}});module.exports={_plugins:[],_cacheId:0,register:function(plugins){var p=this._plugins;[].concat(plugins).forEach(function(plugin){if(p.indexOf(plugin)===-1){p.push(plugin)}});this._cacheId++},unregister:function(plugins){var p=this._plugins;[].concat(plugins).forEach(function(plugin){var idx=p.indexOf(plugin);if(idx!==-1){p.splice(idx,1)}});this._cacheId++},clear:function(){this._plugins=[];this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(chart,hook,args){var descriptors=this.descriptors(chart);var ilen=descriptors.length;var i,descriptor,plugin,params,method;for(i=0;i<ilen;++i){descriptor=descriptors[i];plugin=descriptor.plugin;method=plugin[hook];if(typeof method==="function"){params=[chart].concat(args||[]);params.push(descriptor.options);if(method.apply(plugin,params)===false){return false}}}return true},descriptors:function(chart){var cache=chart.$plugins||(chart.$plugins={});if(cache.id===this._cacheId){return cache.descriptors}var plugins=[];var descriptors=[];var config=chart&&chart.config||{};var options=config.options&&config.options.plugins||{};this._plugins.concat(config.plugins||[]).forEach(function(plugin){var idx=plugins.indexOf(plugin);if(idx!==-1){return}var id=plugin.id;var opts=options[id];if(opts===false){return}if(opts===true){opts=helpers.clone(defaults.global.plugins[id])}plugins.push(plugin);descriptors.push({plugin:plugin,options:opts||{}})});cache.descriptors=descriptors;cache.id=this._cacheId;return descriptors},_invalidate:function(chart){delete chart.$plugins}}},{"../helpers/index":42,"./core.defaults":22}],29:[function(require,module,exports){"use strict";var defaults=require("./core.defaults");var Element=require("./core.element");var helpers=require("../helpers/index");var Ticks=require("./core.ticks");defaults._set("scale",{display:true,position:"left",offset:false,gridLines:{display:true,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawBorder:true,drawOnChartArea:true,drawTicks:true,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:false,borderDash:[],borderDashOffset:0},scaleLabel:{display:false,labelString:"",lineHeight:1.2,padding:{top:4,bottom:4}},ticks:{beginAtZero:false,minRotation:0,maxRotation:50,mirror:false,padding:0,reverse:false,display:true,autoSkip:true,autoSkipPadding:0,labelOffset:0,callback:Ticks.formatters.values,minor:{},major:{}}});function labelsFromTicks(ticks){var labels=[];var i,ilen;for(i=0,ilen=ticks.length;i<ilen;++i){labels.push(ticks[i].label)}return labels}function getLineValue(scale,index,offsetGridLines){var lineValue=scale.getPixelForTick(index);if(offsetGridLines){if(index===0){lineValue-=(scale.getPixelForTick(1)-lineValue)/2}else{lineValue-=(lineValue-scale.getPixelForTick(index-1))/2}}return lineValue}module.exports=function(Chart){function computeTextSize(context,tick,font){return helpers.isArray(tick)?helpers.longestText(context,font,tick):context.measureText(tick).width}function parseFontOptions(options){var valueOrDefault=helpers.valueOrDefault;var globalDefaults=defaults.global;var size=valueOrDefault(options.fontSize,globalDefaults.defaultFontSize);var style=valueOrDefault(options.fontStyle,globalDefaults.defaultFontStyle);var family=valueOrDefault(options.fontFamily,globalDefaults.defaultFontFamily);return{size:size,style:style,family:family,font:helpers.fontString(size,style,family)}}function parseLineHeight(options){return helpers.options.toLineHeight(helpers.valueOrDefault(options.lineHeight,1.2),helpers.valueOrDefault(options.fontSize,defaults.global.defaultFontSize))}Chart.Scale=Element.extend({getPadding:function(){var me=this;return{left:me.paddingLeft||0,top:me.paddingTop||0,right:me.paddingRight||0,bottom:me.paddingBottom||0}},getTicks:function(){return this._ticks},mergeTicksOptions:function(){var ticks=this.options.ticks;if(ticks.minor===false){ticks.minor={display:false}}if(ticks.major===false){ticks.major={display:false}}for(var key in ticks){if(key!=="major"&&key!=="minor"){if(typeof ticks.minor[key]==="undefined"){ticks.minor[key]=ticks[key]}if(typeof ticks.major[key]==="undefined"){ticks.major[key]=ticks[key]}}}},beforeUpdate:function(){helpers.callback(this.options.beforeUpdate,[this])},update:function(maxWidth,maxHeight,margins){var me=this;var i,ilen,labels,label,ticks,tick;me.beforeUpdate();me.maxWidth=maxWidth;me.maxHeight=maxHeight;me.margins=helpers.extend({left:0,right:0,top:0,bottom:0},margins);me.longestTextCache=me.longestTextCache||{};me.beforeSetDimensions();me.setDimensions();me.afterSetDimensions();me.beforeDataLimits();me.determineDataLimits();me.afterDataLimits();me.beforeBuildTicks();ticks=me.buildTicks()||[];me.afterBuildTicks();me.beforeTickToLabelConversion();labels=me.convertTicksToLabels(ticks)||me.ticks;me.afterTickToLabelConversion();me.ticks=labels;for(i=0,ilen=labels.length;i<ilen;++i){label=labels[i];tick=ticks[i];if(!tick){ticks.push(tick={label:label,major:false})}else{tick.label=label}}me._ticks=ticks;me.beforeCalculateTickRotation();me.calculateTickRotation();me.afterCalculateTickRotation();me.beforeFit();me.fit();me.afterFit();me.afterUpdate();return me.minSize},afterUpdate:function(){helpers.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){helpers.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var me=this;if(me.isHorizontal()){me.width=me.maxWidth;me.left=0;me.right=me.width}else{me.height=me.maxHeight;me.top=0;me.bottom=me.height}me.paddingLeft=0;me.paddingTop=0;me.paddingRight=0;me.paddingBottom=0},afterSetDimensions:function(){helpers.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){helpers.callback(this.options.beforeDataLimits,[this])},determineDataLimits:helpers.noop,afterDataLimits:function(){helpers.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){helpers.callback(this.options.beforeBuildTicks,[this])},buildTicks:helpers.noop,afterBuildTicks:function(){helpers.callback(this.options.afterBuildTicks,[this])},beforeTickToLabelConversion:function(){helpers.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var me=this;var tickOpts=me.options.ticks;me.ticks=me.ticks.map(tickOpts.userCallback||tickOpts.callback,this)},afterTickToLabelConversion:function(){helpers.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){helpers.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var me=this;var context=me.ctx;var tickOpts=me.options.ticks;var labels=labelsFromTicks(me._ticks);var tickFont=parseFontOptions(tickOpts);context.font=tickFont.font;var labelRotation=tickOpts.minRotation||0;if(labels.length&&me.options.display&&me.isHorizontal()){var originalLabelWidth=helpers.longestText(context,tickFont.font,labels,me.longestTextCache);var labelWidth=originalLabelWidth;var cosRotation,sinRotation;var tickWidth=me.getPixelForTick(1)-me.getPixelForTick(0)-6;while(labelWidth>tickWidth&&labelRotation<tickOpts.maxRotation){var angleRadians=helpers.toRadians(labelRotation);cosRotation=Math.cos(angleRadians);sinRotation=Math.sin(angleRadians);if(sinRotation*originalLabelWidth>me.maxHeight){labelRotation--;break}labelRotation++;labelWidth=cosRotation*originalLabelWidth}}me.labelRotation=labelRotation},afterCalculateTickRotation:function(){helpers.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){helpers.callback(this.options.beforeFit,[this])},fit:function(){var me=this;var minSize=me.minSize={width:0,height:0};var labels=labelsFromTicks(me._ticks);var opts=me.options;var tickOpts=opts.ticks;var scaleLabelOpts=opts.scaleLabel;var gridLineOpts=opts.gridLines;var display=opts.display;var isHorizontal=me.isHorizontal();var tickFont=parseFontOptions(tickOpts);var tickMarkLength=opts.gridLines.tickMarkLength;if(isHorizontal){minSize.width=me.isFullWidth()?me.maxWidth-me.margins.left-me.margins.right:me.maxWidth}else{minSize.width=display&&gridLineOpts.drawTicks?tickMarkLength:0}if(isHorizontal){minSize.height=display&&gridLineOpts.drawTicks?tickMarkLength:0}else{minSize.height=me.maxHeight}if(scaleLabelOpts.display&&display){var scaleLabelLineHeight=parseLineHeight(scaleLabelOpts);var scaleLabelPadding=helpers.options.toPadding(scaleLabelOpts.padding);var deltaHeight=scaleLabelLineHeight+scaleLabelPadding.height;if(isHorizontal){minSize.height+=deltaHeight}else{minSize.width+=deltaHeight}}if(tickOpts.display&&display){var largestTextWidth=helpers.longestText(me.ctx,tickFont.font,labels,me.longestTextCache);var tallestLabelHeightInLines=helpers.numberOfLabelLines(labels);var lineSpace=tickFont.size*.5;var tickPadding=me.options.ticks.padding;if(isHorizontal){me.longestLabelWidth=largestTextWidth;var angleRadians=helpers.toRadians(me.labelRotation);var cosRotation=Math.cos(angleRadians);var sinRotation=Math.sin(angleRadians);var labelHeight=sinRotation*largestTextWidth+tickFont.size*tallestLabelHeightInLines+lineSpace*(tallestLabelHeightInLines-1)+lineSpace;minSize.height=Math.min(me.maxHeight,minSize.height+labelHeight+tickPadding);me.ctx.font=tickFont.font;var firstLabelWidth=computeTextSize(me.ctx,labels[0],tickFont.font);var lastLabelWidth=computeTextSize(me.ctx,labels[labels.length-1],tickFont.font);if(me.labelRotation!==0){me.paddingLeft=opts.position==="bottom"?cosRotation*firstLabelWidth+3:cosRotation*lineSpace+3;me.paddingRight=opts.position==="bottom"?cosRotation*lineSpace+3:cosRotation*lastLabelWidth+3}else{me.paddingLeft=firstLabelWidth/2+3;me.paddingRight=lastLabelWidth/2+3}}else{if(tickOpts.mirror){largestTextWidth=0}else{largestTextWidth+=tickPadding+lineSpace}minSize.width=Math.min(me.maxWidth,minSize.width+largestTextWidth);me.paddingTop=tickFont.size/2;me.paddingBottom=tickFont.size/2}}me.handleMargins();me.width=minSize.width;me.height=minSize.height},handleMargins:function(){var me=this;if(me.margins){me.paddingLeft=Math.max(me.paddingLeft-me.margins.left,0);me.paddingTop=Math.max(me.paddingTop-me.margins.top,0);me.paddingRight=Math.max(me.paddingRight-me.margins.right,0);me.paddingBottom=Math.max(me.paddingBottom-me.margins.bottom,0)}},afterFit:function(){helpers.callback(this.options.afterFit,[this])},isHorizontal:function(){return this.options.position==="top"||this.options.position==="bottom"},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(rawValue){if(helpers.isNullOrUndef(rawValue)){return NaN}if(typeof rawValue==="number"&&!isFinite(rawValue)){return NaN}if(rawValue){if(this.isHorizontal()){if(rawValue.x!==undefined){return this.getRightValue(rawValue.x)}}else if(rawValue.y!==undefined){return this.getRightValue(rawValue.y)}}return rawValue},getLabelForIndex:helpers.noop,getPixelForValue:helpers.noop,getValueForPixel:helpers.noop,getPixelForTick:function(index){var me=this;var offset=me.options.offset;if(me.isHorizontal()){var innerWidth=me.width-(me.paddingLeft+me.paddingRight);var tickWidth=innerWidth/Math.max(me._ticks.length-(offset?0:1),1);var pixel=tickWidth*index+me.paddingLeft;if(offset){pixel+=tickWidth/2}var finalVal=me.left+Math.round(pixel);finalVal+=me.isFullWidth()?me.margins.left:0;return finalVal}var innerHeight=me.height-(me.paddingTop+me.paddingBottom);return me.top+index*(innerHeight/(me._ticks.length-1))},getPixelForDecimal:function(decimal){var me=this;if(me.isHorizontal()){var innerWidth=me.width-(me.paddingLeft+me.paddingRight);var valueOffset=innerWidth*decimal+me.paddingLeft;var finalVal=me.left+Math.round(valueOffset);finalVal+=me.isFullWidth()?me.margins.left:0;return finalVal}return me.top+decimal*me.height},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var me=this;var min=me.min;var max=me.max;return me.beginAtZero?0:min<0&&max<0?max:min>0&&max>0?min:0},_autoSkip:function(ticks){var skipRatio;var me=this;var isHorizontal=me.isHorizontal();var optionTicks=me.options.ticks.minor;var tickCount=ticks.length;var labelRotationRadians=helpers.toRadians(me.labelRotation);var cosRotation=Math.cos(labelRotationRadians);var longestRotatedLabel=me.longestLabelWidth*cosRotation;var result=[];var i,tick,shouldSkip;var maxTicks;if(optionTicks.maxTicksLimit){maxTicks=optionTicks.maxTicksLimit}if(isHorizontal){skipRatio=false;if((longestRotatedLabel+optionTicks.autoSkipPadding)*tickCount>me.width-(me.paddingLeft+me.paddingRight)){skipRatio=1+Math.floor((longestRotatedLabel+optionTicks.autoSkipPadding)*tickCount/(me.width-(me.paddingLeft+me.paddingRight)))}if(maxTicks&&tickCount>maxTicks){skipRatio=Math.max(skipRatio,Math.floor(tickCount/maxTicks))}}for(i=0;i<tickCount;i++){tick=ticks[i];shouldSkip=skipRatio>1&&i%skipRatio>0||i%skipRatio===0&&i+skipRatio>=tickCount;if(shouldSkip&&i!==tickCount-1){delete tick.label}result.push(tick)}return result},draw:function(chartArea){var me=this;var options=me.options;if(!options.display){return}var context=me.ctx;var globalDefaults=defaults.global;var optionTicks=options.ticks.minor;var optionMajorTicks=options.ticks.major||optionTicks;var gridLines=options.gridLines;var scaleLabel=options.scaleLabel;var isRotated=me.labelRotation!==0;var isHorizontal=me.isHorizontal();var ticks=optionTicks.autoSkip?me._autoSkip(me.getTicks()):me.getTicks();var tickFontColor=helpers.valueOrDefault(optionTicks.fontColor,globalDefaults.defaultFontColor);var tickFont=parseFontOptions(optionTicks);var majorTickFontColor=helpers.valueOrDefault(optionMajorTicks.fontColor,globalDefaults.defaultFontColor);var majorTickFont=parseFontOptions(optionMajorTicks);var tl=gridLines.drawTicks?gridLines.tickMarkLength:0;var scaleLabelFontColor=helpers.valueOrDefault(scaleLabel.fontColor,globalDefaults.defaultFontColor);var scaleLabelFont=parseFontOptions(scaleLabel);var scaleLabelPadding=helpers.options.toPadding(scaleLabel.padding);var labelRotationRadians=helpers.toRadians(me.labelRotation);var itemsToDraw=[];var axisWidth=me.options.gridLines.lineWidth;var xTickStart=options.position==="right"?me.right:me.right-axisWidth-tl;var xTickEnd=options.position==="right"?me.right+tl:me.right;var yTickStart=options.position==="bottom"?me.top+axisWidth:me.bottom-tl-axisWidth;var yTickEnd=options.position==="bottom"?me.top+axisWidth+tl:me.bottom+axisWidth;helpers.each(ticks,function(tick,index){if(helpers.isNullOrUndef(tick.label)){return}var label=tick.label;var lineWidth,lineColor,borderDash,borderDashOffset;if(index===me.zeroLineIndex&&options.offset===gridLines.offsetGridLines){lineWidth=gridLines.zeroLineWidth;lineColor=gridLines.zeroLineColor;borderDash=gridLines.zeroLineBorderDash;borderDashOffset=gridLines.zeroLineBorderDashOffset}else{lineWidth=helpers.valueAtIndexOrDefault(gridLines.lineWidth,index);lineColor=helpers.valueAtIndexOrDefault(gridLines.color,index);borderDash=helpers.valueOrDefault(gridLines.borderDash,globalDefaults.borderDash);borderDashOffset=helpers.valueOrDefault(gridLines.borderDashOffset,globalDefaults.borderDashOffset)}var tx1,ty1,tx2,ty2,x1,y1,x2,y2,labelX,labelY;var textAlign="middle";var textBaseline="middle";var tickPadding=optionTicks.padding;if(isHorizontal){var labelYOffset=tl+tickPadding;if(options.position==="bottom"){textBaseline=!isRotated?"top":"middle";textAlign=!isRotated?"center":"right";labelY=me.top+labelYOffset}else{textBaseline=!isRotated?"bottom":"middle";textAlign=!isRotated?"center":"left";labelY=me.bottom-labelYOffset}var xLineValue=getLineValue(me,index,gridLines.offsetGridLines&&ticks.length>1);if(xLineValue<me.left){lineColor="rgba(0,0,0,0)"}xLineValue+=helpers.aliasPixel(lineWidth);labelX=me.getPixelForTick(index)+optionTicks.labelOffset;tx1=tx2=x1=x2=xLineValue;ty1=yTickStart;ty2=yTickEnd;y1=chartArea.top;y2=chartArea.bottom+axisWidth}else{var isLeft=options.position==="left";var labelXOffset;if(optionTicks.mirror){textAlign=isLeft?"left":"right";labelXOffset=tickPadding}else{textAlign=isLeft?"right":"left";labelXOffset=tl+tickPadding}labelX=isLeft?me.right-labelXOffset:me.left+labelXOffset;var yLineValue=getLineValue(me,index,gridLines.offsetGridLines&&ticks.length>1);if(yLineValue<me.top){lineColor="rgba(0,0,0,0)"}yLineValue+=helpers.aliasPixel(lineWidth);labelY=me.getPixelForTick(index)+optionTicks.labelOffset;tx1=xTickStart;tx2=xTickEnd;x1=chartArea.left;x2=chartArea.right+axisWidth;ty1=ty2=y1=y2=yLineValue}itemsToDraw.push({tx1:tx1,ty1:ty1,tx2:tx2,ty2:ty2,x1:x1,y1:y1,x2:x2,y2:y2,labelX:labelX,labelY:labelY,glWidth:lineWidth,glColor:lineColor,glBorderDash:borderDash,glBorderDashOffset:borderDashOffset,rotation:-1*labelRotationRadians,label:label,major:tick.major,textBaseline:textBaseline,textAlign:textAlign})});helpers.each(itemsToDraw,function(itemToDraw){if(gridLines.display){context.save();context.lineWidth=itemToDraw.glWidth;context.strokeStyle=itemToDraw.glColor;if(context.setLineDash){context.setLineDash(itemToDraw.glBorderDash);context.lineDashOffset=itemToDraw.glBorderDashOffset}context.beginPath();if(gridLines.drawTicks){context.moveTo(itemToDraw.tx1,itemToDraw.ty1);context.lineTo(itemToDraw.tx2,itemToDraw.ty2)}if(gridLines.drawOnChartArea){context.moveTo(itemToDraw.x1,itemToDraw.y1);context.lineTo(itemToDraw.x2,itemToDraw.y2)}context.stroke();context.restore()}if(optionTicks.display){context.save();context.translate(itemToDraw.labelX,itemToDraw.labelY);context.rotate(itemToDraw.rotation);context.font=itemToDraw.major?majorTickFont.font:tickFont.font;context.fillStyle=itemToDraw.major?majorTickFontColor:tickFontColor;context.textBaseline=itemToDraw.textBaseline;context.textAlign=itemToDraw.textAlign;var label=itemToDraw.label;if(helpers.isArray(label)){var lineCount=label.length;var lineHeight=tickFont.size*1.5;var y=me.isHorizontal()?0:-lineHeight*(lineCount-1)/2;for(var i=0;i<lineCount;++i){context.fillText(""+label[i],0,y);y+=lineHeight}}else{context.fillText(label,0,0)}context.restore()}});if(scaleLabel.display){var scaleLabelX;var scaleLabelY;var rotation=0;var halfLineHeight=parseLineHeight(scaleLabel)/2;if(isHorizontal){scaleLabelX=me.left+(me.right-me.left)/2;scaleLabelY=options.position==="bottom"?me.bottom-halfLineHeight-scaleLabelPadding.bottom:me.top+halfLineHeight+scaleLabelPadding.top}else{var isLeft=options.position==="left";scaleLabelX=isLeft?me.left+halfLineHeight+scaleLabelPadding.top:me.right-halfLineHeight-scaleLabelPadding.top;scaleLabelY=me.top+(me.bottom-me.top)/2;rotation=isLeft?-.5*Math.PI:.5*Math.PI}context.save();context.translate(scaleLabelX,scaleLabelY);context.rotate(rotation);context.textAlign="center";context.textBaseline="middle";context.fillStyle=scaleLabelFontColor;context.font=scaleLabelFont.font;context.fillText(scaleLabel.labelString,0,0);context.restore()}if(gridLines.drawBorder){context.lineWidth=helpers.valueAtIndexOrDefault(gridLines.lineWidth,0);context.strokeStyle=helpers.valueAtIndexOrDefault(gridLines.color,0);var x1=me.left;var x2=me.right+axisWidth;var y1=me.top;var y2=me.bottom+axisWidth;var aliasPixel=helpers.aliasPixel(context.lineWidth);if(isHorizontal){y1=y2=options.position==="top"?me.bottom:me.top;y1+=aliasPixel;y2+=aliasPixel}else{x1=x2=options.position==="left"?me.right:me.left;x1+=aliasPixel;x2+=aliasPixel}context.beginPath();context.moveTo(x1,y1);context.lineTo(x2,y2);context.stroke()}}})}},{"../helpers/index":42,"./core.defaults":22,"./core.element":23,"./core.ticks":31}],30:[function(require,module,exports){"use strict";var defaults=require("./core.defaults");var helpers=require("../helpers/index");var layouts=require("./core.layouts");module.exports=function(Chart){Chart.scaleService={constructors:{},defaults:{},registerScaleType:function(type,scaleConstructor,scaleDefaults){this.constructors[type]=scaleConstructor;this.defaults[type]=helpers.clone(scaleDefaults)},getScaleConstructor:function(type){return this.constructors.hasOwnProperty(type)?this.constructors[type]:undefined},getScaleDefaults:function(type){return this.defaults.hasOwnProperty(type)?helpers.merge({},[defaults.scale,this.defaults[type]]):{}},updateScaleDefaults:function(type,additions){var me=this;if(me.defaults.hasOwnProperty(type)){me.defaults[type]=helpers.extend(me.defaults[type],additions)}},addScalesToLayout:function(chart){helpers.each(chart.scales,function(scale){scale.fullWidth=scale.options.fullWidth;scale.position=scale.options.position;scale.weight=scale.options.weight;layouts.addBox(chart,scale)})}}}},{"../helpers/index":42,"./core.defaults":22,"./core.layouts":27}],31:[function(require,module,exports){"use strict";var helpers=require("../helpers/index");module.exports={formatters:{values:function(value){return helpers.isArray(value)?value:""+value},linear:function(tickValue,index,ticks){var delta=ticks.length>3?ticks[2]-ticks[1]:ticks[1]-ticks[0];if(Math.abs(delta)>1){if(tickValue!==Math.floor(tickValue)){delta=tickValue-Math.floor(tickValue)}}var logDelta=helpers.log10(Math.abs(delta));var tickString="";if(tickValue!==0){var numDecimal=-1*Math.floor(logDelta);numDecimal=Math.max(Math.min(numDecimal,20),0);tickString=tickValue.toFixed(numDecimal)}else{tickString="0"}return tickString},logarithmic:function(tickValue,index,ticks){var remain=tickValue/Math.pow(10,Math.floor(helpers.log10(tickValue)));if(tickValue===0){return"0"}else if(remain===1||remain===2||remain===5||index===0||index===ticks.length-1){return tickValue.toExponential()}return""}}}},{"../helpers/index":42}],32:[function(require,module,exports){"use strict";var defaults=require("./core.defaults");var Element=require("./core.element");var helpers=require("../helpers/index");defaults._set("global",{tooltips:{enabled:true,custom:null,mode:"nearest",position:"average",intersect:true,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:true,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:helpers.noop,title:function(tooltipItems,data){var title="";var labels=data.labels;var labelCount=labels?labels.length:0;if(tooltipItems.length>0){var item=tooltipItems[0];if(item.xLabel){title=item.xLabel}else if(labelCount>0&&item.index<labelCount){title=labels[item.index]}}return title},afterTitle:helpers.noop,beforeBody:helpers.noop,beforeLabel:helpers.noop,label:function(tooltipItem,data){var label=data.datasets[tooltipItem.datasetIndex].label||"";if(label){label+=": "}label+=tooltipItem.yLabel;return label},labelColor:function(tooltipItem,chart){var meta=chart.getDatasetMeta(tooltipItem.datasetIndex);var activeElement=meta.data[tooltipItem.index];var view=activeElement._view;return{borderColor:view.borderColor,backgroundColor:view.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:helpers.noop,afterBody:helpers.noop,beforeFooter:helpers.noop,footer:helpers.noop,afterFooter:helpers.noop}}});module.exports=function(Chart){function mergeOpacity(colorString,opacity){var color=helpers.color(colorString);return color.alpha(opacity*color.alpha()).rgbaString()}function pushOrConcat(base,toPush){if(toPush){if(helpers.isArray(toPush)){Array.prototype.push.apply(base,toPush)}else{base.push(toPush)}}return base}function createTooltipItem(element){var xScale=element._xScale;var yScale=element._yScale||element._scale;var index=element._index;var datasetIndex=element._datasetIndex;return{xLabel:xScale?xScale.getLabelForIndex(index,datasetIndex):"",yLabel:yScale?yScale.getLabelForIndex(index,datasetIndex):"",index:index,datasetIndex:datasetIndex,x:element._model.x,y:element._model.y}}function getBaseModel(tooltipOpts){var globalDefaults=defaults.global;var valueOrDefault=helpers.valueOrDefault;return{xPadding:tooltipOpts.xPadding,yPadding:tooltipOpts.yPadding,xAlign:tooltipOpts.xAlign,yAlign:tooltipOpts.yAlign,bodyFontColor:tooltipOpts.bodyFontColor,_bodyFontFamily:valueOrDefault(tooltipOpts.bodyFontFamily,globalDefaults.defaultFontFamily),_bodyFontStyle:valueOrDefault(tooltipOpts.bodyFontStyle,globalDefaults.defaultFontStyle),_bodyAlign:tooltipOpts.bodyAlign,bodyFontSize:valueOrDefault(tooltipOpts.bodyFontSize,globalDefaults.defaultFontSize),bodySpacing:tooltipOpts.bodySpacing,titleFontColor:tooltipOpts.titleFontColor,_titleFontFamily:valueOrDefault(tooltipOpts.titleFontFamily,globalDefaults.defaultFontFamily),_titleFontStyle:valueOrDefault(tooltipOpts.titleFontStyle,globalDefaults.defaultFontStyle),titleFontSize:valueOrDefault(tooltipOpts.titleFontSize,globalDefaults.defaultFontSize),_titleAlign:tooltipOpts.titleAlign,titleSpacing:tooltipOpts.titleSpacing,titleMarginBottom:tooltipOpts.titleMarginBottom,footerFontColor:tooltipOpts.footerFontColor,_footerFontFamily:valueOrDefault(tooltipOpts.footerFontFamily,globalDefaults.defaultFontFamily),_footerFontStyle:valueOrDefault(tooltipOpts.footerFontStyle,globalDefaults.defaultFontStyle),footerFontSize:valueOrDefault(tooltipOpts.footerFontSize,globalDefaults.defaultFontSize),_footerAlign:tooltipOpts.footerAlign,footerSpacing:tooltipOpts.footerSpacing,footerMarginTop:tooltipOpts.footerMarginTop,caretSize:tooltipOpts.caretSize,cornerRadius:tooltipOpts.cornerRadius,backgroundColor:tooltipOpts.backgroundColor,opacity:0,legendColorBackground:tooltipOpts.multiKeyBackground,displayColors:tooltipOpts.displayColors,borderColor:tooltipOpts.borderColor,borderWidth:tooltipOpts.borderWidth}}function getTooltipSize(tooltip,model){var ctx=tooltip._chart.ctx;var height=model.yPadding*2;var width=0;var body=model.body;var combinedBodyLength=body.reduce(function(count,bodyItem){return count+bodyItem.before.length+bodyItem.lines.length+bodyItem.after.length},0);combinedBodyLength+=model.beforeBody.length+model.afterBody.length;var titleLineCount=model.title.length;var footerLineCount=model.footer.length;var titleFontSize=model.titleFontSize;var bodyFontSize=model.bodyFontSize;var footerFontSize=model.footerFontSize;height+=titleLineCount*titleFontSize;height+=titleLineCount?(titleLineCount-1)*model.titleSpacing:0;height+=titleLineCount?model.titleMarginBottom:0;height+=combinedBodyLength*bodyFontSize;height+=combinedBodyLength?(combinedBodyLength-1)*model.bodySpacing:0;height+=footerLineCount?model.footerMarginTop:0;height+=footerLineCount*footerFontSize;height+=footerLineCount?(footerLineCount-1)*model.footerSpacing:0;var widthPadding=0;var maxLineWidth=function(line){width=Math.max(width,ctx.measureText(line).width+widthPadding)};ctx.font=helpers.fontString(titleFontSize,model._titleFontStyle,model._titleFontFamily);helpers.each(model.title,maxLineWidth);ctx.font=helpers.fontString(bodyFontSize,model._bodyFontStyle,model._bodyFontFamily);helpers.each(model.beforeBody.concat(model.afterBody),maxLineWidth);widthPadding=model.displayColors?bodyFontSize+2:0;helpers.each(body,function(bodyItem){helpers.each(bodyItem.before,maxLineWidth);helpers.each(bodyItem.lines,maxLineWidth);helpers.each(bodyItem.after,maxLineWidth)});widthPadding=0;ctx.font=helpers.fontString(footerFontSize,model._footerFontStyle,model._footerFontFamily);helpers.each(model.footer,maxLineWidth);width+=2*model.xPadding;return{width:width,height:height}}function determineAlignment(tooltip,size){var model=tooltip._model;var chart=tooltip._chart;var chartArea=tooltip._chart.chartArea;var xAlign="center";var yAlign="center";if(model.y<size.height){yAlign="top"}else if(model.y>chart.height-size.height){yAlign="bottom"}var lf,rf;var olf,orf;var yf;var midX=(chartArea.left+chartArea.right)/2;var midY=(chartArea.top+chartArea.bottom)/2;if(yAlign==="center"){lf=function(x){return x<=midX};rf=function(x){return x>midX}}else{lf=function(x){return x<=size.width/2};rf=function(x){return x>=chart.width-size.width/2}}olf=function(x){return x+size.width+model.caretSize+model.caretPadding>chart.width};orf=function(x){return x-size.width-model.caretSize-model.caretPadding<0};yf=function(y){return y<=midY?"top":"bottom"};if(lf(model.x)){xAlign="left";if(olf(model.x)){xAlign="center";yAlign=yf(model.y)}}else if(rf(model.x)){xAlign="right";if(orf(model.x)){xAlign="center";yAlign=yf(model.y)}}var opts=tooltip._options;return{xAlign:opts.xAlign?opts.xAlign:xAlign,yAlign:opts.yAlign?opts.yAlign:yAlign}}function getBackgroundPoint(vm,size,alignment,chart){var x=vm.x;var y=vm.y;var caretSize=vm.caretSize;var caretPadding=vm.caretPadding;var cornerRadius=vm.cornerRadius;var xAlign=alignment.xAlign;var yAlign=alignment.yAlign;var paddingAndSize=caretSize+caretPadding;var radiusAndPadding=cornerRadius+caretPadding;if(xAlign==="right"){x-=size.width}else if(xAlign==="center"){x-=size.width/2;if(x+size.width>chart.width){x=chart.width-size.width}if(x<0){x=0}}if(yAlign==="top"){y+=paddingAndSize}else if(yAlign==="bottom"){y-=size.height+paddingAndSize}else{y-=size.height/2}if(yAlign==="center"){if(xAlign==="left"){x+=paddingAndSize}else if(xAlign==="right"){x-=paddingAndSize}}else if(xAlign==="left"){x-=radiusAndPadding}else if(xAlign==="right"){x+=radiusAndPadding}return{x:x,y:y}}Chart.Tooltip=Element.extend({initialize:function(){this._model=getBaseModel(this._options);this._lastActive=[]},getTitle:function(){var me=this;var opts=me._options;var callbacks=opts.callbacks;var beforeTitle=callbacks.beforeTitle.apply(me,arguments);var title=callbacks.title.apply(me,arguments);var afterTitle=callbacks.afterTitle.apply(me,arguments);var lines=[];lines=pushOrConcat(lines,beforeTitle);lines=pushOrConcat(lines,title);lines=pushOrConcat(lines,afterTitle);return lines},getBeforeBody:function(){var lines=this._options.callbacks.beforeBody.apply(this,arguments);return helpers.isArray(lines)?lines:lines!==undefined?[lines]:[]},getBody:function(tooltipItems,data){var me=this;var callbacks=me._options.callbacks;var bodyItems=[];helpers.each(tooltipItems,function(tooltipItem){var bodyItem={before:[],lines:[],after:[]};pushOrConcat(bodyItem.before,callbacks.beforeLabel.call(me,tooltipItem,data));pushOrConcat(bodyItem.lines,callbacks.label.call(me,tooltipItem,data));pushOrConcat(bodyItem.after,callbacks.afterLabel.call(me,tooltipItem,data));bodyItems.push(bodyItem)});return bodyItems},getAfterBody:function(){var lines=this._options.callbacks.afterBody.apply(this,arguments);return helpers.isArray(lines)?lines:lines!==undefined?[lines]:[]},getFooter:function(){var me=this;var callbacks=me._options.callbacks;var beforeFooter=callbacks.beforeFooter.apply(me,arguments);var footer=callbacks.footer.apply(me,arguments);var afterFooter=callbacks.afterFooter.apply(me,arguments);var lines=[];lines=pushOrConcat(lines,beforeFooter);lines=pushOrConcat(lines,footer);lines=pushOrConcat(lines,afterFooter);return lines},update:function(changed){var me=this;var opts=me._options;var existingModel=me._model;var model=me._model=getBaseModel(opts);var active=me._active;var data=me._data;var alignment={xAlign:existingModel.xAlign,yAlign:existingModel.yAlign};var backgroundPoint={x:existingModel.x,y:existingModel.y};var tooltipSize={width:existingModel.width,height:existingModel.height};var tooltipPosition={x:existingModel.caretX,y:existingModel.caretY};var i,len;if(active.length){model.opacity=1;var labelColors=[];var labelTextColors=[];tooltipPosition=Chart.Tooltip.positioners[opts.position].call(me,active,me._eventPosition);var tooltipItems=[];for(i=0,len=active.length;i<len;++i){tooltipItems.push(createTooltipItem(active[i]))}if(opts.filter){tooltipItems=tooltipItems.filter(function(a){return opts.filter(a,data)})}if(opts.itemSort){tooltipItems=tooltipItems.sort(function(a,b){return opts.itemSort(a,b,data)})}helpers.each(tooltipItems,function(tooltipItem){labelColors.push(opts.callbacks.labelColor.call(me,tooltipItem,me._chart));labelTextColors.push(opts.callbacks.labelTextColor.call(me,tooltipItem,me._chart))});model.title=me.getTitle(tooltipItems,data);model.beforeBody=me.getBeforeBody(tooltipItems,data);model.body=me.getBody(tooltipItems,data);model.afterBody=me.getAfterBody(tooltipItems,data);model.footer=me.getFooter(tooltipItems,data);model.x=Math.round(tooltipPosition.x);model.y=Math.round(tooltipPosition.y);model.caretPadding=opts.caretPadding;model.labelColors=labelColors;model.labelTextColors=labelTextColors;model.dataPoints=tooltipItems;tooltipSize=getTooltipSize(this,model);alignment=determineAlignment(this,tooltipSize);backgroundPoint=getBackgroundPoint(model,tooltipSize,alignment,me._chart)}else{model.opacity=0}model.xAlign=alignment.xAlign;model.yAlign=alignment.yAlign;model.x=backgroundPoint.x;model.y=backgroundPoint.y;model.width=tooltipSize.width;model.height=tooltipSize.height;model.caretX=tooltipPosition.x;model.caretY=tooltipPosition.y;me._model=model;if(changed&&opts.custom){opts.custom.call(me,model)}return me},drawCaret:function(tooltipPoint,size){var ctx=this._chart.ctx;var vm=this._view;var caretPosition=this.getCaretPosition(tooltipPoint,size,vm);ctx.lineTo(caretPosition.x1,caretPosition.y1);ctx.lineTo(caretPosition.x2,caretPosition.y2);ctx.lineTo(caretPosition.x3,caretPosition.y3)},getCaretPosition:function(tooltipPoint,size,vm){var x1,x2,x3,y1,y2,y3;var caretSize=vm.caretSize;var cornerRadius=vm.cornerRadius;var xAlign=vm.xAlign;var yAlign=vm.yAlign;var ptX=tooltipPoint.x;var ptY=tooltipPoint.y;var width=size.width;var height=size.height;if(yAlign==="center"){y2=ptY+height/2;if(xAlign==="left"){x1=ptX;x2=x1-caretSize;x3=x1;y1=y2+caretSize;y3=y2-caretSize}else{x1=ptX+width;x2=x1+caretSize;x3=x1;y1=y2-caretSize;y3=y2+caretSize}}else{if(xAlign==="left"){x2=ptX+cornerRadius+caretSize;x1=x2-caretSize;x3=x2+caretSize}else if(xAlign==="right"){x2=ptX+width-cornerRadius-caretSize;x1=x2-caretSize;x3=x2+caretSize}else{x2=vm.caretX;x1=x2-caretSize;x3=x2+caretSize}if(yAlign==="top"){y1=ptY;y2=y1-caretSize;y3=y1}else{y1=ptY+height;y2=y1+caretSize;y3=y1;var tmp=x3;x3=x1;x1=tmp}}return{x1:x1,x2:x2,x3:x3,y1:y1,y2:y2,y3:y3}},drawTitle:function(pt,vm,ctx,opacity){var title=vm.title;if(title.length){ctx.textAlign=vm._titleAlign;ctx.textBaseline="top";var titleFontSize=vm.titleFontSize;var titleSpacing=vm.titleSpacing;ctx.fillStyle=mergeOpacity(vm.titleFontColor,opacity);ctx.font=helpers.fontString(titleFontSize,vm._titleFontStyle,vm._titleFontFamily);var i,len;for(i=0,len=title.length;i<len;++i){ctx.fillText(title[i],pt.x,pt.y);pt.y+=titleFontSize+titleSpacing;if(i+1===title.length){pt.y+=vm.titleMarginBottom-titleSpacing}}}},drawBody:function(pt,vm,ctx,opacity){var bodyFontSize=vm.bodyFontSize;var bodySpacing=vm.bodySpacing;var body=vm.body;ctx.textAlign=vm._bodyAlign;ctx.textBaseline="top";ctx.font=helpers.fontString(bodyFontSize,vm._bodyFontStyle,vm._bodyFontFamily);var xLinePadding=0;var fillLineOfText=function(line){ctx.fillText(line,pt.x+xLinePadding,pt.y);pt.y+=bodyFontSize+bodySpacing};ctx.fillStyle=mergeOpacity(vm.bodyFontColor,opacity);helpers.each(vm.beforeBody,fillLineOfText);var drawColorBoxes=vm.displayColors;xLinePadding=drawColorBoxes?bodyFontSize+2:0;helpers.each(body,function(bodyItem,i){var textColor=mergeOpacity(vm.labelTextColors[i],opacity);ctx.fillStyle=textColor;helpers.each(bodyItem.before,fillLineOfText);helpers.each(bodyItem.lines,function(line){if(drawColorBoxes){ctx.fillStyle=mergeOpacity(vm.legendColorBackground,opacity);ctx.fillRect(pt.x,pt.y,bodyFontSize,bodyFontSize);ctx.lineWidth=1;ctx.strokeStyle=mergeOpacity(vm.labelColors[i].borderColor,opacity);ctx.strokeRect(pt.x,pt.y,bodyFontSize,bodyFontSize);ctx.fillStyle=mergeOpacity(vm.labelColors[i].backgroundColor,opacity);ctx.fillRect(pt.x+1,pt.y+1,bodyFontSize-2,bodyFontSize-2);ctx.fillStyle=textColor}fillLineOfText(line)});helpers.each(bodyItem.after,fillLineOfText)});xLinePadding=0;helpers.each(vm.afterBody,fillLineOfText);pt.y-=bodySpacing},drawFooter:function(pt,vm,ctx,opacity){var footer=vm.footer;if(footer.length){pt.y+=vm.footerMarginTop;ctx.textAlign=vm._footerAlign;ctx.textBaseline="top";ctx.fillStyle=mergeOpacity(vm.footerFontColor,opacity);ctx.font=helpers.fontString(vm.footerFontSize,vm._footerFontStyle,vm._footerFontFamily);helpers.each(footer,function(line){ctx.fillText(line,pt.x,pt.y);pt.y+=vm.footerFontSize+vm.footerSpacing})}},drawBackground:function(pt,vm,ctx,tooltipSize,opacity){ctx.fillStyle=mergeOpacity(vm.backgroundColor,opacity);ctx.strokeStyle=mergeOpacity(vm.borderColor,opacity);ctx.lineWidth=vm.borderWidth;var xAlign=vm.xAlign;var yAlign=vm.yAlign;var x=pt.x;var y=pt.y;var width=tooltipSize.width;var height=tooltipSize.height;var radius=vm.cornerRadius;ctx.beginPath();ctx.moveTo(x+radius,y);if(yAlign==="top"){this.drawCaret(pt,tooltipSize)}ctx.lineTo(x+width-radius,y);ctx.quadraticCurveTo(x+width,y,x+width,y+radius);if(yAlign==="center"&&xAlign==="right"){this.drawCaret(pt,tooltipSize)}ctx.lineTo(x+width,y+height-radius);ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height);if(yAlign==="bottom"){this.drawCaret(pt,tooltipSize)}ctx.lineTo(x+radius,y+height);ctx.quadraticCurveTo(x,y+height,x,y+height-radius);if(yAlign==="center"&&xAlign==="left"){this.drawCaret(pt,tooltipSize)}ctx.lineTo(x,y+radius);ctx.quadraticCurveTo(x,y,x+radius,y);ctx.closePath();ctx.fill();if(vm.borderWidth>0){ctx.stroke()}},draw:function(){var ctx=this._chart.ctx;var vm=this._view;if(vm.opacity===0){return}var tooltipSize={width:vm.width,height:vm.height};var pt={x:vm.x,y:vm.y};var opacity=Math.abs(vm.opacity<.001)?0:vm.opacity;var hasTooltipContent=vm.title.length||vm.beforeBody.length||vm.body.length||vm.afterBody.length||vm.footer.length;if(this._options.enabled&&hasTooltipContent){this.drawBackground(pt,vm,ctx,tooltipSize,opacity);pt.x+=vm.xPadding;pt.y+=vm.yPadding;this.drawTitle(pt,vm,ctx,opacity);this.drawBody(pt,vm,ctx,opacity);this.drawFooter(pt,vm,ctx,opacity)}},handleEvent:function(e){var me=this;var options=me._options;var changed=false;me._lastActive=me._lastActive||[];if(e.type==="mouseout"){me._active=[]}else{me._active=me._chart.getElementsAtEventForMode(e,options.mode,options)}changed=!helpers.arrayEquals(me._active,me._lastActive);if(changed){me._lastActive=me._active;if(options.enabled||options.custom){me._eventPosition={x:e.x,y:e.y};me.update(true);me.pivot()}}return changed}});Chart.Tooltip.positioners={average:function(elements){if(!elements.length){return false}var i,len;var x=0;var y=0;var count=0;for(i=0,len=elements.length;i<len;++i){var el=elements[i];if(el&&el.hasValue()){var pos=el.tooltipPosition();x+=pos.x;y+=pos.y;++count}}return{x:Math.round(x/count),y:Math.round(y/count)}},nearest:function(elements,eventPosition){var x=eventPosition.x;var y=eventPosition.y;var minDistance=Number.POSITIVE_INFINITY;var i,len,nearestElement;for(i=0,len=elements.length;i<len;++i){var el=elements[i];if(el&&el.hasValue()){var center=el.getCenterPoint();var d=helpers.distanceBetweenPoints(eventPosition,center);if(d<minDistance){minDistance=d;nearestElement=el}}}if(nearestElement){var tp=nearestElement.tooltipPosition();x=tp.x;y=tp.y}return{x:x,y:y}}}}},{"../helpers/index":42,"./core.defaults":22,"./core.element":23}],33:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var Element=require("../core/core.element");var helpers=require("../helpers/index");defaults._set("global",{elements:{arc:{backgroundColor:defaults.global.defaultColor,borderColor:"#fff",borderWidth:2}}});module.exports=Element.extend({inLabelRange:function(mouseX){var vm=this._view;if(vm){return Math.pow(mouseX-vm.x,2)<Math.pow(vm.radius+vm.hoverRadius,2)}return false},inRange:function(chartX,chartY){var vm=this._view;if(vm){var pointRelativePosition=helpers.getAngleFromPoint(vm,{x:chartX,y:chartY});var angle=pointRelativePosition.angle;var distance=pointRelativePosition.distance;var startAngle=vm.startAngle;var endAngle=vm.endAngle;while(endAngle<startAngle){endAngle+=2*Math.PI}while(angle>endAngle){angle-=2*Math.PI}while(angle<startAngle){angle+=2*Math.PI}var betweenAngles=angle>=startAngle&&angle<=endAngle;var withinRadius=distance>=vm.innerRadius&&distance<=vm.outerRadius;return betweenAngles&&withinRadius}return false},getCenterPoint:function(){var vm=this._view;var halfAngle=(vm.startAngle+vm.endAngle)/2;var halfRadius=(vm.innerRadius+vm.outerRadius)/2;return{x:vm.x+Math.cos(halfAngle)*halfRadius,y:vm.y+Math.sin(halfAngle)*halfRadius}},getArea:function(){var vm=this._view;return Math.PI*((vm.endAngle-vm.startAngle)/(2*Math.PI))*(Math.pow(vm.outerRadius,2)-Math.pow(vm.innerRadius,2))},tooltipPosition:function(){var vm=this._view;var centreAngle=vm.startAngle+(vm.endAngle-vm.startAngle)/2;var rangeFromCentre=(vm.outerRadius-vm.innerRadius)/2+vm.innerRadius;return{x:vm.x+Math.cos(centreAngle)*rangeFromCentre,y:vm.y+Math.sin(centreAngle)*rangeFromCentre}},draw:function(){var ctx=this._chart.ctx;var vm=this._view;var sA=vm.startAngle;var eA=vm.endAngle;ctx.beginPath();ctx.arc(vm.x,vm.y,vm.outerRadius,sA,eA);ctx.arc(vm.x,vm.y,vm.innerRadius,eA,sA,true);ctx.closePath();ctx.strokeStyle=vm.borderColor;ctx.lineWidth=vm.borderWidth;ctx.fillStyle=vm.backgroundColor;ctx.fill();ctx.lineJoin="bevel";if(vm.borderWidth){ctx.stroke()}}})},{"../core/core.defaults":22,"../core/core.element":23,"../helpers/index":42}],34:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var Element=require("../core/core.element");var helpers=require("../helpers/index");var globalDefaults=defaults.global;defaults._set("global",{elements:{line:{tension:.4,backgroundColor:globalDefaults.defaultColor,borderWidth:3,borderColor:globalDefaults.defaultColor,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:true,fill:true}}});module.exports=Element.extend({draw:function(){var me=this;var vm=me._view;var ctx=me._chart.ctx;var spanGaps=vm.spanGaps;var points=me._children.slice();var globalOptionLineElements=globalDefaults.elements.line;var lastDrawnIndex=-1;var index,current,previous,currentVM;if(me._loop&&points.length){points.push(points[0])}ctx.save();ctx.lineCap=vm.borderCapStyle||globalOptionLineElements.borderCapStyle;if(ctx.setLineDash){ctx.setLineDash(vm.borderDash||globalOptionLineElements.borderDash)}ctx.lineDashOffset=vm.borderDashOffset||globalOptionLineElements.borderDashOffset;ctx.lineJoin=vm.borderJoinStyle||globalOptionLineElements.borderJoinStyle;ctx.lineWidth=vm.borderWidth||globalOptionLineElements.borderWidth;ctx.strokeStyle=vm.borderColor||globalDefaults.defaultColor;ctx.beginPath();lastDrawnIndex=-1;for(index=0;index<points.length;++index){current=points[index];previous=helpers.previousItem(points,index);currentVM=current._view;if(index===0){if(!currentVM.skip){ctx.moveTo(currentVM.x,currentVM.y);lastDrawnIndex=index}}else{previous=lastDrawnIndex===-1?previous:points[lastDrawnIndex];if(!currentVM.skip){if(lastDrawnIndex!==index-1&&!spanGaps||lastDrawnIndex===-1){ctx.moveTo(currentVM.x,currentVM.y)}else{helpers.canvas.lineTo(ctx,previous._view,current._view)}lastDrawnIndex=index}}}ctx.stroke();ctx.restore()}})},{"../core/core.defaults":22,"../core/core.element":23,"../helpers/index":42}],35:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var Element=require("../core/core.element");var helpers=require("../helpers/index");var defaultColor=defaults.global.defaultColor;defaults._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:defaultColor,borderColor:defaultColor,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});function xRange(mouseX){var vm=this._view;return vm?Math.abs(mouseX-vm.x)<vm.radius+vm.hitRadius:false}function yRange(mouseY){var vm=this._view;return vm?Math.abs(mouseY-vm.y)<vm.radius+vm.hitRadius:false}module.exports=Element.extend({inRange:function(mouseX,mouseY){var vm=this._view;return vm?Math.pow(mouseX-vm.x,2)+Math.pow(mouseY-vm.y,2)<Math.pow(vm.hitRadius+vm.radius,2):false},inLabelRange:xRange,inXRange:xRange,inYRange:yRange,getCenterPoint:function(){var vm=this._view;return{x:vm.x,y:vm.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var vm=this._view;return{x:vm.x,y:vm.y,padding:vm.radius+vm.borderWidth}},draw:function(chartArea){var vm=this._view;var model=this._model;var ctx=this._chart.ctx;var pointStyle=vm.pointStyle;var radius=vm.radius;var x=vm.x;var y=vm.y;var color=helpers.color;var errMargin=1.01;var ratio=0;if(vm.skip){return}ctx.strokeStyle=vm.borderColor||defaultColor;ctx.lineWidth=helpers.valueOrDefault(vm.borderWidth,defaults.global.elements.point.borderWidth);ctx.fillStyle=vm.backgroundColor||defaultColor;if(chartArea!==undefined&&(model.x<chartArea.left||chartArea.right*errMargin<model.x||model.y<chartArea.top||chartArea.bottom*errMargin<model.y)){if(model.x<chartArea.left){ratio=(x-model.x)/(chartArea.left-model.x)}else if(chartArea.right*errMargin<model.x){ratio=(model.x-x)/(model.x-chartArea.right)}else if(model.y<chartArea.top){ratio=(y-model.y)/(chartArea.top-model.y)}else if(chartArea.bottom*errMargin<model.y){ratio=(model.y-y)/(model.y-chartArea.bottom)}ratio=Math.round(ratio*100)/100;ctx.strokeStyle=color(ctx.strokeStyle).alpha(ratio).rgbString();ctx.fillStyle=color(ctx.fillStyle).alpha(ratio).rgbString()}helpers.canvas.drawPoint(ctx,pointStyle,radius,x,y)}})},{"../core/core.defaults":22,"../core/core.element":23,"../helpers/index":42}],36:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var Element=require("../core/core.element");defaults._set("global",{elements:{rectangle:{backgroundColor:defaults.global.defaultColor,borderColor:defaults.global.defaultColor,borderSkipped:"bottom",borderWidth:0}}});function isVertical(bar){return bar._view.width!==undefined}function getBarBounds(bar){var vm=bar._view;var x1,x2,y1,y2;if(isVertical(bar)){var halfWidth=vm.width/2;x1=vm.x-halfWidth;x2=vm.x+halfWidth;y1=Math.min(vm.y,vm.base);y2=Math.max(vm.y,vm.base)}else{var halfHeight=vm.height/2;x1=Math.min(vm.x,vm.base);x2=Math.max(vm.x,vm.base);y1=vm.y-halfHeight;y2=vm.y+halfHeight}return{left:x1,top:y1,right:x2,bottom:y2}}module.exports=Element.extend({draw:function(){var ctx=this._chart.ctx;var vm=this._view;var left,right,top,bottom,signX,signY,borderSkipped;var borderWidth=vm.borderWidth;if(!vm.horizontal){left=vm.x-vm.width/2;right=vm.x+vm.width/2;top=vm.y;bottom=vm.base;signX=1;signY=bottom>top?1:-1;borderSkipped=vm.borderSkipped||"bottom"}else{left=vm.base;right=vm.x;top=vm.y-vm.height/2;bottom=vm.y+vm.height/2;signX=right>left?1:-1;signY=1;borderSkipped=vm.borderSkipped||"left"}if(borderWidth){var barSize=Math.min(Math.abs(left-right),Math.abs(top-bottom));borderWidth=borderWidth>barSize?barSize:borderWidth;var halfStroke=borderWidth/2;var borderLeft=left+(borderSkipped!=="left"?halfStroke*signX:0);var borderRight=right+(borderSkipped!=="right"?-halfStroke*signX:0);var borderTop=top+(borderSkipped!=="top"?halfStroke*signY:0);var borderBottom=bottom+(borderSkipped!=="bottom"?-halfStroke*signY:0);if(borderLeft!==borderRight){top=borderTop;bottom=borderBottom}if(borderTop!==borderBottom){left=borderLeft;right=borderRight}}ctx.beginPath();ctx.fillStyle=vm.backgroundColor;ctx.strokeStyle=vm.borderColor;ctx.lineWidth=borderWidth;var corners=[[left,bottom],[left,top],[right,top],[right,bottom]];var borders=["bottom","left","top","right"];var startCorner=borders.indexOf(borderSkipped,0);if(startCorner===-1){startCorner=0}function cornerAt(index){return corners[(startCorner+index)%4]}var corner=cornerAt(0);ctx.moveTo(corner[0],corner[1]);for(var i=1;i<4;i++){corner=cornerAt(i);ctx.lineTo(corner[0],corner[1])}ctx.fill();if(borderWidth){ctx.stroke()}},height:function(){var vm=this._view;return vm.base-vm.y},inRange:function(mouseX,mouseY){var inRange=false;if(this._view){var bounds=getBarBounds(this);inRange=mouseX>=bounds.left&&mouseX<=bounds.right&&mouseY>=bounds.top&&mouseY<=bounds.bottom}return inRange},inLabelRange:function(mouseX,mouseY){var me=this;if(!me._view){return false}var inRange=false;var bounds=getBarBounds(me);if(isVertical(me)){inRange=mouseX>=bounds.left&&mouseX<=bounds.right}else{inRange=mouseY>=bounds.top&&mouseY<=bounds.bottom}return inRange},inXRange:function(mouseX){var bounds=getBarBounds(this);return mouseX>=bounds.left&&mouseX<=bounds.right},inYRange:function(mouseY){var bounds=getBarBounds(this);return mouseY>=bounds.top&&mouseY<=bounds.bottom},getCenterPoint:function(){var vm=this._view;var x,y;if(isVertical(this)){x=vm.x;y=(vm.y+vm.base)/2}else{x=(vm.x+vm.base)/2;y=vm.y}return{x:x,y:y}},getArea:function(){var vm=this._view;return vm.width*Math.abs(vm.y-vm.base)},tooltipPosition:function(){var vm=this._view;return{x:vm.x,y:vm.y}}})},{"../core/core.defaults":22,"../core/core.element":23}],37:[function(require,module,exports){"use strict";module.exports={};module.exports.Arc=require("./element.arc");module.exports.Line=require("./element.line");module.exports.Point=require("./element.point");module.exports.Rectangle=require("./element.rectangle")},{"./element.arc":33,"./element.line":34,"./element.point":35,"./element.rectangle":36}],38:[function(require,module,exports){"use strict";var helpers=require("./helpers.core");var exports=module.exports={clear:function(chart){chart.ctx.clearRect(0,0,chart.width,chart.height)},roundedRect:function(ctx,x,y,width,height,radius){if(radius){var rx=Math.min(radius,width/2);var ry=Math.min(radius,height/2);ctx.moveTo(x+rx,y);ctx.lineTo(x+width-rx,y);ctx.quadraticCurveTo(x+width,y,x+width,y+ry);ctx.lineTo(x+width,y+height-ry);ctx.quadraticCurveTo(x+width,y+height,x+width-rx,y+height);ctx.lineTo(x+rx,y+height);ctx.quadraticCurveTo(x,y+height,x,y+height-ry);ctx.lineTo(x,y+ry);ctx.quadraticCurveTo(x,y,x+rx,y)}else{ctx.rect(x,y,width,height)}},drawPoint:function(ctx,style,radius,x,y){var type,edgeLength,xOffset,yOffset,height,size;if(style&&typeof style==="object"){type=style.toString();if(type==="[object HTMLImageElement]"||type==="[object HTMLCanvasElement]"){ctx.drawImage(style,x-style.width/2,y-style.height/2,style.width,style.height);return}}if(isNaN(radius)||radius<=0){return}switch(style){default:ctx.beginPath();ctx.arc(x,y,radius,0,Math.PI*2);ctx.closePath();ctx.fill();break;case"triangle":ctx.beginPath();edgeLength=3*radius/Math.sqrt(3);height=edgeLength*Math.sqrt(3)/2;ctx.moveTo(x-edgeLength/2,y+height/3);ctx.lineTo(x+edgeLength/2,y+height/3);ctx.lineTo(x,y-2*height/3);ctx.closePath();ctx.fill();break;case"rect":size=1/Math.SQRT2*radius;ctx.beginPath();ctx.fillRect(x-size,y-size,2*size,2*size);ctx.strokeRect(x-size,y-size,2*size,2*size);break;case"rectRounded":var offset=radius/Math.SQRT2;var leftX=x-offset;var topY=y-offset;var sideSize=Math.SQRT2*radius;ctx.beginPath();this.roundedRect(ctx,leftX,topY,sideSize,sideSize,radius/2);ctx.closePath();ctx.fill();break;case"rectRot":size=1/Math.SQRT2*radius;ctx.beginPath();ctx.moveTo(x-size,y);ctx.lineTo(x,y+size);ctx.lineTo(x+size,y);ctx.lineTo(x,y-size);ctx.closePath();ctx.fill();break;case"cross":ctx.beginPath();ctx.moveTo(x,y+radius);ctx.lineTo(x,y-radius);ctx.moveTo(x-radius,y);ctx.lineTo(x+radius,y);ctx.closePath();break;case"crossRot":ctx.beginPath();xOffset=Math.cos(Math.PI/4)*radius;yOffset=Math.sin(Math.PI/4)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+xOffset,y+yOffset);ctx.moveTo(x-xOffset,y+yOffset);ctx.lineTo(x+xOffset,y-yOffset);ctx.closePath();break;case"star":ctx.beginPath();ctx.moveTo(x,y+radius);ctx.lineTo(x,y-radius);ctx.moveTo(x-radius,y);ctx.lineTo(x+radius,y);xOffset=Math.cos(Math.PI/4)*radius;yOffset=Math.sin(Math.PI/4)*radius;ctx.moveTo(x-xOffset,y-yOffset);ctx.lineTo(x+xOffset,y+yOffset);ctx.moveTo(x-xOffset,y+yOffset);ctx.lineTo(x+xOffset,y-yOffset);ctx.closePath();break;case"line":ctx.beginPath();ctx.moveTo(x-radius,y);ctx.lineTo(x+radius,y);ctx.closePath();break;case"dash":ctx.beginPath();ctx.moveTo(x,y);ctx.lineTo(x+radius,y);ctx.closePath();break}ctx.stroke()},clipArea:function(ctx,area){ctx.save();ctx.beginPath();ctx.rect(area.left,area.top,area.right-area.left,area.bottom-area.top);ctx.clip()},unclipArea:function(ctx){ctx.restore()},lineTo:function(ctx,previous,target,flip){if(target.steppedLine){if(target.steppedLine==="after"&&!flip||target.steppedLine!=="after"&&flip){ctx.lineTo(previous.x,target.y)}else{ctx.lineTo(target.x,previous.y)}ctx.lineTo(target.x,target.y);return}if(!target.tension){ctx.lineTo(target.x,target.y);return}ctx.bezierCurveTo(flip?previous.controlPointPreviousX:previous.controlPointNextX,flip?previous.controlPointPreviousY:previous.controlPointNextY,flip?target.controlPointNextX:target.controlPointPreviousX,flip?target.controlPointNextY:target.controlPointPreviousY,target.x,target.y)}};helpers.clear=exports.clear;helpers.drawRoundedRectangle=function(ctx){ctx.beginPath();exports.roundedRect.apply(exports,arguments);ctx.closePath()}},{"./helpers.core":39}],39:[function(require,module,exports){"use strict";var helpers={noop:function(){},uid:function(){var id=0;return function(){return id++}}(),isNullOrUndef:function(value){return value===null||typeof value==="undefined"},isArray:Array.isArray?Array.isArray:function(value){return Object.prototype.toString.call(value)==="[object Array]"},isObject:function(value){return value!==null&&Object.prototype.toString.call(value)==="[object Object]"},valueOrDefault:function(value,defaultValue){return typeof value==="undefined"?defaultValue:value},valueAtIndexOrDefault:function(value,index,defaultValue){return helpers.valueOrDefault(helpers.isArray(value)?value[index]:value,defaultValue)},callback:function(fn,args,thisArg){if(fn&&typeof fn.call==="function"){return fn.apply(thisArg,args)}},each:function(loopable,fn,thisArg,reverse){var i,len,keys;if(helpers.isArray(loopable)){len=loopable.length;if(reverse){for(i=len-1;i>=0;i--){fn.call(thisArg,loopable[i],i)}}else{for(i=0;i<len;i++){fn.call(thisArg,loopable[i],i)}}}else if(helpers.isObject(loopable)){keys=Object.keys(loopable);len=keys.length;for(i=0;i<len;i++){fn.call(thisArg,loopable[keys[i]],keys[i])}}},arrayEquals:function(a0,a1){var i,ilen,v0,v1;if(!a0||!a1||a0.length!==a1.length){return false}for(i=0,ilen=a0.length;i<ilen;++i){v0=a0[i];v1=a1[i];if(v0 instanceof Array&&v1 instanceof Array){if(!helpers.arrayEquals(v0,v1)){return false}}else if(v0!==v1){return false}}return true},clone:function(source){if(helpers.isArray(source)){return source.map(helpers.clone)}if(helpers.isObject(source)){var target={};var keys=Object.keys(source);var klen=keys.length;var k=0;for(;k<klen;++k){target[keys[k]]=helpers.clone(source[keys[k]])}return target}return source},_merger:function(key,target,source,options){var tval=target[key];var sval=source[key];if(helpers.isObject(tval)&&helpers.isObject(sval)){helpers.merge(tval,sval,options)}else{target[key]=helpers.clone(sval)}},_mergerIf:function(key,target,source){var tval=target[key];var sval=source[key];if(helpers.isObject(tval)&&helpers.isObject(sval)){helpers.mergeIf(tval,sval)}else if(!target.hasOwnProperty(key)){target[key]=helpers.clone(sval)}},merge:function(target,source,options){var sources=helpers.isArray(source)?source:[source];var ilen=sources.length;var merge,i,keys,klen,k;if(!helpers.isObject(target)){return target}options=options||{};merge=options.merger||helpers._merger;for(i=0;i<ilen;++i){source=sources[i];if(!helpers.isObject(source)){continue}keys=Object.keys(source);for(k=0,klen=keys.length;k<klen;++k){merge(keys[k],target,source,options)}}return target},mergeIf:function(target,source){return helpers.merge(target,source,{merger:helpers._mergerIf})},extend:function(target){var setFn=function(value,key){target[key]=value};for(var i=1,ilen=arguments.length;i<ilen;++i){helpers.each(arguments[i],setFn)}return target},inherits:function(extensions){var me=this;var ChartElement=extensions&&extensions.hasOwnProperty("constructor")?extensions.constructor:function(){return me.apply(this,arguments)};var Surrogate=function(){this.constructor=ChartElement};Surrogate.prototype=me.prototype;ChartElement.prototype=new Surrogate;ChartElement.extend=helpers.inherits;if(extensions){helpers.extend(ChartElement.prototype,extensions)}ChartElement.__super__=me.prototype;return ChartElement}};module.exports=helpers;helpers.callCallback=helpers.callback;helpers.indexOf=function(array,item,fromIndex){return Array.prototype.indexOf.call(array,item,fromIndex)};helpers.getValueOrDefault=helpers.valueOrDefault;helpers.getValueAtIndexOrDefault=helpers.valueAtIndexOrDefault},{}],40:[function(require,module,exports){"use strict";var helpers=require("./helpers.core");var effects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-t*(t-2)},easeInOutQuad:function(t){if((t/=.5)<1){return.5*t*t}return-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return(t=t-1)*t*t+1},easeInOutCubic:function(t){if((t/=.5)<1){return.5*t*t*t}return.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-((t=t-1)*t*t*t-1)},easeInOutQuart:function(t){if((t/=.5)<1){return.5*t*t*t*t}return-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return(t=t-1)*t*t*t*t+1},easeInOutQuint:function(t){if((t/=.5)<1){return.5*t*t*t*t*t}return.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-Math.cos(t*(Math.PI/2))+1},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return t===0?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return t===1?1:-Math.pow(2,-10*t)+1},easeInOutExpo:function(t){if(t===0){return 0}if(t===1){return 1}if((t/=.5)<1){return.5*Math.pow(2,10*(t-1))}return.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){if(t>=1){return t}return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-(t=t-1)*t)},easeInOutCirc:function(t){if((t/=.5)<1){return-.5*(Math.sqrt(1-t*t)-1)}return.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0){return 0}if(t===1){return 1}if(!p){p=.3}if(a<1){a=1;s=p/4}else{s=p/(2*Math.PI)*Math.asin(1/a)}return-(a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p))},easeOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0){return 0}if(t===1){return 1}if(!p){p=.3}if(a<1){a=1;s=p/4}else{s=p/(2*Math.PI)*Math.asin(1/a)}return a*Math.pow(2,-10*t)*Math.sin((t-s)*(2*Math.PI)/p)+1},easeInOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0){return 0}if((t/=.5)===2){return 1}if(!p){p=.45}if(a<1){a=1;s=p/4}else{s=p/(2*Math.PI)*Math.asin(1/a)}if(t<1){return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p))}return a*Math.pow(2,-10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p)*.5+1},easeInBack:function(t){var s=1.70158;return t*t*((s+1)*t-s)},easeOutBack:function(t){var s=1.70158;return(t=t-1)*t*((s+1)*t+s)+1},easeInOutBack:function(t){var s=1.70158;if((t/=.5)<1){return.5*(t*t*(((s*=1.525)+1)*t-s))}return.5*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)},easeInBounce:function(t){return 1-effects.easeOutBounce(1-t)},easeOutBounce:function(t){if(t<1/2.75){return 7.5625*t*t}if(t<2/2.75){return 7.5625*(t-=1.5/2.75)*t+.75}if(t<2.5/2.75){return 7.5625*(t-=2.25/2.75)*t+.9375}return 7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:function(t){if(t<.5){return effects.easeInBounce(t*2)*.5}return effects.easeOutBounce(t*2-1)*.5+.5}};module.exports={effects:effects};helpers.easingEffects=effects},{"./helpers.core":39}],41:[function(require,module,exports){"use strict";var helpers=require("./helpers.core");module.exports={toLineHeight:function(value,size){var matches=(""+value).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!matches||matches[1]==="normal"){return size*1.2}value=+matches[2];switch(matches[3]){case"px":return value;case"%":value/=100;break;default:break}return size*value},toPadding:function(value){var t,r,b,l;if(helpers.isObject(value)){t=+value.top||0;r=+value.right||0;b=+value.bottom||0;l=+value.left||0}else{t=r=b=l=+value||0}return{top:t,right:r,bottom:b,left:l,height:t+b,width:l+r}},resolve:function(inputs,context,index){var i,ilen,value;for(i=0,ilen=inputs.length;i<ilen;++i){value=inputs[i];if(value===undefined){continue}if(context!==undefined&&typeof value==="function"){value=value(context)}if(index!==undefined&&helpers.isArray(value)){value=value[index]}if(value!==undefined){return value}}}}},{"./helpers.core":39}],42:[function(require,module,exports){"use strict";module.exports=require("./helpers.core");module.exports.easing=require("./helpers.easing");module.exports.canvas=require("./helpers.canvas");module.exports.options=require("./helpers.options")},{"./helpers.canvas":38,"./helpers.core":39,"./helpers.easing":40,"./helpers.options":41}],43:[function(require,module,exports){module.exports={acquireContext:function(item){if(item&&item.canvas){item=item.canvas}return item&&item.getContext("2d")||null}}},{}],44:[function(require,module,exports){"use strict";var helpers=require("../helpers/index");var EXPANDO_KEY="$chartjs";var CSS_PREFIX="chartjs-";var CSS_RENDER_MONITOR=CSS_PREFIX+"render-monitor";var CSS_RENDER_ANIMATION=CSS_PREFIX+"render-animation";var ANIMATION_START_EVENTS=["animationstart","webkitAnimationStart"];var EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function readUsedSize(element,property){var value=helpers.getStyle(element,property);var matches=value&&value.match(/^(\d+)(\.\d+)?px$/);return matches?Number(matches[1]):undefined}function initCanvas(canvas,config){var style=canvas.style;var renderHeight=canvas.getAttribute("height");var renderWidth=canvas.getAttribute("width");canvas[EXPANDO_KEY]={initial:{height:renderHeight,width:renderWidth,style:{display:style.display,height:style.height,width:style.width}}};style.display=style.display||"block";if(renderWidth===null||renderWidth===""){var displayWidth=readUsedSize(canvas,"width");if(displayWidth!==undefined){canvas.width=displayWidth}}if(renderHeight===null||renderHeight===""){if(canvas.style.height===""){canvas.height=canvas.width/(config.options.aspectRatio||2)}else{var displayHeight=readUsedSize(canvas,"height");if(displayWidth!==undefined){canvas.height=displayHeight}}}return canvas}var supportsEventListenerOptions=function(){var supports=false;try{var options=Object.defineProperty({},"passive",{get:function(){supports=true}});window.addEventListener("e",null,options)}catch(e){}return supports}();var eventListenerOptions=supportsEventListenerOptions?{passive:true}:false;function addEventListener(node,type,listener){node.addEventListener(type,listener,eventListenerOptions)}function removeEventListener(node,type,listener){node.removeEventListener(type,listener,eventListenerOptions)}function createEvent(type,chart,x,y,nativeEvent){return{type:type,chart:chart,native:nativeEvent||null,x:x!==undefined?x:null,y:y!==undefined?y:null}}function fromNativeEvent(event,chart){var type=EVENT_TYPES[event.type]||event.type;var pos=helpers.getRelativePosition(event,chart);return createEvent(type,chart,pos.x,pos.y,event)}function throttled(fn,thisArg){var ticking=false;var args=[];return function(){args=Array.prototype.slice.call(arguments);thisArg=thisArg||this;if(!ticking){ticking=true;helpers.requestAnimFrame.call(window,function(){ticking=false;fn.apply(thisArg,args)})}}}function createResizer(handler){var resizer=document.createElement("div");var cls=CSS_PREFIX+"size-monitor";var maxSize=1e6;var style="position:absolute;"+"left:0;"+"top:0;"+"right:0;"+"bottom:0;"+"overflow:hidden;"+"pointer-events:none;"+"visibility:hidden;"+"z-index:-1;";resizer.style.cssText=style;resizer.className=cls;resizer.innerHTML='<div class="'+cls+'-expand" style="'+style+'">'+'<div style="'+"position:absolute;"+"width:"+maxSize+"px;"+"height:"+maxSize+"px;"+"left:0;"+'top:0">'+"</div>"+"</div>"+'<div class="'+cls+'-shrink" style="'+style+'">'+'<div style="'+"position:absolute;"+"width:200%;"+"height:200%;"+"left:0; "+'top:0">'+"</div>"+"</div>";var expand=resizer.childNodes[0];var shrink=resizer.childNodes[1];resizer._reset=function(){expand.scrollLeft=maxSize;expand.scrollTop=maxSize;shrink.scrollLeft=maxSize;shrink.scrollTop=maxSize};var onScroll=function(){resizer._reset();handler()};addEventListener(expand,"scroll",onScroll.bind(expand,"expand"));addEventListener(shrink,"scroll",onScroll.bind(shrink,"shrink"));return resizer}function watchForRender(node,handler){var expando=node[EXPANDO_KEY]||(node[EXPANDO_KEY]={});var proxy=expando.renderProxy=function(e){if(e.animationName===CSS_RENDER_ANIMATION){handler()}};helpers.each(ANIMATION_START_EVENTS,function(type){addEventListener(node,type,proxy)});expando.reflow=!!node.offsetParent;node.classList.add(CSS_RENDER_MONITOR)}function unwatchForRender(node){var expando=node[EXPANDO_KEY]||{};var proxy=expando.renderProxy;if(proxy){helpers.each(ANIMATION_START_EVENTS,function(type){removeEventListener(node,type,proxy)});delete expando.renderProxy}node.classList.remove(CSS_RENDER_MONITOR)}function addResizeListener(node,listener,chart){var expando=node[EXPANDO_KEY]||(node[EXPANDO_KEY]={});var resizer=expando.resizer=createResizer(throttled(function(){if(expando.resizer){return listener(createEvent("resize",chart))}}));watchForRender(node,function(){if(expando.resizer){var container=node.parentNode;if(container&&container!==resizer.parentNode){container.insertBefore(resizer,container.firstChild)}resizer._reset()}})}function removeResizeListener(node){var expando=node[EXPANDO_KEY]||{};var resizer=expando.resizer;delete expando.resizer;unwatchForRender(node);if(resizer&&resizer.parentNode){resizer.parentNode.removeChild(resizer)}}function injectCSS(platform,css){var style=platform._style||document.createElement("style");if(!platform._style){platform._style=style;css="/* Chart.js */\n"+css;style.setAttribute("type","text/css");document.getElementsByTagName("head")[0].appendChild(style)}style.appendChild(document.createTextNode(css))}module.exports={_enabled:typeof window!=="undefined"&&typeof document!=="undefined",initialize:function(){var keyframes="from{opacity:0.99}to{opacity:1}";injectCSS(this,"@-webkit-keyframes "+CSS_RENDER_ANIMATION+"{"+keyframes+"}"+"@keyframes "+CSS_RENDER_ANIMATION+"{"+keyframes+"}"+"."+CSS_RENDER_MONITOR+"{"+"-webkit-animation:"+CSS_RENDER_ANIMATION+" 0.001s;"+"animation:"+CSS_RENDER_ANIMATION+" 0.001s;"+"}")},acquireContext:function(item,config){if(typeof item==="string"){item=document.getElementById(item)}else if(item.length){item=item[0]}if(item&&item.canvas){item=item.canvas}var context=item&&item.getContext&&item.getContext("2d");if(context&&context.canvas===item){initCanvas(item,config);return context}return null},releaseContext:function(context){var canvas=context.canvas;if(!canvas[EXPANDO_KEY]){return}var initial=canvas[EXPANDO_KEY].initial;["height","width"].forEach(function(prop){var value=initial[prop];if(helpers.isNullOrUndef(value)){canvas.removeAttribute(prop)}else{canvas.setAttribute(prop,value)}});helpers.each(initial.style||{},function(value,key){canvas.style[key]=value});canvas.width=canvas.width;delete canvas[EXPANDO_KEY]},addEventListener:function(chart,type,listener){var canvas=chart.canvas;if(type==="resize"){addResizeListener(canvas,listener,chart);return}var expando=listener[EXPANDO_KEY]||(listener[EXPANDO_KEY]={});var proxies=expando.proxies||(expando.proxies={});var proxy=proxies[chart.id+"_"+type]=function(event){listener(fromNativeEvent(event,chart))};addEventListener(canvas,type,proxy)},removeEventListener:function(chart,type,listener){var canvas=chart.canvas;if(type==="resize"){removeResizeListener(canvas,listener);return}var expando=listener[EXPANDO_KEY]||{};var proxies=expando.proxies||{};var proxy=proxies[chart.id+"_"+type];if(!proxy){return}removeEventListener(canvas,type,proxy)}};helpers.addEvent=addEventListener;helpers.removeEvent=removeEventListener},{"../helpers/index":42}],45:[function(require,module,exports){"use strict";var helpers=require("../helpers/index");var basic=require("./platform.basic");var dom=require("./platform.dom");var implementation=dom._enabled?dom:basic;module.exports=helpers.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},implementation)},{"../helpers/index":42,"./platform.basic":43,"./platform.dom":44}],46:[function(require,module,exports){"use strict";module.exports={};module.exports.filler=require("./plugin.filler");module.exports.legend=require("./plugin.legend");module.exports.title=require("./plugin.title")},{"./plugin.filler":47,"./plugin.legend":48,"./plugin.title":49}],47:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var elements=require("../elements/index");var helpers=require("../helpers/index");defaults._set("global",{plugins:{filler:{propagate:true}}});var mappers={dataset:function(source){var index=source.fill;var chart=source.chart;var meta=chart.getDatasetMeta(index);var visible=meta&&chart.isDatasetVisible(index);var points=visible&&meta.dataset._children||[];var length=points.length||0;return!length?null:function(point,i){return i<length&&points[i]._view||null}},boundary:function(source){var boundary=source.boundary;var x=boundary?boundary.x:null;var y=boundary?boundary.y:null;return function(point){return{x:x===null?point.x:x,y:y===null?point.y:y}}}};function decodeFill(el,index,count){var model=el._model||{};var fill=model.fill;var target;if(fill===undefined){fill=!!model.backgroundColor}if(fill===false||fill===null){return false}if(fill===true){return"origin"}target=parseFloat(fill,10);if(isFinite(target)&&Math.floor(target)===target){if(fill[0]==="-"||fill[0]==="+"){target=index+target}if(target===index||target<0||target>=count){return false}return target}switch(fill){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return fill;default:return false}}function computeBoundary(source){var model=source.el._model||{};var scale=source.el._scale||{};var fill=source.fill;var target=null;var horizontal;if(isFinite(fill)){return null}if(fill==="start"){target=model.scaleBottom===undefined?scale.bottom:model.scaleBottom}else if(fill==="end"){target=model.scaleTop===undefined?scale.top:model.scaleTop}else if(model.scaleZero!==undefined){target=model.scaleZero}else if(scale.getBasePosition){target=scale.getBasePosition()}else if(scale.getBasePixel){target=scale.getBasePixel()}if(target!==undefined&&target!==null){if(target.x!==undefined&&target.y!==undefined){return target}if(typeof target==="number"&&isFinite(target)){horizontal=scale.isHorizontal();return{x:horizontal?target:null,y:horizontal?null:target}}}return null}function resolveTarget(sources,index,propagate){var source=sources[index];var fill=source.fill;var visited=[index];var target;if(!propagate){return fill}while(fill!==false&&visited.indexOf(fill)===-1){if(!isFinite(fill)){return fill}target=sources[fill];if(!target){return false}if(target.visible){return fill}visited.push(fill);fill=target.fill}return false}function createMapper(source){var fill=source.fill;var type="dataset";if(fill===false){return null}if(!isFinite(fill)){type="boundary"}return mappers[type](source)}function isDrawable(point){return point&&!point.skip}function drawArea(ctx,curve0,curve1,len0,len1){var i;if(!len0||!len1){return}ctx.moveTo(curve0[0].x,curve0[0].y);for(i=1;i<len0;++i){helpers.canvas.lineTo(ctx,curve0[i-1],curve0[i])}ctx.lineTo(curve1[len1-1].x,curve1[len1-1].y);for(i=len1-1;i>0;--i){helpers.canvas.lineTo(ctx,curve1[i],curve1[i-1],true)}}function doFill(ctx,points,mapper,view,color,loop){var count=points.length;var span=view.spanGaps;var curve0=[];var curve1=[];var len0=0;var len1=0;var i,ilen,index,p0,p1,d0,d1;ctx.beginPath();for(i=0,ilen=count+!!loop;i<ilen;++i){index=i%count;p0=points[index]._view;p1=mapper(p0,index,view);d0=isDrawable(p0);d1=isDrawable(p1);if(d0&&d1){len0=curve0.push(p0);len1=curve1.push(p1)}else if(len0&&len1){if(!span){drawArea(ctx,curve0,curve1,len0,len1);len0=len1=0;curve0=[];curve1=[]}else{if(d0){curve0.push(p0)}if(d1){curve1.push(p1)}}}}drawArea(ctx,curve0,curve1,len0,len1);ctx.closePath();ctx.fillStyle=color;ctx.fill()}module.exports={id:"filler",afterDatasetsUpdate:function(chart,options){var count=(chart.data.datasets||[]).length;var propagate=options.propagate;var sources=[];var meta,i,el,source;for(i=0;i<count;++i){meta=chart.getDatasetMeta(i);el=meta.dataset;source=null;if(el&&el._model&&el instanceof elements.Line){source={visible:chart.isDatasetVisible(i),fill:decodeFill(el,i,count),chart:chart,el:el}}meta.$filler=source;sources.push(source)}for(i=0;i<count;++i){source=sources[i];if(!source){continue}source.fill=resolveTarget(sources,i,propagate);source.boundary=computeBoundary(source);source.mapper=createMapper(source)}},beforeDatasetDraw:function(chart,args){var meta=args.meta.$filler;if(!meta){return}var ctx=chart.ctx;var el=meta.el;var view=el._view;var points=el._children||[];var mapper=meta.mapper;var color=view.backgroundColor||defaults.global.defaultColor;if(mapper&&color&&points.length){helpers.canvas.clipArea(ctx,chart.chartArea);doFill(ctx,points,mapper,view,color,el._loop);helpers.canvas.unclipArea(ctx)}}}},{"../core/core.defaults":22,"../elements/index":37,"../helpers/index":42}],48:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var Element=require("../core/core.element");var helpers=require("../helpers/index");var layouts=require("../core/core.layouts");var noop=helpers.noop;defaults._set("global",{legend:{display:true,position:"top",fullWidth:true,reverse:false,weight:1e3,onClick:function(e,legendItem){var index=legendItem.datasetIndex;var ci=this.chart;var meta=ci.getDatasetMeta(index);meta.hidden=meta.hidden===null?!ci.data.datasets[index].hidden:null;ci.update()},onHover:null,labels:{boxWidth:40,padding:10,generateLabels:function(chart){var data=chart.data;return helpers.isArray(data.datasets)?data.datasets.map(function(dataset,i){return{text:dataset.label,fillStyle:!helpers.isArray(dataset.backgroundColor)?dataset.backgroundColor:dataset.backgroundColor[0],hidden:!chart.isDatasetVisible(i),lineCap:dataset.borderCapStyle,lineDash:dataset.borderDash,lineDashOffset:dataset.borderDashOffset,lineJoin:dataset.borderJoinStyle,lineWidth:dataset.borderWidth,strokeStyle:dataset.borderColor,pointStyle:dataset.pointStyle,datasetIndex:i}},this):[]}}},legendCallback:function(chart){var text=[];text.push('<ul class="'+chart.id+'-legend">');for(var i=0;i<chart.data.datasets.length;i++){text.push('<li><span style="background-color:'+chart.data.datasets[i].backgroundColor+'"></span>');if(chart.data.datasets[i].label){text.push(chart.data.datasets[i].label)}text.push("</li>")}text.push("</ul>");return text.join("")}});function getBoxWidth(labelOpts,fontSize){return labelOpts.usePointStyle?fontSize*Math.SQRT2:labelOpts.boxWidth}var Legend=Element.extend({initialize:function(config){helpers.extend(this,config);this.legendHitBoxes=[];this.doughnutMode=false},beforeUpdate:noop,update:function(maxWidth,maxHeight,margins){var me=this;me.beforeUpdate();me.maxWidth=maxWidth;me.maxHeight=maxHeight;me.margins=margins;me.beforeSetDimensions();me.setDimensions();me.afterSetDimensions();me.beforeBuildLabels();me.buildLabels();me.afterBuildLabels();me.beforeFit();me.fit();me.afterFit();me.afterUpdate();return me.minSize},afterUpdate:noop,beforeSetDimensions:noop,setDimensions:function(){var me=this;if(me.isHorizontal()){me.width=me.maxWidth;me.left=0;me.right=me.width}else{me.height=me.maxHeight;me.top=0;me.bottom=me.height}me.paddingLeft=0;me.paddingTop=0;me.paddingRight=0;me.paddingBottom=0;me.minSize={width:0,height:0}},afterSetDimensions:noop,beforeBuildLabels:noop,buildLabels:function(){var me=this;var labelOpts=me.options.labels||{};var legendItems=helpers.callback(labelOpts.generateLabels,[me.chart],me)||[];if(labelOpts.filter){legendItems=legendItems.filter(function(item){return labelOpts.filter(item,me.chart.data)})}if(me.options.reverse){legendItems.reverse()}me.legendItems=legendItems},afterBuildLabels:noop,beforeFit:noop,fit:function(){var me=this;var opts=me.options;var labelOpts=opts.labels;var display=opts.display;var ctx=me.ctx;var globalDefault=defaults.global;var valueOrDefault=helpers.valueOrDefault;var fontSize=valueOrDefault(labelOpts.fontSize,globalDefault.defaultFontSize);var fontStyle=valueOrDefault(labelOpts.fontStyle,globalDefault.defaultFontStyle);var fontFamily=valueOrDefault(labelOpts.fontFamily,globalDefault.defaultFontFamily);var labelFont=helpers.fontString(fontSize,fontStyle,fontFamily);var hitboxes=me.legendHitBoxes=[];var minSize=me.minSize;var isHorizontal=me.isHorizontal();if(isHorizontal){minSize.width=me.maxWidth;minSize.height=display?10:0}else{minSize.width=display?10:0;minSize.height=me.maxHeight}if(display){ctx.font=labelFont;if(isHorizontal){var lineWidths=me.lineWidths=[0];var totalHeight=me.legendItems.length?fontSize+labelOpts.padding:0;ctx.textAlign="left";ctx.textBaseline="top";helpers.each(me.legendItems,function(legendItem,i){var boxWidth=getBoxWidth(labelOpts,fontSize);var width=boxWidth+fontSize/2+ctx.measureText(legendItem.text).width;if(lineWidths[lineWidths.length-1]+width+labelOpts.padding>=me.width){totalHeight+=fontSize+labelOpts.padding;lineWidths[lineWidths.length]=me.left}hitboxes[i]={left:0,top:0,width:width,height:fontSize};lineWidths[lineWidths.length-1]+=width+labelOpts.padding});minSize.height+=totalHeight}else{var vPadding=labelOpts.padding;var columnWidths=me.columnWidths=[];var totalWidth=labelOpts.padding;var currentColWidth=0;var currentColHeight=0;var itemHeight=fontSize+vPadding;helpers.each(me.legendItems,function(legendItem,i){var boxWidth=getBoxWidth(labelOpts,fontSize);var itemWidth=boxWidth+fontSize/2+ctx.measureText(legendItem.text).width;if(currentColHeight+itemHeight>minSize.height){totalWidth+=currentColWidth+labelOpts.padding;columnWidths.push(currentColWidth);currentColWidth=0;currentColHeight=0}currentColWidth=Math.max(currentColWidth,itemWidth);currentColHeight+=itemHeight;hitboxes[i]={left:0,top:0,width:itemWidth,height:fontSize}});totalWidth+=currentColWidth;columnWidths.push(currentColWidth);minSize.width+=totalWidth}}me.width=minSize.width;me.height=minSize.height},afterFit:noop,isHorizontal:function(){return this.options.position==="top"||this.options.position==="bottom"},draw:function(){var me=this;var opts=me.options;var labelOpts=opts.labels;var globalDefault=defaults.global;var lineDefault=globalDefault.elements.line;var legendWidth=me.width;var lineWidths=me.lineWidths;if(opts.display){var ctx=me.ctx;var valueOrDefault=helpers.valueOrDefault;var fontColor=valueOrDefault(labelOpts.fontColor,globalDefault.defaultFontColor);var fontSize=valueOrDefault(labelOpts.fontSize,globalDefault.defaultFontSize);var fontStyle=valueOrDefault(labelOpts.fontStyle,globalDefault.defaultFontStyle);var fontFamily=valueOrDefault(labelOpts.fontFamily,globalDefault.defaultFontFamily);var labelFont=helpers.fontString(fontSize,fontStyle,fontFamily);var cursor;ctx.textAlign="left";ctx.textBaseline="middle";ctx.lineWidth=.5;ctx.strokeStyle=fontColor;ctx.fillStyle=fontColor;ctx.font=labelFont;var boxWidth=getBoxWidth(labelOpts,fontSize);var hitboxes=me.legendHitBoxes;var drawLegendBox=function(x,y,legendItem){if(isNaN(boxWidth)||boxWidth<=0){return}ctx.save();ctx.fillStyle=valueOrDefault(legendItem.fillStyle,globalDefault.defaultColor);ctx.lineCap=valueOrDefault(legendItem.lineCap,lineDefault.borderCapStyle);ctx.lineDashOffset=valueOrDefault(legendItem.lineDashOffset,lineDefault.borderDashOffset);ctx.lineJoin=valueOrDefault(legendItem.lineJoin,lineDefault.borderJoinStyle);ctx.lineWidth=valueOrDefault(legendItem.lineWidth,lineDefault.borderWidth);ctx.strokeStyle=valueOrDefault(legendItem.strokeStyle,globalDefault.defaultColor);var isLineWidthZero=valueOrDefault(legendItem.lineWidth,lineDefault.borderWidth)===0;if(ctx.setLineDash){ctx.setLineDash(valueOrDefault(legendItem.lineDash,lineDefault.borderDash))}if(opts.labels&&opts.labels.usePointStyle){var radius=fontSize*Math.SQRT2/2;var offSet=radius/Math.SQRT2;var centerX=x+offSet;var centerY=y+offSet;helpers.canvas.drawPoint(ctx,legendItem.pointStyle,radius,centerX,centerY)}else{if(!isLineWidthZero){ctx.strokeRect(x,y,boxWidth,fontSize)}ctx.fillRect(x,y,boxWidth,fontSize)}ctx.restore()};var fillText=function(x,y,legendItem,textWidth){var halfFontSize=fontSize/2;var xLeft=boxWidth+halfFontSize+x;var yMiddle=y+halfFontSize;ctx.fillText(legendItem.text,xLeft,yMiddle);if(legendItem.hidden){ctx.beginPath();ctx.lineWidth=2;ctx.moveTo(xLeft,yMiddle);ctx.lineTo(xLeft+textWidth,yMiddle);ctx.stroke()}};var isHorizontal=me.isHorizontal();if(isHorizontal){cursor={x:me.left+(legendWidth-lineWidths[0])/2,y:me.top+labelOpts.padding,line:0}}else{cursor={x:me.left+labelOpts.padding,y:me.top+labelOpts.padding,line:0}}var itemHeight=fontSize+labelOpts.padding;helpers.each(me.legendItems,function(legendItem,i){var textWidth=ctx.measureText(legendItem.text).width;var width=boxWidth+fontSize/2+textWidth;var x=cursor.x;var y=cursor.y;if(isHorizontal){if(x+width>=legendWidth){y=cursor.y+=itemHeight;cursor.line++;x=cursor.x=me.left+(legendWidth-lineWidths[cursor.line])/2}}else if(y+itemHeight>me.bottom){x=cursor.x=x+me.columnWidths[cursor.line]+labelOpts.padding;y=cursor.y=me.top+labelOpts.padding;cursor.line++}drawLegendBox(x,y,legendItem);hitboxes[i].left=x;hitboxes[i].top=y;fillText(x,y,legendItem,textWidth);if(isHorizontal){cursor.x+=width+labelOpts.padding}else{cursor.y+=itemHeight}})}},handleEvent:function(e){var me=this;var opts=me.options;var type=e.type==="mouseup"?"click":e.type;var changed=false;if(type==="mousemove"){if(!opts.onHover){return}}else if(type==="click"){if(!opts.onClick){return}}else{return}var x=e.x;var y=e.y;if(x>=me.left&&x<=me.right&&y>=me.top&&y<=me.bottom){var lh=me.legendHitBoxes;for(var i=0;i<lh.length;++i){var hitBox=lh[i];if(x>=hitBox.left&&x<=hitBox.left+hitBox.width&&y>=hitBox.top&&y<=hitBox.top+hitBox.height){if(type==="click"){opts.onClick.call(me,e.native,me.legendItems[i]);changed=true;break}else if(type==="mousemove"){opts.onHover.call(me,e.native,me.legendItems[i]);changed=true;break}}}}return changed}});function createNewLegendAndAttach(chart,legendOpts){var legend=new Legend({ctx:chart.ctx,options:legendOpts,chart:chart});layouts.configure(chart,legend,legendOpts);layouts.addBox(chart,legend);chart.legend=legend}module.exports={id:"legend",_element:Legend,beforeInit:function(chart){var legendOpts=chart.options.legend;if(legendOpts){createNewLegendAndAttach(chart,legendOpts)}},beforeUpdate:function(chart){var legendOpts=chart.options.legend;var legend=chart.legend;if(legendOpts){helpers.mergeIf(legendOpts,defaults.global.legend);if(legend){layouts.configure(chart,legend,legendOpts);legend.options=legendOpts}else{createNewLegendAndAttach(chart,legendOpts)}}else if(legend){layouts.removeBox(chart,legend);delete chart.legend}},afterEvent:function(chart,e){var legend=chart.legend;if(legend){legend.handleEvent(e)}}}},{"../core/core.defaults":22,"../core/core.element":23,"../core/core.layouts":27,"../helpers/index":42}],49:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var Element=require("../core/core.element");var helpers=require("../helpers/index");var layouts=require("../core/core.layouts");var noop=helpers.noop;defaults._set("global",{title:{display:false,fontStyle:"bold",fullWidth:true,lineHeight:1.2,padding:10,position:"top",text:"",weight:2e3}});var Title=Element.extend({initialize:function(config){var me=this;helpers.extend(me,config);me.legendHitBoxes=[]},beforeUpdate:noop,update:function(maxWidth,maxHeight,margins){var me=this;me.beforeUpdate();me.maxWidth=maxWidth;me.maxHeight=maxHeight;me.margins=margins;me.beforeSetDimensions();me.setDimensions();me.afterSetDimensions();me.beforeBuildLabels();me.buildLabels();me.afterBuildLabels();me.beforeFit();me.fit();me.afterFit();me.afterUpdate();return me.minSize},afterUpdate:noop,beforeSetDimensions:noop,setDimensions:function(){var me=this;if(me.isHorizontal()){me.width=me.maxWidth;me.left=0;me.right=me.width}else{me.height=me.maxHeight;me.top=0;me.bottom=me.height}me.paddingLeft=0;me.paddingTop=0;me.paddingRight=0;me.paddingBottom=0;me.minSize={width:0,height:0}},afterSetDimensions:noop,beforeBuildLabels:noop,buildLabels:noop,afterBuildLabels:noop,beforeFit:noop,fit:function(){var me=this;var valueOrDefault=helpers.valueOrDefault;var opts=me.options;var display=opts.display;var fontSize=valueOrDefault(opts.fontSize,defaults.global.defaultFontSize);var minSize=me.minSize;var lineCount=helpers.isArray(opts.text)?opts.text.length:1;var lineHeight=helpers.options.toLineHeight(opts.lineHeight,fontSize);var textSize=display?lineCount*lineHeight+opts.padding*2:0;if(me.isHorizontal()){minSize.width=me.maxWidth;minSize.height=textSize}else{minSize.width=textSize;minSize.height=me.maxHeight}me.width=minSize.width;me.height=minSize.height},afterFit:noop,isHorizontal:function(){var pos=this.options.position;return pos==="top"||pos==="bottom"},draw:function(){var me=this;var ctx=me.ctx;var valueOrDefault=helpers.valueOrDefault;var opts=me.options;var globalDefaults=defaults.global;if(opts.display){var fontSize=valueOrDefault(opts.fontSize,globalDefaults.defaultFontSize);var fontStyle=valueOrDefault(opts.fontStyle,globalDefaults.defaultFontStyle);var fontFamily=valueOrDefault(opts.fontFamily,globalDefaults.defaultFontFamily);var titleFont=helpers.fontString(fontSize,fontStyle,fontFamily);var lineHeight=helpers.options.toLineHeight(opts.lineHeight,fontSize);var offset=lineHeight/2+opts.padding;var rotation=0;var top=me.top;var left=me.left;var bottom=me.bottom;var right=me.right;var maxWidth,titleX,titleY;ctx.fillStyle=valueOrDefault(opts.fontColor,globalDefaults.defaultFontColor);ctx.font=titleFont;if(me.isHorizontal()){titleX=left+(right-left)/2;titleY=top+offset;maxWidth=right-left}else{titleX=opts.position==="left"?left+offset:right-offset;titleY=top+(bottom-top)/2;maxWidth=bottom-top;rotation=Math.PI*(opts.position==="left"?-.5:.5)}ctx.save();ctx.translate(titleX,titleY);ctx.rotate(rotation);ctx.textAlign="center";ctx.textBaseline="middle";var text=opts.text;if(helpers.isArray(text)){var y=0;for(var i=0;i<text.length;++i){ctx.fillText(text[i],0,y,maxWidth);y+=lineHeight}}else{ctx.fillText(text,0,0,maxWidth)}ctx.restore()}}});function createNewTitleBlockAndAttach(chart,titleOpts){var title=new Title({ctx:chart.ctx,options:titleOpts,chart:chart});layouts.configure(chart,title,titleOpts);layouts.addBox(chart,title);chart.titleBlock=title}module.exports={id:"title",_element:Title,beforeInit:function(chart){var titleOpts=chart.options.title;if(titleOpts){createNewTitleBlockAndAttach(chart,titleOpts)}},beforeUpdate:function(chart){var titleOpts=chart.options.title;var titleBlock=chart.titleBlock;if(titleOpts){helpers.mergeIf(titleOpts,defaults.global.title);if(titleBlock){layouts.configure(chart,titleBlock,titleOpts);titleBlock.options=titleOpts}else{createNewTitleBlockAndAttach(chart,titleOpts)}}else if(titleBlock){layouts.removeBox(chart,titleBlock);delete chart.titleBlock}}}},{"../core/core.defaults":22,"../core/core.element":23,"../core/core.layouts":27,"../helpers/index":42}],50:[function(require,module,exports){"use strict";module.exports=function(Chart){var defaultConfig={position:"bottom"};var DatasetScale=Chart.Scale.extend({getLabels:function(){var data=this.chart.data;return this.options.labels||(this.isHorizontal()?data.xLabels:data.yLabels)||data.labels},determineDataLimits:function(){var me=this;var labels=me.getLabels();me.minIndex=0;me.maxIndex=labels.length-1;var findIndex;if(me.options.ticks.min!==undefined){findIndex=labels.indexOf(me.options.ticks.min);me.minIndex=findIndex!==-1?findIndex:me.minIndex}if(me.options.ticks.max!==undefined){findIndex=labels.indexOf(me.options.ticks.max);me.maxIndex=findIndex!==-1?findIndex:me.maxIndex}me.min=labels[me.minIndex];me.max=labels[me.maxIndex]},buildTicks:function(){var me=this;var labels=me.getLabels();me.ticks=me.minIndex===0&&me.maxIndex===labels.length-1?labels:labels.slice(me.minIndex,me.maxIndex+1)},getLabelForIndex:function(index,datasetIndex){var me=this;var data=me.chart.data;var isHorizontal=me.isHorizontal();if(data.yLabels&&!isHorizontal){return me.getRightValue(data.datasets[datasetIndex].data[index])}return me.ticks[index-me.minIndex]},getPixelForValue:function(value,index){var me=this;var offset=me.options.offset;var offsetAmt=Math.max(me.maxIndex+1-me.minIndex-(offset?0:1),1);var valueCategory;if(value!==undefined&&value!==null){valueCategory=me.isHorizontal()?value.x:value.y}if(valueCategory!==undefined||value!==undefined&&isNaN(index)){var labels=me.getLabels();value=valueCategory||value;var idx=labels.indexOf(value);index=idx!==-1?idx:index}if(me.isHorizontal()){var valueWidth=me.width/offsetAmt;var widthOffset=valueWidth*(index-me.minIndex);if(offset){widthOffset+=valueWidth/2}return me.left+Math.round(widthOffset)}var valueHeight=me.height/offsetAmt;var heightOffset=valueHeight*(index-me.minIndex);if(offset){heightOffset+=valueHeight/2}return me.top+Math.round(heightOffset)},getPixelForTick:function(index){return this.getPixelForValue(this.ticks[index],index+this.minIndex,null)},getValueForPixel:function(pixel){var me=this;var offset=me.options.offset;var value;var offsetAmt=Math.max(me._ticks.length-(offset?0:1),1);var horz=me.isHorizontal();var valueDimension=(horz?me.width:me.height)/offsetAmt;pixel-=horz?me.left:me.top;if(offset){pixel-=valueDimension/2}if(pixel<=0){value=0}else{value=Math.round(pixel/valueDimension)}return value+me.minIndex},getBasePixel:function(){return this.bottom}});Chart.scaleService.registerScaleType("category",DatasetScale,defaultConfig)}},{}],51:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var helpers=require("../helpers/index");var Ticks=require("../core/core.ticks");module.exports=function(Chart){var defaultConfig={position:"left",ticks:{callback:Ticks.formatters.linear}};var LinearScale=Chart.LinearScaleBase.extend({determineDataLimits:function(){var me=this;var opts=me.options;var chart=me.chart;var data=chart.data;var datasets=data.datasets;var isHorizontal=me.isHorizontal();var DEFAULT_MIN=0;var DEFAULT_MAX=1;function IDMatches(meta){return isHorizontal?meta.xAxisID===me.id:meta.yAxisID===me.id}me.min=null;me.max=null;var hasStacks=opts.stacked;if(hasStacks===undefined){helpers.each(datasets,function(dataset,datasetIndex){if(hasStacks){return}var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&meta.stack!==undefined){hasStacks=true}})}if(opts.stacked||hasStacks){var valuesPerStack={};helpers.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);var key=[meta.type,opts.stacked===undefined&&meta.stack===undefined?datasetIndex:"",meta.stack].join(".");if(valuesPerStack[key]===undefined){valuesPerStack[key]={positiveValues:[],negativeValues:[]}}var positiveValues=valuesPerStack[key].positiveValues;var negativeValues=valuesPerStack[key].negativeValues;if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){helpers.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden){return}positiveValues[index]=positiveValues[index]||0;negativeValues[index]=negativeValues[index]||0;if(opts.relativePoints){positiveValues[index]=100}else if(value<0){negativeValues[index]+=value}else{positiveValues[index]+=value}})}});helpers.each(valuesPerStack,function(valuesForType){var values=valuesForType.positiveValues.concat(valuesForType.negativeValues);var minVal=helpers.min(values);var maxVal=helpers.max(values);me.min=me.min===null?minVal:Math.min(me.min,minVal);me.max=me.max===null?maxVal:Math.max(me.max,maxVal)})}else{helpers.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){helpers.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden){return}if(me.min===null){me.min=value}else if(value<me.min){me.min=value}if(me.max===null){me.max=value}else if(value>me.max){me.max=value}})}})}me.min=isFinite(me.min)&&!isNaN(me.min)?me.min:DEFAULT_MIN;me.max=isFinite(me.max)&&!isNaN(me.max)?me.max:DEFAULT_MAX;this.handleTickRangeOptions()},getTickLimit:function(){var maxTicks;var me=this;var tickOpts=me.options.ticks;if(me.isHorizontal()){maxTicks=Math.min(tickOpts.maxTicksLimit?tickOpts.maxTicksLimit:11,Math.ceil(me.width/50))}else{var tickFontSize=helpers.valueOrDefault(tickOpts.fontSize,defaults.global.defaultFontSize);maxTicks=Math.min(tickOpts.maxTicksLimit?tickOpts.maxTicksLimit:11,Math.ceil(me.height/(2*tickFontSize)))}return maxTicks},handleDirectionalChanges:function(){if(!this.isHorizontal()){this.ticks.reverse()}},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index])},getPixelForValue:function(value){var me=this;var start=me.start;var rightValue=+me.getRightValue(value);var pixel;var range=me.end-start;if(me.isHorizontal()){pixel=me.left+me.width/range*(rightValue-start)}else{pixel=me.bottom-me.height/range*(rightValue-start)}return pixel},getValueForPixel:function(pixel){var me=this;var isHorizontal=me.isHorizontal();var innerDimension=isHorizontal?me.width:me.height;var offset=(isHorizontal?pixel-me.left:me.bottom-pixel)/innerDimension;return me.start+(me.end-me.start)*offset},getPixelForTick:function(index){return this.getPixelForValue(this.ticksAsNumbers[index])}});Chart.scaleService.registerScaleType("linear",LinearScale,defaultConfig)}},{"../core/core.defaults":22,"../core/core.ticks":31,"../helpers/index":42}],52:[function(require,module,exports){"use strict";var helpers=require("../helpers/index");function generateTicks(generationOptions,dataRange){var ticks=[];var spacing;if(generationOptions.stepSize&&generationOptions.stepSize>0){spacing=generationOptions.stepSize}else{var niceRange=helpers.niceNum(dataRange.max-dataRange.min,false);spacing=helpers.niceNum(niceRange/(generationOptions.maxTicks-1),true)}var niceMin=Math.floor(dataRange.min/spacing)*spacing;var niceMax=Math.ceil(dataRange.max/spacing)*spacing;if(generationOptions.min&&generationOptions.max&&generationOptions.stepSize){if(helpers.almostWhole((generationOptions.max-generationOptions.min)/generationOptions.stepSize,spacing/1e3)){niceMin=generationOptions.min;niceMax=generationOptions.max}}var numSpaces=(niceMax-niceMin)/spacing;if(helpers.almostEquals(numSpaces,Math.round(numSpaces),spacing/1e3)){numSpaces=Math.round(numSpaces)}else{numSpaces=Math.ceil(numSpaces)}var precision=1;if(spacing<1){precision=Math.pow(10,spacing.toString().length-2);niceMin=Math.round(niceMin*precision)/precision;niceMax=Math.round(niceMax*precision)/precision}ticks.push(generationOptions.min!==undefined?generationOptions.min:niceMin);for(var j=1;j<numSpaces;++j){ticks.push(Math.round((niceMin+j*spacing)*precision)/precision)}ticks.push(generationOptions.max!==undefined?generationOptions.max:niceMax);return ticks}module.exports=function(Chart){var noop=helpers.noop;Chart.LinearScaleBase=Chart.Scale.extend({getRightValue:function(value){if(typeof value==="string"){return+value}return Chart.Scale.prototype.getRightValue.call(this,value)},handleTickRangeOptions:function(){var me=this;var opts=me.options;var tickOpts=opts.ticks;if(tickOpts.beginAtZero){var minSign=helpers.sign(me.min);var maxSign=helpers.sign(me.max);if(minSign<0&&maxSign<0){me.max=0}else if(minSign>0&&maxSign>0){me.min=0}}var setMin=tickOpts.min!==undefined||tickOpts.suggestedMin!==undefined;var setMax=tickOpts.max!==undefined||tickOpts.suggestedMax!==undefined;if(tickOpts.min!==undefined){me.min=tickOpts.min}else if(tickOpts.suggestedMin!==undefined){if(me.min===null){me.min=tickOpts.suggestedMin}else{me.min=Math.min(me.min,tickOpts.suggestedMin)}}if(tickOpts.max!==undefined){me.max=tickOpts.max}else if(tickOpts.suggestedMax!==undefined){if(me.max===null){me.max=tickOpts.suggestedMax}else{me.max=Math.max(me.max,tickOpts.suggestedMax)}}if(setMin!==setMax){if(me.min>=me.max){if(setMin){me.max=me.min+1}else{me.min=me.max-1}}}if(me.min===me.max){me.max++;if(!tickOpts.beginAtZero){me.min--}}},getTickLimit:noop,handleDirectionalChanges:noop,buildTicks:function(){var me=this;var opts=me.options;var tickOpts=opts.ticks;var maxTicks=me.getTickLimit();maxTicks=Math.max(2,maxTicks);var numericGeneratorOptions={maxTicks:maxTicks,min:tickOpts.min,max:tickOpts.max,stepSize:helpers.valueOrDefault(tickOpts.fixedStepSize,tickOpts.stepSize)};var ticks=me.ticks=generateTicks(numericGeneratorOptions,me);me.handleDirectionalChanges();me.max=helpers.max(ticks);me.min=helpers.min(ticks);if(tickOpts.reverse){ticks.reverse();me.start=me.max;me.end=me.min}else{me.start=me.min;me.end=me.max}},convertTicksToLabels:function(){var me=this;me.ticksAsNumbers=me.ticks.slice();me.zeroLineIndex=me.ticks.indexOf(0);Chart.Scale.prototype.convertTicksToLabels.call(me)}})}},{"../helpers/index":42}],53:[function(require,module,exports){"use strict";var helpers=require("../helpers/index");var Ticks=require("../core/core.ticks");function generateTicks(generationOptions,dataRange){var ticks=[];var valueOrDefault=helpers.valueOrDefault;var tickVal=valueOrDefault(generationOptions.min,Math.pow(10,Math.floor(helpers.log10(dataRange.min))));var endExp=Math.floor(helpers.log10(dataRange.max));var endSignificand=Math.ceil(dataRange.max/Math.pow(10,endExp));var exp,significand;if(tickVal===0){exp=Math.floor(helpers.log10(dataRange.minNotZero));significand=Math.floor(dataRange.minNotZero/Math.pow(10,exp));ticks.push(tickVal);tickVal=significand*Math.pow(10,exp)}else{exp=Math.floor(helpers.log10(tickVal));significand=Math.floor(tickVal/Math.pow(10,exp))}var precision=exp<0?Math.pow(10,Math.abs(exp)):1;do{ticks.push(tickVal);++significand;if(significand===10){significand=1;++exp;precision=exp>=0?1:precision}tickVal=Math.round(significand*Math.pow(10,exp)*precision)/precision}while(exp<endExp||exp===endExp&&significand<endSignificand);var lastTick=valueOrDefault(generationOptions.max,tickVal);ticks.push(lastTick);return ticks}module.exports=function(Chart){var defaultConfig={position:"left",ticks:{callback:Ticks.formatters.logarithmic}};var LogarithmicScale=Chart.Scale.extend({determineDataLimits:function(){var me=this;var opts=me.options;var chart=me.chart;var data=chart.data;var datasets=data.datasets;var isHorizontal=me.isHorizontal();function IDMatches(meta){return isHorizontal?meta.xAxisID===me.id:meta.yAxisID===me.id}me.min=null;me.max=null;me.minNotZero=null;var hasStacks=opts.stacked;if(hasStacks===undefined){helpers.each(datasets,function(dataset,datasetIndex){if(hasStacks){return}var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)&&meta.stack!==undefined){hasStacks=true}})}if(opts.stacked||hasStacks){var valuesPerStack={};helpers.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);var key=[meta.type,opts.stacked===undefined&&meta.stack===undefined?datasetIndex:"",meta.stack].join(".");if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){if(valuesPerStack[key]===undefined){valuesPerStack[key]=[]}helpers.each(dataset.data,function(rawValue,index){var values=valuesPerStack[key];var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden||value<0){return}values[index]=values[index]||0;values[index]+=value})}});helpers.each(valuesPerStack,function(valuesForType){if(valuesForType.length>0){var minVal=helpers.min(valuesForType);var maxVal=helpers.max(valuesForType);me.min=me.min===null?minVal:Math.min(me.min,minVal);me.max=me.max===null?maxVal:Math.max(me.max,maxVal)}})}else{helpers.each(datasets,function(dataset,datasetIndex){var meta=chart.getDatasetMeta(datasetIndex);if(chart.isDatasetVisible(datasetIndex)&&IDMatches(meta)){helpers.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden||value<0){return}if(me.min===null){me.min=value}else if(value<me.min){me.min=value}if(me.max===null){me.max=value}else if(value>me.max){me.max=value}if(value!==0&&(me.minNotZero===null||value<me.minNotZero)){me.minNotZero=value}})}})}this.handleTickRangeOptions()},handleTickRangeOptions:function(){var me=this;var opts=me.options;var tickOpts=opts.ticks;var valueOrDefault=helpers.valueOrDefault;var DEFAULT_MIN=1;var DEFAULT_MAX=10;me.min=valueOrDefault(tickOpts.min,me.min);me.max=valueOrDefault(tickOpts.max,me.max);if(me.min===me.max){if(me.min!==0&&me.min!==null){me.min=Math.pow(10,Math.floor(helpers.log10(me.min))-1);me.max=Math.pow(10,Math.floor(helpers.log10(me.max))+1)}else{me.min=DEFAULT_MIN;me.max=DEFAULT_MAX}}if(me.min===null){me.min=Math.pow(10,Math.floor(helpers.log10(me.max))-1)}if(me.max===null){me.max=me.min!==0?Math.pow(10,Math.floor(helpers.log10(me.min))+1):DEFAULT_MAX}if(me.minNotZero===null){if(me.min>0){me.minNotZero=me.min}else if(me.max<1){me.minNotZero=Math.pow(10,Math.floor(helpers.log10(me.max)))}else{me.minNotZero=DEFAULT_MIN}}},buildTicks:function(){var me=this;var opts=me.options;var tickOpts=opts.ticks;var reverse=!me.isHorizontal();var generationOptions={min:tickOpts.min,max:tickOpts.max};var ticks=me.ticks=generateTicks(generationOptions,me);me.max=helpers.max(ticks);me.min=helpers.min(ticks);if(tickOpts.reverse){reverse=!reverse;me.start=me.max;me.end=me.min}else{me.start=me.min;me.end=me.max}if(reverse){ticks.reverse()}},convertTicksToLabels:function(){this.tickValues=this.ticks.slice();Chart.Scale.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index])},getPixelForTick:function(index){return this.getPixelForValue(this.tickValues[index])},_getFirstTickValue:function(value){var exp=Math.floor(helpers.log10(value));var significand=Math.floor(value/Math.pow(10,exp));return significand*Math.pow(10,exp)},getPixelForValue:function(value){var me=this;var reverse=me.options.ticks.reverse;var log10=helpers.log10;var firstTickValue=me._getFirstTickValue(me.minNotZero);var offset=0;var innerDimension,pixel,start,end,sign;value=+me.getRightValue(value);if(reverse){start=me.end;end=me.start;sign=-1}else{start=me.start;end=me.end;sign=1}if(me.isHorizontal()){innerDimension=me.width;pixel=reverse?me.right:me.left}else{innerDimension=me.height;sign*=-1;pixel=reverse?me.top:me.bottom}if(value!==start){if(start===0){offset=helpers.getValueOrDefault(me.options.ticks.fontSize,Chart.defaults.global.defaultFontSize);innerDimension-=offset;start=firstTickValue}if(value!==0){offset+=innerDimension/(log10(end)-log10(start))*(log10(value)-log10(start))}pixel+=sign*offset}return pixel},getValueForPixel:function(pixel){var me=this;var reverse=me.options.ticks.reverse;var log10=helpers.log10;var firstTickValue=me._getFirstTickValue(me.minNotZero);var innerDimension,start,end,value;if(reverse){start=me.end;end=me.start}else{start=me.start;end=me.end}if(me.isHorizontal()){innerDimension=me.width;value=reverse?me.right-pixel:pixel-me.left}else{innerDimension=me.height;value=reverse?pixel-me.top:me.bottom-pixel}if(value!==start){if(start===0){var offset=helpers.getValueOrDefault(me.options.ticks.fontSize,Chart.defaults.global.defaultFontSize);value-=offset;innerDimension-=offset;start=firstTickValue}value*=log10(end)-log10(start);value/=innerDimension;value=Math.pow(10,log10(start)+value)}return value}});Chart.scaleService.registerScaleType("logarithmic",LogarithmicScale,defaultConfig)}},{"../core/core.ticks":31,"../helpers/index":42}],54:[function(require,module,exports){"use strict";var defaults=require("../core/core.defaults");var helpers=require("../helpers/index");var Ticks=require("../core/core.ticks");module.exports=function(Chart){var globalDefaults=defaults.global;var defaultConfig={display:true,animate:true,position:"chartArea",angleLines:{display:true,color:"rgba(0, 0, 0, 0.1)",lineWidth:1},gridLines:{circular:false},ticks:{showLabelBackdrop:true,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:Ticks.formatters.linear},pointLabels:{display:true,fontSize:10,callback:function(label){return label}}};function getValueCount(scale){var opts=scale.options;return opts.angleLines.display||opts.pointLabels.display?scale.chart.data.labels.length:0}function getPointLabelFontOptions(scale){var pointLabelOptions=scale.options.pointLabels;var fontSize=helpers.valueOrDefault(pointLabelOptions.fontSize,globalDefaults.defaultFontSize);var fontStyle=helpers.valueOrDefault(pointLabelOptions.fontStyle,globalDefaults.defaultFontStyle);var fontFamily=helpers.valueOrDefault(pointLabelOptions.fontFamily,globalDefaults.defaultFontFamily);var font=helpers.fontString(fontSize,fontStyle,fontFamily);return{size:fontSize,style:fontStyle,family:fontFamily,font:font}}function measureLabelSize(ctx,fontSize,label){if(helpers.isArray(label)){return{w:helpers.longestText(ctx,ctx.font,label),h:label.length*fontSize+(label.length-1)*1.5*fontSize}}return{w:ctx.measureText(label).width,h:fontSize}}function determineLimits(angle,pos,size,min,max){if(angle===min||angle===max){return{start:pos-size/2,end:pos+size/2}}else if(angle<min||angle>max){return{start:pos-size-5,end:pos}}return{start:pos,end:pos+size+5}}function fitWithPointLabels(scale){var plFont=getPointLabelFontOptions(scale);var largestPossibleRadius=Math.min(scale.height/2,scale.width/2);var furthestLimits={r:scale.width,l:0,t:scale.height,b:0};var furthestAngles={};var i,textSize,pointPosition;scale.ctx.font=plFont.font;scale._pointLabelSizes=[];var valueCount=getValueCount(scale);for(i=0;i<valueCount;i++){pointPosition=scale.getPointPosition(i,largestPossibleRadius);textSize=measureLabelSize(scale.ctx,plFont.size,scale.pointLabels[i]||"");scale._pointLabelSizes[i]=textSize;var angleRadians=scale.getIndexAngle(i);var angle=helpers.toDegrees(angleRadians)%360;var hLimits=determineLimits(angle,pointPosition.x,textSize.w,0,180);var vLimits=determineLimits(angle,pointPosition.y,textSize.h,90,270);if(hLimits.start<furthestLimits.l){furthestLimits.l=hLimits.start;furthestAngles.l=angleRadians}if(hLimits.end>furthestLimits.r){furthestLimits.r=hLimits.end;furthestAngles.r=angleRadians}if(vLimits.start<furthestLimits.t){furthestLimits.t=vLimits.start;furthestAngles.t=angleRadians}if(vLimits.end>furthestLimits.b){furthestLimits.b=vLimits.end;furthestAngles.b=angleRadians}}scale.setReductions(largestPossibleRadius,furthestLimits,furthestAngles)}function fit(scale){var largestPossibleRadius=Math.min(scale.height/2,scale.width/2);scale.drawingArea=Math.round(largestPossibleRadius);scale.setCenterPoint(0,0,0,0)}function getTextAlignForAngle(angle){if(angle===0||angle===180){return"center"}else if(angle<180){return"left"}return"right"}function fillText(ctx,text,position,fontSize){if(helpers.isArray(text)){var y=position.y;var spacing=1.5*fontSize;for(var i=0;i<text.length;++i){ctx.fillText(text[i],position.x,y);y+=spacing}}else{ctx.fillText(text,position.x,position.y)}}function adjustPointPositionForLabelHeight(angle,textSize,position){if(angle===90||angle===270){position.y-=textSize.h/2}else if(angle>270||angle<90){position.y-=textSize.h}}function drawPointLabels(scale){var ctx=scale.ctx;var opts=scale.options;var angleLineOpts=opts.angleLines;var pointLabelOpts=opts.pointLabels;ctx.lineWidth=angleLineOpts.lineWidth;ctx.strokeStyle=angleLineOpts.color;var outerDistance=scale.getDistanceFromCenterForValue(opts.ticks.reverse?scale.min:scale.max);var plFont=getPointLabelFontOptions(scale);ctx.textBaseline="top";for(var i=getValueCount(scale)-1;i>=0;i--){if(angleLineOpts.display){var outerPosition=scale.getPointPosition(i,outerDistance);ctx.beginPath();ctx.moveTo(scale.xCenter,scale.yCenter);ctx.lineTo(outerPosition.x,outerPosition.y);ctx.stroke();ctx.closePath()}if(pointLabelOpts.display){var pointLabelPosition=scale.getPointPosition(i,outerDistance+5);var pointLabelFontColor=helpers.valueAtIndexOrDefault(pointLabelOpts.fontColor,i,globalDefaults.defaultFontColor);ctx.font=plFont.font;ctx.fillStyle=pointLabelFontColor;var angleRadians=scale.getIndexAngle(i);var angle=helpers.toDegrees(angleRadians);ctx.textAlign=getTextAlignForAngle(angle);adjustPointPositionForLabelHeight(angle,scale._pointLabelSizes[i],pointLabelPosition);fillText(ctx,scale.pointLabels[i]||"",pointLabelPosition,plFont.size)}}}function drawRadiusLine(scale,gridLineOpts,radius,index){var ctx=scale.ctx;ctx.strokeStyle=helpers.valueAtIndexOrDefault(gridLineOpts.color,index-1);ctx.lineWidth=helpers.valueAtIndexOrDefault(gridLineOpts.lineWidth,index-1);if(scale.options.gridLines.circular){ctx.beginPath();ctx.arc(scale.xCenter,scale.yCenter,radius,0,Math.PI*2);ctx.closePath();ctx.stroke()}else{var valueCount=getValueCount(scale);if(valueCount===0){return}ctx.beginPath();var pointPosition=scale.getPointPosition(0,radius);ctx.moveTo(pointPosition.x,pointPosition.y);for(var i=1;i<valueCount;i++){pointPosition=scale.getPointPosition(i,radius);ctx.lineTo(pointPosition.x,pointPosition.y)}ctx.closePath();ctx.stroke()}}function numberOrZero(param){return helpers.isNumber(param)?param:0}var LinearRadialScale=Chart.LinearScaleBase.extend({setDimensions:function(){var me=this;var opts=me.options;var tickOpts=opts.ticks;me.width=me.maxWidth;me.height=me.maxHeight;me.xCenter=Math.round(me.width/2);me.yCenter=Math.round(me.height/2);var minSize=helpers.min([me.height,me.width]);var tickFontSize=helpers.valueOrDefault(tickOpts.fontSize,globalDefaults.defaultFontSize);me.drawingArea=opts.display?minSize/2-(tickFontSize/2+tickOpts.backdropPaddingY):minSize/2},determineDataLimits:function(){var me=this;var chart=me.chart;var min=Number.POSITIVE_INFINITY;var max=Number.NEGATIVE_INFINITY;helpers.each(chart.data.datasets,function(dataset,datasetIndex){if(chart.isDatasetVisible(datasetIndex)){var meta=chart.getDatasetMeta(datasetIndex);helpers.each(dataset.data,function(rawValue,index){var value=+me.getRightValue(rawValue);if(isNaN(value)||meta.data[index].hidden){return}min=Math.min(value,min);max=Math.max(value,max)})}});me.min=min===Number.POSITIVE_INFINITY?0:min;me.max=max===Number.NEGATIVE_INFINITY?0:max;me.handleTickRangeOptions()},getTickLimit:function(){var tickOpts=this.options.ticks;var tickFontSize=helpers.valueOrDefault(tickOpts.fontSize,globalDefaults.defaultFontSize);return Math.min(tickOpts.maxTicksLimit?tickOpts.maxTicksLimit:11,Math.ceil(this.drawingArea/(1.5*tickFontSize)))},convertTicksToLabels:function(){var me=this;Chart.LinearScaleBase.prototype.convertTicksToLabels.call(me);me.pointLabels=me.chart.data.labels.map(me.options.pointLabels.callback,me)},getLabelForIndex:function(index,datasetIndex){return+this.getRightValue(this.chart.data.datasets[datasetIndex].data[index])},fit:function(){if(this.options.pointLabels.display){fitWithPointLabels(this)}else{fit(this)}},setReductions:function(largestPossibleRadius,furthestLimits,furthestAngles){var me=this;var radiusReductionLeft=furthestLimits.l/Math.sin(furthestAngles.l);var radiusReductionRight=Math.max(furthestLimits.r-me.width,0)/Math.sin(furthestAngles.r);var radiusReductionTop=-furthestLimits.t/Math.cos(furthestAngles.t);var radiusReductionBottom=-Math.max(furthestLimits.b-me.height,0)/Math.cos(furthestAngles.b);radiusReductionLeft=numberOrZero(radiusReductionLeft);radiusReductionRight=numberOrZero(radiusReductionRight);radiusReductionTop=numberOrZero(radiusReductionTop);radiusReductionBottom=numberOrZero(radiusReductionBottom);me.drawingArea=Math.min(Math.round(largestPossibleRadius-(radiusReductionLeft+radiusReductionRight)/2),Math.round(largestPossibleRadius-(radiusReductionTop+radiusReductionBottom)/2));me.setCenterPoint(radiusReductionLeft,radiusReductionRight,radiusReductionTop,radiusReductionBottom)},setCenterPoint:function(leftMovement,rightMovement,topMovement,bottomMovement){var me=this;var maxRight=me.width-rightMovement-me.drawingArea;var maxLeft=leftMovement+me.drawingArea;var maxTop=topMovement+me.drawingArea;var maxBottom=me.height-bottomMovement-me.drawingArea;me.xCenter=Math.round((maxLeft+maxRight)/2+me.left);me.yCenter=Math.round((maxTop+maxBottom)/2+me.top)},getIndexAngle:function(index){var angleMultiplier=Math.PI*2/getValueCount(this);var startAngle=this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0;var startAngleRadians=startAngle*Math.PI*2/360;return index*angleMultiplier+startAngleRadians},getDistanceFromCenterForValue:function(value){var me=this;if(value===null){return 0}var scalingFactor=me.drawingArea/(me.max-me.min);if(me.options.ticks.reverse){return(me.max-value)*scalingFactor}return(value-me.min)*scalingFactor},getPointPosition:function(index,distanceFromCenter){var me=this;var thisAngle=me.getIndexAngle(index)-Math.PI/2;return{x:Math.round(Math.cos(thisAngle)*distanceFromCenter)+me.xCenter,y:Math.round(Math.sin(thisAngle)*distanceFromCenter)+me.yCenter}},getPointPositionForValue:function(index,value){return this.getPointPosition(index,this.getDistanceFromCenterForValue(value))},getBasePosition:function(){var me=this;var min=me.min;var max=me.max;return me.getPointPositionForValue(0,me.beginAtZero?0:min<0&&max<0?max:min>0&&max>0?min:0)},draw:function(){var me=this;var opts=me.options;var gridLineOpts=opts.gridLines;var tickOpts=opts.ticks;var valueOrDefault=helpers.valueOrDefault;if(opts.display){var ctx=me.ctx;var startAngle=this.getIndexAngle(0);var tickFontSize=valueOrDefault(tickOpts.fontSize,globalDefaults.defaultFontSize);var tickFontStyle=valueOrDefault(tickOpts.fontStyle,globalDefaults.defaultFontStyle);var tickFontFamily=valueOrDefault(tickOpts.fontFamily,globalDefaults.defaultFontFamily);var tickLabelFont=helpers.fontString(tickFontSize,tickFontStyle,tickFontFamily);helpers.each(me.ticks,function(label,index){if(index>0||tickOpts.reverse){var yCenterOffset=me.getDistanceFromCenterForValue(me.ticksAsNumbers[index]);if(gridLineOpts.display&&index!==0){drawRadiusLine(me,gridLineOpts,yCenterOffset,index)}if(tickOpts.display){var tickFontColor=valueOrDefault(tickOpts.fontColor,globalDefaults.defaultFontColor);ctx.font=tickLabelFont;ctx.save();ctx.translate(me.xCenter,me.yCenter);ctx.rotate(startAngle);if(tickOpts.showLabelBackdrop){var labelWidth=ctx.measureText(label).width;ctx.fillStyle=tickOpts.backdropColor;ctx.fillRect(-labelWidth/2-tickOpts.backdropPaddingX,-yCenterOffset-tickFontSize/2-tickOpts.backdropPaddingY,labelWidth+tickOpts.backdropPaddingX*2,tickFontSize+tickOpts.backdropPaddingY*2)}ctx.textAlign="center";ctx.textBaseline="middle";ctx.fillStyle=tickFontColor;ctx.fillText(label,0,-yCenterOffset);ctx.restore()}}});if(opts.angleLines.display||opts.pointLabels.display){drawPointLabels(me)}}}});Chart.scaleService.registerScaleType("radialLinear",LinearRadialScale,defaultConfig)}},{"../core/core.defaults":22,"../core/core.ticks":31,"../helpers/index":42}],55:[function(require,module,exports){"use strict";var moment=require("moment");moment=typeof moment==="function"?moment:window.moment;var defaults=require("../core/core.defaults");var helpers=require("../helpers/index");var MIN_INTEGER=Number.MIN_SAFE_INTEGER||-9007199254740991;var MAX_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991;var INTERVALS={millisecond:{common:true,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:true,size:1e3,steps:[1,2,5,10,30]},minute:{common:true,size:6e4,steps:[1,2,5,10,30]},hour:{common:true,size:36e5,steps:[1,2,3,6,12]},day:{common:true,size:864e5,steps:[1,2,5]},week:{common:false,size:6048e5,steps:[1,2,3,4]},month:{common:true,size:2628e6,steps:[1,2,3]},quarter:{common:false,size:7884e6,steps:[1,2,3,4]},year:{common:true,size:3154e7}};var UNITS=Object.keys(INTERVALS);function sorter(a,b){return a-b}function arrayUnique(items){var hash={};var out=[];var i,ilen,item;for(i=0,ilen=items.length;i<ilen;++i){item=items[i];if(!hash[item]){hash[item]=true;out.push(item)}}return out}function buildLookupTable(timestamps,min,max,distribution){if(distribution==="linear"||!timestamps.length){return[{time:min,pos:0},{time:max,pos:1}]}var table=[];var items=[min];var i,ilen,prev,curr,next;for(i=0,ilen=timestamps.length;i<ilen;++i){curr=timestamps[i];if(curr>min&&curr<max){items.push(curr)}}items.push(max);for(i=0,ilen=items.length;i<ilen;++i){next=items[i+1];prev=items[i-1];curr=items[i];if(prev===undefined||next===undefined||Math.round((next+prev)/2)!==curr){table.push({time:curr,pos:i/(ilen-1)})}}return table}function lookup(table,key,value){var lo=0;var hi=table.length-1;var mid,i0,i1;while(lo>=0&&lo<=hi){mid=lo+hi>>1;i0=table[mid-1]||null;i1=table[mid];if(!i0){return{lo:null,hi:i1}}else if(i1[key]<value){lo=mid+1}else if(i0[key]>value){hi=mid-1}else{return{lo:i0,hi:i1}}}return{lo:i1,hi:null}}function interpolate(table,skey,sval,tkey){var range=lookup(table,skey,sval);var prev=!range.lo?table[0]:!range.hi?table[table.length-2]:range.lo;var next=!range.lo?table[1]:!range.hi?table[table.length-1]:range.hi;var span=next[skey]-prev[skey];var ratio=span?(sval-prev[skey])/span:0;var offset=(next[tkey]-prev[tkey])*ratio;return prev[tkey]+offset}function momentify(value,options){var parser=options.parser;var format=options.parser||options.format;if(typeof parser==="function"){return parser(value)}if(typeof value==="string"&&typeof format==="string"){return moment(value,format)}if(!(value instanceof moment)){value=moment(value)}if(value.isValid()){return value}if(typeof format==="function"){return format(value)}return value}function parse(input,scale){if(helpers.isNullOrUndef(input)){return null}var options=scale.options.time;var value=momentify(scale.getRightValue(input),options);if(!value.isValid()){return null}if(options.round){value.startOf(options.round)}return value.valueOf()}function determineStepSize(min,max,unit,capacity){var range=max-min;var interval=INTERVALS[unit];var milliseconds=interval.size;var steps=interval.steps;var i,ilen,factor;if(!steps){return Math.ceil(range/(capacity*milliseconds))}for(i=0,ilen=steps.length;i<ilen;++i){factor=steps[i];if(Math.ceil(range/(milliseconds*factor))<=capacity){break}}return factor}function determineUnitForAutoTicks(minUnit,min,max,capacity){var ilen=UNITS.length;var i,interval,factor;for(i=UNITS.indexOf(minUnit);i<ilen-1;++i){interval=INTERVALS[UNITS[i]];factor=interval.steps?interval.steps[interval.steps.length-1]:MAX_INTEGER;if(interval.common&&Math.ceil((max-min)/(factor*interval.size))<=capacity){return UNITS[i]}}return UNITS[ilen-1]}function determineUnitForFormatting(ticks,minUnit,min,max){var duration=moment.duration(moment(max).diff(moment(min)));var ilen=UNITS.length;var i,unit;for(i=ilen-1;i>=UNITS.indexOf(minUnit);i--){unit=UNITS[i];if(INTERVALS[unit].common&&duration.as(unit)>=ticks.length){return unit}}return UNITS[minUnit?UNITS.indexOf(minUnit):0]}function determineMajorUnit(unit){for(var i=UNITS.indexOf(unit)+1,ilen=UNITS.length;i<ilen;++i){if(INTERVALS[UNITS[i]].common){return UNITS[i]}}}function generate(min,max,capacity,options){var timeOpts=options.time;var minor=timeOpts.unit||determineUnitForAutoTicks(timeOpts.minUnit,min,max,capacity);var major=determineMajorUnit(minor);var stepSize=helpers.valueOrDefault(timeOpts.stepSize,timeOpts.unitStepSize);var weekday=minor==="week"?timeOpts.isoWeekday:false;var majorTicksEnabled=options.ticks.major.enabled;var interval=INTERVALS[minor];var first=moment(min);var last=moment(max);var ticks=[];var time;if(!stepSize){stepSize=determineStepSize(min,max,minor,capacity)}if(weekday){first=first.isoWeekday(weekday);last=last.isoWeekday(weekday)}first=first.startOf(weekday?"day":minor);last=last.startOf(weekday?"day":minor);if(last<max){last.add(1,minor)}time=moment(first);if(majorTicksEnabled&&major&&!weekday&&!timeOpts.round){time.startOf(major);time.add(~~((first-time)/(interval.size*stepSize))*stepSize,minor)}for(;time<last;time.add(stepSize,minor)){ticks.push(+time)}ticks.push(+time);return ticks}function computeOffsets(table,ticks,min,max,options){var left=0;var right=0;var upper,lower;if(options.offset&&ticks.length){if(!options.time.min){upper=ticks.length>1?ticks[1]:max;lower=ticks[0];left=(interpolate(table,"time",upper,"pos")-interpolate(table,"time",lower,"pos"))/2}if(!options.time.max){upper=ticks[ticks.length-1];lower=ticks.length>1?ticks[ticks.length-2]:min;right=(interpolate(table,"time",upper,"pos")-interpolate(table,"time",lower,"pos"))/2}}return{left:left,right:right}}function ticksFromTimestamps(values,majorUnit){var ticks=[];var i,ilen,value,major;for(i=0,ilen=values.length;i<ilen;++i){value=values[i];major=majorUnit?value===+moment(value).startOf(majorUnit):false;ticks.push({value:value,major:major})}return ticks}function determineLabelFormat(data,timeOpts){var i,momentDate,hasTime;var ilen=data.length;for(i=0;i<ilen;i++){momentDate=momentify(data[i],timeOpts);if(momentDate.millisecond()!==0){return"MMM D, YYYY h:mm:ss.SSS a"}if(momentDate.second()!==0||momentDate.minute()!==0||momentDate.hour()!==0){hasTime=true}}if(hasTime){return"MMM D, YYYY h:mm:ss a"}return"MMM D, YYYY"}module.exports=function(Chart){var defaultConfig={position:"bottom",distribution:"linear",bounds:"data",time:{parser:false,format:false,unit:false,round:false,displayFormat:false,isoWeekday:false,minUnit:"millisecond",displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:false,source:"auto",major:{enabled:false}}};var TimeScale=Chart.Scale.extend({initialize:function(){if(!moment){throw new Error("Chart.js - Moment.js could not be found! You must include it before Chart.js to use the time scale. Download at https://momentjs.com")}this.mergeTicksOptions();Chart.Scale.prototype.initialize.call(this)},update:function(){var me=this;var options=me.options;if(options.time&&options.time.format){console.warn("options.time.format is deprecated and replaced by options.time.parser.")}return Chart.Scale.prototype.update.apply(me,arguments)},getRightValue:function(rawValue){if(rawValue&&rawValue.t!==undefined){rawValue=rawValue.t}return Chart.Scale.prototype.getRightValue.call(this,rawValue)},determineDataLimits:function(){var me=this;var chart=me.chart;var timeOpts=me.options.time;var unit=timeOpts.unit||"day";var min=MAX_INTEGER;var max=MIN_INTEGER;var timestamps=[];var datasets=[];var labels=[];var i,j,ilen,jlen,data,timestamp;for(i=0,ilen=chart.data.labels.length;i<ilen;++i){labels.push(parse(chart.data.labels[i],me))}for(i=0,ilen=(chart.data.datasets||[]).length;i<ilen;++i){if(chart.isDatasetVisible(i)){data=chart.data.datasets[i].data;if(helpers.isObject(data[0])){datasets[i]=[];for(j=0,jlen=data.length;j<jlen;++j){timestamp=parse(data[j],me);timestamps.push(timestamp);datasets[i][j]=timestamp}}else{timestamps.push.apply(timestamps,labels);datasets[i]=labels.slice(0)}}else{datasets[i]=[]}}if(labels.length){labels=arrayUnique(labels).sort(sorter);min=Math.min(min,labels[0]);max=Math.max(max,labels[labels.length-1])}if(timestamps.length){timestamps=arrayUnique(timestamps).sort(sorter);min=Math.min(min,timestamps[0]);max=Math.max(max,timestamps[timestamps.length-1])}min=parse(timeOpts.min,me)||min;max=parse(timeOpts.max,me)||max;min=min===MAX_INTEGER?+moment().startOf(unit):min;max=max===MIN_INTEGER?+moment().endOf(unit)+1:max;me.min=Math.min(min,max);me.max=Math.max(min+1,max);me._horizontal=me.isHorizontal();me._table=[];me._timestamps={data:timestamps,datasets:datasets,labels:labels}},buildTicks:function(){var me=this;var min=me.min;var max=me.max;var options=me.options;var timeOpts=options.time;var timestamps=[];var ticks=[];var i,ilen,timestamp;switch(options.ticks.source){case"data":timestamps=me._timestamps.data;break;case"labels":timestamps=me._timestamps.labels;break;case"auto":default:timestamps=generate(min,max,me.getLabelCapacity(min),options)}if(options.bounds==="ticks"&&timestamps.length){min=timestamps[0];max=timestamps[timestamps.length-1]}min=parse(timeOpts.min,me)||min;max=parse(timeOpts.max,me)||max;for(i=0,ilen=timestamps.length;i<ilen;++i){timestamp=timestamps[i];if(timestamp>=min&&timestamp<=max){ticks.push(timestamp)}}me.min=min;me.max=max;me._unit=timeOpts.unit||determineUnitForFormatting(ticks,timeOpts.minUnit,me.min,me.max);me._majorUnit=determineMajorUnit(me._unit);me._table=buildLookupTable(me._timestamps.data,min,max,options.distribution);me._offsets=computeOffsets(me._table,ticks,min,max,options);me._labelFormat=determineLabelFormat(me._timestamps.data,timeOpts);return ticksFromTimestamps(ticks,me._majorUnit)},getLabelForIndex:function(index,datasetIndex){var me=this;var data=me.chart.data;var timeOpts=me.options.time;var label=data.labels&&index<data.labels.length?data.labels[index]:"";var value=data.datasets[datasetIndex].data[index];if(helpers.isObject(value)){label=me.getRightValue(value)}if(timeOpts.tooltipFormat){return momentify(label,timeOpts).format(timeOpts.tooltipFormat)}if(typeof label==="string"){return label}return momentify(label,timeOpts).format(me._labelFormat)},tickFormatFunction:function(tick,index,ticks,formatOverride){var me=this;var options=me.options;var time=tick.valueOf();var formats=options.time.displayFormats;var minorFormat=formats[me._unit];var majorUnit=me._majorUnit;var majorFormat=formats[majorUnit];var majorTime=tick.clone().startOf(majorUnit).valueOf();var majorTickOpts=options.ticks.major;var major=majorTickOpts.enabled&&majorUnit&&majorFormat&&time===majorTime;var label=tick.format(formatOverride?formatOverride:major?majorFormat:minorFormat);var tickOpts=major?majorTickOpts:options.ticks.minor;var formatter=helpers.valueOrDefault(tickOpts.callback,tickOpts.userCallback);return formatter?formatter(label,index,ticks):label},convertTicksToLabels:function(ticks){var labels=[];var i,ilen;for(i=0,ilen=ticks.length;i<ilen;++i){labels.push(this.tickFormatFunction(moment(ticks[i].value),i,ticks))}return labels},getPixelForOffset:function(time){var me=this;var size=me._horizontal?me.width:me.height;var start=me._horizontal?me.left:me.top;var pos=interpolate(me._table,"time",time,"pos");return start+size*(me._offsets.left+pos)/(me._offsets.left+1+me._offsets.right)},getPixelForValue:function(value,index,datasetIndex){var me=this;var time=null;if(index!==undefined&&datasetIndex!==undefined){time=me._timestamps.datasets[datasetIndex][index]}if(time===null){time=parse(value,me)}if(time!==null){return me.getPixelForOffset(time)}},getPixelForTick:function(index){var ticks=this.getTicks();return index>=0&&index<ticks.length?this.getPixelForOffset(ticks[index].value):null},getValueForPixel:function(pixel){var me=this;var size=me._horizontal?me.width:me.height;var start=me._horizontal?me.left:me.top;var pos=(size?(pixel-start)/size:0)*(me._offsets.left+1+me._offsets.left)-me._offsets.right;var time=interpolate(me._table,"pos",pos,"time");return moment(time)},getLabelWidth:function(label){var me=this;var ticksOpts=me.options.ticks;var tickLabelWidth=me.ctx.measureText(label).width;var angle=helpers.toRadians(ticksOpts.maxRotation);var cosRotation=Math.cos(angle);var sinRotation=Math.sin(angle);var tickFontSize=helpers.valueOrDefault(ticksOpts.fontSize,defaults.global.defaultFontSize);return tickLabelWidth*cosRotation+tickFontSize*sinRotation},getLabelCapacity:function(exampleTime){var me=this;var formatOverride=me.options.time.displayFormats.millisecond;var exampleLabel=me.tickFormatFunction(moment(exampleTime),0,[],formatOverride);var tickLabelWidth=me.getLabelWidth(exampleLabel);var innerWidth=me.isHorizontal()?me.width:me.height;var capacity=Math.floor(innerWidth/tickLabelWidth);return capacity>0?capacity:1}});Chart.scaleService.registerScaleType("time",TimeScale,defaultConfig)}},{"../core/core.defaults":22,"../helpers/index":42,moment:72}],56:[function(require,module,exports){var colorNames=require("color-name");module.exports={getRgba:getRgba,getHsla:getHsla,getRgb:getRgb,getHsl:getHsl,getHwb:getHwb,getAlpha:getAlpha,hexString:hexString,rgbString:rgbString,rgbaString:rgbaString,percentString:percentString,percentaString:percentaString,hslString:hslString,hslaString:hslaString,hwbString:hwbString,keyword:keyword};function getRgba(string){if(!string){return}var abbr=/^#([a-fA-F0-9]{3})$/i,hex=/^#([a-fA-F0-9]{6})$/i,rgba=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i,per=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i,keyword=/(\w+)/;var rgb=[0,0,0],a=1,match=string.match(abbr);if(match){match=match[1];for(var i=0;i<rgb.length;i++){rgb[i]=parseInt(match[i]+match[i],16)}}else if(match=string.match(hex)){match=match[1];for(var i=0;i<rgb.length;i++){rgb[i]=parseInt(match.slice(i*2,i*2+2),16)}}else if(match=string.match(rgba)){for(var i=0;i<rgb.length;i++){rgb[i]=parseInt(match[i+1])}a=parseFloat(match[4])}else if(match=string.match(per)){for(var i=0;i<rgb.length;i++){rgb[i]=Math.round(parseFloat(match[i+1])*2.55)}a=parseFloat(match[4])}else if(match=string.match(keyword)){if(match[1]=="transparent"){return[0,0,0,0]}rgb=colorNames[match[1]];if(!rgb){return}}for(var i=0;i<rgb.length;i++){rgb[i]=scale(rgb[i],0,255)}if(!a&&a!=0){a=1}else{a=scale(a,0,1)}rgb[3]=a;return rgb}function getHsla(string){if(!string){return}var hsl=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/;var match=string.match(hsl);if(match){var alpha=parseFloat(match[4]);var h=scale(parseInt(match[1]),0,360),s=scale(parseFloat(match[2]),0,100),l=scale(parseFloat(match[3]),0,100),a=scale(isNaN(alpha)?1:alpha,0,1);return[h,s,l,a]}}function getHwb(string){if(!string){return}var hwb=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/;var match=string.match(hwb);if(match){var alpha=parseFloat(match[4]);var h=scale(parseInt(match[1]),0,360),w=scale(parseFloat(match[2]),0,100),b=scale(parseFloat(match[3]),0,100),a=scale(isNaN(alpha)?1:alpha,0,1);return[h,w,b,a]}}function getRgb(string){var rgba=getRgba(string);return rgba&&rgba.slice(0,3)}function getHsl(string){var hsla=getHsla(string);return hsla&&hsla.slice(0,3)}function getAlpha(string){var vals=getRgba(string);if(vals){return vals[3]}else if(vals=getHsla(string)){return vals[3]}else if(vals=getHwb(string)){return vals[3]}}function hexString(rgb){return"#"+hexDouble(rgb[0])+hexDouble(rgb[1])+hexDouble(rgb[2])}function rgbString(rgba,alpha){if(alpha<1||rgba[3]&&rgba[3]<1){return rgbaString(rgba,alpha)}return"rgb("+rgba[0]+", "+rgba[1]+", "+rgba[2]+")"}function rgbaString(rgba,alpha){if(alpha===undefined){alpha=rgba[3]!==undefined?rgba[3]:1}return"rgba("+rgba[0]+", "+rgba[1]+", "+rgba[2]+", "+alpha+")"}function percentString(rgba,alpha){if(alpha<1||rgba[3]&&rgba[3]<1){return percentaString(rgba,alpha)}var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgb("+r+"%, "+g+"%, "+b+"%)"}function percentaString(rgba,alpha){var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgba("+r+"%, "+g+"%, "+b+"%, "+(alpha||rgba[3]||1)+")"}function hslString(hsla,alpha){if(alpha<1||hsla[3]&&hsla[3]<1){return hslaString(hsla,alpha)}return"hsl("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%)"}function hslaString(hsla,alpha){if(alpha===undefined){alpha=hsla[3]!==undefined?hsla[3]:1}return"hsla("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%, "+alpha+")"}function hwbString(hwb,alpha){if(alpha===undefined){alpha=hwb[3]!==undefined?hwb[3]:1}return"hwb("+hwb[0]+", "+hwb[1]+"%, "+hwb[2]+"%"+(alpha!==undefined&&alpha!==1?", "+alpha:"")+")"}function keyword(rgb){return reverseNames[rgb.slice(0,3)]}function scale(num,min,max){return Math.min(Math.max(min,num),max)}function hexDouble(num){var str=num.toString(16).toUpperCase();return str.length<2?"0"+str:str}var reverseNames={};for(var name in colorNames){reverseNames[colorNames[name]]=name}},{"color-name":60}],57:[function(require,module,exports){var convert=require("color-convert");var string=require("chartjs-color-string");var Color=function(obj){if(obj instanceof Color){return obj}if(!(this instanceof Color)){return new Color(obj)}this.valid=false;this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1};var vals;if(typeof obj==="string"){vals=string.getRgba(obj);if(vals){this.setValues("rgb",vals)}else if(vals=string.getHsla(obj)){this.setValues("hsl",vals)}else if(vals=string.getHwb(obj)){this.setValues("hwb",vals)}}else if(typeof obj==="object"){vals=obj;if(vals.r!==undefined||vals.red!==undefined){this.setValues("rgb",vals)}else if(vals.l!==undefined||vals.lightness!==undefined){this.setValues("hsl",vals)}else if(vals.v!==undefined||vals.value!==undefined){this.setValues("hsv",vals)}else if(vals.w!==undefined||vals.whiteness!==undefined){this.setValues("hwb",vals)}else if(vals.c!==undefined||vals.cyan!==undefined){this.setValues("cmyk",vals)}}};Color.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var values=this.values;if(values.alpha!==1){return values.hwb.concat([values.alpha])}return values.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var values=this.values;return values.rgb.concat([values.alpha])},hslaArray:function(){var values=this.values;return values.hsl.concat([values.alpha])},alpha:function(val){if(val===undefined){return this.values.alpha}this.setValues("alpha",val);return this},red:function(val){return this.setChannel("rgb",0,val)},green:function(val){return this.setChannel("rgb",1,val)},blue:function(val){return this.setChannel("rgb",2,val)},hue:function(val){if(val){val%=360;val=val<0?360+val:val}return this.setChannel("hsl",0,val)},saturation:function(val){return this.setChannel("hsl",1,val)},lightness:function(val){return this.setChannel("hsl",2,val)},saturationv:function(val){return this.setChannel("hsv",1,val)},whiteness:function(val){return this.setChannel("hwb",1,val)},blackness:function(val){return this.setChannel("hwb",2,val)},value:function(val){return this.setChannel("hsv",2,val)},cyan:function(val){return this.setChannel("cmyk",0,val)},magenta:function(val){return this.setChannel("cmyk",1,val)},yellow:function(val){return this.setChannel("cmyk",2,val)},black:function(val){return this.setChannel("cmyk",3,val)},hexString:function(){return string.hexString(this.values.rgb)},rgbString:function(){return string.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return string.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return string.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return string.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return string.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return string.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return string.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var rgb=this.values.rgb;return rgb[0]<<16|rgb[1]<<8|rgb[2]},luminosity:function(){var rgb=this.values.rgb;var lum=[];for(var i=0;i<rgb.length;i++){var chan=rgb[i]/255;lum[i]=chan<=.03928?chan/12.92:Math.pow((chan+.055)/1.055,2.4)}return.2126*lum[0]+.7152*lum[1]+.0722*lum[2]},contrast:function(color2){var lum1=this.luminosity();var lum2=color2.luminosity();if(lum1>lum2){return(lum1+.05)/(lum2+.05)}return(lum2+.05)/(lum1+.05)},level:function(color2){var contrastRatio=this.contrast(color2);if(contrastRatio>=7.1){return"AAA"}return contrastRatio>=4.5?"AA":""},dark:function(){var rgb=this.values.rgb;var yiq=(rgb[0]*299+rgb[1]*587+rgb[2]*114)/1e3;return yiq<128},light:function(){return!this.dark()},negate:function(){var rgb=[];for(var i=0;i<3;i++){rgb[i]=255-this.values.rgb[i]}this.setValues("rgb",rgb);return this},lighten:function(ratio){var hsl=this.values.hsl;hsl[2]+=hsl[2]*ratio;this.setValues("hsl",hsl);return this},darken:function(ratio){var hsl=this.values.hsl;hsl[2]-=hsl[2]*ratio;this.setValues("hsl",hsl);return this},saturate:function(ratio){var hsl=this.values.hsl;hsl[1]+=hsl[1]*ratio;this.setValues("hsl",hsl);return this},desaturate:function(ratio){var hsl=this.values.hsl;hsl[1]-=hsl[1]*ratio;this.setValues("hsl",hsl);return this},whiten:function(ratio){var hwb=this.values.hwb;hwb[1]+=hwb[1]*ratio;this.setValues("hwb",hwb);return this},blacken:function(ratio){var hwb=this.values.hwb;hwb[2]+=hwb[2]*ratio;this.setValues("hwb",hwb);return this},greyscale:function(){var rgb=this.values.rgb;var val=rgb[0]*.3+rgb[1]*.59+rgb[2]*.11;this.setValues("rgb",[val,val,val]);return this},clearer:function(ratio){var alpha=this.values.alpha;this.setValues("alpha",alpha-alpha*ratio);return this},opaquer:function(ratio){var alpha=this.values.alpha;this.setValues("alpha",alpha+alpha*ratio);return this},rotate:function(degrees){var hsl=this.values.hsl;var hue=(hsl[0]+degrees)%360;hsl[0]=hue<0?360+hue:hue;this.setValues("hsl",hsl);return this},mix:function(mixinColor,weight){var color1=this;var color2=mixinColor;var p=weight===undefined?.5:weight;var w=2*p-1;var a=color1.alpha()-color2.alpha();var w1=((w*a===-1?w:(w+a)/(1+w*a))+1)/2;var w2=1-w1;return this.rgb(w1*color1.red()+w2*color2.red(),w1*color1.green()+w2*color2.green(),w1*color1.blue()+w2*color2.blue()).alpha(color1.alpha()*p+color2.alpha()*(1-p))},toJSON:function(){return this.rgb()},clone:function(){var result=new Color;var source=this.values;var target=result.values;var value,type;for(var prop in source){if(source.hasOwnProperty(prop)){value=source[prop];type={}.toString.call(value);if(type==="[object Array]"){target[prop]=value.slice(0)}else if(type==="[object Number]"){target[prop]=value}else{console.error("unexpected color value:",value)}}}return result}};Color.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]};Color.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]};Color.prototype.getValues=function(space){var values=this.values;var vals={};for(var i=0;i<space.length;i++){vals[space.charAt(i)]=values[space][i]}if(values.alpha!==1){vals.a=values.alpha}return vals};Color.prototype.setValues=function(space,vals){var values=this.values;var spaces=this.spaces;var maxes=this.maxes;var alpha=1;var i;this.valid=true;if(space==="alpha"){alpha=vals}else if(vals.length){values[space]=vals.slice(0,space.length);alpha=vals[space.length]}else if(vals[space.charAt(0)]!==undefined){for(i=0;i<space.length;i++){values[space][i]=vals[space.charAt(i)]}alpha=vals.a}else if(vals[spaces[space][0]]!==undefined){var chans=spaces[space];for(i=0;i<space.length;i++){values[space][i]=vals[chans[i]]}alpha=vals.alpha}values.alpha=Math.max(0,Math.min(1,alpha===undefined?values.alpha:alpha));if(space==="alpha"){return false}var capped;for(i=0;i<space.length;i++){capped=Math.max(0,Math.min(maxes[space][i],values[space][i]));values[space][i]=Math.round(capped)}for(var sname in spaces){if(sname!==space){values[sname]=convert[space][sname](values[space])}}return true};Color.prototype.setSpace=function(space,args){var vals=args[0];if(vals===undefined){return this.getValues(space)}if(typeof vals==="number"){vals=Array.prototype.slice.call(args)}this.setValues(space,vals);return this};Color.prototype.setChannel=function(space,index,val){var svalues=this.values[space];if(val===undefined){return svalues[index]}else if(val===svalues[index]){return this}svalues[index]=val;this.setValues(space,svalues);return this};if(typeof window!=="undefined"){window.Color=Color}module.exports=Color},{"chartjs-color-string":56,"color-convert":59}],58:[function(require,module,exports){module.exports={rgb2hsl:rgb2hsl,rgb2hsv:rgb2hsv,rgb2hwb:rgb2hwb,rgb2cmyk:rgb2cmyk,rgb2keyword:rgb2keyword,rgb2xyz:rgb2xyz,rgb2lab:rgb2lab,rgb2lch:rgb2lch,hsl2rgb:hsl2rgb,hsl2hsv:hsl2hsv,hsl2hwb:hsl2hwb,hsl2cmyk:hsl2cmyk,hsl2keyword:hsl2keyword,hsv2rgb:hsv2rgb,hsv2hsl:hsv2hsl,hsv2hwb:hsv2hwb,hsv2cmyk:hsv2cmyk,hsv2keyword:hsv2keyword,hwb2rgb:hwb2rgb,hwb2hsl:hwb2hsl,hwb2hsv:hwb2hsv,hwb2cmyk:hwb2cmyk,hwb2keyword:hwb2keyword,cmyk2rgb:cmyk2rgb,cmyk2hsl:cmyk2hsl,cmyk2hsv:cmyk2hsv,cmyk2hwb:cmyk2hwb,cmyk2keyword:cmyk2keyword,keyword2rgb:keyword2rgb,keyword2hsl:keyword2hsl,keyword2hsv:keyword2hsv,keyword2hwb:keyword2hwb,keyword2cmyk:keyword2cmyk,keyword2lab:keyword2lab,keyword2xyz:keyword2xyz,xyz2rgb:xyz2rgb,xyz2lab:xyz2lab,xyz2lch:xyz2lch,lab2xyz:lab2xyz,lab2rgb:lab2rgb,lab2lch:lab2lch,lch2lab:lch2lab,lch2xyz:lch2xyz,lch2rgb:lch2rgb};function rgb2hsl(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min,h,s,l;if(max==min)h=0;else if(r==max)h=(g-b)/delta;else if(g==max)h=2+(b-r)/delta;else if(b==max)h=4+(r-g)/delta;h=Math.min(h*60,360);if(h<0)h+=360;l=(min+max)/2;if(max==min)s=0;else if(l<=.5)s=delta/(max+min);else s=delta/(2-max-min);return[h,s*100,l*100]}function rgb2hsv(rgb){var r=rgb[0],g=rgb[1],b=rgb[2],min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min,h,s,v;if(max==0)s=0;else s=delta/max*1e3/10;if(max==min)h=0;else if(r==max)h=(g-b)/delta;else if(g==max)h=2+(b-r)/delta;else if(b==max)h=4+(r-g)/delta;h=Math.min(h*60,360);if(h<0)h+=360;v=max/255*1e3/10;return[h,s,v]}function rgb2hwb(rgb){var r=rgb[0],g=rgb[1],b=rgb[2],h=rgb2hsl(rgb)[0],w=1/255*Math.min(r,Math.min(g,b)),b=1-1/255*Math.max(r,Math.max(g,b));return[h,w*100,b*100]}function rgb2cmyk(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,c,m,y,k;k=Math.min(1-r,1-g,1-b);c=(1-r-k)/(1-k)||0;m=(1-g-k)/(1-k)||0;y=(1-b-k)/(1-k)||0;return[c*100,m*100,y*100,k*100]}function rgb2keyword(rgb){return reverseKeywords[JSON.stringify(rgb)]}function rgb2xyz(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;g=g>.04045?Math.pow((g+.055)/1.055,2.4):g/12.92;b=b>.04045?Math.pow((b+.055)/1.055,2.4):b/12.92;var x=r*.4124+g*.3576+b*.1805;var y=r*.2126+g*.7152+b*.0722;var z=r*.0193+g*.1192+b*.9505;return[x*100,y*100,z*100]}function rgb2lab(rgb){var xyz=rgb2xyz(rgb),x=xyz[0],y=xyz[1],z=xyz[2],l,a,b;x/=95.047;y/=100;z/=108.883;x=x>.008856?Math.pow(x,1/3):7.787*x+16/116;y=y>.008856?Math.pow(y,1/3):7.787*y+16/116;z=z>.008856?Math.pow(z,1/3):7.787*z+16/116;l=116*y-16;a=500*(x-y);b=200*(y-z);return[l,a,b]}function rgb2lch(args){return lab2lch(rgb2lab(args))}function hsl2rgb(hsl){var h=hsl[0]/360,s=hsl[1]/100,l=hsl[2]/100,t1,t2,t3,rgb,val;if(s==0){val=l*255;return[val,val,val]}if(l<.5)t2=l*(1+s);else t2=l+s-l*s;t1=2*l-t2;rgb=[0,0,0];for(var i=0;i<3;i++){t3=h+1/3*-(i-1);t3<0&&t3++;t3>1&&t3--;if(6*t3<1)val=t1+(t2-t1)*6*t3;else if(2*t3<1)val=t2;else if(3*t3<2)val=t1+(t2-t1)*(2/3-t3)*6;else val=t1;rgb[i]=val*255}return rgb}function hsl2hsv(hsl){var h=hsl[0],s=hsl[1]/100,l=hsl[2]/100,sv,v;if(l===0){return[0,0,0]}l*=2;s*=l<=1?l:2-l;v=(l+s)/2;sv=2*s/(l+s);return[h,sv*100,v*100]}function hsl2hwb(args){return rgb2hwb(hsl2rgb(args))}function hsl2cmyk(args){return rgb2cmyk(hsl2rgb(args))}function hsl2keyword(args){return rgb2keyword(hsl2rgb(args))}function hsv2rgb(hsv){var h=hsv[0]/60,s=hsv[1]/100,v=hsv[2]/100,hi=Math.floor(h)%6;var f=h-Math.floor(h),p=255*v*(1-s),q=255*v*(1-s*f),t=255*v*(1-s*(1-f)),v=255*v;switch(hi){case 0:return[v,t,p];case 1:return[q,v,p];case 2:return[p,v,t];case 3:return[p,q,v];case 4:return[t,p,v];case 5:return[v,p,q]}}function hsv2hsl(hsv){var h=hsv[0],s=hsv[1]/100,v=hsv[2]/100,sl,l;l=(2-s)*v;sl=s*v;sl/=l<=1?l:2-l;sl=sl||0;l/=2;return[h,sl*100,l*100]}function hsv2hwb(args){return rgb2hwb(hsv2rgb(args))}function hsv2cmyk(args){return rgb2cmyk(hsv2rgb(args))}function hsv2keyword(args){return rgb2keyword(hsv2rgb(args))}function hwb2rgb(hwb){var h=hwb[0]/360,wh=hwb[1]/100,bl=hwb[2]/100,ratio=wh+bl,i,v,f,n;if(ratio>1){wh/=ratio;bl/=ratio}i=Math.floor(6*h);v=1-bl;f=6*h-i;if((i&1)!=0){f=1-f}n=wh+f*(v-wh);switch(i){default:case 6:case 0:r=v;g=n;b=wh;break;case 1:r=n;g=v;b=wh;break;case 2:r=wh;g=v;b=n;break;case 3:r=wh;g=n;b=v;break;case 4:r=n;g=wh;b=v;break;case 5:r=v;g=wh;b=n;break}return[r*255,g*255,b*255]}function hwb2hsl(args){return rgb2hsl(hwb2rgb(args))}function hwb2hsv(args){return rgb2hsv(hwb2rgb(args))}function hwb2cmyk(args){return rgb2cmyk(hwb2rgb(args))}function hwb2keyword(args){return rgb2keyword(hwb2rgb(args))}function cmyk2rgb(cmyk){var c=cmyk[0]/100,m=cmyk[1]/100,y=cmyk[2]/100,k=cmyk[3]/100,r,g,b;r=1-Math.min(1,c*(1-k)+k);g=1-Math.min(1,m*(1-k)+k);b=1-Math.min(1,y*(1-k)+k);return[r*255,g*255,b*255]}function cmyk2hsl(args){return rgb2hsl(cmyk2rgb(args))}function cmyk2hsv(args){return rgb2hsv(cmyk2rgb(args))}function cmyk2hwb(args){return rgb2hwb(cmyk2rgb(args))}function cmyk2keyword(args){return rgb2keyword(cmyk2rgb(args))}function xyz2rgb(xyz){var x=xyz[0]/100,y=xyz[1]/100,z=xyz[2]/100,r,g,b;r=x*3.2406+y*-1.5372+z*-.4986;g=x*-.9689+y*1.8758+z*.0415;b=x*.0557+y*-.204+z*1.057;r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r=r*12.92;g=g>.0031308?1.055*Math.pow(g,1/2.4)-.055:g=g*12.92;b=b>.0031308?1.055*Math.pow(b,1/2.4)-.055:b=b*12.92;r=Math.min(Math.max(0,r),1);g=Math.min(Math.max(0,g),1);b=Math.min(Math.max(0,b),1);return[r*255,g*255,b*255]}function xyz2lab(xyz){var x=xyz[0],y=xyz[1],z=xyz[2],l,a,b;x/=95.047;y/=100;z/=108.883;x=x>.008856?Math.pow(x,1/3):7.787*x+16/116;y=y>.008856?Math.pow(y,1/3):7.787*y+16/116;z=z>.008856?Math.pow(z,1/3):7.787*z+16/116;l=116*y-16;a=500*(x-y);b=200*(y-z);return[l,a,b]}function xyz2lch(args){return lab2lch(xyz2lab(args))}function lab2xyz(lab){var l=lab[0],a=lab[1],b=lab[2],x,y,z,y2;if(l<=8){y=l*100/903.3;y2=7.787*(y/100)+16/116}else{y=100*Math.pow((l+16)/116,3);y2=Math.pow(y/100,1/3)}x=x/95.047<=.008856?x=95.047*(a/500+y2-16/116)/7.787:95.047*Math.pow(a/500+y2,3);z=z/108.883<=.008859?z=108.883*(y2-b/200-16/116)/7.787:108.883*Math.pow(y2-b/200,3);return[x,y,z]}function lab2lch(lab){var l=lab[0],a=lab[1],b=lab[2],hr,h,c;hr=Math.atan2(b,a);h=hr*360/2/Math.PI;if(h<0){h+=360}c=Math.sqrt(a*a+b*b);return[l,c,h]}function lab2rgb(args){return xyz2rgb(lab2xyz(args))}function lch2lab(lch){var l=lch[0],c=lch[1],h=lch[2],a,b,hr;hr=h/360*2*Math.PI;a=c*Math.cos(hr);b=c*Math.sin(hr);return[l,a,b]}function lch2xyz(args){return lab2xyz(lch2lab(args))}function lch2rgb(args){return lab2rgb(lch2lab(args))}function keyword2rgb(keyword){return cssKeywords[keyword]}function keyword2hsl(args){return rgb2hsl(keyword2rgb(args))}function keyword2hsv(args){return rgb2hsv(keyword2rgb(args))}function keyword2hwb(args){return rgb2hwb(keyword2rgb(args))}function keyword2cmyk(args){return rgb2cmyk(keyword2rgb(args))}function keyword2lab(args){return rgb2lab(keyword2rgb(args))}function keyword2xyz(args){return rgb2xyz(keyword2rgb(args))}var cssKeywords={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var reverseKeywords={};for(var key in cssKeywords){reverseKeywords[JSON.stringify(cssKeywords[key])]=key}},{}],59:[function(require,module,exports){var conversions=require("./conversions");var convert=function(){return new Converter};for(var func in conversions){convert[func+"Raw"]=function(func){return function(arg){if(typeof arg=="number")arg=Array.prototype.slice.call(arguments);return conversions[func](arg)}}(func);var pair=/(\w+)2(\w+)/.exec(func),from=pair[1],to=pair[2];convert[from]=convert[from]||{};convert[from][to]=convert[func]=function(func){return function(arg){if(typeof arg=="number")arg=Array.prototype.slice.call(arguments);var val=conversions[func](arg);if(typeof val=="string"||val===undefined)return val;for(var i=0;i<val.length;i++)val[i]=Math.round(val[i]);return val}}(func)}var Converter=function(){this.convs={}};Converter.prototype.routeSpace=function(space,args){var values=args[0];if(values===undefined){return this.getValues(space)}if(typeof values=="number"){values=Array.prototype.slice.call(args)}return this.setValues(space,values)};Converter.prototype.setValues=function(space,values){this.space=space;this.convs={};this.convs[space]=values;return this};Converter.prototype.getValues=function(space){var vals=this.convs[space];if(!vals){var fspace=this.space,from=this.convs[fspace];vals=convert[fspace][space](from);this.convs[space]=vals}return vals};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(space){Converter.prototype[space]=function(vals){return this.routeSpace(space,arguments)}});module.exports=convert},{"./conversions":58}],60:[function(require,module,exports){"use strict";module.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],61:[function(require,module,exports){"use strict";module.exports=earcut;module.exports.default=earcut;function earcut(data,holeIndices,dim){dim=dim||2;var hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,outerNode=linkedList(data,0,outerLen,dim,true),triangles=[];if(!outerNode)return triangles;var minX,minY,maxX,maxY,x,y,invSize;if(hasHoles)outerNode=eliminateHoles(data,holeIndices,outerNode,dim);if(data.length>80*dim){minX=maxX=data[0];minY=maxY=data[1];for(var i=dim;i<outerLen;i+=dim){x=data[i];y=data[i+1];if(x<minX)minX=x;if(y<minY)minY=y;if(x>maxX)maxX=x;if(y>maxY)maxY=y}invSize=Math.max(maxX-minX,maxY-minY);invSize=invSize!==0?1/invSize:0}earcutLinked(outerNode,triangles,dim,minX,minY,invSize);return triangles}function linkedList(data,start,end,dim,clockwise){var i,last;if(clockwise===signedArea(data,start,end,dim)>0){for(i=start;i<end;i+=dim)last=insertNode(i,data[i],data[i+1],last)}else{for(i=end-dim;i>=start;i-=dim)last=insertNode(i,data[i],data[i+1],last)}if(last&&equals(last,last.next)){removeNode(last);last=last.next}return last}function filterPoints(start,end){if(!start)return start;if(!end)end=start;var p=start,again;do{again=false;if(!p.steiner&&(equals(p,p.next)||area(p.prev,p,p.next)===0)){removeNode(p);p=end=p.prev;if(p===p.next)break;again=true}else{p=p.next}}while(again||p!==end);return end}function earcutLinked(ear,triangles,dim,minX,minY,invSize,pass){if(!ear)return;if(!pass&&invSize)indexCurve(ear,minX,minY,invSize);var stop=ear,prev,next;while(ear.prev!==ear.next){prev=ear.prev;next=ear.next;if(invSize?isEarHashed(ear,minX,minY,invSize):isEar(ear)){triangles.push(prev.i/dim);triangles.push(ear.i/dim);triangles.push(next.i/dim);removeNode(ear);ear=next.next;stop=next.next;continue}ear=next;if(ear===stop){if(!pass){earcutLinked(filterPoints(ear),triangles,dim,minX,minY,invSize,1)}else if(pass===1){ear=cureLocalIntersections(ear,triangles,dim);earcutLinked(ear,triangles,dim,minX,minY,invSize,2)}else if(pass===2){splitEarcut(ear,triangles,dim,minX,minY,invSize)}break}}}function isEar(ear){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return false;var p=ear.next.next;while(p!==ear.prev){if(pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return false;p=p.next}return true}function isEarHashed(ear,minX,minY,invSize){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return false;var minTX=a.x<b.x?a.x<c.x?a.x:c.x:b.x<c.x?b.x:c.x,minTY=a.y<b.y?a.y<c.y?a.y:c.y:b.y<c.y?b.y:c.y,maxTX=a.x>b.x?a.x>c.x?a.x:c.x:b.x>c.x?b.x:c.x,maxTY=a.y>b.y?a.y>c.y?a.y:c.y:b.y>c.y?b.y:c.y;var minZ=zOrder(minTX,minTY,minX,minY,invSize),maxZ=zOrder(maxTX,maxTY,minX,minY,invSize);var p=ear.prevZ,n=ear.nextZ;while(p&&p.z>=minZ&&n&&n.z<=maxZ){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return false;p=p.prevZ;if(n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return false;n=n.nextZ}while(p&&p.z>=minZ){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return false;p=p.prevZ}while(n&&n.z<=maxZ){if(n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return false;n=n.nextZ}return true}function cureLocalIntersections(start,triangles,dim){var p=start;do{var a=p.prev,b=p.next.next;if(!equals(a,b)&&intersects(a,p,p.next,b)&&locallyInside(a,b)&&locallyInside(b,a)){triangles.push(a.i/dim);triangles.push(p.i/dim);triangles.push(b.i/dim);removeNode(p);removeNode(p.next);p=start=b}p=p.next}while(p!==start);return p}function splitEarcut(start,triangles,dim,minX,minY,invSize){var a=start;do{var b=a.next.next;while(b!==a.prev){if(a.i!==b.i&&isValidDiagonal(a,b)){var c=splitPolygon(a,b);a=filterPoints(a,a.next);c=filterPoints(c,c.next);earcutLinked(a,triangles,dim,minX,minY,invSize);earcutLinked(c,triangles,dim,minX,minY,invSize);return}b=b.next}a=a.next}while(a!==start)}function eliminateHoles(data,holeIndices,outerNode,dim){var queue=[],i,len,start,end,list;for(i=0,len=holeIndices.length;i<len;i++){start=holeIndices[i]*dim;end=i<len-1?holeIndices[i+1]*dim:data.length;list=linkedList(data,start,end,dim,false);if(list===list.next)list.steiner=true;queue.push(getLeftmost(list))}queue.sort(compareX);for(i=0;i<queue.length;i++){eliminateHole(queue[i],outerNode);outerNode=filterPoints(outerNode,outerNode.next)}return outerNode}function compareX(a,b){return a.x-b.x}function eliminateHole(hole,outerNode){outerNode=findHoleBridge(hole,outerNode);if(outerNode){var b=splitPolygon(outerNode,hole);filterPoints(b,b.next)}}function findHoleBridge(hole,outerNode){var p=outerNode,hx=hole.x,hy=hole.y,qx=-Infinity,m;do{if(hy<=p.y&&hy>=p.next.y&&p.next.y!==p.y){var x=p.x+(hy-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(x<=hx&&x>qx){qx=x;if(x===hx){if(hy===p.y)return p;if(hy===p.next.y)return p.next}m=p.x<p.next.x?p:p.next}}p=p.next}while(p!==outerNode);if(!m)return null;if(hx===qx)return m.prev;var stop=m,mx=m.x,my=m.y,tanMin=Infinity,tan;p=m.next;while(p!==stop){if(hx>=p.x&&p.x>=mx&&hx!==p.x&&pointInTriangle(hy<my?hx:qx,hy,mx,my,hy<my?qx:hx,hy,p.x,p.y)){tan=Math.abs(hy-p.y)/(hx-p.x);if((tan<tanMin||tan===tanMin&&p.x>m.x)&&locallyInside(p,hole)){m=p;tanMin=tan}}p=p.next}return m}function indexCurve(start,minX,minY,invSize){var p=start;do{if(p.z===null)p.z=zOrder(p.x,p.y,minX,minY,invSize);p.prevZ=p.prev;p.nextZ=p.next;p=p.next}while(p!==start);p.prevZ.nextZ=null;p.prevZ=null;sortLinked(p)}function sortLinked(list){var i,p,q,e,tail,numMerges,pSize,qSize,inSize=1;do{p=list;list=null;tail=null;numMerges=0;while(p){numMerges++;q=p;pSize=0;for(i=0;i<inSize;i++){pSize++;q=q.nextZ;if(!q)break}qSize=inSize;while(pSize>0||qSize>0&&q){if(pSize!==0&&(qSize===0||!q||p.z<=q.z)){e=p;p=p.nextZ;pSize--}else{e=q;q=q.nextZ;qSize--}if(tail)tail.nextZ=e;else list=e;e.prevZ=tail;tail=e}p=q}tail.nextZ=null;inSize*=2}while(numMerges>1);return list}function zOrder(x,y,minX,minY,invSize){x=32767*(x-minX)*invSize;y=32767*(y-minY)*invSize;x=(x|x<<8)&16711935;x=(x|x<<4)&252645135;x=(x|x<<2)&858993459;x=(x|x<<1)&1431655765;y=(y|y<<8)&16711935;y=(y|y<<4)&252645135;y=(y|y<<2)&858993459;y=(y|y<<1)&1431655765;return x|y<<1}function getLeftmost(start){var p=start,leftmost=start;do{if(p.x<leftmost.x)leftmost=p;p=p.next}while(p!==start);return leftmost}function pointInTriangle(ax,ay,bx,by,cx,cy,px,py){return(cx-px)*(ay-py)-(ax-px)*(cy-py)>=0&&(ax-px)*(by-py)-(bx-px)*(ay-py)>=0&&(bx-px)*(cy-py)-(cx-px)*(by-py)>=0}function isValidDiagonal(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!intersectsPolygon(a,b)&&locallyInside(a,b)&&locallyInside(b,a)&&middleInside(a,b)}function area(p,q,r){return(q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y)}function equals(p1,p2){return p1.x===p2.x&&p1.y===p2.y}function intersects(p1,q1,p2,q2){if(equals(p1,q1)&&equals(p2,q2)||equals(p1,q2)&&equals(p2,q1))return true;return area(p1,q1,p2)>0!==area(p1,q1,q2)>0&&area(p2,q2,p1)>0!==area(p2,q2,q1)>0}function intersectsPolygon(a,b){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==b.i&&p.next.i!==b.i&&intersects(p,p.next,a,b))return true;p=p.next}while(p!==a);return false}function locallyInside(a,b){return area(a.prev,a,a.next)<0?area(a,b,a.next)>=0&&area(a,a.prev,b)>=0:area(a,b,a.prev)<0||area(a,a.next,b)<0}function middleInside(a,b){var p=a,inside=false,px=(a.x+b.x)/2,py=(a.y+b.y)/2;do{if(p.y>py!==p.next.y>py&&p.next.y!==p.y&&px<(p.next.x-p.x)*(py-p.y)/(p.next.y-p.y)+p.x)inside=!inside;p=p.next}while(p!==a);return inside}function splitPolygon(a,b){var a2=new Node(a.i,a.x,a.y),b2=new Node(b.i,b.x,b.y),an=a.next,bp=b.prev;a.next=b;b.prev=a;a2.next=an;an.prev=a2;b2.next=a2;a2.prev=b2;bp.next=b2;b2.prev=bp;return b2}function insertNode(i,x,y,last){var p=new Node(i,x,y);if(!last){p.prev=p;p.next=p}else{p.next=last.next;p.prev=last;last.next.prev=p;last.next=p}return p}function removeNode(p){p.next.prev=p.prev;p.prev.next=p.next;if(p.prevZ)p.prevZ.nextZ=p.nextZ;if(p.nextZ)p.nextZ.prevZ=p.prevZ}function Node(i,x,y){this.i=i;this.x=x;this.y=y;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}earcut.deviation=function(data,holeIndices,dim,triangles){var hasHoles=holeIndices&&holeIndices.length;var outerLen=hasHoles?holeIndices[0]*dim:data.length;var polygonArea=Math.abs(signedArea(data,0,outerLen,dim));if(hasHoles){for(var i=0,len=holeIndices.length;i<len;i++){var start=holeIndices[i]*dim;var end=i<len-1?holeIndices[i+1]*dim:data.length;polygonArea-=Math.abs(signedArea(data,start,end,dim))}}var trianglesArea=0;for(i=0;i<triangles.length;i+=3){var a=triangles[i]*dim;var b=triangles[i+1]*dim;var c=triangles[i+2]*dim;trianglesArea+=Math.abs((data[a]-data[c])*(data[b+1]-data[a+1])-(data[a]-data[b])*(data[c+1]-data[a+1]))}return polygonArea===0&&trianglesArea===0?0:Math.abs((trianglesArea-polygonArea)/polygonArea)};function signedArea(data,start,end,dim){var sum=0;for(var i=start,j=end-dim;i<end;i+=dim){sum+=(data[j]-data[i])*(data[i+1]+data[j+1]);j=i}return sum}earcut.flatten=function(data){var dim=data[0][0].length,result={vertices:[],holes:[],dimensions:dim},holeIndex=0;for(var i=0;i<data.length;i++){for(var j=0;j<data[i].length;j++){for(var d=0;d<dim;d++)result.vertices.push(data[i][j][d])}if(i>0){holeIndex+=data[i-1].length;result.holes.push(holeIndex)}}return result}},{}],62:[function(require,module,exports){"use strict";var has=Object.prototype.hasOwnProperty,prefix="~";function Events(){}if(Object.create){Events.prototype=Object.create(null);if(!(new Events).__proto__)prefix=false}function EE(fn,context,once){this.fn=fn;this.context=context;this.once=once||false}function EventEmitter(){this._events=new Events;this._eventsCount=0}EventEmitter.prototype.eventNames=function eventNames(){var names=[],events,name;if(this._eventsCount===0)return names;for(name in events=this._events){if(has.call(events,name))names.push(prefix?name.slice(1):name)}if(Object.getOwnPropertySymbols){return names.concat(Object.getOwnPropertySymbols(events))}return names};EventEmitter.prototype.listeners=function listeners(event,exists){var evt=prefix?prefix+event:event,available=this._events[evt];if(exists)return!!available;if(!available)return[];if(available.fn)return[available.fn];for(var i=0,l=available.length,ee=new Array(l);i<l;i++){ee[i]=available[i].fn}return ee};EventEmitter.prototype.emit=function emit(event,a1,a2,a3,a4,a5){var evt=prefix?prefix+event:event;if(!this._events[evt])return false;var listeners=this._events[evt],len=arguments.length,args,i;if(listeners.fn){if(listeners.once)this.removeListener(event,listeners.fn,undefined,true);switch(len){case 1:return listeners.fn.call(listeners.context),true;case 2:return listeners.fn.call(listeners.context,a1),true;case 3:return listeners.fn.call(listeners.context,a1,a2),true;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),true;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),true;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),true}for(i=1,args=new Array(len-1);i<len;i++){args[i-1]=arguments[i]}listeners.fn.apply(listeners.context,args)}else{var length=listeners.length,j;for(i=0;i<length;i++){if(listeners[i].once)this.removeListener(event,listeners[i].fn,undefined,true);switch(len){case 1:listeners[i].fn.call(listeners[i].context);break;case 2:listeners[i].fn.call(listeners[i].context,a1);break;case 3:listeners[i].fn.call(listeners[i].context,a1,a2);break;case 4:listeners[i].fn.call(listeners[i].context,a1,a2,a3);break;default:if(!args)for(j=1,args=new Array(len-1);j<len;j++){args[j-1]=arguments[j]}listeners[i].fn.apply(listeners[i].context,args)}}}return true};EventEmitter.prototype.on=function on(event,fn,context){var listener=new EE(fn,context||this),evt=prefix?prefix+event:event;if(!this._events[evt])this._events[evt]=listener,this._eventsCount++;else if(!this._events[evt].fn)this._events[evt].push(listener);else this._events[evt]=[this._events[evt],listener];return this};EventEmitter.prototype.once=function once(event,fn,context){var listener=new EE(fn,context||this,true),evt=prefix?prefix+event:event;if(!this._events[evt])this._events[evt]=listener,this._eventsCount++;else if(!this._events[evt].fn)this._events[evt].push(listener);else this._events[evt]=[this._events[evt],listener];return this};EventEmitter.prototype.removeListener=function removeListener(event,fn,context,once){var evt=prefix?prefix+event:event;if(!this._events[evt])return this;if(!fn){if(--this._eventsCount===0)this._events=new Events;else delete this._events[evt];return this}var listeners=this._events[evt];if(listeners.fn){if(listeners.fn===fn&&(!once||listeners.once)&&(!context||listeners.context===context)){if(--this._eventsCount===0)this._events=new Events;else delete this._events[evt]}}else{for(var i=0,events=[],length=listeners.length;i<length;i++){if(listeners[i].fn!==fn||once&&!listeners[i].once||context&&listeners[i].context!==context){events.push(listeners[i])}}if(events.length)this._events[evt]=events.length===1?events[0]:events;else if(--this._eventsCount===0)this._events=new Events;else delete this._events[evt]}return this};EventEmitter.prototype.removeAllListeners=function removeAllListeners(event){var evt;if(event){evt=prefix?prefix+event:event;if(this._events[evt]){if(--this._eventsCount===0)this._events=new Events;else delete this._events[evt]}}else{this._events=new Events;this._eventsCount=0}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prototype.setMaxListeners=function setMaxListeners(){return this};EventEmitter.prefixed=prefix;EventEmitter.EventEmitter=EventEmitter;if("undefined"!==typeof module){module.exports=EventEmitter}},{}],63:[function(require,module,exports){(function(global){var apple_phone=/iPhone/i,apple_ipod=/iPod/i,apple_tablet=/iPad/i,android_phone=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,android_tablet=/Android/i,amazon_phone=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,amazon_tablet=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,windows_phone=/Windows Phone/i,windows_tablet=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,other_blackberry=/BlackBerry/i,other_blackberry_10=/BB10/i,other_opera=/Opera Mini/i,other_chrome=/(CriOS|Chrome)(?=.*\bMobile\b)/i,other_firefox=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,seven_inch=new RegExp("(?:"+"Nexus 7"+"|"+"BNTV250"+"|"+"Kindle Fire"+"|"+"Silk"+"|"+"GT-P1000"+")","i");var match=function(regex,userAgent){return regex.test(userAgent)};var IsMobileClass=function(userAgent){var ua=userAgent||navigator.userAgent;var tmp=ua.split("[FBAN");if(typeof tmp[1]!=="undefined"){ua=tmp[0]}tmp=ua.split("Twitter");if(typeof tmp[1]!=="undefined"){ua=tmp[0]}this.apple={phone:match(apple_phone,ua),ipod:match(apple_ipod,ua),tablet:!match(apple_phone,ua)&&match(apple_tablet,ua),device:match(apple_phone,ua)||match(apple_ipod,ua)||match(apple_tablet,ua)};this.amazon={phone:match(amazon_phone,ua),tablet:!match(amazon_phone,ua)&&match(amazon_tablet,ua),device:match(amazon_phone,ua)||match(amazon_tablet,ua)};this.android={phone:match(amazon_phone,ua)||match(android_phone,ua),tablet:!match(amazon_phone,ua)&&!match(android_phone,ua)&&(match(amazon_tablet,ua)||match(android_tablet,ua)),device:match(amazon_phone,ua)||match(amazon_tablet,ua)||match(android_phone,ua)||match(android_tablet,ua)};this.windows={phone:match(windows_phone,ua),tablet:match(windows_tablet,ua),device:match(windows_phone,ua)||match(windows_tablet,ua)};this.other={blackberry:match(other_blackberry,ua),blackberry10:match(other_blackberry_10,ua),opera:match(other_opera,ua),firefox:match(other_firefox,ua),chrome:match(other_chrome,ua),device:match(other_blackberry,ua)||match(other_blackberry_10,ua)||match(other_opera,ua)||match(other_firefox,ua)||match(other_chrome,ua)};this.seven_inch=match(seven_inch,ua);this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch;this.phone=this.apple.phone||this.android.phone||this.windows.phone;this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet;if(typeof window==="undefined"){return this}};var instantiate=function(){var IM=new IsMobileClass;IM.Class=IsMobileClass;return IM};if(typeof module!=="undefined"&&module.exports&&typeof window==="undefined"){module.exports=IsMobileClass}else if(typeof module!=="undefined"&&module.exports&&typeof window!=="undefined"){module.exports=instantiate()}else if(typeof define==="function"&&define.amd){define("isMobile",[],global.isMobile=instantiate())}else{global.isMobile=instantiate()}})(this)},{}],64:[function(require,module,exports){(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else if(typeof exports==="object"){factory(require("jquery"))}else{factory(jQuery)}})(function($){"use strict";$.support.htmlMenuitem="HTMLMenuItemElement"in window;$.support.htmlCommand="HTMLCommandElement"in window;$.support.eventSelectstart="onselectstart"in document.documentElement;if(!$.ui||!$.widget){$.cleanData=function(orig){return function(elems){var events,elem,i;for(i=0;elems[i]!=null;i++){elem=elems[i];try{events=$._data(elem,"events");if(events&&events.remove){$(elem).triggerHandler("remove")}}catch(e){}}orig(elems)}}($.cleanData)}var $currentTrigger=null,initialized=false,$win=$(window),counter=0,namespaces={},menus={},types={},defaults={selector:null,appendTo:null,trigger:"right",autoHide:false,delay:200,reposition:true,hideOnSecondTrigger:false,selectableSubMenu:false,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",iconQuit:"context-menu-icon-quit",iconLoadingClass:"context-menu-icon-loading"},determinePosition:function($menu){if($.ui&&$.ui.position){$menu.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none")}else{var offset=this.offset();offset.top+=this.outerHeight();offset.left+=this.outerWidth()/2-$menu.outerWidth()/2;$menu.css(offset)}},position:function(opt,x,y){var offset;if(!x&&!y){opt.determinePosition.call(this,opt.$menu);return}else if(x==="maintain"&&y==="maintain"){offset=opt.$menu.position()}else{var offsetParentOffset=opt.$menu.offsetParent().offset();offset={top:y-offsetParentOffset.top,left:x-offsetParentOffset.left}}var bottom=$win.scrollTop()+$win.height(),right=$win.scrollLeft()+$win.width(),height=opt.$menu.outerHeight(),width=opt.$menu.outerWidth();if(offset.top+height>bottom){offset.top-=height}if(offset.top<0){offset.top=0}if(offset.left+width>right){offset.left-=width}if(offset.left<0){offset.left=0}opt.$menu.css(offset)},positionSubmenu:function($menu){if(typeof $menu==="undefined"){return}if($.ui&&$.ui.position){$menu.css("display","block").position({my:"left top-5",at:"right top",of:this,collision:"flipfit fit"}).css("display","")}else{var offset={top:-9,left:this.outerWidth()-5};$menu.css(offset)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:$.noop,hide:$.noop,activated:$.noop},callback:null,items:{}},hoveract={timer:null,pageX:null,pageY:null},zindex=function($t){var zin=0,$tt=$t;while(true){zin=Math.max(zin,parseInt($tt.css("z-index"),10)||0);$tt=$tt.parent();if(!$tt||!$tt.length||"html body".indexOf($tt.prop("nodeName").toLowerCase())>-1){break}}return zin},handle={abortevent:function(e){e.preventDefault();e.stopImmediatePropagation()},contextmenu:function(e){var $this=$(this);if(e.data.trigger==="right"){e.preventDefault();e.stopImmediatePropagation()}if(e.data.trigger!=="right"&&e.data.trigger!=="demand"&&e.originalEvent){return}if(typeof e.mouseButton!=="undefined"&&e.data){if(!(e.data.trigger==="left"&&e.mouseButton===0)&&!(e.data.trigger==="right"&&e.mouseButton===2)){return}}if($this.hasClass("context-menu-active")){return}if(!$this.hasClass("context-menu-disabled")){$currentTrigger=$this;if(e.data.build){var built=e.data.build($currentTrigger,e);if(built===false){return}e.data=$.extend(true,{},defaults,e.data,built||{});if(!e.data.items||$.isEmptyObject(e.data.items)){if(window.console){(console.error||console.log).call(console,"No items specified to show in contextMenu")}throw new Error("No Items specified")}e.data.$trigger=$currentTrigger;op.create(e.data)}op.show.call($this,e.data,e.pageX,e.pageY)}},click:function(e){e.preventDefault();e.stopImmediatePropagation();$(this).trigger($.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))},mousedown:function(e){var $this=$(this);if($currentTrigger&&$currentTrigger.length&&!$currentTrigger.is($this)){$currentTrigger.data("contextMenu").$menu.trigger("contextmenu:hide")}if(e.button===2){$currentTrigger=$this.data("contextMenuActive",true)}},mouseup:function(e){var $this=$(this);if($this.data("contextMenuActive")&&$currentTrigger&&$currentTrigger.length&&$currentTrigger.is($this)&&!$this.hasClass("context-menu-disabled")){e.preventDefault();e.stopImmediatePropagation();$currentTrigger=$this;$this.trigger($.Event("contextmenu",{data:e.data,pageX:e.pageX,pageY:e.pageY}))}$this.removeData("contextMenuActive")},mouseenter:function(e){var $this=$(this),$related=$(e.relatedTarget),$document=$(document);if($related.is(".context-menu-list")||$related.closest(".context-menu-list").length){return}if($currentTrigger&&$currentTrigger.length){return}hoveract.pageX=e.pageX;hoveract.pageY=e.pageY;hoveract.data=e.data;$document.on("mousemove.contextMenuShow",handle.mousemove);hoveract.timer=setTimeout(function(){hoveract.timer=null;$document.off("mousemove.contextMenuShow");$currentTrigger=$this;$this.trigger($.Event("contextmenu",{data:hoveract.data,pageX:hoveract.pageX,pageY:hoveract.pageY}))},e.data.delay)},mousemove:function(e){hoveract.pageX=e.pageX;hoveract.pageY=e.pageY},mouseleave:function(e){var $related=$(e.relatedTarget);if($related.is(".context-menu-list")||$related.closest(".context-menu-list").length){return}try{clearTimeout(hoveract.timer)}catch(e){}hoveract.timer=null},layerClick:function(e){var $this=$(this),root=$this.data("contextMenuRoot"),button=e.button,x=e.pageX,y=e.pageY,fakeClick=x===undefined,target,offset;e.preventDefault();setTimeout(function(){if(fakeClick){if(root!==null&&typeof root!=="undefined"&&root.$menu!==null&&typeof root.$menu!=="undefined"){root.$menu.trigger("contextmenu:hide")}return}var $window;var triggerAction=root.trigger==="left"&&button===0||root.trigger==="right"&&button===2;if(document.elementFromPoint&&root.$layer){root.$layer.hide();target=document.elementFromPoint(x-$win.scrollLeft(),y-$win.scrollTop());if(target.isContentEditable){var range=document.createRange(),sel=window.getSelection();range.selectNode(target);range.collapse(true);sel.removeAllRanges();sel.addRange(range)}$(target).trigger(e);root.$layer.show()}if(root.hideOnSecondTrigger&&triggerAction&&root.$menu!==null&&typeof root.$menu!=="undefined"){root.$menu.trigger("contextmenu:hide");return}if(root.reposition&&triggerAction){if(document.elementFromPoint){if(root.$trigger.is(target)){root.position.call(root.$trigger,root,x,y);return}}else{offset=root.$trigger.offset();$window=$(window);offset.top+=$window.scrollTop();if(offset.top<=e.pageY){offset.left+=$window.scrollLeft();if(offset.left<=e.pageX){offset.bottom=offset.top+root.$trigger.outerHeight();if(offset.bottom>=e.pageY){offset.right=offset.left+root.$trigger.outerWidth();if(offset.right>=e.pageX){root.position.call(root.$trigger,root,x,y);return}}}}}}if(target&&triggerAction){root.$trigger.one("contextmenu:hidden",function(){$(target).contextMenu({x:x,y:y,button:button})})}if(root!==null&&typeof root!=="undefined"&&root.$menu!==null&&typeof root.$menu!=="undefined"){root.$menu.trigger("contextmenu:hide")}},50)},keyStop:function(e,opt){if(!opt.isInput){e.preventDefault()}e.stopPropagation()},key:function(e){var opt={};if($currentTrigger){opt=$currentTrigger.data("contextMenu")||{}}if(typeof opt.zIndex==="undefined"){opt.zIndex=0}var targetZIndex=0;var getZIndexOfTriggerTarget=function(target){if(target.style.zIndex!==""){targetZIndex=target.style.zIndex}else{if(target.offsetParent!==null&&typeof target.offsetParent!=="undefined"){getZIndexOfTriggerTarget(target.offsetParent)}else if(target.parentElement!==null&&typeof target.parentElement!=="undefined"){getZIndexOfTriggerTarget(target.parentElement)}}};getZIndexOfTriggerTarget(e.target);if(opt.$menu&&parseInt(targetZIndex,10)>parseInt(opt.$menu.css("zIndex"),10)){return}switch(e.keyCode){case 9:case 38:handle.keyStop(e,opt);if(opt.isInput){if(e.keyCode===9&&e.shiftKey){e.preventDefault();if(opt.$selected){opt.$selected.find("input, textarea, select").blur()}if(opt.$menu!==null&&typeof opt.$menu!=="undefined"){opt.$menu.trigger("prevcommand")}return}else if(e.keyCode===38&&opt.$selected.find("input, textarea, select").prop("type")==="checkbox"){e.preventDefault();return}}else if(e.keyCode!==9||e.shiftKey){if(opt.$menu!==null&&typeof opt.$menu!=="undefined"){opt.$menu.trigger("prevcommand")}return}break;case 40:handle.keyStop(e,opt);if(opt.isInput){if(e.keyCode===9){e.preventDefault();if(opt.$selected){opt.$selected.find("input, textarea, select").blur()}if(opt.$menu!==null&&typeof opt.$menu!=="undefined"){opt.$menu.trigger("nextcommand")}return}else if(e.keyCode===40&&opt.$selected.find("input, textarea, select").prop("type")==="checkbox"){e.preventDefault();return}}else{if(opt.$menu!==null&&typeof opt.$menu!=="undefined"){opt.$menu.trigger("nextcommand")}return}break;case 37:handle.keyStop(e,opt);if(opt.isInput||!opt.$selected||!opt.$selected.length){break}if(!opt.$selected.parent().hasClass("context-menu-root")){var $parent=opt.$selected.parent().parent();opt.$selected.trigger("contextmenu:blur");opt.$selected=$parent;return}break;case 39:handle.keyStop(e,opt);if(opt.isInput||!opt.$selected||!opt.$selected.length){break}var itemdata=opt.$selected.data("contextMenu")||{};if(itemdata.$menu&&opt.$selected.hasClass("context-menu-submenu")){opt.$selected=null;itemdata.$selected=null;itemdata.$menu.trigger("nextcommand");return}break;case 35:case 36:if(opt.$selected&&opt.$selected.find("input, textarea, select").length){return}else{(opt.$selected&&opt.$selected.parent()||opt.$menu).children(":not(."+opt.classNames.disabled+", ."+opt.classNames.notSelectable+")")[e.keyCode===36?"first":"last"]().trigger("contextmenu:focus");e.preventDefault();return}break;case 13:handle.keyStop(e,opt);if(opt.isInput){if(opt.$selected&&!opt.$selected.is("textarea, select")){e.preventDefault();return}break}if(typeof opt.$selected!=="undefined"&&opt.$selected!==null){opt.$selected.trigger("mouseup")}return;case 32:case 33:case 34:handle.keyStop(e,opt);return;case 27:handle.keyStop(e,opt);if(opt.$menu!==null&&typeof opt.$menu!=="undefined"){opt.$menu.trigger("contextmenu:hide")}return;default:var k=String.fromCharCode(e.keyCode).toUpperCase();if(opt.accesskeys&&opt.accesskeys[k]){opt.accesskeys[k].$node.trigger(opt.accesskeys[k].$menu?"contextmenu:focus":"mouseup");return}break}e.stopPropagation();if(typeof opt.$selected!=="undefined"&&opt.$selected!==null){opt.$selected.trigger(e)}},prevItem:function(e){e.stopPropagation();var opt=$(this).data("contextMenu")||{};var root=$(this).data("contextMenuRoot")||{};if(opt.$selected){var $s=opt.$selected;opt=opt.$selected.parent().data("contextMenu")||{};opt.$selected=$s}var $children=opt.$menu.children(),$prev=!opt.$selected||!opt.$selected.prev().length?$children.last():opt.$selected.prev(),$round=$prev;while($prev.hasClass(root.classNames.disabled)||$prev.hasClass(root.classNames.notSelectable)||$prev.is(":hidden")){if($prev.prev().length){$prev=$prev.prev()}else{$prev=$children.last()}if($prev.is($round)){return}}if(opt.$selected){handle.itemMouseleave.call(opt.$selected.get(0),e)}handle.itemMouseenter.call($prev.get(0),e);var $input=$prev.find("input, textarea, select");if($input.length){$input.focus()}},nextItem:function(e){e.stopPropagation();var opt=$(this).data("contextMenu")||{};var root=$(this).data("contextMenuRoot")||{};if(opt.$selected){var $s=opt.$selected;opt=opt.$selected.parent().data("contextMenu")||{};opt.$selected=$s}var $children=opt.$menu.children(),$next=!opt.$selected||!opt.$selected.next().length?$children.first():opt.$selected.next(),$round=$next;while($next.hasClass(root.classNames.disabled)||$next.hasClass(root.classNames.notSelectable)||$next.is(":hidden")){if($next.next().length){$next=$next.next()}else{$next=$children.first()}if($next.is($round)){return}}if(opt.$selected){handle.itemMouseleave.call(opt.$selected.get(0),e)}handle.itemMouseenter.call($next.get(0),e);var $input=$next.find("input, textarea, select");if($input.length){$input.focus()}},focusInput:function(){var $this=$(this).closest(".context-menu-item"),data=$this.data(),opt=data.contextMenu,root=data.contextMenuRoot;root.$selected=opt.$selected=$this;root.isInput=opt.isInput=true},blurInput:function(){var $this=$(this).closest(".context-menu-item"),data=$this.data(),opt=data.contextMenu,root=data.contextMenuRoot;root.isInput=opt.isInput=false},menuMouseenter:function(){var root=$(this).data().contextMenuRoot;root.hovering=true},menuMouseleave:function(e){var root=$(this).data().contextMenuRoot;if(root.$layer&&root.$layer.is(e.relatedTarget)){root.hovering=false}},itemMouseenter:function(e){var $this=$(this),data=$this.data(),opt=data.contextMenu,root=data.contextMenuRoot;root.hovering=true;if(e&&root.$layer&&root.$layer.is(e.relatedTarget)){e.preventDefault();e.stopImmediatePropagation()}(opt.$menu?opt:root).$menu.children("."+root.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur");if($this.hasClass(root.classNames.disabled)||$this.hasClass(root.classNames.notSelectable)){opt.$selected=null;return}$this.trigger("contextmenu:focus")},itemMouseleave:function(e){var $this=$(this),data=$this.data(),opt=data.contextMenu,root=data.contextMenuRoot;if(root!==opt&&root.$layer&&root.$layer.is(e.relatedTarget)){if(typeof root.$selected!=="undefined"&&root.$selected!==null){root.$selected.trigger("contextmenu:blur")}e.preventDefault();e.stopImmediatePropagation();root.$selected=opt.$selected=opt.$node;return}if(opt&&opt.$menu&&opt.$menu.hasClass("context-menu-visible")){return}$this.trigger("contextmenu:blur")},itemClick:function(e){var $this=$(this),data=$this.data(),opt=data.contextMenu,root=data.contextMenuRoot,key=data.contextMenuKey,callback;if(!opt.items[key]||$this.is("."+root.classNames.disabled+", .context-menu-separator, ."+root.classNames.notSelectable)||$this.is(".context-menu-submenu")&&root.selectableSubMenu===false){return}e.preventDefault();e.stopImmediatePropagation();if($.isFunction(opt.callbacks[key])&&Object.prototype.hasOwnProperty.call(opt.callbacks,key)){callback=opt.callbacks[key]}else if($.isFunction(root.callback)){callback=root.callback}else{return}if(callback.call(root.$trigger,key,root,e)!==false){root.$menu.trigger("contextmenu:hide")}else if(root.$menu.parent().length){op.update.call(root.$trigger,root)}},inputClick:function(e){e.stopImmediatePropagation()},hideMenu:function(e,data){var root=$(this).data("contextMenuRoot");op.hide.call(root.$trigger,root,data&&data.force)},focusItem:function(e){e.stopPropagation();var $this=$(this),data=$this.data(),opt=data.contextMenu,root=data.contextMenuRoot;if($this.hasClass(root.classNames.disabled)||$this.hasClass(root.classNames.notSelectable)){return}$this.addClass([root.classNames.hover,root.classNames.visible].join(" ")).parent().find(".context-menu-item").not($this).removeClass(root.classNames.visible).filter("."+root.classNames.hover).trigger("contextmenu:blur");opt.$selected=root.$selected=$this;if(opt&&opt.$node&&opt.$node.hasClass("context-menu-submenu")){opt.$node.addClass(root.classNames.hover)}if(opt.$node){root.positionSubmenu.call(opt.$node,opt.$menu)}},blurItem:function(e){e.stopPropagation();var $this=$(this),data=$this.data(),opt=data.contextMenu,root=data.contextMenuRoot;if(opt.autoHide){$this.removeClass(root.classNames.visible)}$this.removeClass(root.classNames.hover);opt.$selected=null}},op={show:function(opt,x,y){var $trigger=$(this),css={};$("#context-menu-layer").trigger("mousedown");opt.$trigger=$trigger;if(opt.events.show.call($trigger,opt)===false){$currentTrigger=null;return}var hasVisibleItems=op.update.call($trigger,opt);if(hasVisibleItems===false){$currentTrigger=null;return}opt.position.call($trigger,opt,x,y);if(opt.zIndex){var additionalZValue=opt.zIndex;if(typeof opt.zIndex==="function"){additionalZValue=opt.zIndex.call($trigger,opt)}css.zIndex=zindex($trigger)+additionalZValue}op.layer.call(opt.$menu,opt,css.zIndex);opt.$menu.find("ul").css("zIndex",css.zIndex+1);opt.$menu.css(css)[opt.animation.show](opt.animation.duration,function(){$trigger.trigger("contextmenu:visible");op.activated(opt);opt.events.activated(opt)});$trigger.data("contextMenu",opt).addClass("context-menu-active");$(document).off("keydown.contextMenu").on("keydown.contextMenu",handle.key);if(opt.autoHide){$(document).on("mousemove.contextMenuAutoHide",function(e){var pos=$trigger.offset();pos.right=pos.left+$trigger.outerWidth();pos.bottom=pos.top+$trigger.outerHeight();if(opt.$layer&&!opt.hovering&&(!(e.pageX>=pos.left&&e.pageX<=pos.right)||!(e.pageY>=pos.top&&e.pageY<=pos.bottom))){setTimeout(function(){if(!opt.hovering&&opt.$menu!==null&&typeof opt.$menu!=="undefined"){opt.$menu.trigger("contextmenu:hide")}},50)}})}},hide:function(opt,force){var $trigger=$(this);if(!opt){opt=$trigger.data("contextMenu")||{}}if(!force&&opt.events&&opt.events.hide.call($trigger,opt)===false){return}$trigger.removeData("contextMenu").removeClass("context-menu-active");if(opt.$layer){setTimeout(function($layer){return function(){$layer.remove()}}(opt.$layer),10);try{delete opt.$layer}catch(e){opt.$layer=null}}$currentTrigger=null;opt.$menu.find("."+opt.classNames.hover).trigger("contextmenu:blur");opt.$selected=null;opt.$menu.find("."+opt.classNames.visible).removeClass(opt.classNames.visible);$(document).off(".contextMenuAutoHide").off("keydown.contextMenu");if(opt.$menu){opt.$menu[opt.animation.hide](opt.animation.duration,function(){if(opt.build){opt.$menu.remove();$.each(opt,function(key){switch(key){case"ns":case"selector":case"build":case"trigger":return true;default:opt[key]=undefined;try{delete opt[key]}catch(e){}return true}})}setTimeout(function(){$trigger.trigger("contextmenu:hidden")},10)})}},create:function(opt,root){if(typeof root==="undefined"){root=opt}opt.$menu=$('<ul class="context-menu-list"></ul>').addClass(opt.className||"").data({contextMenu:opt,contextMenuRoot:root});$.each(["callbacks","commands","inputs"],function(i,k){opt[k]={};if(!root[k]){root[k]={}}});if(!root.accesskeys){root.accesskeys={}}function createNameNode(item){var $name=$("<span></span>");if(item._accesskey){if(item._beforeAccesskey){$name.append(document.createTextNode(item._beforeAccesskey))}$("<span></span>").addClass("context-menu-accesskey").text(item._accesskey).appendTo($name);if(item._afterAccesskey){$name.append(document.createTextNode(item._afterAccesskey))}}else{if(item.isHtmlName){if(typeof item.accesskey!=="undefined"){throw new Error("accesskeys are not compatible with HTML names and cannot be used together in the same item")}$name.html(item.name)}else{$name.text(item.name)}}return $name}$.each(opt.items,function(key,item){var $t=$('<li class="context-menu-item"></li>').addClass(item.className||""),$label=null,$input=null;$t.on("click",$.noop);if(typeof item==="string"||item.type==="cm_separator"){item={type:"cm_seperator"}}item.$node=$t.data({contextMenu:opt,contextMenuRoot:root,contextMenuKey:key});if(typeof item.accesskey!=="undefined"){var aks=splitAccesskey(item.accesskey);for(var i=0,ak;ak=aks[i];i++){if(!root.accesskeys[ak]){root.accesskeys[ak]=item;var matched=item.name.match(new RegExp("^(.*?)("+ak+")(.*)$","i"));if(matched){item._beforeAccesskey=matched[1];item._accesskey=matched[2];item._afterAccesskey=matched[3]}break}}}if(item.type&&types[item.type]){types[item.type].call($t,item,opt,root);$.each([opt,root],function(i,k){k.commands[key]=item;if($.isFunction(item.callback)&&(typeof k.callbacks[key]==="undefined"||typeof opt.type==="undefined")){k.callbacks[key]=item.callback}})}else{if(item.type==="cm_seperator"){$t.addClass("context-menu-separator "+root.classNames.notSelectable)}else if(item.type==="html"){$t.addClass("context-menu-html "+root.classNames.notSelectable)}else if(item.type!=="sub"&&item.type){$label=$("<label></label>").appendTo($t);createNameNode(item).appendTo($label);$t.addClass("context-menu-input");opt.hasTypes=true;$.each([opt,root],function(i,k){k.commands[key]=item;k.inputs[key]=item})}else if(item.items){item.type="sub"}switch(item.type){case"cm_seperator":break;case"text":$input=$('<input type="text" value="1" name="" />').attr("name","context-menu-input-"+key).val(item.value||"").appendTo($label);break;case"textarea":$input=$('<textarea name=""></textarea>').attr("name","context-menu-input-"+key).val(item.value||"").appendTo($label);if(item.height){$input.height(item.height)}break;case"checkbox":$input=$('<input type="checkbox" value="1" name="" />').attr("name","context-menu-input-"+key).val(item.value||"").prop("checked",!!item.selected).prependTo($label);break;case"radio":$input=$('<input type="radio" value="1" name="" />').attr("name","context-menu-input-"+item.radio).val(item.value||"").prop("checked",!!item.selected).prependTo($label);break;case"select":$input=$('<select name=""></select>').attr("name","context-menu-input-"+key).appendTo($label);if(item.options){$.each(item.options,function(value,text){$("<option></option>").val(value).text(text).appendTo($input)});$input.val(item.selected)}break;case"sub":createNameNode(item).appendTo($t);item.appendTo=item.$node;$t.data("contextMenu",item).addClass("context-menu-submenu");item.callback=null;if("function"===typeof item.items.then){op.processPromises(item,root,item.items)}else{op.create(item,root)}break;case"html":$(item.html).appendTo($t);break;default:$.each([opt,root],function(i,k){k.commands[key]=item;if($.isFunction(item.callback)&&(typeof k.callbacks[key]==="undefined"||typeof opt.type==="undefined")){k.callbacks[key]=item.callback}});createNameNode(item).appendTo($t);break}if(item.type&&item.type!=="sub"&&item.type!=="html"&&item.type!=="cm_seperator"){$input.on("focus",handle.focusInput).on("blur",handle.blurInput);if(item.events){$input.on(item.events,opt)}}if(item.icon){if($.isFunction(item.icon)){item._icon=item.icon.call(this,this,$t,key,item)}else{if(typeof item.icon==="string"&&(item.icon.substring(0,4)==="fab "||item.icon.substring(0,4)==="fas "||item.icon.substring(0,4)==="far "||item.icon.substring(0,4)==="fal ")){$t.addClass(root.classNames.icon+" "+root.classNames.icon+"--fa5");item._icon=$('<i class="'+item.icon+'"></i>')}else if(typeof item.icon==="string"&&item.icon.substring(0,3)==="fa-"){item._icon=root.classNames.icon+" "+root.classNames.icon+"--fa fa "+item.icon}else{item._icon=root.classNames.icon+" "+root.classNames.icon+"-"+item.icon}}if(typeof item._icon==="string"){$t.addClass(item._icon)}else{$t.prepend(item._icon)}}}item.$input=$input;item.$label=$label;$t.appendTo(opt.$menu);if(!opt.hasTypes&&$.support.eventSelectstart){$t.on("selectstart.disableTextSelect",handle.abortevent)}});if(!opt.$node){opt.$menu.css("display","none").addClass("context-menu-root")}opt.$menu.appendTo(opt.appendTo||document.body)},resize:function($menu,nested){var domMenu;$menu.css({position:"absolute",display:"block"});$menu.data("width",(domMenu=$menu.get(0)).getBoundingClientRect?Math.ceil(domMenu.getBoundingClientRect().width):$menu.outerWidth()+1);$menu.css({position:"static",minWidth:"0px",maxWidth:"100000px"});$menu.find("> li > ul").each(function(){op.resize($(this),true)});if(!nested){$menu.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return $(this).data("width")})}},update:function(opt,root){var $trigger=this;if(typeof root==="undefined"){root=opt;op.resize(opt.$menu)}var hasVisibleItems=false;opt.$menu.children().each(function(){var $item=$(this),key=$item.data("contextMenuKey"),item=opt.items[key],disabled=$.isFunction(item.disabled)&&item.disabled.call($trigger,key,root)||item.disabled===true,visible;if($.isFunction(item.visible)){visible=item.visible.call($trigger,key,root)}else if(typeof item.visible!=="undefined"){visible=item.visible===true}else{visible=true}if(visible){hasVisibleItems=true}$item[visible?"show":"hide"]();$item[disabled?"addClass":"removeClass"](root.classNames.disabled);if($.isFunction(item.icon)){$item.removeClass(item._icon);var iconResult=item.icon.call(this,$trigger,$item,key,item);if(typeof iconResult==="string"){$item.addClass(iconResult)}else{$item.prepend(iconResult)}}if(item.type){$item.find("input, select, textarea").prop("disabled",disabled);switch(item.type){case"text":case"textarea":item.$input.val(item.value||"");break;case"checkbox":case"radio":item.$input.val(item.value||"").prop("checked",!!item.selected);break;case"select":item.$input.val((item.selected===0?"0":item.selected)||"");break}}if(item.$menu){var subMenuHasVisibleItems=op.update.call($trigger,item,root);if(subMenuHasVisibleItems){hasVisibleItems=true}}});return hasVisibleItems},layer:function(opt,zIndex){var $layer=opt.$layer=$('<div id="context-menu-layer"></div>').css({height:$win.height(),width:$win.width(),display:"block",position:"fixed","z-index":zIndex,top:0,left:0,opacity:0,filter:"alpha(opacity=0)","background-color":"#000"}).data("contextMenuRoot",opt).insertBefore(this).on("contextmenu",handle.abortevent).on("mousedown",handle.layerClick);if(typeof document.body.style.maxWidth==="undefined"){$layer.css({position:"absolute",height:$(document).height()})}return $layer},processPromises:function(opt,root,promise){opt.$node.addClass(root.classNames.iconLoadingClass);function completedPromise(opt,root,items){if(typeof items==="undefined"){errorPromise(undefined)}finishPromiseProcess(opt,root,items)}function errorPromise(opt,root,errorItem){if(typeof errorItem==="undefined"){errorItem={error:{name:"No items and no error item",icon:"context-menu-icon context-menu-icon-quit"}};if(window.console){(console.error||console.log).call(console,'When you reject a promise, provide an "items" object, equal to normal sub-menu items')}}else if(typeof errorItem==="string"){errorItem={error:{name:errorItem}}}finishPromiseProcess(opt,root,errorItem)}function finishPromiseProcess(opt,root,items){if(typeof root.$menu==="undefined"||!root.$menu.is(":visible")){return}opt.$node.removeClass(root.classNames.iconLoadingClass);opt.items=items;op.create(opt,root,true);op.update(opt,root);root.positionSubmenu.call(opt.$node,opt.$menu)}promise.then(completedPromise.bind(this,opt,root),errorPromise.bind(this,opt,root))},activated:function(opt){var $menu=opt.$menu;var $menuOffset=$menu.offset();var winHeight=$(window).height();var winScrollTop=$(window).scrollTop();var menuHeight=$menu.height();if(menuHeight>winHeight){$menu.css({height:winHeight+"px","overflow-x":"hidden","overflow-y":"auto",top:winScrollTop+"px"})}else if($menuOffset.top<winScrollTop||$menuOffset.top+menuHeight>winScrollTop+winHeight){$menu.css({top:"0px"})}}};function splitAccesskey(val){var t=val.split(/\s+/);var keys=[];for(var i=0,k;k=t[i];i++){k=k.charAt(0).toUpperCase();keys.push(k)}return keys}$.fn.contextMenu=function(operation){var $t=this,$o=operation;if(this.length>0){if(typeof operation==="undefined"){this.first().trigger("contextmenu")}else if(typeof operation.x!=="undefined"&&typeof operation.y!=="undefined"){this.first().trigger($.Event("contextmenu",{pageX:operation.x,pageY:operation.y,mouseButton:operation.button}))}else if(operation==="hide"){var $menu=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;if($menu){$menu.trigger("contextmenu:hide")}}else if(operation==="destroy"){$.contextMenu("destroy",{context:this})}else if($.isPlainObject(operation)){operation.context=this;$.contextMenu("create",operation)}else if(operation){this.removeClass("context-menu-disabled")}else if(!operation){this.addClass("context-menu-disabled")}}else{$.each(menus,function(){if(this.selector===$t.selector){$o.data=this;$.extend($o.data,{trigger:"demand"})}});handle.contextmenu.call($o.target,$o)}return this};$.contextMenu=function(operation,options){if(typeof operation!=="string"){options=operation;operation="create"}if(typeof options==="string"){options={selector:options}}else if(typeof options==="undefined"){options={}}var o=$.extend(true,{},defaults,options||{});var $document=$(document);var $context=$document;var _hasContext=false;if(!o.context||!o.context.length){o.context=document}else{$context=$(o.context).first();o.context=$context.get(0);_hasContext=!$(o.context).is(document)}switch(operation){case"update":if(_hasContext){op.update($context)}else{for(var menu in menus){if(menus.hasOwnProperty(menu)){op.update(menus[menu])}}}break;case"create":if(!o.selector){throw new Error("No selector specified")}if(o.selector.match(/.context-menu-(list|item|input)($|\s)/)){throw new Error('Cannot bind to selector "'+o.selector+'" as it contains a reserved className')}if(!o.build&&(!o.items||$.isEmptyObject(o.items))){throw new Error("No Items specified")}counter++;o.ns=".contextMenu"+counter;if(!_hasContext){namespaces[o.selector]=o.ns}menus[o.ns]=o;if(!o.trigger){o.trigger="right"}if(!initialized){var itemClick=o.itemClickEvent==="click"?"click.contextMenu":"mouseup.contextMenu";var contextMenuItemObj={"contextmenu:focus.contextMenu":handle.focusItem,"contextmenu:blur.contextMenu":handle.blurItem,"contextmenu.contextMenu":handle.abortevent,"mouseenter.contextMenu":handle.itemMouseenter,"mouseleave.contextMenu":handle.itemMouseleave};contextMenuItemObj[itemClick]=handle.itemClick;$document.on({"contextmenu:hide.contextMenu":handle.hideMenu,"prevcommand.contextMenu":handle.prevItem,"nextcommand.contextMenu":handle.nextItem,"contextmenu.contextMenu":handle.abortevent,"mouseenter.contextMenu":handle.menuMouseenter,"mouseleave.contextMenu":handle.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",handle.inputClick).on(contextMenuItemObj,".context-menu-item");initialized=true}$context.on("contextmenu"+o.ns,o.selector,o,handle.contextmenu);if(_hasContext){$context.on("remove"+o.ns,function(){$(this).contextMenu("destroy")})}switch(o.trigger){case"hover":$context.on("mouseenter"+o.ns,o.selector,o,handle.mouseenter).on("mouseleave"+o.ns,o.selector,o,handle.mouseleave);break;case"left":$context.on("click"+o.ns,o.selector,o,handle.click);break;case"touchstart":$context.on("touchstart"+o.ns,o.selector,o,handle.click);break}if(!o.build){op.create(o)}break;case"destroy":var $visibleMenu;if(_hasContext){var context=o.context;$.each(menus,function(ns,o){if(!o){return true}if(!$(context).is(o.selector)){return true}$visibleMenu=$(".context-menu-list").filter(":visible");if($visibleMenu.length&&$visibleMenu.data().contextMenuRoot.$trigger.is($(o.context).find(o.selector))){$visibleMenu.trigger("contextmenu:hide",{force:true})}try{if(menus[o.ns].$menu){menus[o.ns].$menu.remove()}delete menus[o.ns]}catch(e){menus[o.ns]=null}$(o.context).off(o.ns);return true})}else if(!o.selector){$document.off(".contextMenu .contextMenuAutoHide");$.each(menus,function(ns,o){$(o.context).off(o.ns)});namespaces={};menus={};counter=0;initialized=false;$("#context-menu-layer, .context-menu-list").remove()}else if(namespaces[o.selector]){$visibleMenu=$(".context-menu-list").filter(":visible");if($visibleMenu.length&&$visibleMenu.data().contextMenuRoot.$trigger.is(o.selector)){$visibleMenu.trigger("contextmenu:hide",{force:true})}try{if(menus[namespaces[o.selector]].$menu){menus[namespaces[o.selector]].$menu.remove()}delete menus[namespaces[o.selector]]}catch(e){menus[namespaces[o.selector]]=null}$document.off(namespaces[o.selector])}break;case"html5":if(!$.support.htmlCommand&&!$.support.htmlMenuitem||typeof options==="boolean"&&options){$('menu[type="context"]').each(function(){if(this.id){$.contextMenu({selector:"[contextmenu="+this.id+"]",items:$.contextMenu.fromMenu(this)})}}).css("display","none")}break;default:throw new Error('Unknown operation "'+operation+'"')}return this};$.contextMenu.setInputValues=function(opt,data){if(typeof data==="undefined"){data={}}$.each(opt.inputs,function(key,item){switch(item.type){case"text":case"textarea":item.value=data[key]||"";break;case"checkbox":item.selected=data[key]?true:false;break;case"radio":item.selected=(data[item.radio]||"")===item.value;break;case"select":item.selected=data[key]||"";break}})};$.contextMenu.getInputValues=function(opt,data){if(typeof data==="undefined"){data={}}$.each(opt.inputs,function(key,item){switch(item.type){case"text":case"textarea":case"select":data[key]=item.$input.val();break;case"checkbox":data[key]=item.$input.prop("checked");break;case"radio":if(item.$input.prop("checked")){data[item.radio]=item.value}break}});return data};function inputLabel(node){return node.id&&$('label[for="'+node.id+'"]').val()||node.name}function menuChildren(items,$children,counter){if(!counter){counter=0}$children.each(function(){var $node=$(this),node=this,nodeName=this.nodeName.toLowerCase(),label,item;if(nodeName==="label"&&$node.find("input, textarea, select").length){label=$node.text();$node=$node.children().first();node=$node.get(0);nodeName=node.nodeName.toLowerCase()}switch(nodeName){case"menu":item={name:$node.attr("label"),items:{}};counter=menuChildren(item.items,$node.children(),counter);break;case"a":case"button":item={name:$node.text(),disabled:!!$node.attr("disabled"),callback:function(){return function(){$node.get(0).click()}}()};break;case"menuitem":case"command":switch($node.attr("type")){case undefined:case"command":case"menuitem":item={name:$node.attr("label"),disabled:!!$node.attr("disabled"),icon:$node.attr("icon"),callback:function(){return function(){$node.get(0).click()}}()};break;case"checkbox":item={type:"checkbox",disabled:!!$node.attr("disabled"),name:$node.attr("label"),selected:!!$node.attr("checked")};break;case"radio":item={type:"radio",disabled:!!$node.attr("disabled"),name:$node.attr("label"),radio:$node.attr("radiogroup"),value:$node.attr("id"),selected:!!$node.attr("checked")};break;default:item=undefined}break;case"hr":item="-------";break;case"input":switch($node.attr("type")){case"text":item={type:"text",name:label||inputLabel(node),disabled:!!$node.attr("disabled"),value:$node.val()};break;case"checkbox":item={type:"checkbox",name:label||inputLabel(node),disabled:!!$node.attr("disabled"),selected:!!$node.attr("checked")};break;case"radio":item={type:"radio",name:label||inputLabel(node),disabled:!!$node.attr("disabled"),radio:!!$node.attr("name"),value:$node.val(),selected:!!$node.attr("checked")};break;default:item=undefined;break}break;case"select":item={type:"select",name:label||inputLabel(node),disabled:!!$node.attr("disabled"),selected:$node.val(),options:{}};$node.children().each(function(){item.options[this.value]=$(this).text()});break;case"textarea":item={type:"textarea",name:label||inputLabel(node),disabled:!!$node.attr("disabled"),value:$node.val()};break;case"label":break;default:item={type:"html",html:$node.clone(true)};break}if(item){counter++;items["key"+counter]=item}});return counter}$.contextMenu.fromMenu=function(element){var $this=$(element),items={};menuChildren(items,$this.children());return items};$.contextMenu.defaults=defaults;$.contextMenu.types=types;$.contextMenu.handle=handle;$.contextMenu.op=op;$.contextMenu.menus=menus})},{jquery:70}],65:[function(require,module,exports){(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory(jQuery)}})(function($){$.ui=$.ui||{};$.extend($.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});$.fn.extend({scrollParent:function(includeHidden){var position=this.css("position"),excludeStaticParent=position==="absolute",overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);if(excludeStaticParent&&parent.css("position")==="static"){return false}return overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return position==="fixed"||!scrollParent.length?$(this[0].ownerDocument||document):scrollParent},uniqueId:function(){var uuid=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+ ++uuid}})}}(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){$(this).removeAttr("id")}})}});function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();if("area"===nodeName){map=element.parentNode;mapName=map.name;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false}img=$("img[usemap='#"+mapName+"']")[0];return!!img&&visible(img)}return(/^(input|select|textarea|button|object)$/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return $.css(this,"visibility")==="hidden"}).length}$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}});if(!$("<a>").outerWidth(1).jquery){$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0;if(border){size-=parseFloat($.css(elem,"border"+this+"Width"))||0}if(margin){size-=parseFloat($.css(elem,"margin"+this))||0}});return size}$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this)}return this.each(function(){$(this).css(type,reduce(this,size)+"px")})};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size)}return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px")})}})}if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}}if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){$.fn.removeData=function(removeData){return function(key){if(arguments.length){return removeData.call(this,$.camelCase(key))}else{return removeData.call(this)}}}($.fn.removeData)}$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());$.fn.extend({focus:function(orig){return function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem)}},delay)}):orig.apply(this,arguments)}}($.fn.focus),disableSelection:function(){var eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(eventType+".ui-disableSelection",function(event){event.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex)}if(this.length){var elem=$(this[0]),position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value}}elem=elem.parent()}}return 0}});$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]])}},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(!set){return}if(!allowDisconnected&&(!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11)){return}for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args)}}}}})},{}],66:[function(require,module,exports){(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./widget"],factory)}else{factory(jQuery)}})(function($){var mouseHandled=false;$(document).mouseup(function(){mouseHandled=false});return $.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).bind("click."+this.widgetName,function(event){if(true===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(event){if(mouseHandled){return}this._mouseMoved=false;this._mouseStarted&&this._mouseUp(event);this._mouseDownEvent=event;var that=this,btnIsLeft=event.which===1,elIsCancel=typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false;if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=this._mouseStart(event)!==false;if(!this._mouseStarted){event.preventDefault();return true}}if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(event){return that._mouseMove(event)};this._mouseUpDelegate=function(event){return that._mouseUp(event)};this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){return this._mouseUp(event)}else if(!event.which){return this._mouseUp(event)}}if(event.which||event.button){this._mouseMoved=true}if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault()}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,event)!==false;this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)}return!this._mouseStarted},_mouseUp:function(event){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target===this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(event)}mouseHandled=false;return false},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})},{}],67:[function(require,module,exports){(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./mouse","./widget"],factory)}else{factory(jQuery)}})(function($){return $.widget("ui.slider",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this._calculateNewMax();this.element.addClass("ui-slider"+" ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=false},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),handle="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",handles=[];handleCount=options.values&&options.values.length||1;if(existingHandles.length>handleCount){existingHandles.slice(handleCount).remove();existingHandles=existingHandles.slice(0,handleCount)}for(i=existingHandles.length;i<handleCount;i++){handles.push(handle)}this.handles=existingHandles.add($(handles.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(i){$(this).data("ui-slider-handle-index",i)})},_createRange:function(){var options=this.options,classes="";if(options.range){if(options.range===true){if(!options.values){options.values=[this._valueMin(),this._valueMin()]}else if(options.values.length&&options.values.length!==2){options.values=[options.values[0],options.values[0]]}else if($.isArray(options.values)){options.values=options.values.slice(0)}}if(!this.range||!this.range.length){this.range=$("<div></div>").appendTo(this.element);classes="ui-slider-range"+" ui-widget-header ui-corner-all"}else{this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""})}this.range.addClass(classes+(options.range==="min"||options.range==="max"?" ui-slider-range-"+options.range:""))}else{if(this.range){this.range.remove()}this.range=null}},_setupEvents:function(){this._off(this.handles);this._on(this.handles,this._handleEvents);this._hoverable(this.handles);this._focusable(this.handles)},_destroy:function(){this.handles.remove();if(this.range){this.range.remove()}this.element.removeClass("ui-slider"+" ui-slider-horizontal"+" ui-slider-vertical"+" ui-widget"+" ui-widget-content"+" ui-corner-all");this._mouseDestroy()},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,allowed,offset,mouseOverHandle,that=this,o=this.options;if(o.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();position={x:event.pageX,y:event.pageY};normValue=this._normValueFromMouse(position);distance=this._valueMax()-this._valueMin()+1;this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));if(distance>thisDistance||distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min)){distance=thisDistance;closestHandle=$(this);index=i}});allowed=this._start(event,index);if(allowed===false){return false}this._mouseSliding=true;this._handleIndex=index;closestHandle.addClass("ui-state-active").focus();offset=closestHandle.offset();mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-closestHandle.width()/2,top:event.pageY-offset.top-closestHandle.height()/2-(parseInt(closestHandle.css("borderTopWidth"),10)||0)-(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+(parseInt(closestHandle.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(event,index,normValue)}this._animateOff=true;return true},_mouseStart:function(){return true},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);this._slide(event,this._handleIndex,normValue);return false},_mouseStop:function(event){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(event,this._handleIndex);this._change(event,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;if(this.orientation==="horizontal"){pixelTotal=this.elementSize.width;pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{pixelTotal=this.elementSize.height;pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}percentMouse=pixelMouse/pixelTotal;if(percentMouse>1){percentMouse=1}if(percentMouse<0){percentMouse=0}if(this.orientation==="vertical"){percentMouse=1-percentMouse}valueTotal=this._valueMax()-this._valueMin();valueMouse=this._valueMin()+percentMouse*valueTotal;return this._trimAlignValue(valueMouse)},_start:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}return this._trigger("start",event,uiHash)},_slide:function(event,index,newVal){var otherVal,newValues,allowed;if(this.options.values&&this.options.values.length){otherVal=this.values(index?0:1);if(this.options.values.length===2&&this.options.range===true&&(index===0&&newVal>otherVal||index===1&&newVal<otherVal)){newVal=otherVal}if(newVal!==this.values(index)){newValues=this.values();newValues[index]=newVal;allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal,values:newValues});otherVal=this.values(index?0:1);if(allowed!==false){this.values(index,newVal)}}}else{if(newVal!==this.value()){allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal});if(allowed!==false){this.value(newVal)}}}},_stop:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}this._trigger("stop",event,uiHash)},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}this._lastChangedValue=index;this._trigger("change",event,uiHash)}},value:function(newValue){if(arguments.length){this.options.value=this._trimAlignValue(newValue);this._refreshValue();this._change(null,0);return}return this._value()},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1){this.options.values[index]=this._trimAlignValue(newValue);this._refreshValue();this._change(null,index);return}if(arguments.length){if($.isArray(arguments[0])){vals=this.options.values;newValues=arguments[0];for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(newValues[i]);this._change(null,i)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(index)}else{return this.value()}}}else{return this._values()}},_setOption:function(key,value){var i,valsLength=0;if(key==="range"&&this.options.range===true){if(value==="min"){this.options.value=this._values(0);this.options.values=null}else if(value==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null}}if($.isArray(this.options.values)){valsLength=this.options.values.length}if(key==="disabled"){this.element.toggleClass("ui-state-disabled",!!value)}this._super(key,value);switch(key){case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();this.handles.css(value==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(i=0;i<valsLength;i+=1){this._change(null,i)}this._animateOff=false;break;case"step":case"min":case"max":this._animateOff=true;this._calculateNewMax();this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break}},_value:function(){var val=this.options.value;val=this._trimAlignValue(val);return val},_values:function(index){var val,vals,i;if(arguments.length){val=this.options.values[index];val=this._trimAlignValue(val);return val}else if(this.options.values&&this.options.values.length){vals=this.options.values.slice();for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(vals[i])}return vals}else{return[]}},_trimAlignValue:function(val){if(val<=this._valueMin()){return this._valueMin()}if(val>=this._valueMax()){return this._valueMax()}var step=this.options.step>0?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;if(Math.abs(valModStep)*2>=step){alignValue+=valModStep>0?step:-step}return parseFloat(alignValue.toFixed(5))},_calculateNewMax:function(){var max=this.options.max,min=this._valueMin(),step=this.options.step,aboveMin=Math.floor(+(max-min).toFixed(this._precision())/step)*step;max=aboveMin+min;this.max=parseFloat(max.toFixed(this._precision()))},_precision:function(){var precision=this._precisionOf(this.options.step);if(this.options.min!==null){precision=Math.max(precision,this._precisionOf(this.options.min))}return precision},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return decimal===-1?0:str.length-decimal-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=!this._animateOff?o.animate:false,_set={};if(this.options.values&&this.options.values.length){this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100;_set[that.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate);if(that.options.range===true){if(that.orientation==="horizontal"){if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate)}if(i===1){that.range[animate?"animate":"css"]({width:valPercent-lastValPercent+"%"},{queue:false,duration:o.animate})}}else{if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({bottom:valPercent+"%"},o.animate)}if(i===1){that.range[animate?"animate":"css"]({height:valPercent-lastValPercent+"%"},{queue:false,duration:o.animate})}}}lastValPercent=valPercent})}else{value=this.value();valueMin=this._valueMin();valueMax=this._valueMax();valPercent=valueMax!==valueMin?(value-valueMin)/(valueMax-valueMin)*100:0;_set[this.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate);if(oRange==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate)}if(oRange==="max"&&this.orientation==="horizontal"){this.range[animate?"animate":"css"]({width:100-valPercent+"%"},{queue:false,duration:o.animate})}if(oRange==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate)}if(oRange==="max"&&this.orientation==="vertical"){this.range[animate?"animate":"css"]({height:100-valPercent+"%"},{queue:false,duration:o.animate})}}},_handleEvents:{keydown:function(event){var allowed,curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:event.preventDefault();if(!this._keySliding){this._keySliding=true;$(event.target).addClass("ui-state-active");allowed=this._start(event,index);if(allowed===false){return}}break}step=this.options.step;if(this.options.values&&this.options.values.length){curVal=newVal=this.values(index)}else{curVal=newVal=this.value()}switch(event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax()){return}newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin()){return}newVal=this._trimAlignValue(curVal-step);break}this._slide(event,index,newVal)},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(event,index);this._change(event,index);$(event.target).removeClass("ui-state-active")}}}})})},{}],68:[function(require,module,exports){(function(factory){if(typeof define==="function"&&define.amd){define(["jquery","./core","./widget"],factory)}else{factory(jQuery)}})(function($){return $.widget("ui.tabs",{version:"1.11.4",delay:300,options:{active:null,collapsible:false,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var rhash=/#.*$/;return function(anchor){var anchorUrl,locationUrl;anchor=anchor.cloneNode(false);anchorUrl=anchor.href.replace(rhash,"");locationUrl=location.href.replace(rhash,"");try{anchorUrl=decodeURIComponent(anchorUrl)}catch(error){}try{locationUrl=decodeURIComponent(locationUrl)}catch(error){}return anchor.hash.length>1&&anchorUrl===locationUrl}}(),_create:function(){var that=this,options=this.options;this.running=false;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",options.collapsible);this._processTabs();options.active=this._initialActive();if($.isArray(options.disabled)){options.disabled=$.unique(options.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(li){return that.tabs.index(li)}))).sort()}if(this.options.active!==false&&this.anchors.length){this.active=this._findActive(options.active)}else{this.active=$()}this._refresh();if(this.active.length){this.load(options.active)}},_initialActive:function(){var active=this.options.active,collapsible=this.options.collapsible,locationHash=location.hash.substring(1);if(active===null){if(locationHash){this.tabs.each(function(i,tab){if($(tab).attr("aria-controls")===locationHash){active=i;return false}})}if(active===null){active=this.tabs.index(this.tabs.filter(".ui-tabs-active"))}if(active===null||active===-1){active=this.tabs.length?0:false}}if(active!==false){active=this.tabs.index(this.tabs.eq(active));if(active===-1){active=collapsible?false:0}}if(!collapsible&&active===false&&this.anchors.length){active=0}return active},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?$():this._getPanelForTab(this.active)}},_tabKeydown:function(event){var focusedTab=$(this.document[0].activeElement).closest("li"),selectedIndex=this.tabs.index(focusedTab),goingForward=true;if(this._handlePageNav(event)){return}switch(event.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:selectedIndex++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:goingForward=false;selectedIndex--;break;case $.ui.keyCode.END:selectedIndex=this.anchors.length-1;break;case $.ui.keyCode.HOME:selectedIndex=0;break;case $.ui.keyCode.SPACE:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex);return;case $.ui.keyCode.ENTER:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex===this.options.active?false:selectedIndex);return;default:return}event.preventDefault();clearTimeout(this.activating);selectedIndex=this._focusNextTab(selectedIndex,goingForward);if(!event.ctrlKey&&!event.metaKey){focusedTab.attr("aria-selected","false");this.tabs.eq(selectedIndex).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",selectedIndex)},this.delay)}},_panelKeydown:function(event){if(this._handlePageNav(event)){return}if(event.ctrlKey&&event.keyCode===$.ui.keyCode.UP){event.preventDefault();this.active.focus()}},_handlePageNav:function(event){if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,false));return true}if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,true));return true}},_findNextTab:function(index,goingForward){var lastTabIndex=this.tabs.length-1;function constrain(){if(index>lastTabIndex){index=0}if(index<0){index=lastTabIndex}return index}while($.inArray(constrain(),this.options.disabled)!==-1){index=goingForward?index+1:index-1}return index},_focusNextTab:function(index,goingForward){index=this._findNextTab(index,goingForward);this.tabs.eq(index).focus();return index},_setOption:function(key,value){if(key==="active"){this._activate(value);return}if(key==="disabled"){this._setupDisabled(value);return}this._super(key,value);if(key==="collapsible"){this.element.toggleClass("ui-tabs-collapsible",value);if(!value&&this.options.active===false){this._activate(0)}}if(key==="event"){this._setupEvents(value)}if(key==="heightStyle"){this._setupHeightStyle(value)}},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var options=this.options,lis=this.tablist.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab)});this._processTabs();if(options.active===false||!this.anchors.length){options.active=false;this.active=$()}else if(this.active.length&&!$.contains(this.tablist[0],this.active[0])){if(this.tabs.length===options.disabled.length){options.active=false;this.active=$()}else{this._activate(this._findNextTab(Math.max(0,options.active-1),false))}}else{options.active=this.tabs.index(this.active)}this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"});if(!this.active.length){this.tabs.eq(0).attr("tabIndex",0)}else{this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})}},_processTabs:function(){var that=this,prevTabs=this.tabs,prevAnchors=this.anchors,prevPanels=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(event){if($(this).is(".ui-state-disabled")){event.preventDefault()}}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){if($(this).closest("li").is(".ui-state-disabled")){this.blur()}});this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return $("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=$();this.anchors.each(function(i,anchor){var selector,panel,panelId,anchorId=$(anchor).uniqueId().attr("id"),tab=$(anchor).closest("li"),originalAriaControls=tab.attr("aria-controls");if(that._isLocal(anchor)){selector=anchor.hash;panelId=selector.substring(1);panel=that.element.find(that._sanitizeSelector(selector))}else{panelId=tab.attr("aria-controls")||$({}).uniqueId()[0].id;selector="#"+panelId;panel=that.element.find(selector);if(!panel.length){panel=that._createPanel(panelId);panel.insertAfter(that.panels[i-1]||that.tablist)}panel.attr("aria-live","polite")}if(panel.length){that.panels=that.panels.add(panel)}if(originalAriaControls){tab.data("ui-tabs-aria-controls",originalAriaControls)}tab.attr({"aria-controls":panelId,"aria-labelledby":anchorId});panel.attr("aria-labelledby",anchorId)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel");if(prevTabs){this._off(prevTabs.not(this.tabs));this._off(prevAnchors.not(this.anchors));this._off(prevPanels.not(this.panels))}},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(id){return $("<div>").attr("id",id).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",true)},_setupDisabled:function(disabled){if($.isArray(disabled)){if(!disabled.length){disabled=false}else if(disabled.length===this.anchors.length){disabled=true}}for(var i=0,li;li=this.tabs[i];i++){if(disabled===true||$.inArray(i,disabled)!==-1){$(li).addClass("ui-state-disabled").attr("aria-disabled","true")}else{$(li).removeClass("ui-state-disabled").removeAttr("aria-disabled")}}this.options.disabled=disabled},_setupEvents:function(event){var events={};if(event){$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"})}this._off(this.anchors.add(this.tabs).add(this.panels));this._on(true,this.anchors,{click:function(event){event.preventDefault()}});this._on(this.anchors,events);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(heightStyle){var maxHeight,parent=this.element.parent();if(heightStyle==="fill"){maxHeight=parent.height();maxHeight-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return}maxHeight-=elem.outerHeight(true)});this.element.children().not(this.panels).each(function(){maxHeight-=$(this).outerHeight(true)});this.panels.each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")}else if(heightStyle==="auto"){maxHeight=0;this.panels.each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height())}).height(maxHeight)}},_eventHandler:function(event){var options=this.options,active=this.active,anchor=$(event.currentTarget),tab=anchor.closest("li"),clickedIsActive=tab[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():this._getPanelForTab(tab),toHide=!active.length?$():this._getPanelForTab(active),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():tab,newPanel:toShow};event.preventDefault();if(tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||this.running||clickedIsActive&&!options.collapsible||this._trigger("beforeActivate",event,eventData)===false){return}options.active=collapsing?false:this.tabs.index(tab);this.active=clickedIsActive?$():tab;if(this.xhr){this.xhr.abort()}if(!toHide.length&&!toShow.length){$.error("jQuery UI Tabs: Mismatching fragment identifier.")}if(toShow.length){this.load(this.tabs.index(tab),event)}this._toggle(event,eventData)},_toggle:function(event,eventData){var that=this,toShow=eventData.newPanel,toHide=eventData.oldPanel;this.running=true;function complete(){that.running=false;that._trigger("activate",event,eventData)}function show(){eventData.newTab.closest("li").addClass("ui-tabs-active ui-state-active");if(toShow.length&&that.options.show){that._show(toShow,that.options.show,complete)}else{toShow.show();complete()}}if(toHide.length&&this.options.hide){this._hide(toHide,this.options.hide,function(){eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");show()})}else{eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");toHide.hide();show()}toHide.attr("aria-hidden","true");eventData.oldTab.attr({"aria-selected":"false","aria-expanded":"false"});if(toShow.length&&toHide.length){eventData.oldTab.attr("tabIndex",-1)}else if(toShow.length){this.tabs.filter(function(){return $(this).attr("tabIndex")===0}).attr("tabIndex",-1)}toShow.attr("aria-hidden","false");eventData.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(index){var anchor,active=this._findActive(index);if(active[0]===this.active[0]){return}if(!active.length){active=this.active}anchor=active.find(".ui-tabs-anchor")[0];this._eventHandler({target:anchor,currentTarget:anchor,preventDefault:$.noop})},_findActive:function(index){return index===false?$():this.tabs.eq(index)},_getIndex:function(index){if(typeof index==="string"){index=this.anchors.index(this.anchors.filter("[href$='"+index+"']"))}return index},_destroy:function(){if(this.xhr){this.xhr.abort()}this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();this.tablist.unbind(this.eventNamespace);this.tabs.add(this.panels).each(function(){if($.data(this,"ui-tabs-destroy")){$(this).remove()}else{$(this).removeClass("ui-state-default ui-state-active ui-state-disabled "+"ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}});this.tabs.each(function(){var li=$(this),prev=li.data("ui-tabs-aria-controls");if(prev){li.attr("aria-controls",prev).removeData("ui-tabs-aria-controls")}else{li.removeAttr("aria-controls")}});this.panels.show();if(this.options.heightStyle!=="content"){this.panels.css("height","")}},enable:function(index){var disabled=this.options.disabled;if(disabled===false){return}if(index===undefined){disabled=false}else{index=this._getIndex(index);if($.isArray(disabled)){disabled=$.map(disabled,function(num){return num!==index?num:null})}else{disabled=$.map(this.tabs,function(li,num){return num!==index?num:null})}}this._setupDisabled(disabled)},disable:function(index){var disabled=this.options.disabled;if(disabled===true){return}if(index===undefined){disabled=true}else{index=this._getIndex(index);if($.inArray(index,disabled)!==-1){return}if($.isArray(disabled)){disabled=$.merge([index],disabled).sort()}else{disabled=[index]}}this._setupDisabled(disabled)},load:function(index,event){index=this._getIndex(index);var that=this,tab=this.tabs.eq(index),anchor=tab.find(".ui-tabs-anchor"),panel=this._getPanelForTab(tab),eventData={tab:tab,panel:panel},complete=function(jqXHR,status){if(status==="abort"){that.panels.stop(false,true)}tab.removeClass("ui-tabs-loading");panel.removeAttr("aria-busy");if(jqXHR===that.xhr){delete that.xhr}};if(this._isLocal(anchor[0])){return}this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData));if(this.xhr&&this.xhr.statusText!=="canceled"){tab.addClass("ui-tabs-loading");panel.attr("aria-busy","true");this.xhr.done(function(response,status,jqXHR){setTimeout(function(){panel.html(response);that._trigger("load",event,eventData);complete(jqXHR,status)},1)}).fail(function(jqXHR,status){setTimeout(function(){complete(jqXHR,status)},1)})}},_ajaxSettings:function(anchor,event,eventData){var that=this;return{url:anchor.attr("href"),beforeSend:function(jqXHR,settings){return that._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData))}}},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id))}})})},{}],69:[function(require,module,exports){(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory(jQuery)}})(function($){var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=function(orig){return function(elems){var events,elem,i;for(i=0;(elem=elems[i])!=null;i++){try{events=$._data(elem,"events");if(events&&events.remove){$(elem).triggerHandler("remove")}}catch(e){}}orig(elems)}}($.cleanData);$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget}$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element)}if(arguments.length){this._createWidget(options,element)}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base;basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return}proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}}()});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)});delete existingConstructor._childConstructors}else{base._childConstructors.push(constructor)}$.widget.bridge(name,constructor);return constructor};$.widget.extend=function(target){var input=widget_slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value)}else{target[key]=value}}}}return target};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=widget_slice.call(arguments,1),returnValue=this;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(options==="instance"){returnValue=instance;return false}if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'")}if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance")}methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false}})}else{if(args.length){options=$.widget.extend.apply(null,[options].concat(args))}this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{});if(instance._init){instance._init()}}else{$.data(this,fullName,new object(options,this))}})}return returnValue}};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=widget_uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy()}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options)}if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key]}curOption[key]=value}else{if(arguments.length===1){return this.options[key]===undefined?null:this.options[key]}options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key])}return this},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!value);if(value){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}}return this},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false}if(!handlers){handlers=element;element=this.element;delegateElement=this.widget()}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element)}$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return}return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++}var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy)}else{element.bind(eventName,handlerProxy)}})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.unbind(eventName).undelegate(eventName);this.bindings=$(this.bindings.not(element).get());this.focusable=$(this.focusable.not(element).get());this.hoverable=$(this.hoverable.not(element).get())},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop]}}}this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented())}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options}}var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options}}hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay)}if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options)}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback)}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0])}next()})}}});return $.widget})},{}],70:[function(require,module,exports){(function(global,factory){"use strict";if(typeof module==="object"&&typeof module.exports==="object"){module.exports=global.document?factory(global,true):function(w){if(!w.document){throw new Error("jQuery requires a window with a document")}return factory(w)}}else{factory(global)}})(typeof window!=="undefined"?window:this,function(window,noGlobal){"use strict";var arr=[];var document=window.document;var getProto=Object.getPrototypeOf;var slice=arr.slice;var concat=arr.concat;var push=arr.push;var indexOf=arr.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var fnToString=hasOwn.toString;var ObjectFunctionString=fnToString.call(Object);var support={};var isFunction=function isFunction(obj){return typeof obj==="function"&&typeof obj.nodeType!=="number"};var isWindow=function isWindow(obj){return obj!=null&&obj===obj.window};var preservedScriptAttributes={type:true,src:true,noModule:true};function DOMEval(code,doc,node){doc=doc||document;var i,script=doc.createElement("script");script.text=code;if(node){for(i in preservedScriptAttributes){if(node[i]){script[i]=node[i]}}}doc.head.appendChild(script).parentNode.removeChild(script)}function toType(obj){if(obj==null){return obj+""}return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj}var version="3.3.1",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,length:0,toArray:function(){return slice.call(this)},get:function(num){if(num==null){return slice.call(this)}return num<0?this[num+this.length]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;return ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice};jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++}if(typeof target!=="object"&&!isFunction(target)){target={}}if(i===length){target=this;i--}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&Array.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}return target};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function(msg){throw new Error(msg)},noop:function(){},isPlainObject:function(obj){var proto,Ctor;if(!obj||toString.call(obj)!=="[object Object]"){return false}proto=getProto(obj);if(!proto){return true}Ctor=hasOwn.call(proto,"constructor")&&proto.constructor;return typeof Ctor==="function"&&fnToString.call(Ctor)===ObjectFunctionString},isEmptyObject:function(obj){var name;for(name in obj){return false}return true},globalEval:function(code){DOMEval(code)},each:function(obj,callback){var length,i=0;if(isArrayLike(obj)){length=obj.length;for(;i<length;i++){if(callback.call(obj[i],i,obj[i])===false){break}}}else{for(i in obj){if(callback.call(obj[i],i,obj[i])===false){break}}}return obj},trim:function(text){return text==null?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArrayLike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr)}else{push.call(ret,arr)}}return ret},inArray:function(elem,arr,i){return arr==null?-1:indexOf.call(arr,elem,i)},merge:function(first,second){var len=+second.length,j=0,i=first.length;for(;j<len;j++){first[i++]=second[j]}first.length=i;return first},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect){matches.push(elems[i])}}return matches},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems)){length=elems.length;for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}return concat.apply([],ret)},guid:1,support:support});if(typeof Symbol==="function"){jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]}jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=toType(obj);if(isFunction(obj)||isWindow(obj)){return false}return type==="array"||length===0||typeof length==="number"&&length>0&&length-1 in obj}var Sizzle=function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true}return 0},hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){var i=0,len=list.length;for(;i<len;i++){if(list[i]===elem){return i}}return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){if(asCodePoint){if(ch==="\0"){return"�"}return ch.slice(0,-1)+"\\"+ch.charCodeAt(ch.length-1).toString(16)+" "}return"\\"+ch},unloadHandler=function(){setDocument()},disabledAncestor=addCombinator(function(elem){return elem.disabled===true&&("form"in elem||"label"in elem)},{dir:"parentNode",next:"legend"});try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=target.length,i=0;while(target[j++]=els[i++]){}target.length=j-1}}}function Sizzle(selector,context,results,seed){var m,i,elem,nid,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;results=results||[];if(typeof selector!=="string"||!selector||nodeType!==1&&nodeType!==9&&nodeType!==11){return results}if(!seed){if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)}context=context||document;if(documentIsHTML){if(nodeType!==11&&(match=rquickExpr.exec(selector))){if(m=match[1]){if(nodeType===9){if(elem=context.getElementById(m)){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}if(support.qsa&&!compilerCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nodeType!==1){newContext=context;newSelector=selector}else if(context.nodeName.toLowerCase()!=="object"){if(nid=context.getAttribute("id")){nid=nid.replace(rcssescape,fcssescape)}else{context.setAttribute("id",nid=expando)}groups=tokenize(selector);i=groups.length;while(i--){groups[i]="#"+nid+" "+toSelector(groups[i])}newSelector=groups.join(",");newContext=rsibling.test(selector)&&testContext(context.parentNode)||context}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(nid===expando){context.removeAttribute("id")}}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()]}return cache[key+" "]=value}return cache}function markFunction(fn){fn[expando]=true;return fn}function assert(fn){var el=document.createElement("fieldset");try{return!!fn(el)}catch(e){return false}finally{if(el.parentNode){el.parentNode.removeChild(el)}el=null}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=arr.length;while(i--){Expr.attrHandle[arr[i]]=handler}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&a.sourceIndex-b.sourceIndex;if(diff){return diff}if(cur){while(cur=cur.nextSibling){if(cur===b){return-1}}}return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}function createDisabledPseudo(disabled){return function(elem){if("form"in elem){if(elem.parentNode&&elem.disabled===false){if("label"in elem){if("label"in elem.parentNode){return elem.parentNode.disabled===disabled}else{return elem.disabled===disabled}}return elem.isDisabled===disabled||elem.isDisabled!==!disabled&&disabledAncestor(elem)===disabled}return elem.disabled===disabled}else if("label"in elem){return elem.disabled===disabled}return false}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[j=matchIndexes[i]]){seed[j]=!(matches[j]=seed[j])}}})})}function testContext(context){return context&&typeof context.getElementsByTagName!=="undefined"&&context}support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};setDocument=Sizzle.setDocument=function(node){var hasCompare,subWindow,doc=node?node.ownerDocument||node:preferredDoc;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document}document=doc;docElem=document.documentElement;documentIsHTML=!isXML(document);if(preferredDoc!==document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow){if(subWindow.addEventListener){subWindow.addEventListener("unload",unloadHandler,false)}else if(subWindow.attachEvent){subWindow.attachEvent("onunload",unloadHandler)}}support.attributes=assert(function(el){el.className="i";return!el.getAttribute("className")});support.getElementsByTagName=assert(function(el){el.appendChild(document.createComment(""));return!el.getElementsByTagName("*").length});support.getElementsByClassName=rnative.test(document.getElementsByClassName);support.getById=assert(function(el){docElem.appendChild(el).id=expando;return!document.getElementsByName||!document.getElementsByName(expando).length});if(support.getById){Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}};Expr.find["ID"]=function(id,context){if(typeof context.getElementById!=="undefined"&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[]}}}else{Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return node&&node.value===attrId}};Expr.find["ID"]=function(id,context){if(typeof context.getElementById!=="undefined"&&documentIsHTML){var node,i,elems,elem=context.getElementById(id);if(elem){node=elem.getAttributeNode("id");if(node&&node.value===id){return[elem]}elems=context.getElementsByName(id);i=0;while(elem=elems[i++]){node=elem.getAttributeNode("id");if(node&&node.value===id){return[elem]}}}return[]}}}Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!=="undefined"){return context.getElementsByTagName(tag)}else if(support.qsa){return context.querySelectorAll(tag)}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while(elem=results[i++]){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!=="undefined"&&documentIsHTML){return context.getElementsByClassName(className)}};rbuggyMatches=[];rbuggyQSA=[];if(support.qsa=rnative.test(document.querySelectorAll)){assert(function(el){docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a>"+"<select id='"+expando+"-\r\\' msallowcapture=''>"+"<option selected=''></option></select>";if(el.querySelectorAll("[msallowcapture^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")")}if(!el.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")")}if(!el.querySelectorAll("[id~="+expando+"-]").length){rbuggyQSA.push("~=")}if(!el.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}if(!el.querySelectorAll("a#"+expando+"+*").length){rbuggyQSA.push(".#.+[+~]")}});assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a>"+"<select disabled='disabled'><option/></select>";var input=document.createElement("input");input.setAttribute("type","hidden");el.appendChild(input).setAttribute("name","D");if(el.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=")}if(el.querySelectorAll(":enabled").length!==2){rbuggyQSA.push(":enabled",":disabled")}docElem.appendChild(el).disabled=true;if(el.querySelectorAll(":disabled").length!==2){rbuggyQSA.push(":enabled",":disabled")}el.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}if(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)){assert(function(el){support.disconnectedMatch=matches.call(el,"*");matches.call(el,"[s!='']:x");rbuggyMatches.push("!=",pseudos)})}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while(b=b.parentNode){if(b===a){return true}}}return false};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare}compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||!support.sortDetached&&b.compareDocumentPosition(a)===compare){if(a===document||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return-1}if(b===document||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1}return sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0}return compare&4?-1:1}:function(a,b){if(a===b){hasDuplicate=true;return 0}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===document?-1:b===document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0}else if(aup===bup){return siblingCheck(a,b)}cur=a;while(cur=cur.parentNode){ap.unshift(cur)}cur=b;while(cur=cur.parentNode){bp.unshift(cur)}while(ap[i]===bp[i]){i++}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return document};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)}expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&!compilerCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)}return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null};Sizzle.escape=function(sel){return(sel+"").replace(rcssescape,fcssescape)};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while(elem=results[i++]){if(elem===results[i]){j=duplicates.push(i)}}while(j--){results.splice(duplicates[j],1)}}sortInput=null;return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while(node=elem[i++]){ret+=getText(node)}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else if(nodeType===3||nodeType===4){return elem.nodeValue}return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+(match[7]+match[8]||match[3]==="odd")}else if(match[3]){Sizzle.error(match[0])}return match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null}if(match[3]){match[2]=match[4]||match[5]||""}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}return match.slice(0,3)}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!=="undefined"&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!="}if(!operator){return true}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false}},CHILD:function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=false;if(parent){if(simple){while(dir){node=elem;while(node=node[dir]){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false}}start=dir=type==="only"&&!start&&"nextSibling"}return true}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){node=parent;outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});cache=uniqueCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=nodeIndex&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if(node.nodeType===1&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}}else{if(useCache){node=elem;outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});cache=uniqueCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=nodeIndex}if(diff===false){while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});uniqueCache[type]=[dirruns,diff]}if(node===elem){break}}}}}diff-=last;return diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument)}if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if(elem=unmatched[i]){seed[i]=!(matches[i]=elem)}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);input[0]=null;return!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){text=text.replace(runescape,funescape);return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang")){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}}while((elem=elem.parentNode)&&elem.nodeType===1);return false}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:createDisabledPseudo(false),disabled:createDisabledPseudo(true),checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==="input"&&!!elem.checked||nodeName==="option"&&!!elem.selected},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false}}return true},parent:function(elem){return!Expr.pseudos["empty"](elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},text:function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text")},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i)}return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i)}return matchIndexes})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)}for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters;tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0)}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar}groups.push(tokens=[])}matched=false;if(match=rcombinators.exec(soFar)){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}}if(!matched){break}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value}return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&key==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)}}return false}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true}}}}else{while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={});if(skip&&skip===elem.nodeName.toLowerCase()){elem=elem[dir]||elem}else if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return newCache[2]=oldCache[2]}else{uniqueCache[key]=newCache;if(newCache[2]=matcher(elem,context,xml)){return true}}}}}return false}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false}}return true}:matchers[0]}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results)}return results}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if(elem=unmatched[i]){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i)}}}}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml)}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if(elem=temp[i]){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if(elem=matcherOut[i]){temp.push(matcherIn[i]=elem)}}postFinder(null,matcherOut=[],temp,xml)}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml)}else{push.apply(results,matcherOut)}}})}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,true),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));checkContext=null;return ret}];for(;i<len;i++){if(matcher=Expr.relative[tokens[i].type]){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||.1,len=elems.length;if(outermost){outermostContext=context===document||context||outermost}for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;if(!context&&elem.ownerDocument!==document){setDocument(elem);xml=!documentIsHTML}while(matcher=elementMatchers[j++]){if(matcher(elem,context||document,xml)){results.push(elem);break}}if(outermost){dirruns=dirrunsUnique}}if(bySet){if(elem=!matcher&&elem){matchedCount--}if(seed){unmatched.push(elem)}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while(matcher=setMatchers[j++]){matcher(unmatched,setMatched,context,xml)}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)}}}setMatched=condense(setMatched)}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1){Sizzle.uniqueSort(results)}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector)}i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached)}else{elementMatchers.push(cached)}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector}return cached};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results}else if(compiled){context=context.parentNode}selector=selector.slice(tokens.shift().value.length)}i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[type=token.type]){break}if(find=Expr.find[type]){if(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context)){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context);return results};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(el){return el.compareDocumentPosition(document.createElement("fieldset"))&1});if(!assert(function(el){el.innerHTML="<a href='#'></a>";return el.firstChild.getAttribute("href")==="#"})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)}})}if(!support.attributes||!assert(function(el){el.innerHTML="<input/>";el.firstChild.setAttribute("value","");return el.firstChild.getAttribute("value")===""})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue}})}if(!assert(function(el){return el.getAttribute("disabled")==null})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}})}return Sizzle}(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;jQuery.escapeSelector=Sizzle.escape;var dir=function(elem,dir,until){var matched=[],truncate=until!==undefined;while((elem=elem[dir])&&elem.nodeType!==9){if(elem.nodeType===1){if(truncate&&jQuery(elem).is(until)){break}matched.push(elem)}}return matched};var siblings=function(n,elem){var matched=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){matched.push(n)}}return matched};var rneedsContext=jQuery.expr.match.needsContext;function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()}var rsingleTag=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function winnow(elements,qualifier,not){if(isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not})}if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return elem===qualifier!==not})}if(typeof qualifier!=="string"){return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not})}return jQuery.filter(qualifier,elements,not)}jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")"}if(elems.length===1&&elem.nodeType===1){return jQuery.find.matchesSelector(elem,expr)?[elem]:[]}return jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1}))};jQuery.fn.extend({find:function(selector){var i,ret,len=this.length,self=this;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true}}}))}ret=this.pushStack([]);for(i=0;i<len;i++){jQuery.find(selector,self[i],ret)}return len>1?jQuery.uniqueSort(ret):ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],false))},not:function(selector){return this.pushStack(winnow(this,selector||[],true))},is:function(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,init=jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector){return this}root=root||rootjQuery;if(typeof selector==="string"){if(selector[0]==="<"&&selector[selector.length-1]===">"&&selector.length>=3){match=[null,selector,null]}else{match=rquickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(isFunction(this[match])){this[match](context[match])}else{this.attr(match,context[match])}}}return this}else{elem=document.getElementById(match[2]);if(elem){this[0]=elem;this.length=1}return this}}else if(!context||context.jquery){return(context||root).find(selector)}else{return this.constructor(context).find(selector)}}else if(selector.nodeType){this[0]=selector;this.length=1;return this}else if(isFunction(selector)){return root.ready!==undefined?root.ready(selector):selector(jQuery)}return jQuery.makeArray(selector,this)};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){var i=0;for(;i<l;i++){if(jQuery.contains(this,targets[i])){return true}}})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],targets=typeof selectors!=="string"&&jQuery(selectors);if(!rneedsContext.test(selectors)){for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(targets?targets.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}}}}return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched)},index:function(elem){if(!elem){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof elem==="string"){return indexOf.call(jQuery(elem),this[0])}return indexOf.call(this,elem.jquery?elem[0]:elem)},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}});function sibling(cur,dir){while((cur=cur[dir])&&cur.nodeType!==1){}return cur}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return siblings(elem.firstChild)},contents:function(elem){if(nodeName(elem,"iframe")){return elem.contentDocument}if(nodeName(elem,"template")){elem=elem.content||elem}return jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until}if(selector&&typeof selector==="string"){matched=jQuery.filter(selector,matched)}if(this.length>1){if(!guaranteedUnique[name]){jQuery.uniqueSort(matched)}if(rparentsprev.test(name)){matched.reverse()}}return this.pushStack(matched)}});var rnothtmlwhite=/[^\x20\t\r\n\f]+/g;function createOptions(options){var object={};jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=true});return object}jQuery.Callbacks=function(options){options=typeof options==="string"?createOptions(options):jQuery.extend({},options);var firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){locked=locked||options.once;fired=firing=true;for(;queue.length;firingIndex=-1){memory=queue.shift();while(++firingIndex<list.length){if(list[firingIndex].apply(memory[0],memory[1])===false&&options.stopOnFalse){firingIndex=list.length;memory=false}}}if(!options.memory){memory=false}firing=false;if(locked){if(memory){list=[]}else{list=""}}},self={add:function(){if(list){if(memory&&!firing){firingIndex=list.length-1;queue.push(memory)}(function add(args){jQuery.each(args,function(_,arg){if(isFunction(arg)){if(!options.unique||!self.has(arg)){list.push(arg)}}else if(arg&&arg.length&&toType(arg)!=="string"){add(arg)}})})(arguments);if(memory&&!firing){fire()}}return this},remove:function(){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(index<=firingIndex){firingIndex--}}});return this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0},empty:function(){if(list){list=[]}return this},disable:function(){locked=queue=[];list=memory="";return this},disabled:function(){return!list},lock:function(){locked=queue=[];if(!memory&&!firing){list=memory=""}return this},locked:function(){return!!locked},fireWith:function(context,args){if(!locked){args=args||[];args=[context,args.slice?args.slice():args];queue.push(args);if(!firing){fire()}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!fired}};return self};function Identity(v){return v}function Thrower(ex){throw ex}function adoptValue(value,resolve,reject,noValue){var method;try{if(value&&isFunction(method=value.promise)){method.call(value).done(resolve).fail(reject)}else if(value&&isFunction(method=value.then)){method.call(value,resolve,reject)}else{resolve.apply(undefined,[value].slice(noValue))}}catch(value){reject.apply(undefined,[value])}}jQuery.extend({Deferred:function(func){var tuples=[["notify","progress",jQuery.Callbacks("memory"),jQuery.Callbacks("memory"),2],["resolve","done",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),0,"resolved"],["reject","fail",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),1,"rejected"]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},catch:function(fn){return promise.then(null,fn)},pipe:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&isFunction(returned.promise)){returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject)}else{newDefer[tuple[0]+"With"](this,fn?[returned]:arguments)}})});fns=null}).promise()},then:function(onFulfilled,onRejected,onProgress){var maxDepth=0;function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function(){var returned,then;if(depth<maxDepth){return}returned=handler.apply(that,args);if(returned===deferred.promise()){throw new TypeError("Thenable self-resolution")}then=returned&&(typeof returned==="object"||typeof returned==="function")&&returned.then;if(isFunction(then)){if(special){then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special))}else{maxDepth++;then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith))}}else{if(handler!==Identity){that=undefined;args=[returned]}(special||deferred.resolveWith)(that,args)}},process=special?mightThrow:function(){try{mightThrow()}catch(e){if(jQuery.Deferred.exceptionHook){jQuery.Deferred.exceptionHook(e,process.stackTrace)}if(depth+1>=maxDepth){if(handler!==Thrower){that=undefined;args=[e]}deferred.rejectWith(that,args)}}};if(depth){process()}else{if(jQuery.Deferred.getStackHook){process.stackTrace=jQuery.Deferred.getStackHook()}window.setTimeout(process)}}}return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith));tuples[1][3].add(resolve(0,newDefer,isFunction(onFulfilled)?onFulfilled:Identity));tuples[2][3].add(resolve(0,newDefer,isFunction(onRejected)?onRejected:Thrower))}).promise()},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise}},deferred={};jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString},tuples[3-i][2].disable,tuples[3-i][3].disable,tuples[0][2].lock,tuples[0][3].lock)}list.add(tuple[3].fire);deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?undefined:this,arguments);return this};deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);if(func){func.call(deferred,deferred)}return deferred},when:function(singleValue){var remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=slice.call(arguments),master=jQuery.Deferred(),updateFunc=function(i){return function(value){resolveContexts[i]=this;resolveValues[i]=arguments.length>1?slice.call(arguments):value;if(!--remaining){master.resolveWith(resolveContexts,resolveValues)}}};if(remaining<=1){adoptValue(singleValue,master.done(updateFunc(i)).resolve,master.reject,!remaining);if(master.state()==="pending"||isFunction(resolveValues[i]&&resolveValues[i].then)){return master.then()}}while(i--){adoptValue(resolveValues[i],updateFunc(i),master.reject)}return master.promise()}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){if(window.console&&window.console.warn&&error&&rerrorNames.test(error.name)){window.console.warn("jQuery.Deferred exception: "+error.message,error.stack,stack)}};jQuery.readyException=function(error){window.setTimeout(function(){throw error})};var readyList=jQuery.Deferred();jQuery.fn.ready=function(fn){readyList.then(fn).catch(function(error){jQuery.readyException(error)});return this};jQuery.extend({isReady:false,readyWait:1,ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return}readyList.resolveWith(document,[jQuery])}});jQuery.ready.then=readyList.then;function completed(){document.removeEventListener("DOMContentLoaded",completed);window.removeEventListener("load",completed);jQuery.ready()}if(document.readyState==="complete"||document.readyState!=="loading"&&!document.documentElement.doScroll){window.setTimeout(jQuery.ready)}else{document.addEventListener("DOMContentLoaded",completed);window.addEventListener("load",completed)}var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=key==null;if(toType(key)==="object"){chainable=true;for(i in key){access(elems,fn,i,key[i],true,emptyGet,raw)}}else if(value!==undefined){chainable=true;if(!isFunction(value)){raw=true}if(bulk){if(raw){fn.call(elems,value);fn=null}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value)}}}if(fn){for(;i<len;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))}}}if(chainable){return elems}if(bulk){return fn.call(elems)}return len?fn(elems[0],key):emptyGet};var rmsPrefix=/^-ms-/,rdashAlpha=/-([a-z])/g;function fcamelCase(all,letter){return letter.toUpperCase()}function camelCase(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)}var acceptData=function(owner){return owner.nodeType===1||owner.nodeType===9||!+owner.nodeType};function Data(){this.expando=jQuery.expando+Data.uid++}Data.uid=1;Data.prototype={cache:function(owner){var value=owner[this.expando];if(!value){value={};if(acceptData(owner)){if(owner.nodeType){owner[this.expando]=value}else{Object.defineProperty(owner,this.expando,{value:value,configurable:true})}}}return value},set:function(owner,data,value){var prop,cache=this.cache(owner);if(typeof data==="string"){cache[camelCase(data)]=value}else{for(prop in data){cache[camelCase(prop)]=data[prop]}}return cache},get:function(owner,key){return key===undefined?this.cache(owner):owner[this.expando]&&owner[this.expando][camelCase(key)]},access:function(owner,key,value){if(key===undefined||key&&typeof key==="string"&&value===undefined){return this.get(owner,key)}this.set(owner,key,value);return value!==undefined?value:key},remove:function(owner,key){var i,cache=owner[this.expando];if(cache===undefined){return}if(key!==undefined){if(Array.isArray(key)){key=key.map(camelCase)}else{key=camelCase(key);key=key in cache?[key]:key.match(rnothtmlwhite)||[]}i=key.length;while(i--){delete cache[key[i]]}}if(key===undefined||jQuery.isEmptyObject(cache)){if(owner.nodeType){owner[this.expando]=undefined}else{delete owner[this.expando]}}},hasData:function(owner){var cache=owner[this.expando];return cache!==undefined&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data;var dataUser=new Data;var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;function getData(data){if(data==="true"){return true}if(data==="false"){return false}if(data==="null"){return null}if(data===+data+""){return+data}if(rbrace.test(data)){return JSON.parse(data)}return data}function dataAttr(elem,key,data){var name;if(data===undefined&&elem.nodeType===1){name="data-"+key.replace(rmultiDash,"-$&").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=getData(data)}catch(e){}dataUser.set(elem,key,data)}else{data=undefined}}return data}jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,data){return dataUser.access(elem,name,data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,name)}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=dataUser.get(elem);if(elem.nodeType===1&&!dataPriv.get(elem,"hasDataAttrs")){i=attrs.length;while(i--){if(attrs[i]){name=attrs[i].name;if(name.indexOf("data-")===0){name=camelCase(name.slice(5));dataAttr(elem,name,data[name])}}}dataPriv.set(elem,"hasDataAttrs",true)}}return data}if(typeof key==="object"){return this.each(function(){dataUser.set(this,key)})}return access(this,function(value){var data;if(elem&&value===undefined){data=dataUser.get(elem,key);if(data!==undefined){return data}data=dataAttr(elem,key);if(data!==undefined){return data}return}this.each(function(){dataUser.set(this,key,value)})},null,value,arguments.length>1,null,true)},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=dataPriv.get(elem,type);if(data){if(!queue||Array.isArray(data)){queue=dataPriv.access(elem,type,jQuery.makeArray(data))}else{queue.push(data)}}return queue||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if(fn==="inprogress"){fn=queue.shift();startLength--}if(fn){if(type==="fx"){queue.unshift("inprogress")}delete hooks.stop;fn.call(elem,next,hooks)}if(!startLength&&hooks){hooks.empty.fire()}},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key])})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}if(arguments.length<setter){return jQuery.queue(this[0],type)}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!--count){defer.resolveWith(elements,[elements])}};if(typeof type!=="string"){obj=type;type=undefined}type=type||"fx";while(i--){tmp=dataPriv.get(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}resolve();return defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i");var cssExpand=["Top","Right","Bottom","Left"];var isHiddenWithinTree=function(elem,el){elem=el||elem;return elem.style.display==="none"||elem.style.display===""&&jQuery.contains(elem.ownerDocument,elem)&&jQuery.css(elem,"display")==="none"};var swap=function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name]}return ret};function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale,maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=(jQuery.cssNumber[prop]||unit!=="px"&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){initial=initial/2;unit=unit||initialInUnit[3];initialInUnit=+initial||1;while(maxIterations--){jQuery.style(elem,prop,initialInUnit+unit);if((1-scale)*(1-(scale=currentValue()/initial||.5))<=0){maxIterations=0}initialInUnit=initialInUnit/scale}initialInUnit=initialInUnit*2;jQuery.style(elem,prop,initialInUnit+unit);valueParts=valueParts||[]}if(valueParts){initialInUnit=+initialInUnit||+initial||0;adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2];if(tween){tween.unit=unit;tween.start=initialInUnit;tween.end=adjusted}}return adjusted}var defaultDisplayMap={};function getDefaultDisplay(elem){var temp,doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName];if(display){return display}temp=doc.body.appendChild(doc.createElement(nodeName));display=jQuery.css(temp,"display");temp.parentNode.removeChild(temp);if(display==="none"){display="block"}defaultDisplayMap[nodeName]=display;return display}function showHide(elements,show){var display,elem,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue}display=elem.style.display;if(show){if(display==="none"){values[index]=dataPriv.get(elem,"display")||null;if(!values[index]){elem.style.display=""}}if(elem.style.display===""&&isHiddenWithinTree(elem)){values[index]=getDefaultDisplay(elem)}}else{if(display!=="none"){values[index]="none";dataPriv.set(elem,"display",display)}}}for(index=0;index<length;index++){if(values[index]!=null){elements[index].style.display=values[index]}}return elements}jQuery.fn.extend({show:function(){return showHide(this,true)},hide:function(){return showHide(this)},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide()}return this.each(function(){if(isHiddenWithinTree(this)){jQuery(this).show()}else{jQuery(this).hide()}})}});var rcheckableType=/^(?:checkbox|radio)$/i;var rtagName=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i;var rscriptType=/^$|^module$|\/(?:java|ecma)script/i;var wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;function getAll(context,tag){var ret;if(typeof context.getElementsByTagName!=="undefined"){ret=context.getElementsByTagName(tag||"*")}else if(typeof context.querySelectorAll!=="undefined"){ret=context.querySelectorAll(tag||"*")}else{ret=[]}if(tag===undefined||tag&&nodeName(context,tag)){return jQuery.merge([context],ret)}return ret}function setGlobalEval(elems,refElements){var i=0,l=elems.length;for(;i<l;i++){dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"))}}var rhtml=/<|&#?\w+;/;function buildFragment(elems,context,scripts,selection,ignored){var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(toType(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem)}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem))}else{tmp=tmp||fragment.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild}jQuery.merge(nodes,tmp.childNodes);tmp=fragment.firstChild;tmp.textContent=""}}}fragment.textContent="";i=0;while(elem=nodes[i++]){if(selection&&jQuery.inArray(elem,selection)>-1){if(ignored){ignored.push(elem)}continue}contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(fragment.appendChild(elem),"script");if(contains){setGlobalEval(tmp)}if(scripts){j=0;while(elem=tmp[j++]){if(rscriptType.test(elem.type||"")){scripts.push(elem)}}}}return fragment}(function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio");input.setAttribute("checked","checked");input.setAttribute("name","t");div.appendChild(input);support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue})();var documentElement=document.documentElement;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;function returnTrue(){return true}function returnFalse(){return false}function safeActiveElement(){try{return document.activeElement}catch(err){}}function on(elem,types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}for(type in types){on(elem,type,selector,data,types[type],one)}return elem}if(data==null&&fn==null){fn=selector;data=selector=undefined}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}if(fn===false){fn=returnFalse}else if(!fn){return elem}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(!elemData){return}if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}if(selector){jQuery.find.matchesSelector(documentElement,selector)}if(!handler.guid){handler.guid=jQuery.guid++}if(!(events=elemData.events)){events=elemData.events={}}if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!=="undefined"&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):undefined}}types=(types||"").match(rnothtmlwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle)}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}jQuery.event.global[type]=true}},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(!elemData||!(events=elemData.events)){return}types=(types||"").match(rnothtmlwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)}continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--}if(special.remove){special.remove.call(elem,handleObj)}}}if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle)}delete events[type]}}if(jQuery.isEmptyObject(events)){dataPriv.remove(elem,"handle events")}},dispatch:function(nativeEvent){var event=jQuery.event.fix(nativeEvent);var i,j,ret,matched,handleObj,handlerQueue,args=new Array(arguments.length),handlers=(dataPriv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;for(i=1;i<arguments.length;i++){args[i]=arguments[i]}event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return}handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.rnamespace||event.rnamespace.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation()}}}}}if(special.postDispatch){special.postDispatch.call(this,event)}return event.result},handlers:function(event,handlers){var i,handleObj,sel,matchedHandlers,matchedSelectors,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&!(event.type==="click"&&event.button>=1)){for(;cur!==this;cur=cur.parentNode||this){if(cur.nodeType===1&&!(event.type==="click"&&cur.disabled===true)){matchedHandlers=[];matchedSelectors={};for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matchedSelectors[sel]===undefined){matchedSelectors[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length}if(matchedSelectors[sel]){matchedHandlers.push(handleObj)}}if(matchedHandlers.length){handlerQueue.push({elem:cur,handlers:matchedHandlers})}}}}cur=this;if(delegateCount<handlers.length){handlerQueue.push({elem:cur,handlers:handlers.slice(delegateCount)})}return handlerQueue},addProp:function(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:true,configurable:true,get:isFunction(hook)?function(){if(this.originalEvent){return hook(this.originalEvent)}}:function(){if(this.originalEvent){return this.originalEvent[name]}},set:function(value){Object.defineProperty(this,name,{enumerable:true,configurable:true,writable:true,value:value})}})},fix:function(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent)},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&nodeName(this,"input")){this.click();return false}},_default:function(event){return nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){if(event.result!==undefined&&event.originalEvent){event.originalEvent.returnValue=event.result}}}}};jQuery.removeEvent=function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===false?returnTrue:returnFalse;this.target=src.target&&src.target.nodeType===3?src.target.parentNode:src.target;this.currentTarget=src.currentTarget;this.relatedTarget=src.relatedTarget}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=src&&src.timeStamp||Date.now();this[jQuery.expando]=true};jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:false,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(e&&!this.isSimulated){e.preventDefault()}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(e&&!this.isSimulated){e.stopPropagation()}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;if(e&&!this.isSimulated){e.stopImmediatePropagation()}this.stopPropagation()}};jQuery.each({altKey:true,bubbles:true,cancelable:true,changedTouches:true,ctrlKey:true,detail:true,eventPhase:true,metaKey:true,pageX:true,pageY:true,shiftKey:true,view:true,char:true,charCode:true,key:true,keyCode:true,button:true,buttons:true,clientX:true,clientY:true,offsetX:true,offsetY:true,pointerId:true,pointerType:true,screenX:true,screenY:true,targetTouches:true,toElement:true,touches:true,which:function(event){var button=event.button;if(event.which==null&&rkeyEvent.test(event.type)){return event.charCode!=null?event.charCode:event.keyCode}if(!event.which&&button!==undefined&&rmouseEvent.test(event.type)){if(button&1){return 1}if(button&2){return 3}if(button&4){return 2}return 0}return event.which}},jQuery.event.addProp);jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||related!==target&&!jQuery.contains(target,related)){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn)},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(type in types){this.off(type,selector,types[type])}return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false){fn=returnFalse}return this.each(function(){jQuery.event.remove(this,types,fn,selector)})}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function manipulationTarget(elem,content){if(nodeName(elem,"table")&&nodeName(content.nodeType!==11?content:content.firstChild,"tr")){return jQuery(elem).children("tbody")[0]||elem}return elem}function disableScript(elem){elem.type=(elem.getAttribute("type")!==null)+"/"+elem.type;return elem}function restoreScript(elem){if((elem.type||"").slice(0,5)==="true/"){elem.type=elem.type.slice(5)}else{elem.removeAttribute("type")}return elem}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(dest.nodeType!==1){return}if(dataPriv.hasData(src)){pdataOld=dataPriv.access(src);pdataCur=dataPriv.set(dest,pdataOld);events=pdataOld.events;if(events){delete pdataCur.handle;pdataCur.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i])}}}}if(dataUser.hasData(src)){udataOld=dataUser.access(src);udataCur=jQuery.extend({},udataOld);dataUser.set(dest,udataCur)}}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();if(nodeName==="input"&&rcheckableType.test(src.type)){dest.checked=src.checked}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}}function domManip(collection,args,callback,ignored){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],valueIsFunction=isFunction(value);if(valueIsFunction||l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value)){return collection.each(function(index){var self=collection.eq(index);if(valueIsFunction){args[0]=value.call(this,index,self.html())}domManip(self,args,callback,ignored)})}if(l){fragment=buildFragment(args,collection[0].ownerDocument,false,collection,ignored);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first}if(first||ignored){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"))}}callback.call(collection[i],node,i)}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src&&(node.type||"").toLowerCase()!=="module"){if(jQuery._evalUrl){jQuery._evalUrl(node.src)}}else{DOMEval(node.textContent.replace(rcleanScript,""),doc,node)}}}}}}return collection}function remove(elem,selector,keepData){var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;for(;(node=nodes[i])!=null;i++){if(!keepData&&node.nodeType===1){jQuery.cleanData(getAll(node))}if(node.parentNode){if(keepData&&jQuery.contains(node.ownerDocument,node)){setGlobalEval(getAll(node,"script"))}node.parentNode.removeChild(node)}}return elem}jQuery.extend({htmlPrefilter:function(html){return html.replace(rxhtmlTag,"<$1></$2>")},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(true),inPage=jQuery.contains(elem.ownerDocument,elem);if(!support.noCloneChecked&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0,l=srcElements.length;i<l;i++){fixInput(srcElements[i],destElements[i])}}if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0,l=srcElements.length;i<l;i++){cloneCopyEvent(srcElements[i],destElements[i])}}else{cloneCopyEvent(elem,clone)}}destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"))}return clone},cleanData:function(elems){var data,elem,type,special=jQuery.event.special,i=0;for(;(elem=elems[i])!==undefined;i++){if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}}elem[dataPriv.expando]=undefined}if(elem[dataUser.expando]){elem[dataUser.expando]=undefined}}}}});jQuery.fn.extend({detach:function(selector){return remove(this,selector,true)},remove:function(selector){return remove(this,selector)},text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=value}})},null,value,arguments.length)},append:function(){return domManip(this,arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return domManip(this,arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return domManip(this,arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this)}})},after:function(){return domManip(this,arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling)}})},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.textContent=""}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined&&elem.nodeType===1){return elem.innerHTML}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value}}elem=0}catch(e){}}if(elem){this.empty().append(value)}},null,value,arguments.length)},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;if(jQuery.inArray(this,ignored)<0){jQuery.cleanData(getAll(this));if(parent){parent.replaceChild(elem,this)}}},ignored)}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret,elems.get())}return this.pushStack(ret)}});var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var getStyles=function(elem){var view=elem.ownerDocument.defaultView;if(!view||!view.opener){view=window}return view.getComputedStyle(elem)};var rboxStyle=new RegExp(cssExpand.join("|"),"i");(function(){function computeStyleTests(){if(!div){return}container.style.cssText="position:absolute;left:-11111px;width:60px;"+"margin-top:1px;padding:0;border:0";div.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;"+"margin:auto;border:1px;padding:1px;"+"width:60%;top:1%";documentElement.appendChild(container).appendChild(div);var divStyle=window.getComputedStyle(div);pixelPositionVal=divStyle.top!=="1%";reliableMarginLeftVal=roundPixelMeasures(divStyle.marginLeft)===12;div.style.right="60%";pixelBoxStylesVal=roundPixelMeasures(divStyle.right)===36;boxSizingReliableVal=roundPixelMeasures(divStyle.width)===36;div.style.position="absolute";scrollboxSizeVal=div.offsetWidth===36||"absolute";documentElement.removeChild(container);div=null}function roundPixelMeasures(measure){return Math.round(parseFloat(measure))}var pixelPositionVal,boxSizingReliableVal,scrollboxSizeVal,pixelBoxStylesVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");if(!div.style){return}div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";jQuery.extend(support,{boxSizingReliable:function(){computeStyleTests();return boxSizingReliableVal},pixelBoxStyles:function(){computeStyleTests();return pixelBoxStylesVal},pixelPosition:function(){computeStyleTests();return pixelPositionVal},reliableMarginLeft:function(){computeStyleTests();return reliableMarginLeftVal},scrollboxSize:function(){computeStyleTests();return scrollboxSizeVal}})})();function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);if(computed){ret=computed.getPropertyValue(name)||computed[name];if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name)}if(!support.pixelBoxStyles()&&rnumnonpx.test(ret)&&rboxStyle.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}}return ret!==undefined?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){if(conditionFn()){delete this.get;return}return(this.get=hookFn).apply(this,arguments)}}}var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rcustomProp=/^--/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","Moz","ms"],emptyStyle=document.createElement("div").style;function vendorPropName(name){if(name in emptyStyle){return name}var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in emptyStyle){return name}}}function finalPropName(name){var ret=jQuery.cssProps[name];if(!ret){ret=jQuery.cssProps[name]=vendorPropName(name)||name}return ret}function setPositiveNumber(elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}function boxModelAdjustment(elem,dimension,box,isBorderBox,styles,computedVal){var i=dimension==="width"?1:0,extra=0,delta=0;if(box===(isBorderBox?"border":"content")){return 0}for(;i<4;i+=2){if(box==="margin"){delta+=jQuery.css(elem,box+cssExpand[i],true,styles)}if(!isBorderBox){delta+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(box!=="padding"){delta+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}else{extra+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}else{if(box==="content"){delta-=jQuery.css(elem,"padding"+cssExpand[i],true,styles)}if(box!=="margin"){delta-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}}if(!isBorderBox&&computedVal>=0){delta+=Math.max(0,Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-computedVal-delta-extra-.5))}return delta}function getWidthOrHeight(elem,dimension,extra){var styles=getStyles(elem),val=curCSS(elem,dimension,styles),isBorderBox=jQuery.css(elem,"boxSizing",false,styles)==="border-box",valueIsBorderBox=isBorderBox;if(rnumnonpx.test(val)){if(!extra){return val}val="auto"}valueIsBorderBox=valueIsBorderBox&&(support.boxSizingReliable()||val===elem.style[dimension]);if(val==="auto"||!parseFloat(val)&&jQuery.css(elem,"display",false,styles)==="inline"){val=elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)];valueIsBorderBox=true}val=parseFloat(val)||0;return val+boxModelAdjustment(elem,dimension,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles,val)+"px"}jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}}}},cssNumber:{animationIterationCount:true,columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}var ret,type,hooks,origName=camelCase(name),isCustomProp=rcustomProp.test(name),style=elem.style;if(!isCustomProp){name=finalPropName(origName)}hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rcssNum.exec(value))&&ret[1]){value=adjustCSS(elem,name,ret);type="number"}if(value==null||value!==value){return}if(type==="number"){value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px")}if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit"}if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){if(isCustomProp){style.setProperty(name,value)}else{style[name]=value}}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,extra,styles){var val,num,hooks,origName=camelCase(name),isCustomProp=rcustomProp.test(name);if(!isCustomProp){name=finalPropName(origName)}hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks){val=hooks.get(elem,true,extra)}if(val===undefined){val=curCSS(elem,name,styles)}if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name]}if(extra===""||extra){num=parseFloat(val);return extra===true||isFinite(num)?num||0:val}return val}});jQuery.each(["height","width"],function(i,dimension){jQuery.cssHooks[dimension]={get:function(elem,computed,extra){if(computed){return rdisplayswap.test(jQuery.css(elem,"display"))&&(!elem.getClientRects().length||!elem.getBoundingClientRect().width)?swap(elem,cssShow,function(){return getWidthOrHeight(elem,dimension,extra)}):getWidthOrHeight(elem,dimension,extra)}},set:function(elem,value,extra){var matches,styles=getStyles(elem),isBorderBox=jQuery.css(elem,"boxSizing",false,styles)==="border-box",subtract=extra&&boxModelAdjustment(elem,dimension,extra,isBorderBox,styles);if(isBorderBox&&support.scrollboxSize()===styles.position){subtract-=Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-parseFloat(styles[dimension])-boxModelAdjustment(elem,dimension,"border",false,styles)-.5)}if(subtract&&(matches=rcssNum.exec(value))&&(matches[3]||"px")!=="px"){elem.style[dimension]=value;value=jQuery.css(elem,dimension)}return setPositiveNumber(elem,value,subtract)}}});jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){if(computed){return(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px"}});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]}return expanded}};if(prefix!=="margin"){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber}});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(Array.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles)}return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||jQuery.easing._default;this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration)}else{this.pos=eased=percent}this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(hooks&&hooks.set){hooks.set(this)}else{Tween.propHooks._default.set(this)}return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem.nodeType!==1||tween.elem[tween.prop]!=null&&tween.elem.style[tween.prop]==null){return tween.elem[tween.prop]}result=jQuery.css(tween.elem,tween.prop,"");return!result||result==="auto"?0:result},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween)}else if(tween.elem.nodeType===1&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}else{tween.elem[tween.prop]=tween.now}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now}}};jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},_default:"swing"};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var fxNow,inProgress,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;function schedule(){if(inProgress){if(document.hidden===false&&window.requestAnimationFrame){window.requestAnimationFrame(schedule)}else{window.setTimeout(schedule,jQuery.fx.interval)}jQuery.fx.tick()}}function createFxNow(){window.setTimeout(function(){fxNow=undefined});return fxNow=Date.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type}if(includeWidth){attrs.opacity=attrs.width=type}return attrs}function createTween(value,prop,animation){var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if(tween=collection[index].call(animation,prop,value)){return tween}}}function defaultPrefilter(elem,props,opts){var prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display,isBox="width"in props||"height"in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire()}}}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire()}})})}for(prop in props){value=props[prop];if(rfxtypes.test(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true}else{continue}}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}}propTween=!jQuery.isEmptyObject(props);if(!propTween&&jQuery.isEmptyObject(orig)){return}if(isBox&&elem.nodeType===1){opts.overflow=[style.overflow,style.overflowX,style.overflowY];restoreDisplay=dataShow&&dataShow.display;if(restoreDisplay==null){restoreDisplay=dataPriv.get(elem,"display")}display=jQuery.css(elem,"display");if(display==="none"){if(restoreDisplay){display=restoreDisplay}else{showHide([elem],true);restoreDisplay=elem.style.display||restoreDisplay;display=jQuery.css(elem,"display");showHide([elem])}}if(display==="inline"||display==="inline-block"&&restoreDisplay!=null){if(jQuery.css(elem,"float")==="none"){if(!propTween){anim.done(function(){style.display=restoreDisplay});if(restoreDisplay==null){display=style.display;restoreDisplay=display==="none"?"":display}}style.display="inline-block"}}}if(opts.overflow){style.overflow="hidden";anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}propTween=false;for(prop in orig){if(!propTween){if(dataShow){if("hidden"in dataShow){hidden=dataShow.hidden}}else{dataShow=dataPriv.access(elem,"fxshow",{display:restoreDisplay})}if(toggle){dataShow.hidden=!hidden}if(hidden){showHide([elem],true)}anim.done(function(){if(!hidden){showHide([elem])}dataPriv.remove(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop])}})}propTween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=propTween.start;if(hidden){propTween.end=propTween.start;propTween.start=0}}}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=camelCase(index);easing=specialEasing[name];value=props[index];if(Array.isArray(value)){easing=value[1];value=props[index]=value[0]}if(index!==name){props[name]=value;delete props[index]}hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}}else{specialEasing[name]=easing}}}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped){return false}var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent)}deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining}if(!length){deferred.notifyWith(elem,[animation,1,0])}deferred.resolveWith(elem,[animation]);return false},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this}stopped=true;for(;index<length;index++){animation.tweens[index].run(1)}if(gotoEnd){deferred.notifyWith(elem,[animation,1,0]);deferred.resolveWith(elem,[animation,gotoEnd])}else{deferred.rejectWith(elem,[animation,gotoEnd])}return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=Animation.prefilters[index].call(animation,elem,props,animation.opts);if(result){if(isFunction(result.stop)){jQuery._queueHooks(animation.elem,animation.opts.queue).stop=result.stop.bind(result)}return result}}jQuery.map(props,createTween,animation);if(isFunction(animation.opts.start)){animation.opts.start.call(elem,animation)}animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always);jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation}jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);adjustCSS(tween.elem,prop,rcssNum.exec(value),tween);return tween}]},tweener:function(props,callback){if(isFunction(props)){callback=props;props=["*"]}else{props=props.match(rnothtmlwhite)}var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];Animation.tweeners[prop]=Animation.tweeners[prop]||[];Animation.tweeners[prop].unshift(callback)}},prefilters:[defaultPrefilter],prefilter:function(callback,prepend){if(prepend){Animation.prefilters.unshift(callback)}else{Animation.prefilters.push(callback)}}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!isFunction(easing)&&easing};if(jQuery.fx.off){opt.duration=0}else{if(typeof opt.duration!=="number"){if(opt.duration in jQuery.fx.speeds){opt.duration=jQuery.fx.speeds[opt.duration]}else{opt.duration=jQuery.fx.speeds._default}}}if(opt.queue==null||opt.queue===true){opt.queue="fx"}opt.old=opt.complete;opt.complete=function(){if(isFunction(opt.old)){opt.old.call(this)}if(opt.queue){jQuery.dequeue(this,opt.queue)}};return opt};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||dataPriv.get(this,"finish")){anim.stop(true)}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false){this.queue(type||"fx",[])}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index])}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index])}}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1)}}if(dequeue||!gotoEnd){jQuery.dequeue(this,type)}})},finish:function(type){if(type!==false){type=type||"fx"}return this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true)}for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1)}}for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this)}}delete data.finish})}});jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback)}});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.timers=[];jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;fxNow=Date.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}fxNow=undefined};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);jQuery.fx.start()};jQuery.fx.interval=13;jQuery.fx.start=function(){if(inProgress){return}inProgress=true;schedule()};jQuery.fx.stop=function(){inProgress=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})};(function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox";support.checkOn=input.value!=="";support.optSelected=opt.selected;input=document.createElement("input");input.value="t";input.type="radio";support.radioValue=input.value==="t"})();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}});jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(nType===3||nType===8||nType===2){return}if(typeof elem.getAttribute==="undefined"){return jQuery.prop(elem,name,value)}if(nType!==1||!jQuery.isXMLDoc(elem)){hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:undefined)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);return}if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}elem.setAttribute(name,value+"");return value}if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret}ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}}},removeAttr:function(elem,value){var name,i=0,attrNames=value&&value.match(rnothtmlwhite);if(attrNames&&elem.nodeType===1){while(name=attrNames[i++]){elem.removeAttribute(name)}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name)}else{elem.setAttribute(name,name)}return name}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle,lowercaseName=name.toLowerCase();if(!isXML){handle=attrHandle[lowercaseName];attrHandle[lowercaseName]=ret;ret=getter(elem,name,isXML)!=null?lowercaseName:null;attrHandle[lowercaseName]=handle}return ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}});jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(nType===3||nType===8||nType===2){return}if(nType!==1||!jQuery.isXMLDoc(elem)){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==undefined){if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}return elem[name]=value}if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret}return elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");if(tabindex){return parseInt(tabindex,10)}if(rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href){return 0}return-1}}},propFix:{for:"htmlFor",class:"className"}});if(!support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent&&parent.parentNode){parent.parentNode.selectedIndex}return null},set:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex}}}}}jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});function stripAndCollapse(value){var tokens=value.match(rnothtmlwhite)||[];return tokens.join(" ")}function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}function classesToArray(value){if(Array.isArray(value)){return value}if(typeof value==="string"){return value.match(rnothtmlwhite)||[]}return[]}jQuery.fn.extend({addClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))})}classes=classesToArray(value);if(classes.length){while(elem=this[i++]){curValue=getClass(elem);cur=elem.nodeType===1&&" "+stripAndCollapse(curValue)+" ";if(cur){j=0;while(clazz=classes[j++]){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" "}}finalValue=stripAndCollapse(cur);if(curValue!==finalValue){elem.setAttribute("class",finalValue)}}}}return this},removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))})}if(!arguments.length){return this.attr("class","")}classes=classesToArray(value);if(classes.length){while(elem=this[i++]){curValue=getClass(elem);cur=elem.nodeType===1&&" "+stripAndCollapse(curValue)+" ";if(cur){j=0;while(clazz=classes[j++]){while(cur.indexOf(" "+clazz+" ")>-1){cur=cur.replace(" "+clazz+" "," ")}}finalValue=stripAndCollapse(cur);if(curValue!==finalValue){elem.setAttribute("class",finalValue)}}}}return this},toggleClass:function(value,stateVal){var type=typeof value,isValidValue=type==="string"||Array.isArray(value);if(typeof stateVal==="boolean"&&isValidValue){return stateVal?this.addClass(value):this.removeClass(value)}if(isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)})}return this.each(function(){var className,i,self,classNames;if(isValidValue){i=0;self=jQuery(this);classNames=classesToArray(value);while(className=classNames[i++]){if(self.hasClass(className)){self.removeClass(className)}else{self.addClass(className)}}}else if(value===undefined||type==="boolean"){className=getClass(this);if(className){dataPriv.set(this,"__className__",className)}if(this.setAttribute){this.setAttribute("class",className||value===false?"":dataPriv.get(this,"__className__")||"")}}})},hasClass:function(selector){var className,elem,i=0;className=" "+selector+" ";while(elem=this[i++]){if(elem.nodeType===1&&(" "+stripAndCollapse(getClass(elem))+" ").indexOf(className)>-1){return true}}return false}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,valueIsFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}ret=elem.value;if(typeof ret==="string"){return ret.replace(rreturn,"")}return ret==null?"":ret}return}valueIsFunction=isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return}if(valueIsFunction){val=value.call(this,i,jQuery(this).val())}else{val=value}if(val==null){val=""}else if(typeof val==="number"){val+=""}else if(Array.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:stripAndCollapse(jQuery.text(elem))}},select:{get:function(elem){var value,option,i,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one",values=one?null:[],max=one?index+1:options.length;if(index<0){i=max}else{i=one?index:0}for(;i<max;i++){option=options[i];if((option.selected||i===index)&&!option.disabled&&(!option.parentNode.disabled||!nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}return values},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(option.selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1){optionSet=true}}if(!optionSet){elem.selectedIndex=-1}return values}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(Array.isArray(value)){return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1}}};if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});support.focusin="onfocusin"in window;var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,stopPropagationCallback=function(e){e.stopPropagation()};jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,lastElement,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=lastElement=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return}if(rfocusMorph.test(type+jQuery.event.triggered)){return}if(type.indexOf(".")>-1){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem}data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return}if(!onlyHandlers&&!special.noBubble&&!isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode}for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur}if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window)}}i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){lastElement=cur;event.type=i>1?bubbleType:special.bindType||type;handle=(dataPriv.get(cur,"events")||{})[event.type]&&dataPriv.get(cur,"handle");if(handle){handle.apply(cur,data)}handle=ontype&&cur[ontype];if(handle&&handle.apply&&acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===false){event.preventDefault()}}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&acceptData(elem)){if(ontype&&isFunction(elem[type])&&!isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null}jQuery.event.triggered=type;if(event.isPropagationStopped()){lastElement.addEventListener(type,stopPropagationCallback)}elem[type]();if(event.isPropagationStopped()){lastElement.removeEventListener(type,stopPropagationCallback)}jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp}}}}return event.result},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:true});jQuery.event.trigger(e,null,elem)}});jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true)}}});if(!support.focusin){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix);if(!attaches){doc.addEventListener(orig,handler,true)}dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,true);dataPriv.remove(doc,fix)}else{dataPriv.access(doc,fix,attaches)}}}})}var location=window.location;var nonce=Date.now();var rquery=/\?/;jQuery.parseXML=function(data){var xml;if(!data||typeof data!=="string"){return null}try{xml=(new window.DOMParser).parseFromString(data,"text/xml")}catch(e){xml=undefined}if(!xml||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}return xml};var rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(Array.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"&&v!=null?i:"")+"]",v,traditional,add)}})}else if(!traditional&&toType(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,valueOrFunction){var value=isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value==null?"":value)};if(Array.isArray(a)||a.jquery&&!jQuery.isPlainObject(a)){jQuery.each(a,function(){add(this.name,this.value)})}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&")};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();if(val==null){return null}if(Array.isArray(val)){return jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}})}return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});var r20=/%20/g,rhash=/#.*$/,rantiCache=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href;function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[];if(isFunction(func)){while(dataType=dataTypes[i++]){if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func)}else{(structure[dataType]=structure[dataType]||[]).push(func)}}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=structure===transports;function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false}else if(seekingTransport){return!(selected=dataTypeOrTransport)}});return selected}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:deep||(deep={}))[key]=src[key]}}if(deep){jQuery.extend(true,target,deep)}return target}function ajaxHandleResponses(s,jqXHR,responses){var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0]in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv]}}current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response}if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType)}prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev}else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2]}else if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1])}break}}}}if(conv!==true){if(conv&&s.throws){response=conv(response)}else{try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}}}}return{state:"success",data:response}}jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":JSON.parse,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(completed){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString)){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match==null?null:match},getAllResponseHeaders:function(){return completed?responseHeadersString:null},setRequestHeader:function(name,value){if(completed==null){name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name;requestHeaders[name]=value}return this},overrideMimeType:function(type){if(completed==null){s.mimeType=type}return this},statusCode:function(map){var code;if(map){if(completed){jqXHR.always(map[jqXHR.status])}else{for(code in map){statusCode[code]=[statusCode[code],map[code]]}}}return this},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText)}done(0,finalText);return this}};deferred.promise(jqXHR);s.url=((url||s.url||location.href)+"").replace(rprotocol,location.protocol+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=(s.dataType||"*").toLowerCase().match(rnothtmlwhite)||[""];if(s.crossDomain==null){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url;urlAnchor.href=urlAnchor.href;s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!==urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=true}}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(completed){return jqXHR}fireGlobals=jQuery.event&&s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url.replace(rhash,"");if(!s.hasContent){uncached=s.url.slice(cacheURL.length);if(s.data&&(s.processData||typeof s.data==="string")){cacheURL+=(rquery.test(cacheURL)?"&":"?")+s.data;delete s.data}if(s.cache===false){cacheURL=cacheURL.replace(rantiCache,"$1");uncached=(rquery.test(cacheURL)?"&":"?")+"_="+nonce+++uncached}s.url=cacheURL+uncached}else if(s.data&&s.processData&&(s.contentType||"").indexOf("application/x-www-form-urlencoded")===0){s.data=s.data.replace(r20,"+")}if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL])}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||completed)){return jqXHR.abort()}strAbort="abort";completeDeferred.add(s.complete);jqXHR.done(s.success);jqXHR.fail(s.error);transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(completed){return jqXHR}if(s.async&&s.timeout>0){timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{completed=false;transport.send(requestHeaders,done)}catch(e){if(completed){throw e}done(-1,e)}}function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(completed){return}completed=true;if(timeoutTimer){window.clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses)}response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified}modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified}}if(status===204||s.type==="HEAD"){statusText="nocontent"}else if(status===304){statusText="notmodified"}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error])}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!--jQuery.active){jQuery.event.trigger("ajaxStop")}}}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}});jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",cache:true,async:false,global:false,throws:true})};jQuery.fn.extend({wrapAll:function(html){var wrap;if(this[0]){if(isFunction(html)){html=html.call(this[0])}wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstElementChild){elem=elem.firstElementChild}return elem}).append(this)}return this},wrapInner:function(html){if(isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var htmlIsFunction=isFunction(html);return this.each(function(i){jQuery(this).wrapAll(htmlIsFunction?html.call(this,i):html)})},unwrap:function(selector){this.parent(selector).not("body").each(function(){jQuery(this).replaceWith(this.childNodes)});return this}});jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem)};jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length)};jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported;support.ajax=xhrSupported=!!xhrSupported;jQuery.ajaxTransport(function(options){var callback,errorCallback;if(support.cors||xhrSupported&&!options.crossDomain){return{send:function(headers,complete){var i,xhr=options.xhr();xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i]}}if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType)}if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}for(i in headers){xhr.setRequestHeader(i,headers[i])}callback=function(type){return function(){if(callback){callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.ontimeout=xhr.onreadystatechange=null;if(type==="abort"){xhr.abort()}else if(type==="error"){if(typeof xhr.status!=="number"){complete(0,"error")}else{complete(xhr.status,xhr.statusText)}}else{complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,(xhr.responseType||"text")!=="text"||typeof xhr.responseText!=="string"?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders())}}}};xhr.onload=callback();errorCallback=xhr.onerror=xhr.ontimeout=callback("error");if(xhr.onabort!==undefined){xhr.onabort=errorCallback}else{xhr.onreadystatechange=function(){if(xhr.readyState===4){window.setTimeout(function(){if(callback){errorCallback()}})}}}callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback){throw e}}},abort:function(){if(callback){callback()}}}}});jQuery.ajaxPrefilter(function(s){if(s.crossDomain){s.contents.script=false}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, "+"application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET"}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove();callback=null;if(evt){complete(evt.type==="error"?404:200,evt.type)}});document.head.appendChild(script[0])},abort:function(){if(callback){callback()}}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;this[callback]=true;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&(s.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName)}else if(s.jsonp!==false){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName}s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){if(overwritten===undefined){jQuery(window).removeProp(callbackName)}else{window[callbackName]=overwritten}if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}if(responseContainer&&isFunction(overwritten)){overwritten(responseContainer[0])}responseContainer=overwritten=undefined});return"script"}});support.createHTMLDocument=function(){var body=document.implementation.createHTMLDocument("").body;body.innerHTML="<form></form><form></form>";return body.childNodes.length===2}();jQuery.parseHTML=function(data,context,keepScripts){if(typeof data!=="string"){return[]}if(typeof context==="boolean"){keepScripts=context;context=false}var base,parsed,scripts;if(!context){if(support.createHTMLDocument){context=document.implementation.createHTMLDocument("");base=context.createElement("base");base.href=document.location.href;context.head.appendChild(base)}else{context=document}}parsed=rsingleTag.exec(data);scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])]}parsed=buildFragment([data],context,scripts);if(scripts&&scripts.length){jQuery(scripts).remove()}return jQuery.merge([],parsed.childNodes)};jQuery.fn.load=function(url,params,callback){var selector,type,response,self=this,off=url.indexOf(" ");if(off>-1){selector=stripAndCollapse(url.slice(off));url=url.slice(0,off)}if(isFunction(params)){callback=params;params=undefined}else if(params&&typeof params==="object"){type="POST"}if(self.length>0){jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR])})})}return this};jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}});jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative"}curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&(curCSSTop+curCSSLeft).indexOf("auto")>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(isFunction(options)){options=options.call(elem,i,jQuery.extend({},curOffset))}if(options.top!=null){props.top=options.top-curOffset.top+curTop}if(options.left!=null){props.left=options.left-curOffset.left+curLeft}if("using"in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)})}var rect,win,elem=this[0];if(!elem){return}if(!elem.getClientRects().length){return{top:0,left:0}}rect=elem.getBoundingClientRect();win=elem.ownerDocument.defaultView;return{top:rect.top+win.pageYOffset,left:rect.left+win.pageXOffset}},position:function(){if(!this[0]){return}var offsetParent,offset,doc,elem=this[0],parentOffset={top:0,left:0};if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect()}else{offset=this.offset();doc=elem.ownerDocument;offsetParent=elem.offsetParent||doc.documentElement;while(offsetParent&&(offsetParent===doc.body||offsetParent===doc.documentElement)&&jQuery.css(offsetParent,"position")==="static"){offsetParent=offsetParent.parentNode}if(offsetParent&&offsetParent!==elem&&offsetParent.nodeType===1){parentOffset=jQuery(offsetParent).offset();parentOffset.top+=jQuery.css(offsetParent,"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent,"borderLeftWidth",true)}}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent;while(offsetParent&&jQuery.css(offsetParent,"position")==="static"){offsetParent=offsetParent.offsetParent}return offsetParent||documentElement})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win;if(isWindow(elem)){win=elem}else if(elem.nodeType===9){win=elem.defaultView}if(val===undefined){return win?win[prop]:elem[method]}if(win){win.scrollTo(!top?val:win.pageXOffset,top?val:win.pageYOffset)}else{elem[method]=val}},method,val,arguments.length)}});jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed}})});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return access(this,function(elem,type,value){var doc;if(isWindow(elem)){return funcName.indexOf("outer")===0?elem["inner"+name]:elem.document.documentElement["client"+name]}if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable)}})});jQuery.each(("blur focus focusin focusout resize scroll click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}});jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn)}});jQuery.proxy=function(fn,context){var tmp,args,proxy;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp}if(!isFunction(fn)){return undefined}args=slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy};jQuery.holdReady=function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}};jQuery.isArray=Array.isArray;jQuery.parseJSON=JSON.parse;jQuery.nodeName=nodeName;jQuery.isFunction=isFunction;jQuery.isWindow=isWindow;jQuery.camelCase=camelCase;jQuery.type=toType;jQuery.now=Date.now;jQuery.isNumeric=function(obj){var type=jQuery.type(obj);return(type==="number"||type==="string")&&!isNaN(obj-parseFloat(obj))};if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery})}var _jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery};if(!noGlobal){window.jQuery=window.$=jQuery}return jQuery})},{}],71:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var MiniSignalBinding=function(){function MiniSignalBinding(fn,once,thisArg){if(once===undefined)once=false;_classCallCheck(this,MiniSignalBinding);this._fn=fn;this._once=once;this._thisArg=thisArg;this._next=this._prev=this._owner=null}_createClass(MiniSignalBinding,[{key:"detach",value:function detach(){if(this._owner===null)return false;this._owner.detach(this);return true}}]);return MiniSignalBinding}();function _addMiniSignalBinding(self,node){if(!self._head){self._head=node;self._tail=node}else{self._tail._next=node;node._prev=self._tail;self._tail=node}node._owner=self;return node}var MiniSignal=function(){function MiniSignal(){_classCallCheck(this,MiniSignal);this._head=this._tail=undefined}_createClass(MiniSignal,[{key:"handlers",value:function handlers(){var exists=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var node=this._head;if(exists)return!!node;var ee=[];while(node){ee.push(node);node=node._next}return ee}},{key:"has",value:function has(node){if(!(node instanceof MiniSignalBinding)){throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.")}return node._owner===this}},{key:"dispatch",value:function dispatch(){var node=this._head;if(!node)return false;while(node){if(node._once)this.detach(node);node._fn.apply(node._thisArg,arguments);node=node._next}return true}},{key:"add",value:function add(fn){var thisArg=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(typeof fn!=="function"){throw new Error("MiniSignal#add(): First arg must be a Function.")}return _addMiniSignalBinding(this,new MiniSignalBinding(fn,false,thisArg))}},{key:"once",value:function once(fn){var thisArg=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(typeof fn!=="function"){throw new Error("MiniSignal#once(): First arg must be a Function.")}return _addMiniSignalBinding(this,new MiniSignalBinding(fn,true,thisArg))}},{key:"detach",value:function detach(node){if(!(node instanceof MiniSignalBinding)){throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.")}if(node._owner!==this)return this;if(node._prev)node._prev._next=node._next;if(node._next)node._next._prev=node._prev;if(node===this._head){this._head=node._next;if(node._next===null){this._tail=null}}else if(node===this._tail){this._tail=node._prev;this._tail._next=null}node._owner=null;return this}},{key:"detachAll",value:function detachAll(){var node=this._head;if(!node)return this;this._head=this._tail=null;while(node){node._owner=null;node=node._next}return this}}]);return MiniSignal}();MiniSignal.MiniSignalBinding=MiniSignalBinding;exports["default"]=MiniSignal;module.exports=exports["default"]},{}],72:[function(require,module,exports){(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.moment=factory()})(this,function(){"use strict";var hookCallback;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(callback){hookCallback=callback}function isArray(input){return input instanceof Array||Object.prototype.toString.call(input)==="[object Array]"}function isObject(input){return input!=null&&Object.prototype.toString.call(input)==="[object Object]"}function isObjectEmpty(obj){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(obj).length===0}else{var k;for(k in obj){if(obj.hasOwnProperty(k)){return false}}return true}}function isUndefined(input){return input===void 0}function isNumber(input){return typeof input==="number"||Object.prototype.toString.call(input)==="[object Number]"}function isDate(input){return input instanceof Date||Object.prototype.toString.call(input)==="[object Date]"}function map(arr,fn){var res=[],i;for(i=0;i<arr.length;++i){res.push(fn(arr[i],i))}return res}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i]}}if(hasOwnProp(b,"toString")){a.toString=b.toString}if(hasOwnProp(b,"valueOf")){a.valueOf=b.valueOf}return a}function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc()}function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],meridiem:null,rfc2822:false,weekdayMismatch:false}}function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags()}return m._pf}var some;if(Array.prototype.some){some=Array.prototype.some}else{some=function(fun){var t=Object(this);var len=t.length>>>0;for(var i=0;i<len;i++){if(i in t&&fun.call(this,t[i],i,t)){return true}}return false}}function isValid(m){if(m._isValid==null){var flags=getParsingFlags(m);var parsedParts=some.call(flags.parsedDateParts,function(i){return i!=null});var isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||flags.meridiem&&parsedParts);if(m._strict){isNowValid=isNowValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(m)){m._isValid=isNowValid}else{return isNowValid}}return m._isValid}function createInvalid(flags){var m=createUTC(NaN);if(flags!=null){extend(getParsingFlags(m),flags)}else{getParsingFlags(m).userInvalidated=true}return m}var momentProperties=hooks.momentProperties=[];function copyConfig(to,from){var i,prop,val;if(!isUndefined(from._isAMomentObject)){to._isAMomentObject=from._isAMomentObject}if(!isUndefined(from._i)){to._i=from._i}if(!isUndefined(from._f)){to._f=from._f}if(!isUndefined(from._l)){to._l=from._l}if(!isUndefined(from._strict)){to._strict=from._strict}if(!isUndefined(from._tzm)){to._tzm=from._tzm}if(!isUndefined(from._isUTC)){to._isUTC=from._isUTC}if(!isUndefined(from._offset)){to._offset=from._offset}if(!isUndefined(from._pf)){to._pf=getParsingFlags(from)}if(!isUndefined(from._locale)){to._locale=from._locale}if(momentProperties.length>0){for(i=0;i<momentProperties.length;i++){prop=momentProperties[i];val=from[prop];if(!isUndefined(val)){to[prop]=val}}}return to}var updateInProgress=false;function Moment(config){copyConfig(this,config);this._d=new Date(config._d!=null?config._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(updateInProgress===false){updateInProgress=true;hooks.updateOffset(this);updateInProgress=false}}function isMoment(obj){return obj instanceof Moment||obj!=null&&obj._isAMomentObject!=null}function absFloor(number){if(number<0){return Math.ceil(number)||0}else{return Math.floor(number)}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){value=absFloor(coercedNumber)}return value}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i])){diffs++}}return diffs+lengthDiff}function warn(msg){if(hooks.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}function deprecate(msg,fn){var firstTime=true;return extend(function(){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(null,msg)}if(firstTime){var args=[];var arg;for(var i=0;i<arguments.length;i++){arg="";if(typeof arguments[i]==="object"){arg+="\n["+i+"] ";for(var key in arguments[0]){arg+=key+": "+arguments[0][key]+", "}arg=arg.slice(0,-2)}else{arg=arguments[i]}args.push(arg)}warn(msg+"\nArguments: "+Array.prototype.slice.call(args).join("")+"\n"+(new Error).stack);firstTime=false}return fn.apply(this,arguments)},fn)}var deprecations={};function deprecateSimple(name,msg){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(name,msg)}if(!deprecations[name]){warn(msg);deprecations[name]=true}}hooks.suppressDeprecationWarnings=false;hooks.deprecationHandler=null;function isFunction(input){return input instanceof Function||Object.prototype.toString.call(input)==="[object Function]"}function set(config){var prop,i;for(i in config){prop=config[i];if(isFunction(prop)){this[i]=prop}else{this["_"+i]=prop}}this._config=config;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(parentConfig,childConfig){var res=extend({},parentConfig),prop;for(prop in childConfig){if(hasOwnProp(childConfig,prop)){if(isObject(parentConfig[prop])&&isObject(childConfig[prop])){res[prop]={};extend(res[prop],parentConfig[prop]);extend(res[prop],childConfig[prop])}else if(childConfig[prop]!=null){res[prop]=childConfig[prop]}else{delete res[prop]}}}for(prop in parentConfig){if(hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])){res[prop]=extend({},res[prop])}}return res}function Locale(config){if(config!=null){this.set(config)}}var keys;if(Object.keys){keys=Object.keys}else{keys=function(obj){var i,res=[];for(i in obj){if(hasOwnProp(obj,i)){res.push(i)}}return res}}var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(key,mom,now){var output=this._calendar[key]||this._calendar["sameElse"];return isFunction(output)?output.call(mom,now):output}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];if(format||!formatUpper){return format}this._longDateFormat[key]=formatUpper.replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)});return this._longDateFormat[key]}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d";var defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace("%d",number)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)}function pastFuture(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return isFunction(format)?format(output):format.replace(/%s/i,output)}var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return typeof units==="string"?aliases[units]||aliases[units.toLowerCase()]:undefined}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop]}}}return normalizedInput}var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority}function getPrioritizedUnits(unitsObj){var units=[];for(var u in unitsObj){units.push({unit:u,priority:priorities[u]})}units.sort(function(a,b){return a.priority-b.priority});return units}function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;var localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;var formatFunctions={};var formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==="string"){func=function(){return this[callback]()}}if(token){formatTokenFunctions[token]=func}if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}}if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)}}}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="",i;for(i=0;i<length;i++){output+=isFunction(array[i])?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate()}format=expandFormat(format,m.localeData());formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format);return formatFunctions[format](m)}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}var match1=/\d/;var match2=/\d\d/;var match3=/\d{3}/;var match4=/\d{4}/;var match6=/[+-]?\d{6}/;var match1to2=/\d\d?/;var match3to4=/\d\d\d\d?/;var match5to6=/\d\d\d\d\d\d?/;var match1to3=/\d{1,3}/;var match1to4=/\d{1,4}/;var match1to6=/[+-]?\d{1,6}/;var matchUnsigned=/\d+/;var matchSigned=/[+-]?\d+/;var matchOffset=/Z|[+-]\d\d:?\d\d/gi;var matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi;var matchTimestamp=/[+-]?\d+(\.\d{1,3})?/;var matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;var regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token))}return regexes[token](config._strict,config._locale)}function unescapeFormat(s){return regexEscape(s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4}))}function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var tokens={};function addParseToken(token,callback){var i,func=callback;if(typeof token==="string"){token=[token]}if(isNumber(callback)){func=function(input,array){array[callback]=toInt(input)}}for(i=0;i<token.length;i++){tokens[token[i]]=func}}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token)}}var YEAR=0;var MONTH=1;var DATE=2;var HOUR=3;var MINUTE=4;var SECOND=5;var MILLISECOND=6;var WEEK=7;var WEEKDAY=8;addFormatToken("Y",0,0,function(){var y=this.year();return y<=9999?""+y:"+"+y});addFormatToken(0,["YY",2],0,function(){return this.year()%100});addFormatToken(0,["YYYY",4],0,"year");addFormatToken(0,["YYYYY",5],0,"year");addFormatToken(0,["YYYYYY",6,true],0,"year");addUnitAlias("year","y");addUnitPriority("year",1);addRegexToken("Y",matchSigned);addRegexToken("YY",match1to2,match2);addRegexToken("YYYY",match1to4,match4);addRegexToken("YYYYY",match1to6,match6);addRegexToken("YYYYYY",match1to6,match6);addParseToken(["YYYYY","YYYYYY"],YEAR);addParseToken("YYYY",function(input,array){array[YEAR]=input.length===2?hooks.parseTwoDigitYear(input):toInt(input)});addParseToken("YY",function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input)});addParseToken("Y",function(input,array){array[YEAR]=parseInt(input,10)});function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",true);function getIsLeapYear(){return isLeapYear(this.year())}function makeGetSet(unit,keepTime){return function(value){if(value!=null){set$1(this,unit,value);hooks.updateOffset(this,keepTime);return this}else{return get(this,unit)}}}function get(mom,unit){return mom.isValid()?mom._d["get"+(mom._isUTC?"UTC":"")+unit]():NaN}function set$1(mom,unit,value){if(mom.isValid()&&!isNaN(value)){if(unit==="FullYear"&&isLeapYear(mom.year())&&mom.month()===1&&mom.date()===29){mom._d["set"+(mom._isUTC?"UTC":"")+unit](value,mom.month(),daysInMonth(value,mom.month()))}else{mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}}}function stringGet(units){units=normalizeUnits(units);if(isFunction(this[units])){return this[units]()}return this}function stringSet(units,value){if(typeof units==="object"){units=normalizeObjectUnits(units);var prioritized=getPrioritizedUnits(units);for(var i=0;i<prioritized.length;i++){this[prioritized[i].unit](units[prioritized[i].unit])}}else{units=normalizeUnits(units);if(isFunction(this[units])){return this[units](value)}}return this}function mod(n,x){return(n%x+x)%x}var indexOf;if(Array.prototype.indexOf){indexOf=Array.prototype.indexOf}else{indexOf=function(o){var i;for(i=0;i<this.length;++i){if(this[i]===o){return i}}return-1}}function daysInMonth(year,month){if(isNaN(year)||isNaN(month)){return NaN}var modMonth=mod(month,12);year+=(month-modMonth)/12;return modMonth===1?isLeapYear(year)?29:28:31-modMonth%7%2}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1});addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)});addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)});addUnitAlias("month","M");addUnitPriority("month",8);addRegexToken("M",match1to2);addRegexToken("MM",match1to2,match2);addRegexToken("MMM",function(isStrict,locale){return locale.monthsShortRegex(isStrict)});addRegexToken("MMMM",function(isStrict,locale){return locale.monthsRegex(isStrict)});addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1});addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month}else{getParsingFlags(config).invalidMonth=input}});var MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function localeMonths(m,format){if(!m){return isArray(this._months)?this._months:this._months["standalone"]}return isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?"format":"standalone"][m.month()]}var defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function localeMonthsShort(m,format){if(!m){return isArray(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]}function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(i=0;i<12;++i){mom=createUTC([2e3,i]);this._shortMonthsParse[i]=this.monthsShort(mom,"").toLocaleLowerCase();this._longMonthsParse[i]=this.months(mom,"").toLocaleLowerCase()}}if(strict){if(format==="MMM"){ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null}}else{if(format==="MMM"){ii=indexOf.call(this._shortMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._longMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}}}function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact){return handleStrictParse.call(this,monthName,format,strict)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(i=0;i<12;i++){mom=createUTC([2e3,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i");this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")}if(!strict&&!this._monthsParse[i]){regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="MMMM"&&this._longMonthsParse[i].test(monthName)){return i}else if(strict&&format==="MMM"&&this._shortMonthsParse[i].test(monthName)){return i}else if(!strict&&this._monthsParse[i].test(monthName)){return i}}}function setMonth(mom,value){var dayOfMonth;if(!mom.isValid()){return mom}if(typeof value==="string"){if(/^\d+$/.test(value)){value=toInt(value)}else{value=mom.localeData().monthsParse(value);if(!isNumber(value)){return mom}}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function getSetMonth(value){if(value!=null){setMonth(this,value);hooks.updateOffset(this,true);return this}else{return get(this,"Month")}}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}var defaultMonthsShortRegex=matchWord;function monthsShortRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!hasOwnProp(this,"_monthsShortRegex")){this._monthsShortRegex=defaultMonthsShortRegex}return this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex}}var defaultMonthsRegex=matchWord;function monthsRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!hasOwnProp(this,"_monthsRegex")){this._monthsRegex=defaultMonthsRegex}return this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex}}function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length}var shortPieces=[],longPieces=[],mixedPieces=[],i,mom;for(i=0;i<12;i++){mom=createUTC([2e3,i]);shortPieces.push(this.monthsShort(mom,""));longPieces.push(this.months(mom,""));mixedPieces.push(this.months(mom,""));mixedPieces.push(this.monthsShort(mom,""))}shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<12;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i])}for(i=0;i<24;i++){mixedPieces[i]=regexEscape(mixedPieces[i])}this._monthsRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i")}function createDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<100&&y>=0&&isFinite(date.getFullYear())){date.setFullYear(y)}return date}function createUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<100&&y>=0&&isFinite(date.getUTCFullYear())){date.setUTCFullYear(y)}return date}function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1}function dayOfYearFromWeeks(year,week,weekday,dow,doy){var localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset,resYear,resDayOfYear;if(dayOfYear<=0){resYear=year-1;resDayOfYear=daysInYear(resYear)+dayOfYear}else if(dayOfYear>daysInYear(year)){resYear=year+1;resDayOfYear=dayOfYear-daysInYear(year)}else{resYear=year;resDayOfYear=dayOfYear}return{year:resYear,dayOfYear:resDayOfYear}}function weekOfYear(mom,dow,doy){var weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1,resWeek,resYear;if(week<1){resYear=mom.year()-1;resWeek=week+weeksInYear(resYear,dow,doy)}else if(week>weeksInYear(mom.year(),dow,doy)){resWeek=week-weeksInYear(mom.year(),dow,doy);resYear=mom.year()+1}else{resYear=mom.year();resWeek=week}return{week:resWeek,year:resYear}}function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7}addFormatToken("w",["ww",2],"wo","week");addFormatToken("W",["WW",2],"Wo","isoWeek");addUnitAlias("week","w");addUnitAlias("isoWeek","W");addUnitPriority("week",5);addUnitPriority("isoWeek",5);addRegexToken("w",match1to2);addRegexToken("ww",match1to2,match2);addRegexToken("W",match1to2);addRegexToken("WW",match1to2,match2);addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)});function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,"d")}function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,"d")}addFormatToken("d",0,"do","day");addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)});addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)});addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)});addFormatToken("e",0,0,"weekday");addFormatToken("E",0,0,"isoWeekday");addUnitAlias("day","d");addUnitAlias("weekday","e");addUnitAlias("isoWeekday","E");addUnitPriority("day",11);addUnitPriority("weekday",11);addUnitPriority("isoWeekday",11);addRegexToken("d",match1to2);addRegexToken("e",match1to2);addRegexToken("E",match1to2);addRegexToken("dd",function(isStrict,locale){return locale.weekdaysMinRegex(isStrict)});addRegexToken("ddd",function(isStrict,locale){return locale.weekdaysShortRegex(isStrict)});addRegexToken("dddd",function(isStrict,locale){return locale.weekdaysRegex(isStrict)});addWeekParseToken(["dd","ddd","dddd"],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);if(weekday!=null){week.d=weekday}else{getParsingFlags(config).invalidWeekday=input}});addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});function parseWeekday(input,locale){if(typeof input!=="string"){return input}if(!isNaN(input)){return parseInt(input,10)}input=locale.weekdaysParse(input);if(typeof input==="number"){return input}return null}function parseIsoWeekday(input,locale){if(typeof input==="string"){return locale.weekdaysParse(input)%7||7}return isNaN(input)?null:input}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function localeWeekdays(m,format){if(!m){return isArray(this._weekdays)?this._weekdays:this._weekdays["standalone"]}return isArray(this._weekdays)?this._weekdays[m.day()]:this._weekdays[this._weekdays.isFormat.test(format)?"format":"standalone"][m.day()]}var defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function localeWeekdaysShort(m){return m?this._weekdaysShort[m.day()]:this._weekdaysShort}var defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function localeWeekdaysMin(m){return m?this._weekdaysMin[m.day()]:this._weekdaysMin}function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(i=0;i<7;++i){mom=createUTC([2e3,1]).day(i);this._minWeekdaysParse[i]=this.weekdaysMin(mom,"").toLocaleLowerCase();this._shortWeekdaysParse[i]=this.weekdaysShort(mom,"").toLocaleLowerCase();this._weekdaysParse[i]=this.weekdays(mom,"").toLocaleLowerCase()}}if(strict){if(format==="dddd"){ii=indexOf.call(this._weekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}}else{if(format==="dddd"){ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._minWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}}}function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact){return handleStrictParse$1.call(this,weekdayName,format,strict)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);if(strict&&!this._fullWeekdaysParse[i]){this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(mom,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(mom,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(mom,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[i]){regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="dddd"&&this._fullWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="ddd"&&this._shortWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="dd"&&this._minWeekdaysParse[i].test(weekdayName)){return i}else if(!strict&&this._weekdaysParse[i].test(weekdayName)){return i}}}function getSetDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,"d")}else{return day}}function getSetLocaleDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,"d")}function getSetISODayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}if(input!=null){var weekday=parseIsoWeekday(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7)}else{return this.day()||7}}var defaultWeekdaysRegex=matchWord;function weekdaysRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!hasOwnProp(this,"_weekdaysRegex")){this._weekdaysRegex=defaultWeekdaysRegex}return this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex}}var defaultWeekdaysShortRegex=matchWord;function weekdaysShortRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!hasOwnProp(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=defaultWeekdaysShortRegex}return this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}var defaultWeekdaysMinRegex=matchWord;function weekdaysMinRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!hasOwnProp(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=defaultWeekdaysMinRegex}return this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length}var minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[],i,mom,minp,shortp,longp;for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);minp=this.weekdaysMin(mom,"");shortp=this.weekdaysShort(mom,"");longp=this.weekdays(mom,"");minPieces.push(minp);shortPieces.push(shortp);longPieces.push(longp);mixedPieces.push(minp);mixedPieces.push(shortp);mixedPieces.push(longp)}minPieces.sort(cmpLenRev);shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<7;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i]);mixedPieces[i]=regexEscape(mixedPieces[i])}this._weekdaysRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+minPieces.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}addFormatToken("H",["HH",2],0,"hour");addFormatToken("h",["hh",2],0,hFormat);addFormatToken("k",["kk",2],0,kFormat);addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)});addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)});addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}meridiem("a",true);meridiem("A",false);addUnitAlias("hour","h");addUnitPriority("hour",13);function matchMeridiem(isStrict,locale){return locale._meridiemParse}addRegexToken("a",matchMeridiem);addRegexToken("A",matchMeridiem);addRegexToken("H",match1to2);addRegexToken("h",match1to2);addRegexToken("k",match1to2);addRegexToken("HH",match1to2,match2);addRegexToken("hh",match1to2,match2);addRegexToken("kk",match1to2,match2);addRegexToken("hmm",match3to4);addRegexToken("hmmss",match5to6);addRegexToken("Hmm",match3to4);addRegexToken("Hmmss",match5to6);addParseToken(["H","HH"],HOUR);addParseToken(["k","kk"],function(input,array,config){var kInput=toInt(input);array[HOUR]=kInput===24?0:kInput});addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input});addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true});addParseToken("hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));getParsingFlags(config).bigHour=true});addParseToken("hmmss",function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));getParsingFlags(config).bigHour=true});addParseToken("Hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos))});addParseToken("Hmmss",function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2))});function localeIsPM(input){return(input+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i;function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}}var getSetHour=makeGetSet("Hours",true);var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse};var locales={};var localeFamilies={};var globalLocale;function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split("-");j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split("-"):null;while(j>0){locale=loadLocale(split.slice(0,j).join("-"));if(locale){return locale}if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break}j--}i++}return globalLocale}function loadLocale(name){var oldLocale=null;if(!locales[name]&&typeof module!=="undefined"&&module&&module.exports){try{oldLocale=globalLocale._abbr;var aliasedRequire=require;aliasedRequire("./locale/"+name);getSetGlobalLocale(oldLocale)}catch(e){}}return locales[name]}function getSetGlobalLocale(key,values){var data;if(key){if(isUndefined(values)){data=getLocale(key)}else{data=defineLocale(key,values)}if(data){globalLocale=data}else{if(typeof console!=="undefined"&&console.warn){console.warn("Locale "+key+" not found. Did you forget to load it?")}}}return globalLocale._abbr}function defineLocale(name,config){if(config!==null){var locale,parentConfig=baseConfig;config.abbr=name;if(locales[name]!=null){deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");parentConfig=locales[name]._config}else if(config.parentLocale!=null){if(locales[config.parentLocale]!=null){parentConfig=locales[config.parentLocale]._config}else{locale=loadLocale(config.parentLocale);if(locale!=null){parentConfig=locale._config}else{if(!localeFamilies[config.parentLocale]){localeFamilies[config.parentLocale]=[]}localeFamilies[config.parentLocale].push({name:name,config:config});return null}}}locales[name]=new Locale(mergeConfigs(parentConfig,config));if(localeFamilies[name]){localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config)})}getSetGlobalLocale(name);return locales[name]}else{delete locales[name];return null}}function updateLocale(name,config){if(config!=null){var locale,tmpLocale,parentConfig=baseConfig;tmpLocale=loadLocale(name);if(tmpLocale!=null){parentConfig=tmpLocale._config}config=mergeConfigs(parentConfig,config);locale=new Locale(config);locale.parentLocale=locales[name];locales[name]=locale;getSetGlobalLocale(name)}else{if(locales[name]!=null){if(locales[name].parentLocale!=null){locales[name]=locales[name].parentLocale}else if(locales[name]!=null){delete locales[name]}}}return locales[name]}function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr}if(!key){return globalLocale}if(!isArray(key)){locale=loadLocale(key);if(locale){return locale}key=[key]}return chooseLocale(key)}function listLocales(){return keys(locales)}function checkOverflow(m){var overflow;var a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0)?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}if(getParsingFlags(m)._overflowWeeks&&overflow===-1){overflow=WEEK}if(getParsingFlags(m)._overflowWeekday&&overflow===-1){overflow=WEEKDAY}getParsingFlags(m).overflow=overflow}return m}function defaults(a,b,c){if(a!=null){return a}if(b!=null){return b}return c}function currentDateArray(config){var nowValue=new Date(hooks.now());if(config._useUTC){return[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()]}return[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()]}function configFromArray(config){var i,date,input=[],currentDate,expectedWeekday,yearToUse;if(config._d){return}currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config)}if(config._dayOfYear!=null){yearToUse=defaults(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)||config._dayOfYear===0){getParsingFlags(config)._overflowDayOfYear=true}date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=config._a[i]==null?i===2?1:0:config._a[i]}if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0}config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay();if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm)}if(config._nextDay){config._a[HOUR]=24}if(config._w&&typeof config._w.d!=="undefined"&&config._w.d!==expectedWeekday){getParsingFlags(config).weekdayMismatch=true}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year);week=defaults(w.W,1);weekday=defaults(w.E,1);if(weekday<1||weekday>7){weekdayOverflow=true}}else{dow=config._locale._week.dow;doy=config._locale._week.doy;var curWeek=weekOfYear(createLocal(),dow,doy);weekYear=defaults(w.gg,config._a[YEAR],curWeek.year);week=defaults(w.w,curWeek.week);if(w.d!=null){weekday=w.d;if(weekday<0||weekday>6){weekdayOverflow=true}}else if(w.e!=null){weekday=w.e+dow;if(w.e<0||w.e>6){weekdayOverflow=true}}else{weekday=dow}}if(week<1||week>weeksInYear(weekYear,dow,doy)){getParsingFlags(config)._overflowWeeks=true}else if(weekdayOverflow!=null){getParsingFlags(config)._overflowWeekday=true}else{temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var tzRegex=/Z|[+-]\d\d(?::?\d\d)?/;var isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/]];var isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]];var aspNetJsonRegex=/^\/?Date\((\-?\d+)/i;function configFromISO(config){var i,l,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),allowTime,dateFormat,timeFormat,tzFormat;if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0];allowTime=isoDates[i][2]!==false;break}}if(dateFormat==null){config._isValid=false;return}if(match[3]){for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||" ")+isoTimes[i][0];break}}if(timeFormat==null){config._isValid=false;return}}if(!allowTime&&timeFormat!=null){config._isValid=false;return}if(match[4]){if(tzRegex.exec(match[4])){tzFormat="Z"}else{config._isValid=false;return}}config._f=dateFormat+(timeFormat||"")+(tzFormat||"");configFromStringAndFormat(config)}else{config._isValid=false}}var rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[untruncateYear(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)];if(secondStr){result.push(parseInt(secondStr,10))}return result}function untruncateYear(yearStr){var year=parseInt(yearStr,10);if(year<=49){return 2e3+year}else if(year<=999){return 1900+year}return year}function preprocessRFC2822(s){return s.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(weekdayStr,parsedInput,config){if(weekdayStr){var weekdayProvided=defaultLocaleWeekdaysShort.indexOf(weekdayStr),weekdayActual=new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay();if(weekdayProvided!==weekdayActual){getParsingFlags(config).weekdayMismatch=true;config._isValid=false;return false}}return true}var obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function calculateOffset(obsOffset,militaryOffset,numOffset){if(obsOffset){return obsOffsets[obsOffset]}else if(militaryOffset){return 0}else{var hm=parseInt(numOffset,10);var m=hm%100,h=(hm-m)/100;return h*60+m}}function configFromRFC2822(config){var match=rfc2822.exec(preprocessRFC2822(config._i));if(match){var parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]);if(!checkWeekday(match[1],parsedArray,config)){return}config._a=parsedArray;config._tzm=calculateOffset(match[8],match[9],match[10]);config._d=createUTCDate.apply(null,config._a);config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);getParsingFlags(config).rfc2822=true}else{config._isValid=false}}function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return}configFromISO(config);if(config._isValid===false){delete config._isValid}else{return}configFromRFC2822(config);if(config._isValid===false){delete config._isValid}else{return}hooks.createFromInputFallback(config)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged and will be removed in an upcoming major release. Please refer to "+"http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))});hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(config){if(config._f===hooks.ISO_8601){configFromISO(config);return}if(config._f===hooks.RFC_2822){configFromRFC2822(config);return}config._a=[];getParsingFlags(config).empty=true;var string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false}else{getParsingFlags(config).unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token)}}getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string)}if(config._a[HOUR]<=12&&getParsingFlags(config).bigHour===true&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined}getParsingFlags(config).parsedDateParts=config._a.slice(0);getParsingFlags(config).meridiem=config._meridiem;config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);configFromArray(config);checkOverflow(config)}function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour}if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem)}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12}if(!isPm&&hour===12){hour=0}return hour}else{return hour}}function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return}for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC}tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(!isValid(tempConfig)){continue}currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}extend(config,bestMoment||tempConfig)}function configFromObject(config){if(config._d){return}var i=normalizeObjectUnits(config._i);config._a=map([i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10)});configFromArray(config)}function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));if(res._nextDay){res.add(1,"d");res._nextDay=undefined}return res}function prepareConfig(config){var input=config._i,format=config._f;config._locale=config._locale||getLocale(config._l);if(input===null||format===undefined&&input===""){return createInvalid({nullInput:true})}if(typeof input==="string"){config._i=input=config._locale.preparse(input)}if(isMoment(input)){return new Moment(checkOverflow(input))}else if(isDate(input)){config._d=input}else if(isArray(format)){configFromStringAndArray(config)}else if(format){configFromStringAndFormat(config)}else{configFromInput(config)}if(!isValid(config)){config._d=null}return config}function configFromInput(config){var input=config._i;if(isUndefined(input)){config._d=new Date(hooks.now())}else if(isDate(input)){config._d=new Date(input.valueOf())}else if(typeof input==="string"){configFromString(config)}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10)});configFromArray(config)}else if(isObject(input)){configFromObject(config)}else if(isNumber(input)){config._d=new Date(input)}else{hooks.createFromInputFallback(config)}}function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(locale===true||locale===false){strict=locale;locale=undefined}if(isObject(input)&&isObjectEmpty(input)||isArray(input)&&input.length===0){input=undefined}c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c)}function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false)}var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other<this?this:other}else{return createInvalid()}});var prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other>this?this:other}else{return createInvalid()}});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0]}if(!moments.length){return createLocal()}res=moments[0];for(i=1;i<moments.length;++i){if(!moments[i].isValid()||moments[i][fn](res)){res=moments[i]}}return res}function min(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)}function max(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)}var now=function(){return Date.now?Date.now():+new Date};var ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(m){for(var key in m){if(!(indexOf.call(ordering,key)!==-1&&(m[key]==null||!isNaN(m[key])))){return false}}var unitHasDecimal=false;for(var i=0;i<ordering.length;++i){if(m[ordering[i]]){if(unitHasDecimal){return false}if(parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])){unitHasDecimal=true}}}return true}function isValid$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=isDurationValid(normalizedInput);this._milliseconds=+milliseconds+seconds*1e3+minutes*6e4+hours*1e3*60*60;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._locale=getLocale();this._bubble()}function isDuration(obj){return obj instanceof Duration}function absRound(number){if(number<0){return Math.round(-1*number)*-1}else{return Math.round(number)}}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset();var sign="+";if(offset<0){offset=-offset;sign="-"}return sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}offset("Z",":");offset("ZZ","");addRegexToken("Z",matchShortOffset);addRegexToken("ZZ",matchShortOffset);addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(matchShortOffset,input)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var matches=(string||"").match(matcher);if(matches===null){return null}var chunk=matches[matches.length-1]||[];var parts=(chunk+"").match(chunkOffset)||["-",0,0];var minutes=+(parts[1]*60)+toInt(parts[2]);return minutes===0?0:parts[0]==="+"?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf();res._d.setTime(res._d.valueOf()+diff);hooks.updateOffset(res,false);return res}else{return createLocal(input).local()}}function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset()/15)*15}hooks.updateOffset=function(){};function getSetOffset(input,keepLocalTime,keepMinutes){var offset=this._offset||0,localAdjust;if(!this.isValid()){return input!=null?this:NaN}if(input!=null){if(typeof input==="string"){input=offsetFromString(matchShortOffset,input);if(input===null){return this}}else if(Math.abs(input)<16&&!keepMinutes){input=input*60}if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this)}this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,"m")}if(offset!==input){if(!keepLocalTime||this._changeInProgress){addSubtract(this,createDuration(input-offset,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;hooks.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?offset:getDateOffset(this)}}function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=="string"){input=-input}this.utcOffset(input,keepLocalTime);return this}else{return-this.utcOffset()}}function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime)}function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),"m")}}return this}function setOffsetToParsedOffset(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var tZone=offsetFromString(matchOffset,this._i);if(tZone!=null){this.utcOffset(tZone)}else{this.utcOffset(0,true)}}return this}function hasAlignedHourOffset(input){if(!this.isValid()){return false}input=input?createLocal(input).utcOffset():0;return(this.utcOffset()-input)%60===0}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined(this._isDSTShifted)){return this._isDSTShifted}var c={};copyConfig(c,this);c=prepareConfig(c);if(c._a){var other=c._isUTC?createUTC(c._a):createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function isLocal(){return this.isValid()?!this._isUTC:false}function isUtcOffset(){return this.isValid()?this._isUTC:false}function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:false}var aspNetRegex=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/;var isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else if(isNumber(input)){duration={};if(key){duration[key]=input}else{duration.milliseconds=input}}else if(!!(match=aspNetRegex.exec(input))){sign=match[1]==="-"?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(match[MILLISECOND]*1e3))*sign}}else if(!!(match=isoRegex.exec(input))){sign=match[1]==="-"?-1:match[1]==="+"?1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)}}else if(duration==null){duration={}}else if(typeof duration==="object"&&("from"in duration||"to"in duration)){diffRes=momentsDifference(createLocal(duration.from),createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months}ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,"_locale")){ret._locale=input._locale}return ret}createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};res.months=other.month()-base.month()+(other.year()-base.year())*12;if(base.clone().add(res.months,"M").isAfter(other)){--res.months}res.milliseconds=+other-+base.clone().add(res.months,"M");return res}function momentsDifference(base,other){var res;if(!(base.isValid()&&other.isValid())){return{milliseconds:0,months:0}}other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other)}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months}return res}function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");tmp=val;val=period;period=tmp}val=typeof val==="string"?+val:val;dur=createDuration(val,period);addSubtract(this,dur,direction);return this}}function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);if(!mom.isValid()){return}updateOffset=updateOffset==null?true:updateOffset;if(months){setMonth(mom,get(mom,"Month")+months*isAdding)}if(days){set$1(mom,"Date",get(mom,"Date")+days*isAdding)}if(milliseconds){mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding)}if(updateOffset){hooks.updateOffset(mom,days||months)}}var add=createAdder(1,"add");var subtract=createAdder(-1,"subtract");function getCalendarFormat(myMoment,now){var diff=myMoment.diff(now,"days",true);return diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse"}function calendar$1(time,formats){var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf("day"),format=hooks.calendarFormat(this,sod)||"sameElse";var output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)))}function clone(){return new Moment(this)}function isAfter(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(!isUndefined(units)?units:"millisecond");if(units==="millisecond"){return this.valueOf()>localInput.valueOf()}else{return localInput.valueOf()<this.clone().startOf(units).valueOf()}}function isBefore(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(!isUndefined(units)?units:"millisecond");if(units==="millisecond"){return this.valueOf()<localInput.valueOf()}else{return this.clone().endOf(units).valueOf()<localInput.valueOf()}}function isBetween(from,to,units,inclusivity){inclusivity=inclusivity||"()";return(inclusivity[0]==="("?this.isAfter(from,units):!this.isBefore(from,units))&&(inclusivity[1]===")"?this.isBefore(to,units):!this.isAfter(to,units))}function isSame(input,units){var localInput=isMoment(input)?input:createLocal(input),inputMs;if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units||"millisecond");if(units==="millisecond"){return this.valueOf()===localInput.valueOf()}else{inputMs=localInput.valueOf();return this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf()}}function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units)}function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units)}function diff(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid()){return NaN}that=cloneWithOffset(input,this);if(!that.isValid()){return NaN}zoneDelta=(that.utcOffset()-this.utcOffset())*6e4;units=normalizeUnits(units);switch(units){case"year":output=monthDiff(this,that)/12;break;case"month":output=monthDiff(this,that);break;case"quarter":output=monthDiff(this,that)/3;break;case"second":output=(this-that)/1e3;break;case"minute":output=(this-that)/6e4;break;case"hour":output=(this-that)/36e5;break;case"day":output=(this-that-zoneDelta)/864e5;break;case"week":output=(this-that-zoneDelta)/6048e5;break;default:output=this-that}return asFloat?output:absFloor(output)}function monthDiff(a,b){var wholeMonthDiff=(b.year()-a.year())*12+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months"),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,"months");adjust=(b-anchor)/(anchor-anchor2)}else{anchor2=a.clone().add(wholeMonthDiff+1,"months");adjust=(b-anchor)/(anchor2-anchor)}return-(wholeMonthDiff+adjust)||0}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(keepOffset){if(!this.isValid()){return null}var utc=keepOffset!==true;var m=utc?this.clone().utc():this;if(m.year()<0||m.year()>9999){return formatMoment(m,utc?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ")}if(isFunction(Date.prototype.toISOString)){if(utc){return this.toDate().toISOString()}else{return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",formatMoment(m,"Z"))}}return formatMoment(m,utc?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var func="moment";var zone="";if(!this.isLocal()){func=this.utcOffset()===0?"moment.utc":"moment.parseZone";zone="Z"}var prefix="["+func+'("]';var year=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";var datetime="-MM-DD[T]HH:mm:ss.SSS";var suffix=zone+'[")]';return this.format(prefix+year+datetime+suffix)}function format(inputString){if(!inputString){inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat}var output=formatMoment(this,inputString);return this.localeData().postformat(output)}function from(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function fromNow(withoutSuffix){return this.from(createLocal(),withoutSuffix)}function to(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function toNow(withoutSuffix){return this.to(createLocal(),withoutSuffix)}function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr}else{newLocaleData=getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData}return this}}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){if(key===undefined){return this.localeData()}else{return this.locale(key)}});function localeData(){return this._locale}function startOf(units){units=normalizeUnits(units);switch(units){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(units==="week"){this.weekday(0)}if(units==="isoWeek"){this.isoWeekday(1)}if(units==="quarter"){this.month(Math.floor(this.month()/3)*3)}return this}function endOf(units){units=normalizeUnits(units);if(units===undefined||units==="millisecond"){return this}if(units==="date"){units="day"}return this.startOf(units).add(1,units==="isoWeek"?"week":units).subtract(1,"ms")}function valueOf(){return this._d.valueOf()-(this._offset||0)*6e4}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid(this)}function parsingFlags(){return extend({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100});addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}addWeekYearFormatToken("gggg","weekYear");addWeekYearFormatToken("ggggg","weekYear");addWeekYearFormatToken("GGGG","isoWeekYear");addWeekYearFormatToken("GGGGG","isoWeekYear");addUnitAlias("weekYear","gg");addUnitAlias("isoWeekYear","GG");addUnitPriority("weekYear",1);addUnitPriority("isoWeekYear",1);addRegexToken("G",matchSigned);addRegexToken("g",matchSigned);addRegexToken("GG",match1to2,match2);addRegexToken("gg",match1to2,match2);addRegexToken("GGGG",match1to4,match4);addRegexToken("gggg",match1to4,match4);addRegexToken("GGGGG",match1to6,match6);addRegexToken("ggggg",match1to6,match6);addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)});addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input)});function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)}function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;if(input==null){return weekOfYear(this,dow,doy).year}else{weeksTarget=weeksInYear(input,dow,doy);if(week>weeksTarget){week=weeksTarget}return setWeekAll.call(this,input,week,weekday,dow,doy)}}function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);this.year(date.getUTCFullYear());this.month(date.getUTCMonth());this.date(date.getUTCDate());return this}addFormatToken("Q",0,"Qo","quarter");addUnitAlias("quarter","Q");addUnitPriority("quarter",7);addRegexToken("Q",match1);addParseToken("Q",function(input,array){array[MONTH]=(toInt(input)-1)*3});function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date");addUnitAlias("date","D");addUnitPriority("date",9);addRegexToken("D",match1to2);addRegexToken("DD",match1to2,match2);addRegexToken("Do",function(isStrict,locale){return isStrict?locale._dayOfMonthOrdinalParse||locale._ordinalParse:locale._dayOfMonthOrdinalParseLenient});addParseToken(["D","DD"],DATE);addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",true);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear");addUnitAlias("dayOfYear","DDD");addUnitPriority("dayOfYear",4);addRegexToken("DDD",match1to3);addRegexToken("DDDD",match3);addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)});function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return input==null?dayOfYear:this.add(input-dayOfYear,"d")}addFormatToken("m",["mm",2],0,"minute");addUnitAlias("minute","m");addUnitPriority("minute",14);addRegexToken("m",match1to2);addRegexToken("mm",match1to2,match2);addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",false);addFormatToken("s",["ss",2],0,"second");addUnitAlias("second","s");addUnitPriority("second",15);addRegexToken("s",match1to2);addRegexToken("ss",match1to2,match2);addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",false);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)});addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)});addFormatToken(0,["SSS",3],0,"millisecond");addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10});addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100});addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});addUnitAlias("millisecond","ms");addUnitPriority("millisecond",16);addRegexToken("S",match1to3,match1);addRegexToken("SS",match1to3,match2);addRegexToken("SSS",match1to3,match3);var token;for(token="SSSS";token.length<=9;token+="S"){addRegexToken(token,matchUnsigned)}function parseMs(input,array){array[MILLISECOND]=toInt(("0."+input)*1e3)}for(token="S";token.length<=9;token+="S"){addParseToken(token,parseMs)}var getSetMillisecond=makeGetSet("Milliseconds",false);addFormatToken("z",0,0,"zoneAbbr");addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var proto=Moment.prototype;proto.add=add;proto.calendar=calendar$1;proto.clone=clone;proto.diff=diff;proto.endOf=endOf;proto.format=format;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$2;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract;proto.toArray=toArray;proto.toObject=toObject;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;proto.toJSON=toJSON;proto.toString=toString;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth);proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth);proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear);proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone);proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);function createUnix(input){return createLocal(input*1e3)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(string){return string}var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1(format,index,field,setter){var locale=getLocale();var utc=createUTC().set(setter,index);return locale[field](utc,format)}function listMonthsImpl(format,index,field){if(isNumber(format)){index=format;format=undefined}format=format||"";if(index!=null){return get$1(format,index,field,"month")}var i;var out=[];for(i=0;i<12;i++){out[i]=get$1(format,i,field,"month")}return out}function listWeekdaysImpl(localeSorted,format,index,field){if(typeof localeSorted==="boolean"){if(isNumber(format)){index=format;format=undefined}format=format||""}else{format=localeSorted;index=format;localeSorted=false;if(isNumber(format)){index=format;format=undefined}format=format||""}var locale=getLocale(),shift=localeSorted?locale._week.dow:0;if(index!=null){return get$1(format,(index+shift)%7,field,"day")}var i;var out=[];for(i=0;i<7;i++){out[i]=get$1(format,(i+shift)%7,field,"day")}return out}function listMonths(format,index){return listMonthsImpl(format,index,"months")}function listMonthsShort(format,index){return listMonthsImpl(format,index,"monthsShort")}function listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")}function listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")}function listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")}getSetGlobalLocale("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=toInt(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th";return number+output}});hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale);hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs(){var data=this._data;this._milliseconds=mathAbs(this._milliseconds);this._days=mathAbs(this._days);this._months=mathAbs(this._months);data.milliseconds=mathAbs(data.milliseconds);data.seconds=mathAbs(data.seconds);data.minutes=mathAbs(data.minutes);data.hours=mathAbs(data.hours);data.months=mathAbs(data.months);data.years=mathAbs(data.years);return this}function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble()}function add$1(input,value){return addSubtract$1(this,input,value,1)}function subtract$1(input,value){return addSubtract$1(this,input,value,-1)}function absCeil(number){if(number<0){return Math.floor(number)}else{return Math.ceil(number)}}function bubble(){var milliseconds=this._milliseconds;var days=this._days;var months=this._months;var data=this._data;var seconds,minutes,hours,years,monthsFromDays;if(!(milliseconds>=0&&days>=0&&months>=0||milliseconds<=0&&days<=0&&months<=0)){milliseconds+=absCeil(monthsToDays(months)+days)*864e5;days=0;months=0}data.milliseconds=milliseconds%1e3;seconds=absFloor(milliseconds/1e3);data.seconds=seconds%60;minutes=absFloor(seconds/60);data.minutes=minutes%60;hours=absFloor(minutes/60);data.hours=hours%24;days+=absFloor(hours/24);monthsFromDays=absFloor(daysToMonths(days));months+=monthsFromDays;days-=absCeil(monthsToDays(monthsFromDays));years=absFloor(months/12);months%=12;data.days=days;data.months=months;data.years=years;return this}function daysToMonths(days){return days*4800/146097}function monthsToDays(months){return months*146097/4800}function as(units){if(!this.isValid()){return NaN}var days;var months;var milliseconds=this._milliseconds;units=normalizeUnits(units);if(units==="month"||units==="year"){days=this._days+milliseconds/864e5;months=this._months+daysToMonths(days);return units==="month"?months:months/12}else{days=this._days+Math.round(monthsToDays(this._months));switch(units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return days*24+milliseconds/36e5;case"minute":return days*1440+milliseconds/6e4;case"second":return days*86400+milliseconds/1e3;case"millisecond":return Math.floor(days*864e5)+milliseconds;default:throw new Error("Unknown unit "+units)}}}function valueOf$1(){if(!this.isValid()){return NaN}return this._milliseconds+this._days*864e5+this._months%12*2592e6+toInt(this._months/12)*31536e6}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms");var asSeconds=makeAs("s");var asMinutes=makeAs("m");var asHours=makeAs("h");var asDays=makeAs("d");var asWeeks=makeAs("w");var asMonths=makeAs("M");var asYears=makeAs("y");function clone$1(){return createDuration(this)}function get$2(units){units=normalizeUnits(units);return this.isValid()?this[units+"s"]():NaN}function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN}}var milliseconds=makeGetter("milliseconds");var seconds=makeGetter("seconds");var minutes=makeGetter("minutes");var hours=makeGetter("hours");var days=makeGetter("days");var months=makeGetter("months");var years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round;var thresholds={ss:44,s:45,m:45,h:22,d:26,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime$1(posNegDuration,withoutSuffix,locale){var duration=createDuration(posNegDuration).abs();var seconds=round(duration.as("s"));var minutes=round(duration.as("m"));var hours=round(duration.as("h"));var days=round(duration.as("d"));var months=round(duration.as("M"));var years=round(duration.as("y"));var a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days]||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years];a[2]=withoutSuffix;a[3]=+posNegDuration>0;a[4]=locale;return substituteTimeAgo.apply(null,a)}function getSetRelativeTimeRounding(roundingFunction){if(roundingFunction===undefined){return round}if(typeof roundingFunction==="function"){round=roundingFunction;return true}return false}function getSetRelativeTimeThreshold(threshold,limit){if(thresholds[threshold]===undefined){return false}if(limit===undefined){return thresholds[threshold]}thresholds[threshold]=limit;if(threshold==="s"){thresholds.ss=limit-1}return true}function humanize(withSuffix){if(!this.isValid()){return this.localeData().invalidDate()}var locale=this.localeData();var output=relativeTime$1(this,!withSuffix,locale);if(withSuffix){output=locale.pastFuture(+this,output)}return locale.postformat(output)}var abs$1=Math.abs;function sign(x){return(x>0)-(x<0)||+x}function toISOString$1(){if(!this.isValid()){return this.localeData().invalidDate()}var seconds=abs$1(this._milliseconds)/1e3;var days=abs$1(this._days);var months=abs$1(this._months);var minutes,hours,years;minutes=absFloor(seconds/60);hours=absFloor(minutes/60);seconds%=60;minutes%=60;years=absFloor(months/12);months%=12;var Y=years;var M=months;var D=days;var h=hours;var m=minutes;var s=seconds?seconds.toFixed(3).replace(/\.?0+$/,""):"";var total=this.asSeconds();if(!total){return"P0D"}var totalSign=total<0?"-":"";var ymSign=sign(this._months)!==sign(total)?"-":"";var daysSign=sign(this._days)!==sign(total)?"-":"";var hmsSign=sign(this._milliseconds)!==sign(total)?"-":"";return totalSign+"P"+(Y?ymSign+Y+"Y":"")+(M?ymSign+M+"M":"")+(D?daysSign+D+"D":"")+(h||m||s?"T":"")+(h?hmsSign+h+"H":"")+(m?hmsSign+m+"M":"")+(s?hmsSign+s+"S":"")}var proto$2=Duration.prototype;proto$2.isValid=isValid$1;proto$2.abs=abs;proto$2.add=add$1;proto$2.subtract=subtract$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$1;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1);proto$2.lang=lang;addFormatToken("X",0,0,"unix");addFormatToken("x",0,0,"valueOf");addRegexToken("x",matchSigned);addRegexToken("X",matchTimestamp);addParseToken("X",function(input,array,config){config._d=new Date(parseFloat(input,10)*1e3)});addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))});hooks.version="2.22.2";setHookCallback(createLocal);hooks.fn=proto;hooks.min=min;hooks.max=max;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"};return hooks})},{}],73:[function(require,module,exports){module.exports=function(subject){validateSubject(subject);var eventsStorage=createEventsStorage(subject);subject.on=eventsStorage.on;subject.off=eventsStorage.off;subject.fire=eventsStorage.fire;return subject};function createEventsStorage(subject){var registeredEvents=Object.create(null);return{on:function(eventName,callback,ctx){if(typeof callback!=="function"){throw new Error("callback is expected to be a function")}var handlers=registeredEvents[eventName];if(!handlers){handlers=registeredEvents[eventName]=[]}handlers.push({callback:callback,ctx:ctx});return subject},off:function(eventName,callback){var wantToRemoveAll=typeof eventName==="undefined";if(wantToRemoveAll){registeredEvents=Object.create(null);return subject}if(registeredEvents[eventName]){var deleteAllCallbacksForEvent=typeof callback!=="function";if(deleteAllCallbacksForEvent){delete registeredEvents[eventName]}else{var callbacks=registeredEvents[eventName];for(var i=0;i<callbacks.length;++i){if(callbacks[i].callback===callback){callbacks.splice(i,1)}}}}return subject},fire:function(eventName){var callbacks=registeredEvents[eventName];if(!callbacks){return subject}var fireArguments;if(arguments.length>1){fireArguments=Array.prototype.splice.call(arguments,1)}for(var i=0;i<callbacks.length;++i){var callbackInfo=callbacks[i];callbackInfo.callback.apply(callbackInfo.ctx,fireArguments)}return subject}}}function validateSubject(subject){if(!subject){throw new Error("Eventify cannot use falsy object as events subject")}var reservedWords=["on","fire","off"];for(var i=0;i<reservedWords.length;++i){if(subject.hasOwnProperty(reservedWords[i])){throw new Error("Subject cannot be eventified, since it already has property '"+reservedWords[i]+"'")}}}},{}],74:[function(require,module,exports){module.exports=createGraph;var eventify=require("ngraph.events");function createGraph(options){options=options||{};if("uniqueLinkId"in options){console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\n"+"Use `multigraph` option instead\n","\n","Note: there is also change in default behavior: From now own each graph\n"+"is considered to be not a multigraph by default (each edge is unique).");options.multigraph=options.uniqueLinkId}if(options.multigraph===undefined)options.multigraph=false;var nodes=typeof Object.create==="function"?Object.create(null):{},links=[],multiEdges={},nodesCount=0,suspendEvents=0,forEachNode=createNodeIterator(),createLink=options.multigraph?createUniqueLink:createSingleLink,changes=[],recordLinkChange=noop,recordNodeChange=noop,enterModification=noop,exitModification=noop;var graphPart={addNode:addNode,addLink:addLink,removeLink:removeLink,removeNode:removeNode,getNode:getNode,getNodesCount:function(){return nodesCount},getLinksCount:function(){return links.length},getLinks:getLinks,forEachNode:forEachNode,forEachLinkedNode:forEachLinkedNode,forEachLink:forEachLink,beginUpdate:enterModification,endUpdate:exitModification,clear:clear,hasLink:getLink,hasNode:getNode,getLink:getLink};eventify(graphPart);monitorSubscribers();return graphPart;function monitorSubscribers(){var realOn=graphPart.on;graphPart.on=on;function on(){graphPart.beginUpdate=enterModification=enterModificationReal;graphPart.endUpdate=exitModification=exitModificationReal;recordLinkChange=recordLinkChangeReal;recordNodeChange=recordNodeChangeReal;graphPart.on=realOn;return realOn.apply(graphPart,arguments)}}function recordLinkChangeReal(link,changeType){changes.push({link:link,changeType:changeType})}function recordNodeChangeReal(node,changeType){changes.push({node:node,changeType:changeType})}function addNode(nodeId,data){if(nodeId===undefined){throw new Error("Invalid node identifier")}enterModification();var node=getNode(nodeId);if(!node){node=new Node(nodeId,data);nodesCount++;recordNodeChange(node,"add")}else{node.data=data;recordNodeChange(node,"update")}nodes[nodeId]=node;exitModification();return node}function getNode(nodeId){return nodes[nodeId]}function removeNode(nodeId){var node=getNode(nodeId);if(!node){return false}enterModification();var prevLinks=node.links;if(prevLinks){node.links=null;for(var i=0;i<prevLinks.length;++i){removeLink(prevLinks[i])}}delete nodes[nodeId];nodesCount--;recordNodeChange(node,"remove");exitModification();return true}function addLink(fromId,toId,data){enterModification();var fromNode=getNode(fromId)||addNode(fromId);var toNode=getNode(toId)||addNode(toId);var link=createLink(fromId,toId,data);links.push(link);addLinkToNode(fromNode,link);if(fromId!==toId){addLinkToNode(toNode,link)}recordLinkChange(link,"add");exitModification();return link}function createSingleLink(fromId,toId,data){var linkId=makeLinkId(fromId,toId);return new Link(fromId,toId,data,linkId)}function createUniqueLink(fromId,toId,data){var linkId=makeLinkId(fromId,toId);var isMultiEdge=multiEdges.hasOwnProperty(linkId);if(isMultiEdge||getLink(fromId,toId)){if(!isMultiEdge){multiEdges[linkId]=0}var suffix="@"+ ++multiEdges[linkId];linkId=makeLinkId(fromId+suffix,toId+suffix)}return new Link(fromId,toId,data,linkId)}function getLinks(nodeId){var node=getNode(nodeId);return node?node.links:null}function removeLink(link){if(!link){return false}var idx=indexOfElementInArray(link,links);if(idx<0){return false}enterModification();links.splice(idx,1);var fromNode=getNode(link.fromId);var toNode=getNode(link.toId);if(fromNode){idx=indexOfElementInArray(link,fromNode.links);if(idx>=0){fromNode.links.splice(idx,1)}}if(toNode){idx=indexOfElementInArray(link,toNode.links);if(idx>=0){toNode.links.splice(idx,1)}}recordLinkChange(link,"remove");exitModification();return true}function getLink(fromNodeId,toNodeId){var node=getNode(fromNodeId),i;if(!node||!node.links){return null}for(i=0;i<node.links.length;++i){var link=node.links[i];if(link.fromId===fromNodeId&&link.toId===toNodeId){return link}}return null}function clear(){enterModification();forEachNode(function(node){removeNode(node.id)});exitModification()}function forEachLink(callback){var i,length;if(typeof callback==="function"){for(i=0,length=links.length;i<length;++i){callback(links[i])}}}function forEachLinkedNode(nodeId,callback,oriented){var node=getNode(nodeId);if(node&&node.links&&typeof callback==="function"){if(oriented){return forEachOrientedLink(node.links,nodeId,callback)}else{return forEachNonOrientedLink(node.links,nodeId,callback)}}}function forEachNonOrientedLink(links,nodeId,callback){var quitFast;for(var i=0;i<links.length;++i){var link=links[i];var linkedNodeId=link.fromId===nodeId?link.toId:link.fromId;quitFast=callback(nodes[linkedNodeId],link);if(quitFast){return true}}}function forEachOrientedLink(links,nodeId,callback){var quitFast;for(var i=0;i<links.length;++i){var link=links[i];if(link.fromId===nodeId){quitFast=callback(nodes[link.toId],link);if(quitFast){return true}}}}function noop(){}function enterModificationReal(){suspendEvents+=1}function exitModificationReal(){suspendEvents-=1;if(suspendEvents===0&&changes.length>0){graphPart.fire("changed",changes);changes.length=0}}function createNodeIterator(){return Object.keys?objectKeysIterator:forInIterator}function objectKeysIterator(callback){if(typeof callback!=="function"){return}var keys=Object.keys(nodes);for(var i=0;i<keys.length;++i){if(callback(nodes[keys[i]])){return true}}}function forInIterator(callback){if(typeof callback!=="function"){return}var node;for(node in nodes){if(callback(nodes[node])){return true}}}}function indexOfElementInArray(element,array){if(!array)return-1;if(array.indexOf){return array.indexOf(element)}var len=array.length,i;for(i=0;i<len;i+=1){if(array[i]===element){return i}}return-1}function Node(id,data){this.id=id;this.links=null;this.data=data}function addLinkToNode(node,link){if(node.links){node.links.push(link)}else{node.links=[link]}}function Link(fromId,toId,data,id){this.fromId=fromId;this.toId=toId;this.data=data;this.id=id}function hashCode(str){var hash=0,i,chr,len;if(str.length==0)return hash;for(i=0,len=str.length;i<len;i++){chr=str.charCodeAt(i);hash=(hash<<5)-hash+chr;hash|=0}return hash}function makeLinkId(fromId,toId){return fromId.toString()+"👉 "+toId.toString()}},{"ngraph.events":73}],75:[function(require,module,exports){module.exports={random:random,randomIterator:randomIterator};function random(inputSeed){var seed=typeof inputSeed==="number"?inputSeed:+new Date;var randomFunc=function(){seed=seed+2127912214+(seed<<12)&4294967295;seed=(seed^3345072700^seed>>>19)&4294967295;seed=seed+374761393+(seed<<5)&4294967295;seed=(seed+3550635116^seed<<9)&4294967295;seed=seed+4251993797+(seed<<3)&4294967295;seed=(seed^3042594569^seed>>>16)&4294967295;return(seed&268435455)/268435456};return{next:function(maxValue){return Math.floor(randomFunc()*maxValue)},nextDouble:function(){return randomFunc()}}}function randomIterator(array,customRandom){var localRandom=customRandom||random();if(typeof localRandom.next!=="function"){throw new Error("customRandom does not match expected API: next() function is missing")}return{forEach:function(callback){var i,j,t;for(i=array.length-1;i>0;--i){j=localRandom.next(i+1);t=array[j];array[j]=array[i];array[i]=t;callback(t)}if(array.length){callback(array[0])}},shuffle:function(){var i,j,t;for(i=array.length-1;i>0;--i){j=localRandom.next(i+1);t=array[j];array[j]=array[i];array[i]=t}return array}}}},{}],76:[function(require,module,exports){"use strict";var getOwnPropertySymbols=Object.getOwnPropertySymbols;var hasOwnProperty=Object.prototype.hasOwnProperty;var propIsEnumerable=Object.prototype.propertyIsEnumerable;function toObject(val){if(val===null||val===undefined){throw new TypeError("Object.assign cannot be called with null or undefined")}return Object(val)}function shouldUseNative(){try{if(!Object.assign){return false}var test1=new String("abc");test1[5]="de";if(Object.getOwnPropertyNames(test1)[0]==="5"){return false}var test2={};for(var i=0;i<10;i++){test2["_"+String.fromCharCode(i)]=i}var order2=Object.getOwnPropertyNames(test2).map(function(n){return test2[n]});if(order2.join("")!=="0123456789"){return false}var test3={};"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter});if(Object.keys(Object.assign({},test3)).join("")!=="abcdefghijklmnopqrst"){return false}return true}catch(err){return false}}module.exports=shouldUseNative()?Object.assign:function(target,source){var from;var to=toObject(target);var symbols;for(var s=1;s<arguments.length;s++){from=Object(arguments[s]);for(var key in from){if(hasOwnProperty.call(from,key)){to[key]=from[key]}}if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++){if(propIsEnumerable.call(from,symbols[i])){to[symbols[i]]=from[symbols[i]]}}}}return to}},{}],77:[function(require,module,exports){"use strict";module.exports=function parseURI(str,opts){opts=opts||{};var o={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var m=o.parser[opts.strictMode?"strict":"loose"].exec(str);var uri={};var i=14;while(i--)uri[o.key[i]]=m[i]||"";uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1)uri[o.q.name][$1]=$2});return uri}},{}],78:[function(require,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!path){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash=substr(path,-1)==="/";path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/");if(!path&&!isAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isAbsolute?"/":"")+path};exports.isAbsolute=function(path){return path.charAt(0)==="/"};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){if(typeof p!=="string"){throw new TypeError("Arguments to path.join must be strings")}return p}).join("/"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!=="")break}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!=="")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push("..")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")};exports.sep="/";exports.delimiter=":";exports.dirname=function(path){if(typeof path!=="string")path=path+"";if(path.length===0)return".";var code=path.charCodeAt(0);var hasRoot=code===47;var end=-1;var matchedSlash=true;for(var i=path.length-1;i>=1;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){end=i;break}}else{matchedSlash=false}}if(end===-1)return hasRoot?"/":".";if(hasRoot&&end===1){return"/"}return path.slice(0,end)};function basename(path){if(typeof path!=="string")path=path+"";var start=0;var end=-1;var matchedSlash=true;var i;for(i=path.length-1;i>=0;--i){if(path.charCodeAt(i)===47){if(!matchedSlash){start=i+1;break}}else if(end===-1){matchedSlash=false;end=i+1}}if(end===-1)return"";return path.slice(start,end)}exports.basename=function(path,ext){var f=basename(path);if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){if(typeof path!=="string")path=path+"";var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var preDotState=0;for(var i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break}continue}if(end===-1){matchedSlash=false;end=i+1}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1}else if(startDot!==-1){preDotState=-1}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){return""}return path.slice(startDot,end)};function filter(xs,f){if(xs.filter)return xs.filter(f);var res=[];for(var i=0;i<xs.length;i++){if(f(xs[i],i,xs))res.push(xs[i])}return res}var substr="ab".substr(-1)==="b"?function(str,start,len){return str.substr(start,len)}:function(str,start,len){if(start<0)start=str.length+start;return str.substr(start,len)}}).call(this,require("_process"))},{_process:246}],79:[function(require,module,exports){var EMPTY_ARRAY_BUFFER=new ArrayBuffer(0);var Buffer=function(gl,type,data,drawType){this.gl=gl;this.buffer=gl.createBuffer();this.type=type||gl.ARRAY_BUFFER;this.drawType=drawType||gl.STATIC_DRAW;this.data=EMPTY_ARRAY_BUFFER;if(data){this.upload(data)}this._updateID=0};Buffer.prototype.upload=function(data,offset,dontBind){if(!dontBind)this.bind();var gl=this.gl;data=data||this.data;offset=offset||0;if(this.data.byteLength>=data.byteLength){gl.bufferSubData(this.type,offset,data)}else{gl.bufferData(this.type,data,this.drawType)}this.data=data};Buffer.prototype.bind=function(){var gl=this.gl;gl.bindBuffer(this.type,this.buffer)};Buffer.createVertexBuffer=function(gl,data,drawType){return new Buffer(gl,gl.ARRAY_BUFFER,data,drawType)};Buffer.createIndexBuffer=function(gl,data,drawType){return new Buffer(gl,gl.ELEMENT_ARRAY_BUFFER,data,drawType)};Buffer.create=function(gl,type,data,drawType){return new Buffer(gl,type,data,drawType)};Buffer.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};module.exports=Buffer},{}],80:[function(require,module,exports){var Texture=require("./GLTexture");var Framebuffer=function(gl,width,height){this.gl=gl;this.framebuffer=gl.createFramebuffer();this.stencil=null;this.texture=null;this.width=width||100;this.height=height||100};Framebuffer.prototype.enableTexture=function(texture){var gl=this.gl;this.texture=texture||new Texture(gl);this.texture.bind();this.bind();gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this.texture.texture,0)};Framebuffer.prototype.enableStencil=function(){if(this.stencil)return;var gl=this.gl;this.stencil=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,this.stencil);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,this.stencil);gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,this.width,this.height)};Framebuffer.prototype.clear=function(r,g,b,a){this.bind();var gl=this.gl;gl.clearColor(r,g,b,a);gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT)};Framebuffer.prototype.bind=function(){var gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,this.framebuffer)};Framebuffer.prototype.unbind=function(){var gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,null)};Framebuffer.prototype.resize=function(width,height){var gl=this.gl;this.width=width;this.height=height;if(this.texture){this.texture.uploadData(null,width,height)}if(this.stencil){gl.bindRenderbuffer(gl.RENDERBUFFER,this.stencil);gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,width,height)}};Framebuffer.prototype.destroy=function(){var gl=this.gl;if(this.texture){this.texture.destroy()}gl.deleteFramebuffer(this.framebuffer);this.gl=null;this.stencil=null;this.texture=null};Framebuffer.createRGBA=function(gl,width,height,data){var texture=Texture.fromData(gl,null,width,height);texture.enableNearestScaling();texture.enableWrapClamp();var fbo=new Framebuffer(gl,width,height);fbo.enableTexture(texture);fbo.unbind();return fbo};Framebuffer.createFloat32=function(gl,width,height,data){var texture=new Texture.fromData(gl,data,width,height);texture.enableNearestScaling();texture.enableWrapClamp();var fbo=new Framebuffer(gl,width,height);fbo.enableTexture(texture);fbo.unbind();return fbo};module.exports=Framebuffer},{"./GLTexture":82}],81:[function(require,module,exports){var compileProgram=require("./shader/compileProgram"),extractAttributes=require("./shader/extractAttributes"),extractUniforms=require("./shader/extractUniforms"),setPrecision=require("./shader/setPrecision"),generateUniformAccessObject=require("./shader/generateUniformAccessObject");var Shader=function(gl,vertexSrc,fragmentSrc,precision,attributeLocations){this.gl=gl;if(precision){vertexSrc=setPrecision(vertexSrc,precision);fragmentSrc=setPrecision(fragmentSrc,precision)}this.program=compileProgram(gl,vertexSrc,fragmentSrc,attributeLocations);this.attributes=extractAttributes(gl,this.program);this.uniformData=extractUniforms(gl,this.program);this.uniforms=generateUniformAccessObject(gl,this.uniformData)};Shader.prototype.bind=function(){this.gl.useProgram(this.program);return this};Shader.prototype.destroy=function(){this.attributes=null;this.uniformData=null;this.uniforms=null;var gl=this.gl;gl.deleteProgram(this.program)};module.exports=Shader},{"./shader/compileProgram":87,"./shader/extractAttributes":89,"./shader/extractUniforms":90,"./shader/generateUniformAccessObject":91,"./shader/setPrecision":95}],82:[function(require,module,exports){var Texture=function(gl,width,height,format,type){this.gl=gl;this.texture=gl.createTexture();this.mipmap=false;this.premultiplyAlpha=false;this.width=width||-1;this.height=height||-1;this.format=format||gl.RGBA;this.type=type||gl.UNSIGNED_BYTE};Texture.prototype.upload=function(source){this.bind();var gl=this.gl;gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var newWidth=source.videoWidth||source.width;var newHeight=source.videoHeight||source.height;if(newHeight!==this.height||newWidth!==this.width){gl.texImage2D(gl.TEXTURE_2D,0,this.format,this.format,this.type,source)}else{gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,this.format,this.type,source)}this.width=newWidth;this.height=newHeight};var FLOATING_POINT_AVAILABLE=false;Texture.prototype.uploadData=function(data,width,height){this.bind();var gl=this.gl;if(data instanceof Float32Array){if(!FLOATING_POINT_AVAILABLE){var ext=gl.getExtension("OES_texture_float");if(ext){FLOATING_POINT_AVAILABLE=true}else{throw new Error("floating point textures not available")}}this.type=gl.FLOAT}else{this.type=this.type||gl.UNSIGNED_BYTE}gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);if(width!==this.width||height!==this.height){gl.texImage2D(gl.TEXTURE_2D,0,this.format,width,height,0,this.format,this.type,data||null)}else{gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,width,height,this.format,this.type,data||null)}this.width=width;this.height=height};Texture.prototype.bind=function(location){var gl=this.gl;if(location!==undefined){gl.activeTexture(gl.TEXTURE0+location)}gl.bindTexture(gl.TEXTURE_2D,this.texture)};Texture.prototype.unbind=function(){var gl=this.gl;gl.bindTexture(gl.TEXTURE_2D,null)};Texture.prototype.minFilter=function(linear){var gl=this.gl;this.bind();if(this.mipmap){gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,linear?gl.LINEAR_MIPMAP_LINEAR:gl.NEAREST_MIPMAP_NEAREST)}else{gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,linear?gl.LINEAR:gl.NEAREST)}};Texture.prototype.magFilter=function(linear){var gl=this.gl;this.bind();gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,linear?gl.LINEAR:gl.NEAREST)};Texture.prototype.enableMipmap=function(){var gl=this.gl;this.bind();this.mipmap=true;gl.generateMipmap(gl.TEXTURE_2D)};Texture.prototype.enableLinearScaling=function(){this.minFilter(true);this.magFilter(true)};Texture.prototype.enableNearestScaling=function(){this.minFilter(false);this.magFilter(false)};Texture.prototype.enableWrapClamp=function(){var gl=this.gl;this.bind();gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE)};Texture.prototype.enableWrapRepeat=function(){var gl=this.gl;this.bind();gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT)};Texture.prototype.enableWrapMirrorRepeat=function(){var gl=this.gl;this.bind();gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.MIRRORED_REPEAT);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.MIRRORED_REPEAT)};Texture.prototype.destroy=function(){var gl=this.gl;gl.deleteTexture(this.texture)};Texture.fromSource=function(gl,source,premultiplyAlpha){var texture=new Texture(gl);texture.premultiplyAlpha=premultiplyAlpha||false;texture.upload(source);return texture};Texture.fromData=function(gl,data,width,height){var texture=new Texture(gl);texture.uploadData(data,width,height);return texture};module.exports=Texture},{}],83:[function(require,module,exports){var setVertexAttribArrays=require("./setVertexAttribArrays");function VertexArrayObject(gl,state){this.nativeVaoExtension=null;if(!VertexArrayObject.FORCE_NATIVE){this.nativeVaoExtension=gl.getExtension("OES_vertex_array_object")||gl.getExtension("MOZ_OES_vertex_array_object")||gl.getExtension("WEBKIT_OES_vertex_array_object")}this.nativeState=state;if(this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var maxAttribs=gl.getParameter(gl.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(maxAttribs),attribState:new Array(maxAttribs)}}this.gl=gl;this.attributes=[];this.indexBuffer=null;this.dirty=false}VertexArrayObject.prototype.constructor=VertexArrayObject;module.exports=VertexArrayObject;VertexArrayObject.FORCE_NATIVE=false;VertexArrayObject.prototype.bind=function(){if(this.nativeVao){this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao);if(this.dirty){this.dirty=false;this.activate();return this}if(this.indexBuffer){this.indexBuffer.bind()}}else{this.activate()}return this};VertexArrayObject.prototype.unbind=function(){if(this.nativeVao){this.nativeVaoExtension.bindVertexArrayOES(null)}return this};VertexArrayObject.prototype.activate=function(){var gl=this.gl;var lastBuffer=null;for(var i=0;i<this.attributes.length;i++){var attrib=this.attributes[i];if(lastBuffer!==attrib.buffer){attrib.buffer.bind();lastBuffer=attrib.buffer}gl.vertexAttribPointer(attrib.attribute.location,attrib.attribute.size,attrib.type||gl.FLOAT,attrib.normalized||false,attrib.stride||0,attrib.start||0)}setVertexAttribArrays(gl,this.attributes,this.nativeState);if(this.indexBuffer){this.indexBuffer.bind()}return this};VertexArrayObject.prototype.addAttribute=function(buffer,attribute,type,normalized,stride,start){this.attributes.push({buffer:buffer,attribute:attribute,location:attribute.location,type:type||this.gl.FLOAT,normalized:normalized||false,stride:stride||0,start:start||0});this.dirty=true;return this};VertexArrayObject.prototype.addIndex=function(buffer){this.indexBuffer=buffer;this.dirty=true;return this};VertexArrayObject.prototype.clear=function(){if(this.nativeVao){this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao)}this.attributes.length=0;this.indexBuffer=null;return this};VertexArrayObject.prototype.draw=function(type,size,start){var gl=this.gl;if(this.indexBuffer){gl.drawElements(type,size||this.indexBuffer.data.length,gl.UNSIGNED_SHORT,(start||0)*2)}else{gl.drawArrays(type,start,size||this.getSize())}return this};VertexArrayObject.prototype.destroy=function(){this.gl=null;this.indexBuffer=null;this.attributes=null;this.nativeState=null;if(this.nativeVao){this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao)}this.nativeVaoExtension=null;this.nativeVao=null};VertexArrayObject.prototype.getSize=function(){var attrib=this.attributes[0];return attrib.buffer.data.length/(attrib.stride/4||attrib.attribute.size)}},{"./setVertexAttribArrays":86}],84:[function(require,module,exports){var createContext=function(canvas,options){var gl=canvas.getContext("webgl",options)||canvas.getContext("experimental-webgl",options);if(!gl){throw new Error("This browser does not support webGL. Try using the canvas renderer")}return gl};module.exports=createContext},{}],85:[function(require,module,exports){var gl={createContext:require("./createContext"),setVertexAttribArrays:require("./setVertexAttribArrays"),GLBuffer:require("./GLBuffer"),GLFramebuffer:require("./GLFramebuffer"),GLShader:require("./GLShader"),GLTexture:require("./GLTexture"),VertexArrayObject:require("./VertexArrayObject"),shader:require("./shader")};if(typeof module!=="undefined"&&module.exports){module.exports=gl}if(typeof window!=="undefined"){window.PIXI=window.PIXI||{};window.PIXI.glCore=gl}},{"./GLBuffer":79,"./GLFramebuffer":80,"./GLShader":81,"./GLTexture":82,"./VertexArrayObject":83,"./createContext":84,"./setVertexAttribArrays":86,"./shader":92}],86:[function(require,module,exports){var setVertexAttribArrays=function(gl,attribs,state){var i;if(state){var tempAttribState=state.tempAttribState,attribState=state.attribState;for(i=0;i<tempAttribState.length;i++){tempAttribState[i]=false}for(i=0;i<attribs.length;i++){tempAttribState[attribs[i].attribute.location]=true}for(i=0;i<attribState.length;i++){if(attribState[i]!==tempAttribState[i]){attribState[i]=tempAttribState[i];if(state.attribState[i]){gl.enableVertexAttribArray(i)}else{gl.disableVertexAttribArray(i)}}}}else{for(i=0;i<attribs.length;i++){var attrib=attribs[i];gl.enableVertexAttribArray(attrib.attribute.location)}}};module.exports=setVertexAttribArrays},{}],87:[function(require,module,exports){var compileProgram=function(gl,vertexSrc,fragmentSrc,attributeLocations){var glVertShader=compileShader(gl,gl.VERTEX_SHADER,vertexSrc);var glFragShader=compileShader(gl,gl.FRAGMENT_SHADER,fragmentSrc);var program=gl.createProgram();gl.attachShader(program,glVertShader);gl.attachShader(program,glFragShader);if(attributeLocations){for(var i in attributeLocations){gl.bindAttribLocation(program,attributeLocations[i],i)}}gl.linkProgram(program);if(!gl.getProgramParameter(program,gl.LINK_STATUS)){console.error("Pixi.js Error: Could not initialize shader.");console.error("gl.VALIDATE_STATUS",gl.getProgramParameter(program,gl.VALIDATE_STATUS));console.error("gl.getError()",gl.getError());if(gl.getProgramInfoLog(program)!==""){console.warn("Pixi.js Warning: gl.getProgramInfoLog()",gl.getProgramInfoLog(program))}gl.deleteProgram(program);program=null}gl.deleteShader(glVertShader);gl.deleteShader(glFragShader);return program};var compileShader=function(gl,type,src){var shader=gl.createShader(type);gl.shaderSource(shader,src);gl.compileShader(shader);if(!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){console.log(gl.getShaderInfoLog(shader));return null}return shader};module.exports=compileProgram},{}],88:[function(require,module,exports){var defaultValue=function(type,size){switch(type){case"float":return 0;case"vec2":return new Float32Array(2*size);case"vec3":return new Float32Array(3*size);case"vec4":return new Float32Array(4*size);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*size);case"ivec3":return new Int32Array(3*size);case"ivec4":return new Int32Array(4*size);case"bool":return false;case"bvec2":return booleanArray(2*size);case"bvec3":return booleanArray(3*size);case"bvec4":return booleanArray(4*size);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}};var booleanArray=function(size){var array=new Array(size);for(var i=0;i<array.length;i++){array[i]=false}return array};module.exports=defaultValue},{}],89:[function(require,module,exports){var mapType=require("./mapType");var mapSize=require("./mapSize");var extractAttributes=function(gl,program){var attributes={};var totalAttributes=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES);for(var i=0;i<totalAttributes;i++){var attribData=gl.getActiveAttrib(program,i);var type=mapType(gl,attribData.type);attributes[attribData.name]={type:type,size:mapSize(type),location:gl.getAttribLocation(program,attribData.name),pointer:pointer}}return attributes};var pointer=function(type,normalized,stride,start){gl.vertexAttribPointer(this.location,this.size,type||gl.FLOAT,normalized||false,stride||0,start||0)};module.exports=extractAttributes},{"./mapSize":93,"./mapType":94}],90:[function(require,module,exports){var mapType=require("./mapType");var defaultValue=require("./defaultValue");var extractUniforms=function(gl,program){var uniforms={};var totalUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS);for(var i=0;i<totalUniforms;i++){var uniformData=gl.getActiveUniform(program,i);var name=uniformData.name.replace(/\[.*?\]/,"");var type=mapType(gl,uniformData.type);uniforms[name]={type:type,size:uniformData.size,location:gl.getUniformLocation(program,name),value:defaultValue(type,uniformData.size)}}return uniforms};module.exports=extractUniforms},{"./defaultValue":88,"./mapType":94}],91:[function(require,module,exports){var generateUniformAccessObject=function(gl,uniformData){var uniforms={data:{}};uniforms.gl=gl;var uniformKeys=Object.keys(uniformData);for(var i=0;i<uniformKeys.length;i++){var fullName=uniformKeys[i];var nameTokens=fullName.split(".");var name=nameTokens[nameTokens.length-1];var uniformGroup=getUniformGroup(nameTokens,uniforms);var uniform=uniformData[fullName];uniformGroup.data[name]=uniform;uniformGroup.gl=gl;Object.defineProperty(uniformGroup,name,{get:generateGetter(name),set:generateSetter(name,uniform)})}return uniforms};var generateGetter=function(name){return function(){return this.data[name].value}};var GLSL_SINGLE_SETTERS={float:function setSingleFloat(gl,location,value){gl.uniform1f(location,value)},vec2:function setSingleVec2(gl,location,value){gl.uniform2f(location,value[0],value[1])},vec3:function setSingleVec3(gl,location,value){gl.uniform3f(location,value[0],value[1],value[2])},vec4:function setSingleVec4(gl,location,value){gl.uniform4f(location,value[0],value[1],value[2],value[3])},int:function setSingleInt(gl,location,value){gl.uniform1i(location,value)},ivec2:function setSingleIvec2(gl,location,value){gl.uniform2i(location,value[0],value[1])},ivec3:function setSingleIvec3(gl,location,value){gl.uniform3i(location,value[0],value[1],value[2])},ivec4:function setSingleIvec4(gl,location,value){gl.uniform4i(location,value[0],value[1],value[2],value[3])},bool:function setSingleBool(gl,location,value){gl.uniform1i(location,value)},bvec2:function setSingleBvec2(gl,location,value){gl.uniform2i(location,value[0],value[1])},bvec3:function setSingleBvec3(gl,location,value){gl.uniform3i(location,value[0],value[1],value[2])},bvec4:function setSingleBvec4(gl,location,value){gl.uniform4i(location,value[0],value[1],value[2],value[3])},mat2:function setSingleMat2(gl,location,value){gl.uniformMatrix2fv(location,false,value)},mat3:function setSingleMat3(gl,location,value){gl.uniformMatrix3fv(location,false,value)},mat4:function setSingleMat4(gl,location,value){gl.uniformMatrix4fv(location,false,value)},sampler2D:function setSingleSampler2D(gl,location,value){gl.uniform1i(location,value)}};var GLSL_ARRAY_SETTERS={float:function setFloatArray(gl,location,value){gl.uniform1fv(location,value)},vec2:function setVec2Array(gl,location,value){gl.uniform2fv(location,value)},vec3:function setVec3Array(gl,location,value){gl.uniform3fv(location,value)},vec4:function setVec4Array(gl,location,value){gl.uniform4fv(location,value)},int:function setIntArray(gl,location,value){gl.uniform1iv(location,value)},ivec2:function setIvec2Array(gl,location,value){gl.uniform2iv(location,value)},ivec3:function setIvec3Array(gl,location,value){gl.uniform3iv(location,value)},ivec4:function setIvec4Array(gl,location,value){gl.uniform4iv(location,value)},bool:function setBoolArray(gl,location,value){gl.uniform1iv(location,value)},bvec2:function setBvec2Array(gl,location,value){gl.uniform2iv(location,value)},bvec3:function setBvec3Array(gl,location,value){gl.uniform3iv(location,value)},bvec4:function setBvec4Array(gl,location,value){gl.uniform4iv(location,value)},sampler2D:function setSampler2DArray(gl,location,value){gl.uniform1iv(location,value)}};function generateSetter(name,uniform){return function(value){this.data[name].value=value;var location=this.data[name].location;if(uniform.size===1){GLSL_SINGLE_SETTERS[uniform.type](this.gl,location,value)}else{GLSL_ARRAY_SETTERS[uniform.type](this.gl,location,value)}}}function getUniformGroup(nameTokens,uniform){var cur=uniform;for(var i=0;i<nameTokens.length-1;i++){var o=cur[nameTokens[i]]||{data:{}};cur[nameTokens[i]]=o;cur=o}return cur}module.exports=generateUniformAccessObject},{}],92:[function(require,module,exports){module.exports={compileProgram:require("./compileProgram"),defaultValue:require("./defaultValue"),extractAttributes:require("./extractAttributes"),extractUniforms:require("./extractUniforms"),generateUniformAccessObject:require("./generateUniformAccessObject"),setPrecision:require("./setPrecision"),mapSize:require("./mapSize"),mapType:require("./mapType")}},{"./compileProgram":87,"./defaultValue":88,"./extractAttributes":89,"./extractUniforms":90,"./generateUniformAccessObject":91,"./mapSize":93,"./mapType":94,"./setPrecision":95}],93:[function(require,module,exports){var mapSize=function(type){return GLSL_TO_SIZE[type]};var GLSL_TO_SIZE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};module.exports=mapSize},{}],94:[function(require,module,exports){var mapType=function(gl,type){if(!GL_TABLE){var typeNames=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(var i=0;i<typeNames.length;++i){var tn=typeNames[i];GL_TABLE[gl[tn]]=GL_TO_GLSL_TYPES[tn]}}return GL_TABLE[type]};var GL_TABLE=null;var GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};module.exports=mapType},{}],95:[function(require,module,exports){var setPrecision=function(src,precision){if(src.substring(0,9)!=="precision"){return"precision "+precision+" float;\n"+src}return src};module.exports=setPrecision},{}],96:[function(require,module,exports){"use strict";exports.__esModule=true;var _core=require("../core");var core=_interopRequireWildcard(_core);var _ismobilejs=require("ismobilejs");var _ismobilejs2=_interopRequireDefault(_ismobilejs);var _accessibleTarget=require("./accessibleTarget");var _accessibleTarget2=_interopRequireDefault(_accessibleTarget);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}core.utils.mixins.delayMixin(core.DisplayObject.prototype,_accessibleTarget2.default);var KEY_CODE_TAB=9;var DIV_TOUCH_SIZE=100;var DIV_TOUCH_POS_X=0;var DIV_TOUCH_POS_Y=0;var DIV_TOUCH_ZINDEX=2;var DIV_HOOK_SIZE=1;var DIV_HOOK_POS_X=-1e3;var DIV_HOOK_POS_Y=-1e3;var DIV_HOOK_ZINDEX=2;var AccessibilityManager=function(){function AccessibilityManager(renderer){_classCallCheck(this,AccessibilityManager);if((_ismobilejs2.default.tablet||_ismobilejs2.default.phone)&&!navigator.isCocoonJS){this.createTouchHook()}var div=document.createElement("div");div.style.width=DIV_TOUCH_SIZE+"px";div.style.height=DIV_TOUCH_SIZE+"px";div.style.position="absolute";div.style.top=DIV_TOUCH_POS_X+"px";div.style.left=DIV_TOUCH_POS_Y+"px";div.style.zIndex=DIV_TOUCH_ZINDEX;this.div=div;this.pool=[];this.renderId=0;this.debug=false;this.renderer=renderer;this.children=[];this._onKeyDown=this._onKeyDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this.isActive=false;this.isMobileAccessabillity=false;window.addEventListener("keydown",this._onKeyDown,false)}AccessibilityManager.prototype.createTouchHook=function createTouchHook(){var _this=this;var hookDiv=document.createElement("button");hookDiv.style.width=DIV_HOOK_SIZE+"px";hookDiv.style.height=DIV_HOOK_SIZE+"px";hookDiv.style.position="absolute";hookDiv.style.top=DIV_HOOK_POS_X+"px";hookDiv.style.left=DIV_HOOK_POS_Y+"px";hookDiv.style.zIndex=DIV_HOOK_ZINDEX;hookDiv.style.backgroundColor="#FF0000";hookDiv.title="HOOK DIV";hookDiv.addEventListener("focus",function(){_this.isMobileAccessabillity=true;_this.activate();document.body.removeChild(hookDiv)});document.body.appendChild(hookDiv)};AccessibilityManager.prototype.activate=function activate(){if(this.isActive){return}this.isActive=true;window.document.addEventListener("mousemove",this._onMouseMove,true);window.removeEventListener("keydown",this._onKeyDown,false);this.renderer.on("postrender",this.update,this);if(this.renderer.view.parentNode){this.renderer.view.parentNode.appendChild(this.div)}};AccessibilityManager.prototype.deactivate=function deactivate(){if(!this.isActive||this.isMobileAccessabillity){return}this.isActive=false;window.document.removeEventListener("mousemove",this._onMouseMove);window.addEventListener("keydown",this._onKeyDown,false);this.renderer.off("postrender",this.update);if(this.div.parentNode){this.div.parentNode.removeChild(this.div)}};AccessibilityManager.prototype.updateAccessibleObjects=function updateAccessibleObjects(displayObject){if(!displayObject.visible){return}if(displayObject.accessible&&displayObject.interactive){if(!displayObject._accessibleActive){this.addChild(displayObject)}displayObject.renderId=this.renderId}var children=displayObject.children;for(var i=0;i<children.length;i++){this.updateAccessibleObjects(children[i])}};AccessibilityManager.prototype.update=function update(){if(!this.renderer.renderingToScreen){return}this.updateAccessibleObjects(this.renderer._lastObjectRendered);var rect=this.renderer.view.getBoundingClientRect();var sx=rect.width/this.renderer.width;var sy=rect.height/this.renderer.height;var div=this.div;div.style.left=rect.left+"px";div.style.top=rect.top+"px";div.style.width=this.renderer.width+"px";div.style.height=this.renderer.height+"px";for(var i=0;i<this.children.length;i++){var child=this.children[i];if(child.renderId!==this.renderId){child._accessibleActive=false;core.utils.removeItems(this.children,i,1);this.div.removeChild(child._accessibleDiv);this.pool.push(child._accessibleDiv);child._accessibleDiv=null;i--;if(this.children.length===0){this.deactivate()}}else{div=child._accessibleDiv;var hitArea=child.hitArea;var wt=child.worldTransform;if(child.hitArea){div.style.left=(wt.tx+hitArea.x*wt.a)*sx+"px";div.style.top=(wt.ty+hitArea.y*wt.d)*sy+"px";div.style.width=hitArea.width*wt.a*sx+"px";div.style.height=hitArea.height*wt.d*sy+"px"}else{hitArea=child.getBounds();this.capHitArea(hitArea);div.style.left=hitArea.x*sx+"px";div.style.top=hitArea.y*sy+"px";div.style.width=hitArea.width*sx+"px";div.style.height=hitArea.height*sy+"px";if(div.title!==child.accessibleTitle&&child.accessibleTitle!==null){div.title=child.accessibleTitle}if(div.getAttribute("aria-label")!==child.accessibleHint&&child.accessibleHint!==null){div.setAttribute("aria-label",child.accessibleHint)}}}}this.renderId++};AccessibilityManager.prototype.capHitArea=function capHitArea(hitArea){if(hitArea.x<0){hitArea.width+=hitArea.x;hitArea.x=0}if(hitArea.y<0){hitArea.height+=hitArea.y;hitArea.y=0}if(hitArea.x+hitArea.width>this.renderer.width){hitArea.width=this.renderer.width-hitArea.x}if(hitArea.y+hitArea.height>this.renderer.height){hitArea.height=this.renderer.height-hitArea.y}};AccessibilityManager.prototype.addChild=function addChild(displayObject){var div=this.pool.pop();if(!div){div=document.createElement("button");div.style.width=DIV_TOUCH_SIZE+"px";div.style.height=DIV_TOUCH_SIZE+"px";div.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent";div.style.position="absolute";div.style.zIndex=DIV_TOUCH_ZINDEX;div.style.borderStyle="none";if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){div.setAttribute("aria-live","off")}else{div.setAttribute("aria-live","polite")}if(navigator.userAgent.match(/rv:.*Gecko\//)){div.setAttribute("aria-relevant","additions")}else{div.setAttribute("aria-relevant","text")}div.addEventListener("click",this._onClick.bind(this));div.addEventListener("focus",this._onFocus.bind(this));div.addEventListener("focusout",this._onFocusOut.bind(this))}if(displayObject.accessibleTitle&&displayObject.accessibleTitle!==null){div.title=displayObject.accessibleTitle}else if(!displayObject.accessibleHint||displayObject.accessibleHint===null){div.title="displayObject "+displayObject.tabIndex}if(displayObject.accessibleHint&&displayObject.accessibleHint!==null){div.setAttribute("aria-label",displayObject.accessibleHint)}displayObject._accessibleActive=true;displayObject._accessibleDiv=div;div.displayObject=displayObject;this.children.push(displayObject);this.div.appendChild(displayObject._accessibleDiv);displayObject._accessibleDiv.tabIndex=displayObject.tabIndex};AccessibilityManager.prototype._onClick=function _onClick(e){var interactionManager=this.renderer.plugins.interaction;interactionManager.dispatchEvent(e.target.displayObject,"click",interactionManager.eventData)};AccessibilityManager.prototype._onFocus=function _onFocus(e){if(!e.target.getAttribute("aria-live","off")){e.target.setAttribute("aria-live","assertive")}var interactionManager=this.renderer.plugins.interaction;interactionManager.dispatchEvent(e.target.displayObject,"mouseover",interactionManager.eventData)};AccessibilityManager.prototype._onFocusOut=function _onFocusOut(e){if(!e.target.getAttribute("aria-live","off")){e.target.setAttribute("aria-live","polite")}var interactionManager=this.renderer.plugins.interaction;interactionManager.dispatchEvent(e.target.displayObject,"mouseout",interactionManager.eventData)};AccessibilityManager.prototype._onKeyDown=function _onKeyDown(e){if(e.keyCode!==KEY_CODE_TAB){return}this.activate()};AccessibilityManager.prototype._onMouseMove=function _onMouseMove(e){if(e.movementX===0&&e.movementY===0){return}this.deactivate()};AccessibilityManager.prototype.destroy=function destroy(){this.div=null;for(var i=0;i<this.children.length;i++){this.children[i].div=null}window.document.removeEventListener("mousemove",this._onMouseMove);window.removeEventListener("keydown",this._onKeyDown);this.pool=null;this.children=null;this.renderer=null};return AccessibilityManager}();exports.default=AccessibilityManager;core.WebGLRenderer.registerPlugin("accessibility",AccessibilityManager);core.CanvasRenderer.registerPlugin("accessibility",AccessibilityManager)},{"../core":121,"./accessibleTarget":97,ismobilejs:63}],97:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default={accessible:false,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:false,_accessibleDiv:false}},{}],98:[function(require,module,exports){"use strict";exports.__esModule=true;var _accessibleTarget=require("./accessibleTarget");Object.defineProperty(exports,"accessibleTarget",{enumerable:true,get:function get(){return _interopRequireDefault(_accessibleTarget).default}});var _AccessibilityManager=require("./AccessibilityManager");Object.defineProperty(exports,"AccessibilityManager",{enumerable:true,get:function get(){return _interopRequireDefault(_AccessibilityManager).default}});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./AccessibilityManager":96,"./accessibleTarget":97}],99:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _autoDetectRenderer=require("./autoDetectRenderer");var _Container=require("./display/Container");var _Container2=_interopRequireDefault(_Container);var _ticker=require("./ticker");var _settings=require("./settings");var _settings2=_interopRequireDefault(_settings);var _const=require("./const");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Application=function(){function Application(options,arg2,arg3,arg4,arg5){_classCallCheck(this,Application);if(typeof options==="number"){options=Object.assign({width:options,height:arg2||_settings2.default.RENDER_OPTIONS.height,forceCanvas:!!arg4,sharedTicker:!!arg5},arg3)}this._options=options=Object.assign({autoStart:true,sharedTicker:false,forceCanvas:false,sharedLoader:false},options);this.renderer=(0,_autoDetectRenderer.autoDetectRenderer)(options);this.stage=new _Container2.default;this._ticker=null;this.ticker=options.sharedTicker?_ticker.shared:new _ticker.Ticker;if(options.autoStart){this.start()}}Application.prototype.render=function render(){this.renderer.render(this.stage)};Application.prototype.stop=function stop(){this._ticker.stop()};Application.prototype.start=function start(){this._ticker.start()};Application.prototype.destroy=function destroy(removeView,stageOptions){if(this._ticker){var oldTicker=this._ticker;this.ticker=null;oldTicker.destroy()}this.stage.destroy(stageOptions);this.stage=null;this.renderer.destroy(removeView);this.renderer=null;this._options=null};_createClass(Application,[{key:"ticker",set:function set(ticker){if(this._ticker){this._ticker.remove(this.render,this)}this._ticker=ticker;if(ticker){ticker.add(this.render,this,_const.UPDATE_PRIORITY.LOW)}},get:function get(){return this._ticker}},{key:"view",get:function get(){return this.renderer.view}},{key:"screen",get:function get(){return this.renderer.screen}}]);return Application}();exports.default=Application},{"./autoDetectRenderer":101,"./const":102,"./display/Container":104,"./settings":157,"./ticker":177}],100:[function(require,module,exports){"use strict";exports.__esModule=true;var _pixiGlCore=require("pixi-gl-core");var _settings=require("./settings");var _settings2=_interopRequireDefault(_settings);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function checkPrecision(src,def){if(src instanceof Array){if(src[0].substring(0,9)!=="precision"){var copy=src.slice(0);copy.unshift("precision "+def+" float;");return copy}}else if(src.trim().substring(0,9)!=="precision"){return"precision "+def+" float;\n"+src}return src}var Shader=function(_GLShader){_inherits(Shader,_GLShader);function Shader(gl,vertexSrc,fragmentSrc,attributeLocations,precision){_classCallCheck(this,Shader);return _possibleConstructorReturn(this,_GLShader.call(this,gl,checkPrecision(vertexSrc,precision||_settings2.default.PRECISION_VERTEX),checkPrecision(fragmentSrc,precision||_settings2.default.PRECISION_FRAGMENT),undefined,attributeLocations))}return Shader}(_pixiGlCore.GLShader);exports.default=Shader},{"./settings":157,"pixi-gl-core":85}],101:[function(require,module,exports){"use strict";exports.__esModule=true;exports.autoDetectRenderer=autoDetectRenderer;var _utils=require("./utils");var utils=_interopRequireWildcard(_utils);var _CanvasRenderer=require("./renderers/canvas/CanvasRenderer");var _CanvasRenderer2=_interopRequireDefault(_CanvasRenderer);var _WebGLRenderer=require("./renderers/webgl/WebGLRenderer");var _WebGLRenderer2=_interopRequireDefault(_WebGLRenderer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function autoDetectRenderer(options,arg1,arg2,arg3){var forceCanvas=options&&options.forceCanvas;if(arg3!==undefined){forceCanvas=arg3}if(!forceCanvas&&utils.isWebGLSupported()){return new _WebGLRenderer2.default(options,arg1,arg2)}return new _CanvasRenderer2.default(options,arg1,arg2)}},{"./renderers/canvas/CanvasRenderer":133,"./renderers/webgl/WebGLRenderer":140,"./utils":181}],102:[function(require,module,exports){"use strict";exports.__esModule=true;var VERSION=exports.VERSION="4.8.1";var PI_2=exports.PI_2=Math.PI*2;var RAD_TO_DEG=exports.RAD_TO_DEG=180/Math.PI;var DEG_TO_RAD=exports.DEG_TO_RAD=Math.PI/180;var RENDERER_TYPE=exports.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2};var BLEND_MODES=exports.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19};var DRAW_MODES=exports.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};var SCALE_MODES=exports.SCALE_MODES={LINEAR:0,NEAREST:1};var WRAP_MODES=exports.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2};var GC_MODES=exports.GC_MODES={AUTO:0,MANUAL:1};var URL_FILE_EXTENSION=exports.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i;var DATA_URI=exports.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;var SVG_SIZE=exports.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var SHAPES=exports.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4};var PRECISION=exports.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"};var TRANSFORM_MODE=exports.TRANSFORM_MODE={STATIC:0,DYNAMIC:1};var TEXT_GRADIENT=exports.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1};var UPDATE_PRIORITY=exports.UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50}},{}],103:[function(require,module,exports){"use strict";exports.__esModule=true;var _math=require("../math");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Bounds=function(){function Bounds(){_classCallCheck(this,Bounds);this.minX=Infinity;this.minY=Infinity;this.maxX=-Infinity;this.maxY=-Infinity;this.rect=null}Bounds.prototype.isEmpty=function isEmpty(){return this.minX>this.maxX||this.minY>this.maxY};Bounds.prototype.clear=function clear(){this.updateID++;this.minX=Infinity;this.minY=Infinity;this.maxX=-Infinity;this.maxY=-Infinity};Bounds.prototype.getRectangle=function getRectangle(rect){if(this.minX>this.maxX||this.minY>this.maxY){return _math.Rectangle.EMPTY}rect=rect||new _math.Rectangle(0,0,1,1);rect.x=this.minX;rect.y=this.minY;rect.width=this.maxX-this.minX;rect.height=this.maxY-this.minY;return rect};Bounds.prototype.addPoint=function addPoint(point){this.minX=Math.min(this.minX,point.x);this.maxX=Math.max(this.maxX,point.x);this.minY=Math.min(this.minY,point.y);this.maxY=Math.max(this.maxY,point.y)};Bounds.prototype.addQuad=function addQuad(vertices){var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;var x=vertices[0];var y=vertices[1];minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=vertices[2];y=vertices[3];minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=vertices[4];y=vertices[5];minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=vertices[6];y=vertices[7];minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;this.minX=minX;this.minY=minY;this.maxX=maxX;this.maxY=maxY};Bounds.prototype.addFrame=function addFrame(transform,x0,y0,x1,y1){var matrix=transform.worldTransform;var a=matrix.a;var b=matrix.b;var c=matrix.c;var d=matrix.d;var tx=matrix.tx;var ty=matrix.ty;var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;var x=a*x0+c*y0+tx;var y=b*x0+d*y0+ty;minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=a*x1+c*y0+tx;y=b*x1+d*y0+ty;minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=a*x0+c*y1+tx;y=b*x0+d*y1+ty;minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;x=a*x1+c*y1+tx;y=b*x1+d*y1+ty;minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY;this.minX=minX;this.minY=minY;this.maxX=maxX;this.maxY=maxY};Bounds.prototype.addVertices=function addVertices(transform,vertices,beginOffset,endOffset){var matrix=transform.worldTransform;var a=matrix.a;var b=matrix.b;var c=matrix.c;var d=matrix.d;var tx=matrix.tx;var ty=matrix.ty;var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;for(var i=beginOffset;i<endOffset;i+=2){var rawX=vertices[i];var rawY=vertices[i+1];var x=a*rawX+c*rawY+tx;var y=d*rawY+b*rawX+ty;minX=x<minX?x:minX;minY=y<minY?y:minY;maxX=x>maxX?x:maxX;maxY=y>maxY?y:maxY}this.minX=minX;this.minY=minY;this.maxX=maxX;this.maxY=maxY};Bounds.prototype.addBounds=function addBounds(bounds){var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;this.minX=bounds.minX<minX?bounds.minX:minX;this.minY=bounds.minY<minY?bounds.minY:minY;this.maxX=bounds.maxX>maxX?bounds.maxX:maxX;this.maxY=bounds.maxY>maxY?bounds.maxY:maxY};Bounds.prototype.addBoundsMask=function addBoundsMask(bounds,mask){var _minX=bounds.minX>mask.minX?bounds.minX:mask.minX;var _minY=bounds.minY>mask.minY?bounds.minY:mask.minY;var _maxX=bounds.maxX<mask.maxX?bounds.maxX:mask.maxX;var _maxY=bounds.maxY<mask.maxY?bounds.maxY:mask.maxY;if(_minX<=_maxX&&_minY<=_maxY){var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;this.minX=_minX<minX?_minX:minX;this.minY=_minY<minY?_minY:minY;this.maxX=_maxX>maxX?_maxX:maxX;this.maxY=_maxY>maxY?_maxY:maxY}};Bounds.prototype.addBoundsArea=function addBoundsArea(bounds,area){var _minX=bounds.minX>area.x?bounds.minX:area.x;var _minY=bounds.minY>area.y?bounds.minY:area.y;var _maxX=bounds.maxX<area.x+area.width?bounds.maxX:area.x+area.width;var _maxY=bounds.maxY<area.y+area.height?bounds.maxY:area.y+area.height;if(_minX<=_maxX&&_minY<=_maxY){var minX=this.minX;var minY=this.minY;var maxX=this.maxX;var maxY=this.maxY;this.minX=_minX<minX?_minX:minX;this.minY=_minY<minY?_minY:minY;this.maxX=_maxX>maxX?_maxX:maxX;this.maxY=_maxY>maxY?_maxY:maxY}};return Bounds}();exports.default=Bounds},{"../math":126}],104:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _utils=require("../utils");var _DisplayObject2=require("./DisplayObject");var _DisplayObject3=_interopRequireDefault(_DisplayObject2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Container=function(_DisplayObject){_inherits(Container,_DisplayObject);function Container(){_classCallCheck(this,Container);var _this=_possibleConstructorReturn(this,_DisplayObject.call(this));_this.children=[];return _this}Container.prototype.onChildrenChange=function onChildrenChange(){};Container.prototype.addChild=function addChild(child){var argumentsLength=arguments.length;if(argumentsLength>1){for(var i=0;i<argumentsLength;i++){this.addChild(arguments[i])}}else{if(child.parent){child.parent.removeChild(child)}child.parent=this;child.transform._parentID=-1;this.children.push(child);this._boundsID++;this.onChildrenChange(this.children.length-1);child.emit("added",this)}return child};Container.prototype.addChildAt=function addChildAt(child,index){if(index<0||index>this.children.length){throw new Error(child+"addChildAt: The index "+index+" supplied is out of bounds "+this.children.length)}if(child.parent){child.parent.removeChild(child)}child.parent=this;child.transform._parentID=-1;this.children.splice(index,0,child);this._boundsID++;this.onChildrenChange(index);child.emit("added",this);return child};Container.prototype.swapChildren=function swapChildren(child,child2){if(child===child2){return}var index1=this.getChildIndex(child);var index2=this.getChildIndex(child2);this.children[index1]=child2;this.children[index2]=child;this.onChildrenChange(index1<index2?index1:index2)};Container.prototype.getChildIndex=function getChildIndex(child){var index=this.children.indexOf(child);if(index===-1){throw new Error("The supplied DisplayObject must be a child of the caller")}return index};Container.prototype.setChildIndex=function setChildIndex(child,index){if(index<0||index>=this.children.length){throw new Error("The index "+index+" supplied is out of bounds "+this.children.length)}var currentIndex=this.getChildIndex(child);(0,_utils.removeItems)(this.children,currentIndex,1);this.children.splice(index,0,child);this.onChildrenChange(index)};Container.prototype.getChildAt=function getChildAt(index){if(index<0||index>=this.children.length){throw new Error("getChildAt: Index ("+index+") does not exist.")}return this.children[index]};Container.prototype.removeChild=function removeChild(child){var argumentsLength=arguments.length;if(argumentsLength>1){for(var i=0;i<argumentsLength;i++){this.removeChild(arguments[i])}}else{var index=this.children.indexOf(child);if(index===-1)return null;child.parent=null;child.transform._parentID=-1;(0,_utils.removeItems)(this.children,index,1);this._boundsID++;this.onChildrenChange(index);child.emit("removed",this)}return child};Container.prototype.removeChildAt=function removeChildAt(index){var child=this.getChildAt(index);child.parent=null;child.transform._parentID=-1;(0,_utils.removeItems)(this.children,index,1);this._boundsID++;this.onChildrenChange(index);child.emit("removed",this);return child};Container.prototype.removeChildren=function removeChildren(){var beginIndex=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var endIndex=arguments[1];var begin=beginIndex;var end=typeof endIndex==="number"?endIndex:this.children.length;var range=end-begin;var removed=void 0;if(range>0&&range<=end){removed=this.children.splice(begin,range);for(var i=0;i<removed.length;++i){removed[i].parent=null;if(removed[i].transform){removed[i].transform._parentID=-1}}this._boundsID++;this.onChildrenChange(beginIndex);for(var _i=0;_i<removed.length;++_i){removed[_i].emit("removed",this)}return removed}else if(range===0&&this.children.length===0){return[]}throw new RangeError("removeChildren: numeric values are outside the acceptable range.")};Container.prototype.updateTransform=function updateTransform(){this._boundsID++;this.transform.updateTransform(this.parent.transform);this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var i=0,j=this.children.length;i<j;++i){var child=this.children[i];if(child.visible){child.updateTransform()}}};Container.prototype.calculateBounds=function calculateBounds(){this._bounds.clear();this._calculateBounds();for(var i=0;i<this.children.length;i++){var child=this.children[i];if(!child.visible||!child.renderable){continue}child.calculateBounds();if(child._mask){child._mask.calculateBounds();this._bounds.addBoundsMask(child._bounds,child._mask._bounds)}else if(child.filterArea){this._bounds.addBoundsArea(child._bounds,child.filterArea)}else{this._bounds.addBounds(child._bounds)}}this._lastBoundsID=this._boundsID};Container.prototype._calculateBounds=function _calculateBounds(){};Container.prototype.renderWebGL=function renderWebGL(renderer){if(!this.visible||this.worldAlpha<=0||!this.renderable){return}if(this._mask||this._filters){this.renderAdvancedWebGL(renderer)}else{this._renderWebGL(renderer);for(var i=0,j=this.children.length;i<j;++i){this.children[i].renderWebGL(renderer)}}};Container.prototype.renderAdvancedWebGL=function renderAdvancedWebGL(renderer){renderer.flush();var filters=this._filters;var mask=this._mask;if(filters){if(!this._enabledFilters){this._enabledFilters=[]}this._enabledFilters.length=0;for(var i=0;i<filters.length;i++){if(filters[i].enabled){this._enabledFilters.push(filters[i])}}if(this._enabledFilters.length){renderer.filterManager.pushFilter(this,this._enabledFilters)}}if(mask){renderer.maskManager.pushMask(this,this._mask)}this._renderWebGL(renderer);for(var _i2=0,j=this.children.length;_i2<j;_i2++){this.children[_i2].renderWebGL(renderer)}renderer.flush();if(mask){renderer.maskManager.popMask(this,this._mask)}if(filters&&this._enabledFilters&&this._enabledFilters.length){renderer.filterManager.popFilter()}};Container.prototype._renderWebGL=function _renderWebGL(renderer){};Container.prototype._renderCanvas=function _renderCanvas(renderer){};Container.prototype.renderCanvas=function renderCanvas(renderer){if(!this.visible||this.worldAlpha<=0||!this.renderable){return}if(this._mask){renderer.maskManager.pushMask(this._mask)}this._renderCanvas(renderer);for(var i=0,j=this.children.length;i<j;++i){this.children[i].renderCanvas(renderer)}if(this._mask){renderer.maskManager.popMask(renderer)}};Container.prototype.destroy=function destroy(options){_DisplayObject.prototype.destroy.call(this);var destroyChildren=typeof options==="boolean"?options:options&&options.children;var oldChildren=this.removeChildren(0,this.children.length);if(destroyChildren){for(var i=0;i<oldChildren.length;++i){oldChildren[i].destroy(options)}}};_createClass(Container,[{key:"width",get:function get(){return this.scale.x*this.getLocalBounds().width},set:function set(value){var width=this.getLocalBounds().width;if(width!==0){this.scale.x=value/width}else{this.scale.x=1}this._width=value}},{key:"height",get:function get(){return this.scale.y*this.getLocalBounds().height},set:function set(value){var height=this.getLocalBounds().height;if(height!==0){this.scale.y=value/height}else{this.scale.y=1}this._height=value}}]);return Container}(_DisplayObject3.default);exports.default=Container;Container.prototype.containerUpdateTransform=Container.prototype.updateTransform},{"../utils":181,"./DisplayObject":105}],105:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _eventemitter=require("eventemitter3");var _eventemitter2=_interopRequireDefault(_eventemitter);var _const=require("../const");var _settings=require("../settings");var _settings2=_interopRequireDefault(_settings);var _TransformStatic=require("./TransformStatic");var _TransformStatic2=_interopRequireDefault(_TransformStatic);var _Transform=require("./Transform");var _Transform2=_interopRequireDefault(_Transform);var _Bounds=require("./Bounds");var _Bounds2=_interopRequireDefault(_Bounds);var _math=require("../math");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var DisplayObject=function(_EventEmitter){_inherits(DisplayObject,_EventEmitter);function DisplayObject(){_classCallCheck(this,DisplayObject);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));var TransformClass=_settings2.default.TRANSFORM_MODE===_const.TRANSFORM_MODE.STATIC?_TransformStatic2.default:_Transform2.default;_this.tempDisplayObjectParent=null;_this.transform=new TransformClass;_this.alpha=1;_this.visible=true;_this.renderable=true;_this.parent=null;_this.worldAlpha=1;_this.filterArea=null;_this._filters=null;_this._enabledFilters=null;_this._bounds=new _Bounds2.default;_this._boundsID=0;_this._lastBoundsID=-1;_this._boundsRect=null;_this._localBoundsRect=null;_this._mask=null;_this._destroyed=false;return _this}DisplayObject.prototype.updateTransform=function updateTransform(){this.transform.updateTransform(this.parent.transform);this.worldAlpha=this.alpha*this.parent.worldAlpha;this._bounds.updateID++};DisplayObject.prototype._recursivePostUpdateTransform=function _recursivePostUpdateTransform(){if(this.parent){this.parent._recursivePostUpdateTransform();this.transform.updateTransform(this.parent.transform)}else{this.transform.updateTransform(this._tempDisplayObjectParent.transform)}};DisplayObject.prototype.getBounds=function getBounds(skipUpdate,rect){if(!skipUpdate){if(!this.parent){this.parent=this._tempDisplayObjectParent;this.updateTransform();this.parent=null}else{this._recursivePostUpdateTransform();this.updateTransform()}}if(this._boundsID!==this._lastBoundsID){this.calculateBounds()}if(!rect){if(!this._boundsRect){this._boundsRect=new _math.Rectangle}rect=this._boundsRect}return this._bounds.getRectangle(rect)};DisplayObject.prototype.getLocalBounds=function getLocalBounds(rect){var transformRef=this.transform;var parentRef=this.parent;this.parent=null;this.transform=this._tempDisplayObjectParent.transform;if(!rect){if(!this._localBoundsRect){this._localBoundsRect=new _math.Rectangle}rect=this._localBoundsRect}var bounds=this.getBounds(false,rect);this.parent=parentRef;this.transform=transformRef;return bounds};DisplayObject.prototype.toGlobal=function toGlobal(position,point){var skipUpdate=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!skipUpdate){this._recursivePostUpdateTransform();if(!this.parent){this.parent=this._tempDisplayObjectParent;this.displayObjectUpdateTransform();this.parent=null}else{this.displayObjectUpdateTransform()}}return this.worldTransform.apply(position,point)};DisplayObject.prototype.toLocal=function toLocal(position,from,point,skipUpdate){if(from){position=from.toGlobal(position,point,skipUpdate)}if(!skipUpdate){this._recursivePostUpdateTransform();if(!this.parent){this.parent=this._tempDisplayObjectParent;this.displayObjectUpdateTransform();this.parent=null}else{this.displayObjectUpdateTransform()}}return this.worldTransform.applyInverse(position,point)};DisplayObject.prototype.renderWebGL=function renderWebGL(renderer){};DisplayObject.prototype.renderCanvas=function renderCanvas(renderer){};DisplayObject.prototype.setParent=function setParent(container){if(!container||!container.addChild){throw new Error("setParent: Argument must be a Container")}container.addChild(this);return container};DisplayObject.prototype.setTransform=function setTransform(){var x=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var scaleX=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var scaleY=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;var rotation=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var skewX=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;var skewY=arguments.length>6&&arguments[6]!==undefined?arguments[6]:0;var pivotX=arguments.length>7&&arguments[7]!==undefined?arguments[7]:0;var pivotY=arguments.length>8&&arguments[8]!==undefined?arguments[8]:0;this.position.x=x;this.position.y=y;this.scale.x=!scaleX?1:scaleX;this.scale.y=!scaleY?1:scaleY;this.rotation=rotation;this.skew.x=skewX;this.skew.y=skewY;this.pivot.x=pivotX;this.pivot.y=pivotY;return this};DisplayObject.prototype.destroy=function destroy(){this.removeAllListeners();if(this.parent){this.parent.removeChild(this)}this.transform=null;this.parent=null;this._bounds=null;this._currentBounds=null;this._mask=null;this.filterArea=null;this.interactive=false;this.interactiveChildren=false;this._destroyed=true};_createClass(DisplayObject,[{key:"_tempDisplayObjectParent",get:function get(){if(this.tempDisplayObjectParent===null){this.tempDisplayObjectParent=new DisplayObject}return this.tempDisplayObjectParent}},{key:"x",get:function get(){return this.position.x},set:function set(value){this.transform.position.x=value}},{key:"y",get:function get(){return this.position.y},set:function set(value){this.transform.position.y=value}},{key:"worldTransform",get:function get(){return this.transform.worldTransform}},{key:"localTransform",get:function get(){return this.transform.localTransform}},{key:"position",get:function get(){return this.transform.position},set:function set(value){this.transform.position.copy(value)}},{key:"scale",get:function get(){return this.transform.scale},set:function set(value){this.transform.scale.copy(value)}},{key:"pivot",get:function get(){return this.transform.pivot},set:function set(value){this.transform.pivot.copy(value)}},{key:"skew",get:function get(){return this.transform.skew},set:function set(value){this.transform.skew.copy(value)}},{key:"rotation",get:function get(){return this.transform.rotation},set:function set(value){this.transform.rotation=value}},{key:"worldVisible",get:function get(){var item=this;do{if(!item.visible){return false}item=item.parent}while(item);return true}},{key:"mask",get:function get(){return this._mask},set:function set(value){if(this._mask){this._mask.renderable=true;this._mask.isMask=false}this._mask=value;if(this._mask){this._mask.renderable=false;this._mask.isMask=true}}},{key:"filters",get:function get(){return this._filters&&this._filters.slice()},set:function set(value){this._filters=value&&value.slice()}}]);return DisplayObject}(_eventemitter2.default);exports.default=DisplayObject;DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform},{"../const":102,"../math":126,"../settings":157,"./Bounds":103,"./Transform":106,"./TransformStatic":108,eventemitter3:62}],106:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _math=require("../math");var _TransformBase2=require("./TransformBase");var _TransformBase3=_interopRequireDefault(_TransformBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Transform=function(_TransformBase){_inherits(Transform,_TransformBase);function Transform(){_classCallCheck(this,Transform);var _this=_possibleConstructorReturn(this,_TransformBase.call(this));_this.position=new _math.Point(0,0);_this.scale=new _math.Point(1,1);_this.skew=new _math.ObservablePoint(_this.updateSkew,_this,0,0);_this.pivot=new _math.Point(0,0);_this._rotation=0;_this._cx=1;_this._sx=0;_this._cy=0;_this._sy=1;return _this}Transform.prototype.updateSkew=function updateSkew(){this._cx=Math.cos(this._rotation+this.skew._y);this._sx=Math.sin(this._rotation+this.skew._y);this._cy=-Math.sin(this._rotation-this.skew._x);this._sy=Math.cos(this._rotation-this.skew._x)};Transform.prototype.updateLocalTransform=function updateLocalTransform(){var lt=this.localTransform;lt.a=this._cx*this.scale.x;lt.b=this._sx*this.scale.x;lt.c=this._cy*this.scale.y;lt.d=this._sy*this.scale.y;lt.tx=this.position.x-(this.pivot.x*lt.a+this.pivot.y*lt.c);lt.ty=this.position.y-(this.pivot.x*lt.b+this.pivot.y*lt.d)};Transform.prototype.updateTransform=function updateTransform(parentTransform){var lt=this.localTransform;lt.a=this._cx*this.scale.x;lt.b=this._sx*this.scale.x;lt.c=this._cy*this.scale.y;lt.d=this._sy*this.scale.y;lt.tx=this.position.x-(this.pivot.x*lt.a+this.pivot.y*lt.c);lt.ty=this.position.y-(this.pivot.x*lt.b+this.pivot.y*lt.d);var pt=parentTransform.worldTransform;var wt=this.worldTransform;wt.a=lt.a*pt.a+lt.b*pt.c;wt.b=lt.a*pt.b+lt.b*pt.d;wt.c=lt.c*pt.a+lt.d*pt.c;wt.d=lt.c*pt.b+lt.d*pt.d;wt.tx=lt.tx*pt.a+lt.ty*pt.c+pt.tx;wt.ty=lt.tx*pt.b+lt.ty*pt.d+pt.ty;this._worldID++};Transform.prototype.setFromMatrix=function setFromMatrix(matrix){matrix.decompose(this)};_createClass(Transform,[{key:"rotation",get:function get(){return this._rotation},set:function set(value){this._rotation=value;this.updateSkew()}}]);return Transform}(_TransformBase3.default);exports.default=Transform},{"../math":126,"./TransformBase":107}],107:[function(require,module,exports){"use strict";exports.__esModule=true;var _math=require("../math");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TransformBase=function(){function TransformBase(){_classCallCheck(this,TransformBase);this.worldTransform=new _math.Matrix;this.localTransform=new _math.Matrix;this._worldID=0;this._parentID=0}TransformBase.prototype.updateLocalTransform=function updateLocalTransform(){};TransformBase.prototype.updateTransform=function updateTransform(parentTransform){var pt=parentTransform.worldTransform;var wt=this.worldTransform;var lt=this.localTransform;wt.a=lt.a*pt.a+lt.b*pt.c;wt.b=lt.a*pt.b+lt.b*pt.d;wt.c=lt.c*pt.a+lt.d*pt.c;wt.d=lt.c*pt.b+lt.d*pt.d;wt.tx=lt.tx*pt.a+lt.ty*pt.c+pt.tx;wt.ty=lt.tx*pt.b+lt.ty*pt.d+pt.ty;this._worldID++};return TransformBase}();exports.default=TransformBase;TransformBase.prototype.updateWorldTransform=TransformBase.prototype.updateTransform;TransformBase.IDENTITY=new TransformBase},{"../math":126}],108:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _math=require("../math");var _TransformBase2=require("./TransformBase");var _TransformBase3=_interopRequireDefault(_TransformBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var TransformStatic=function(_TransformBase){_inherits(TransformStatic,_TransformBase);function TransformStatic(){_classCallCheck(this,TransformStatic);var _this=_possibleConstructorReturn(this,_TransformBase.call(this));_this.position=new _math.ObservablePoint(_this.onChange,_this,0,0);_this.scale=new _math.ObservablePoint(_this.onChange,_this,1,1);_this.pivot=new _math.ObservablePoint(_this.onChange,_this,0,0);_this.skew=new _math.ObservablePoint(_this.updateSkew,_this,0,0);_this._rotation=0;_this._cx=1;_this._sx=0;_this._cy=0;_this._sy=1;_this._localID=0;_this._currentLocalID=0;return _this}TransformStatic.prototype.onChange=function onChange(){this._localID++};TransformStatic.prototype.updateSkew=function updateSkew(){this._cx=Math.cos(this._rotation+this.skew._y);this._sx=Math.sin(this._rotation+this.skew._y);this._cy=-Math.sin(this._rotation-this.skew._x);this._sy=Math.cos(this._rotation-this.skew._x);this._localID++};TransformStatic.prototype.updateLocalTransform=function updateLocalTransform(){var lt=this.localTransform;if(this._localID!==this._currentLocalID){lt.a=this._cx*this.scale._x;lt.b=this._sx*this.scale._x;lt.c=this._cy*this.scale._y;lt.d=this._sy*this.scale._y;lt.tx=this.position._x-(this.pivot._x*lt.a+this.pivot._y*lt.c);lt.ty=this.position._y-(this.pivot._x*lt.b+this.pivot._y*lt.d);this._currentLocalID=this._localID;this._parentID=-1}};TransformStatic.prototype.updateTransform=function updateTransform(parentTransform){var lt=this.localTransform;if(this._localID!==this._currentLocalID){lt.a=this._cx*this.scale._x;lt.b=this._sx*this.scale._x;lt.c=this._cy*this.scale._y;lt.d=this._sy*this.scale._y;lt.tx=this.position._x-(this.pivot._x*lt.a+this.pivot._y*lt.c);lt.ty=this.position._y-(this.pivot._x*lt.b+this.pivot._y*lt.d);this._currentLocalID=this._localID;this._parentID=-1}if(this._parentID!==parentTransform._worldID){var pt=parentTransform.worldTransform;var wt=this.worldTransform;wt.a=lt.a*pt.a+lt.b*pt.c;wt.b=lt.a*pt.b+lt.b*pt.d;wt.c=lt.c*pt.a+lt.d*pt.c;wt.d=lt.c*pt.b+lt.d*pt.d;wt.tx=lt.tx*pt.a+lt.ty*pt.c+pt.tx;wt.ty=lt.tx*pt.b+lt.ty*pt.d+pt.ty;this._parentID=parentTransform._worldID;this._worldID++}};TransformStatic.prototype.setFromMatrix=function setFromMatrix(matrix){matrix.decompose(this);this._localID++};_createClass(TransformStatic,[{key:"rotation",get:function get(){return this._rotation},set:function set(value){this._rotation=value;this.updateSkew()}}]);return TransformStatic}(_TransformBase3.default);exports.default=TransformStatic},{"../math":126,"./TransformBase":107}],109:[function(require,module,exports){"use strict";exports.__esModule=true;var _Container2=require("../display/Container");var _Container3=_interopRequireDefault(_Container2);var _RenderTexture=require("../textures/RenderTexture");var _RenderTexture2=_interopRequireDefault(_RenderTexture);var _Texture=require("../textures/Texture");var _Texture2=_interopRequireDefault(_Texture);var _GraphicsData=require("./GraphicsData");var _GraphicsData2=_interopRequireDefault(_GraphicsData);var _Sprite=require("../sprites/Sprite");var _Sprite2=_interopRequireDefault(_Sprite);var _math=require("../math");var _utils=require("../utils");var _const=require("../const");var _Bounds=require("../display/Bounds");var _Bounds2=_interopRequireDefault(_Bounds);var _bezierCurveTo2=require("./utils/bezierCurveTo");var _bezierCurveTo3=_interopRequireDefault(_bezierCurveTo2);var _CanvasRenderer=require("../renderers/canvas/CanvasRenderer");var _CanvasRenderer2=_interopRequireDefault(_CanvasRenderer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var canvasRenderer=void 0;var tempMatrix=new _math.Matrix;var tempPoint=new _math.Point;var tempColor1=new Float32Array(4);var tempColor2=new Float32Array(4);var Graphics=function(_Container){_inherits(Graphics,_Container);function Graphics(){var nativeLines=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;_classCallCheck(this,Graphics);var _this=_possibleConstructorReturn(this,_Container.call(this));_this.fillAlpha=1;_this.lineWidth=0;_this.nativeLines=nativeLines;_this.lineColor=0;_this.lineAlignment=.5;_this.graphicsData=[];_this.tint=16777215;_this._prevTint=16777215;_this.blendMode=_const.BLEND_MODES.NORMAL;_this.currentPath=null;_this._webGL={};_this.isMask=false;_this.boundsPadding=0;_this._localBounds=new _Bounds2.default;_this.dirty=0;_this.fastRectDirty=-1;_this.clearDirty=0;_this.boundsDirty=-1;_this.cachedSpriteDirty=false;_this._spriteRect=null;_this._fastRect=false;return _this}Graphics.prototype.clone=function clone(){var clone=new Graphics;clone.renderable=this.renderable;clone.fillAlpha=this.fillAlpha;clone.lineWidth=this.lineWidth;clone.lineColor=this.lineColor;clone.lineAlignment=this.lineAlignment;clone.tint=this.tint;clone.blendMode=this.blendMode;clone.isMask=this.isMask;clone.boundsPadding=this.boundsPadding;clone.dirty=0;clone.cachedSpriteDirty=this.cachedSpriteDirty;for(var i=0;i<this.graphicsData.length;++i){clone.graphicsData.push(this.graphicsData[i].clone())}clone.currentPath=clone.graphicsData[clone.graphicsData.length-1];clone.updateLocalBounds();return clone};Graphics.prototype._quadraticCurveLength=function _quadraticCurveLength(fromX,fromY,cpX,cpY,toX,toY){var ax=fromX-(2*cpX+toX);var ay=fromY-(2*cpY+toY);var bx=2*((cpX-2)*fromX);var by=2*((cpY-2)*fromY);var a=4*(ax*ax+ay*ay);var b=4*(ax*bx+ay*by);var c=bx*bx+by*by;var s=2*Math.sqrt(a+b+c);var a2=Math.sqrt(a);var a32=2*a*a2;var c2=2*Math.sqrt(c);var ba=b/a2;return(a32*s+a2*b*(s-c2)+(4*c*a-b*b)*Math.log((2*a2+ba+s)/(ba+c2)))/(4*a32)};Graphics.prototype._bezierCurveLength=function _bezierCurveLength(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY){var n=10;var result=0;var t=0;var t2=0;var t3=0;var nt=0;var nt2=0;var nt3=0;var x=0;var y=0;var dx=0;var dy=0;var prevX=fromX;var prevY=fromY;for(var i=1;i<=n;++i){t=i/n;t2=t*t;t3=t2*t;nt=1-t;nt2=nt*nt;nt3=nt2*nt;x=nt3*fromX+3*nt2*t*cpX+3*nt*t2*cpX2+t3*toX;y=nt3*fromY+3*nt2*t*cpY+3*nt*t2*cpY2+t3*toY;dx=prevX-x;dy=prevY-y;prevX=x;prevY=y;result+=Math.sqrt(dx*dx+dy*dy)}return result};Graphics.prototype._segmentsCount=function _segmentsCount(length){var result=Math.ceil(length/Graphics.CURVES.maxLength);if(result<Graphics.CURVES.minSegments){result=Graphics.CURVES.minSegments}else if(result>Graphics.CURVES.maxSegments){result=Graphics.CURVES.maxSegments}return result};Graphics.prototype.lineStyle=function lineStyle(){var lineWidth=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var color=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var alpha=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var alignment=arguments.length>3&&arguments[3]!==undefined?arguments[3]:.5;this.lineWidth=lineWidth;this.lineColor=color;this.lineAlpha=alpha;this.lineAlignment=alignment;if(this.currentPath){if(this.currentPath.shape.points.length){var shape=new _math.Polygon(this.currentPath.shape.points.slice(-2));shape.closed=false;this.drawShape(shape)}else{this.currentPath.lineWidth=this.lineWidth;this.currentPath.lineColor=this.lineColor;this.currentPath.lineAlpha=this.lineAlpha;this.currentPath.lineAlignment=this.lineAlignment}}return this};Graphics.prototype.moveTo=function moveTo(x,y){var shape=new _math.Polygon([x,y]);shape.closed=false;this.drawShape(shape);return this};Graphics.prototype.lineTo=function lineTo(x,y){this.currentPath.shape.points.push(x,y);this.dirty++;return this};Graphics.prototype.quadraticCurveTo=function quadraticCurveTo(cpX,cpY,toX,toY){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points=[0,0]}}else{this.moveTo(0,0)}var points=this.currentPath.shape.points;var xa=0;var ya=0;if(points.length===0){this.moveTo(0,0)}var fromX=points[points.length-2];var fromY=points[points.length-1];var n=Graphics.CURVES.adaptive?this._segmentsCount(this._quadraticCurveLength(fromX,fromY,cpX,cpY,toX,toY)):20;for(var i=1;i<=n;++i){var j=i/n;xa=fromX+(cpX-fromX)*j;ya=fromY+(cpY-fromY)*j;points.push(xa+(cpX+(toX-cpX)*j-xa)*j,ya+(cpY+(toY-cpY)*j-ya)*j)}this.dirty++;return this};Graphics.prototype.bezierCurveTo=function bezierCurveTo(cpX,cpY,cpX2,cpY2,toX,toY){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points=[0,0]}}else{this.moveTo(0,0)}var points=this.currentPath.shape.points;var fromX=points[points.length-2];var fromY=points[points.length-1];points.length-=2;var n=Graphics.CURVES.adaptive?this._segmentsCount(this._bezierCurveLength(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY)):20;(0,_bezierCurveTo3.default)(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY,n,points);this.dirty++;return this};Graphics.prototype.arcTo=function arcTo(x1,y1,x2,y2,radius){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points.push(x1,y1)}}else{this.moveTo(x1,y1)}var points=this.currentPath.shape.points;var fromX=points[points.length-2];var fromY=points[points.length-1];var a1=fromY-y1;var b1=fromX-x1;var a2=y2-y1;var b2=x2-x1;var mm=Math.abs(a1*b2-b1*a2);if(mm<1e-8||radius===0){if(points[points.length-2]!==x1||points[points.length-1]!==y1){points.push(x1,y1)}}else{var dd=a1*a1+b1*b1;var cc=a2*a2+b2*b2;var tt=a1*a2+b1*b2;var k1=radius*Math.sqrt(dd)/mm;var k2=radius*Math.sqrt(cc)/mm;var j1=k1*tt/dd;var j2=k2*tt/cc;var cx=k1*b2+k2*b1;var cy=k1*a2+k2*a1;var px=b1*(k2+j1);var py=a1*(k2+j1);var qx=b2*(k1+j2);var qy=a2*(k1+j2);var startAngle=Math.atan2(py-cy,px-cx);var endAngle=Math.atan2(qy-cy,qx-cx);this.arc(cx+x1,cy+y1,radius,startAngle,endAngle,b1*a2>b2*a1)}this.dirty++;return this};Graphics.prototype.arc=function arc(cx,cy,radius,startAngle,endAngle){var anticlockwise=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;if(startAngle===endAngle){return this}if(!anticlockwise&&endAngle<=startAngle){endAngle+=_const.PI_2}else if(anticlockwise&&startAngle<=endAngle){startAngle+=_const.PI_2}var sweep=endAngle-startAngle;var segs=Graphics.CURVES.adaptive?this._segmentsCount(Math.abs(sweep)*radius):Math.ceil(Math.abs(sweep)/_const.PI_2)*40;if(sweep===0){return this}var startX=cx+Math.cos(startAngle)*radius;var startY=cy+Math.sin(startAngle)*radius;var points=this.currentPath?this.currentPath.shape.points:null;if(points){if(points[points.length-2]!==startX||points[points.length-1]!==startY){points.push(startX,startY)}}else{this.moveTo(startX,startY);points=this.currentPath.shape.points}var theta=sweep/(segs*2);var theta2=theta*2;var cTheta=Math.cos(theta);var sTheta=Math.sin(theta);var segMinus=segs-1;var remainder=segMinus%1/segMinus;for(var i=0;i<=segMinus;++i){var real=i+remainder*i;var angle=theta+startAngle+theta2*real;var c=Math.cos(angle);var s=-Math.sin(angle);points.push((cTheta*c+sTheta*s)*radius+cx,(cTheta*-s+sTheta*c)*radius+cy)}this.dirty++;return this};Graphics.prototype.beginFill=function beginFill(){var color=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var alpha=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this.filling=true;this.fillColor=color;this.fillAlpha=alpha;if(this.currentPath){if(this.currentPath.shape.points.length<=2){this.currentPath.fill=this.filling;this.currentPath.fillColor=this.fillColor;this.currentPath.fillAlpha=this.fillAlpha}}return this};Graphics.prototype.endFill=function endFill(){this.filling=false;this.fillColor=null;this.fillAlpha=1;return this};Graphics.prototype.drawRect=function drawRect(x,y,width,height){this.drawShape(new _math.Rectangle(x,y,width,height));return this};Graphics.prototype.drawRoundedRect=function drawRoundedRect(x,y,width,height,radius){this.drawShape(new _math.RoundedRectangle(x,y,width,height,radius));return this};Graphics.prototype.drawCircle=function drawCircle(x,y,radius){this.drawShape(new _math.Circle(x,y,radius));return this};Graphics.prototype.drawEllipse=function drawEllipse(x,y,width,height){this.drawShape(new _math.Ellipse(x,y,width,height));return this};Graphics.prototype.drawPolygon=function drawPolygon(path){var points=path;var closed=true;if(points instanceof _math.Polygon){closed=points.closed;points=points.points}if(!Array.isArray(points)){points=new Array(arguments.length);for(var i=0;i<points.length;++i){points[i]=arguments[i]}}var shape=new _math.Polygon(points);shape.closed=closed;this.drawShape(shape);return this};Graphics.prototype.drawStar=function drawStar(x,y,points,radius,innerRadius){var rotation=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;innerRadius=innerRadius||radius/2;var startAngle=-1*Math.PI/2+rotation;var len=points*2;var delta=_const.PI_2/len;var polygon=[];for(var i=0;i<len;i++){var r=i%2?innerRadius:radius;var angle=i*delta+startAngle;polygon.push(x+r*Math.cos(angle),y+r*Math.sin(angle))}return this.drawPolygon(polygon)};Graphics.prototype.clear=function clear(){if(this.lineWidth||this.filling||this.graphicsData.length>0){this.lineWidth=0;this.lineAlignment=.5;this.filling=false;this.boundsDirty=-1;this.dirty++;this.clearDirty++;this.graphicsData.length=0}this.currentPath=null;this._spriteRect=null;return this};Graphics.prototype.isFastRect=function isFastRect(){return this.graphicsData.length===1&&this.graphicsData[0].shape.type===_const.SHAPES.RECT&&!this.graphicsData[0].lineWidth};Graphics.prototype._renderWebGL=function _renderWebGL(renderer){if(this.dirty!==this.fastRectDirty){this.fastRectDirty=this.dirty;this._fastRect=this.isFastRect()}if(this._fastRect){this._renderSpriteRect(renderer)}else{renderer.setObjectRenderer(renderer.plugins.graphics);renderer.plugins.graphics.render(this)}};Graphics.prototype._renderSpriteRect=function _renderSpriteRect(renderer){var rect=this.graphicsData[0].shape;if(!this._spriteRect){this._spriteRect=new _Sprite2.default(new _Texture2.default(_Texture2.default.WHITE))}var sprite=this._spriteRect;if(this.tint===16777215){sprite.tint=this.graphicsData[0].fillColor}else{var t1=tempColor1;var t2=tempColor2;(0,_utils.hex2rgb)(this.graphicsData[0].fillColor,t1);(0,_utils.hex2rgb)(this.tint,t2);t1[0]*=t2[0];t1[1]*=t2[1];t1[2]*=t2[2];sprite.tint=(0,_utils.rgb2hex)(t1)}sprite.alpha=this.graphicsData[0].fillAlpha;sprite.worldAlpha=this.worldAlpha*sprite.alpha;sprite.blendMode=this.blendMode;sprite._texture._frame.width=rect.width;sprite._texture._frame.height=rect.height;sprite.transform.worldTransform=this.transform.worldTransform;sprite.anchor.set(-rect.x/rect.width,-rect.y/rect.height);sprite._onAnchorUpdate();sprite._renderWebGL(renderer)};Graphics.prototype._renderCanvas=function _renderCanvas(renderer){if(this.isMask===true){return}renderer.plugins.graphics.render(this)};Graphics.prototype._calculateBounds=function _calculateBounds(){if(this.boundsDirty!==this.dirty){this.boundsDirty=this.dirty;this.updateLocalBounds();this.cachedSpriteDirty=true}var lb=this._localBounds;this._bounds.addFrame(this.transform,lb.minX,lb.minY,lb.maxX,lb.maxY)};Graphics.prototype.containsPoint=function containsPoint(point){this.worldTransform.applyInverse(point,tempPoint);var graphicsData=this.graphicsData;for(var i=0;i<graphicsData.length;++i){var data=graphicsData[i];if(!data.fill){continue}if(data.shape){if(data.shape.contains(tempPoint.x,tempPoint.y)){if(data.holes){for(var _i=0;_i<data.holes.length;_i++){var hole=data.holes[_i];if(hole.contains(tempPoint.x,tempPoint.y)){return false}}}return true}}}return false};Graphics.prototype.updateLocalBounds=function updateLocalBounds(){var minX=Infinity;var maxX=-Infinity;var minY=Infinity;var maxY=-Infinity;if(this.graphicsData.length){var shape=0;var x=0;var y=0;var w=0;var h=0;for(var i=0;i<this.graphicsData.length;i++){var data=this.graphicsData[i];var type=data.type;var lineWidth=data.lineWidth;shape=data.shape;if(type===_const.SHAPES.RECT||type===_const.SHAPES.RREC){x=shape.x-lineWidth/2;y=shape.y-lineWidth/2;w=shape.width+lineWidth;h=shape.height+lineWidth;minX=x<minX?x:minX;maxX=x+w>maxX?x+w:maxX;minY=y<minY?y:minY;maxY=y+h>maxY?y+h:maxY}else if(type===_const.SHAPES.CIRC){x=shape.x;y=shape.y;w=shape.radius+lineWidth/2;h=shape.radius+lineWidth/2;minX=x-w<minX?x-w:minX;maxX=x+w>maxX?x+w:maxX;minY=y-h<minY?y-h:minY;maxY=y+h>maxY?y+h:maxY}else if(type===_const.SHAPES.ELIP){x=shape.x;y=shape.y;w=shape.width+lineWidth/2;h=shape.height+lineWidth/2;minX=x-w<minX?x-w:minX;maxX=x+w>maxX?x+w:maxX;minY=y-h<minY?y-h:minY;maxY=y+h>maxY?y+h:maxY}else{var points=shape.points;var x2=0;var y2=0;var dx=0;var dy=0;var rw=0;var rh=0;var cx=0;var cy=0;for(var j=0;j+2<points.length;j+=2){x=points[j];y=points[j+1];x2=points[j+2];y2=points[j+3];dx=Math.abs(x2-x);dy=Math.abs(y2-y);h=lineWidth;w=Math.sqrt(dx*dx+dy*dy);if(w<1e-9){continue}rw=(h/w*dy+dx)/2;rh=(h/w*dx+dy)/2;cx=(x2+x)/2;cy=(y2+y)/2;minX=cx-rw<minX?cx-rw:minX;maxX=cx+rw>maxX?cx+rw:maxX;minY=cy-rh<minY?cy-rh:minY;maxY=cy+rh>maxY?cy+rh:maxY}}}}else{minX=0;maxX=0;minY=0;maxY=0}var padding=this.boundsPadding;this._localBounds.minX=minX-padding;this._localBounds.maxX=maxX+padding;this._localBounds.minY=minY-padding;this._localBounds.maxY=maxY+padding};Graphics.prototype.drawShape=function drawShape(shape){if(this.currentPath){if(this.currentPath.shape.points.length<=2){this.graphicsData.pop()}}this.currentPath=null;var data=new _GraphicsData2.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,shape,this.lineAlignment);this.graphicsData.push(data);if(data.type===_const.SHAPES.POLY){data.shape.closed=data.shape.closed||this.filling;this.currentPath=data}this.dirty++;return data};Graphics.prototype.generateCanvasTexture=function generateCanvasTexture(scaleMode){var resolution=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var bounds=this.getLocalBounds();var canvasBuffer=_RenderTexture2.default.create(bounds.width,bounds.height,scaleMode,resolution);if(!canvasRenderer){canvasRenderer=new _CanvasRenderer2.default}this.transform.updateLocalTransform();this.transform.localTransform.copy(tempMatrix);tempMatrix.invert();tempMatrix.tx-=bounds.x;tempMatrix.ty-=bounds.y;canvasRenderer.render(this,canvasBuffer,true,tempMatrix);var texture=_Texture2.default.fromCanvas(canvasBuffer.baseTexture._canvasRenderTarget.canvas,scaleMode,"graphics");texture.baseTexture.resolution=resolution;texture.baseTexture.update();return texture};Graphics.prototype.closePath=function closePath(){var currentPath=this.currentPath;if(currentPath&&currentPath.shape){currentPath.shape.close()}return this};Graphics.prototype.addHole=function addHole(){var hole=this.graphicsData.pop();this.currentPath=this.graphicsData[this.graphicsData.length-1];this.currentPath.addHole(hole.shape);this.currentPath=null;return this};Graphics.prototype.destroy=function destroy(options){_Container.prototype.destroy.call(this,options);for(var i=0;i<this.graphicsData.length;++i){this.graphicsData[i].destroy()}for(var id in this._webGL){for(var j=0;j<this._webGL[id].data.length;++j){this._webGL[id].data[j].destroy()}}if(this._spriteRect){this._spriteRect.destroy()}this.graphicsData=null;this.currentPath=null;this._webGL=null;this._localBounds=null};return Graphics}(_Container3.default);exports.default=Graphics;Graphics._SPRITE_TEXTURE=null;Graphics.CURVES={adaptive:false,maxLength:10,minSegments:8,maxSegments:2048}},{"../const":102,"../display/Bounds":103,"../display/Container":104,"../math":126,"../renderers/canvas/CanvasRenderer":133,"../sprites/Sprite":158,"../textures/RenderTexture":169,"../textures/Texture":171,"../utils":181,"./GraphicsData":110,"./utils/bezierCurveTo":112}],110:[function(require,module,exports){"use strict";exports.__esModule=true;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var GraphicsData=function(){function GraphicsData(lineWidth,lineColor,lineAlpha,fillColor,fillAlpha,fill,nativeLines,shape,lineAlignment){_classCallCheck(this,GraphicsData);this.lineWidth=lineWidth;this.lineAlignment=lineAlignment;this.nativeLines=nativeLines;this.lineColor=lineColor;this.lineAlpha=lineAlpha;this._lineTint=lineColor;this.fillColor=fillColor;this.fillAlpha=fillAlpha;this._fillTint=fillColor;this.fill=fill;this.holes=[];this.shape=shape;this.type=shape.type}GraphicsData.prototype.clone=function clone(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape)};GraphicsData.prototype.addHole=function addHole(shape){this.holes.push(shape)};GraphicsData.prototype.destroy=function destroy(){this.shape=null;this.holes=null};return GraphicsData}();exports.default=GraphicsData},{}],111:[function(require,module,exports){"use strict";exports.__esModule=true;var _CanvasRenderer=require("../../renderers/canvas/CanvasRenderer");var _CanvasRenderer2=_interopRequireDefault(_CanvasRenderer);var _const=require("../../const");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CanvasGraphicsRenderer=function(){function CanvasGraphicsRenderer(renderer){_classCallCheck(this,CanvasGraphicsRenderer);this.renderer=renderer}CanvasGraphicsRenderer.prototype.render=function render(graphics){var renderer=this.renderer;var context=renderer.context;var worldAlpha=graphics.worldAlpha;var transform=graphics.transform.worldTransform;var resolution=renderer.resolution;if(this._prevTint!==this.tint){this.dirty=true}context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution);if(graphics.dirty){this.updateGraphicsTint(graphics);graphics.dirty=false}renderer.setBlendMode(graphics.blendMode);for(var i=0;i<graphics.graphicsData.length;i++){var data=graphics.graphicsData[i];var shape=data.shape;var fillColor=data._fillTint;var lineColor=data._lineTint;context.lineWidth=data.lineWidth;if(data.type===_const.SHAPES.POLY){context.beginPath();this.renderPolygon(shape.points,shape.closed,context);for(var j=0;j<data.holes.length;j++){this.renderPolygon(data.holes[j].points,true,context)}if(data.fill){context.globalAlpha=data.fillAlpha*worldAlpha;context.fillStyle="#"+("00000"+(fillColor|0).toString(16)).substr(-6);context.fill()}if(data.lineWidth){context.globalAlpha=data.lineAlpha*worldAlpha;context.strokeStyle="#"+("00000"+(lineColor|0).toString(16)).substr(-6);context.stroke()}}else if(data.type===_const.SHAPES.RECT){if(data.fillColor||data.fillColor===0){context.globalAlpha=data.fillAlpha*worldAlpha;context.fillStyle="#"+("00000"+(fillColor|0).toString(16)).substr(-6);context.fillRect(shape.x,shape.y,shape.width,shape.height)}if(data.lineWidth){context.globalAlpha=data.lineAlpha*worldAlpha;context.strokeStyle="#"+("00000"+(lineColor|0).toString(16)).substr(-6);context.strokeRect(shape.x,shape.y,shape.width,shape.height)}}else if(data.type===_const.SHAPES.CIRC){context.beginPath();context.arc(shape.x,shape.y,shape.radius,0,2*Math.PI);context.closePath();if(data.fill){context.globalAlpha=data.fillAlpha*worldAlpha;context.fillStyle="#"+("00000"+(fillColor|0).toString(16)).substr(-6);context.fill()}if(data.lineWidth){context.globalAlpha=data.lineAlpha*worldAlpha;context.strokeStyle="#"+("00000"+(lineColor|0).toString(16)).substr(-6);context.stroke()}}else if(data.type===_const.SHAPES.ELIP){var w=shape.width*2;var h=shape.height*2;var x=shape.x-w/2;var y=shape.y-h/2;context.beginPath();var kappa=.5522848;var ox=w/2*kappa;var oy=h/2*kappa;var xe=x+w;var ye=y+h;var xm=x+w/2;var ym=y+h/2;context.moveTo(x,ym);context.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y);context.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym);context.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye);context.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym);context.closePath();if(data.fill){context.globalAlpha=data.fillAlpha*worldAlpha;context.fillStyle="#"+("00000"+(fillColor|0).toString(16)).substr(-6);context.fill()}if(data.lineWidth){context.globalAlpha=data.lineAlpha*worldAlpha;context.strokeStyle="#"+("00000"+(lineColor|0).toString(16)).substr(-6);context.stroke()}}else if(data.type===_const.SHAPES.RREC){var rx=shape.x;var ry=shape.y;var width=shape.width;var height=shape.height;var radius=shape.radius;var maxRadius=Math.min(width,height)/2|0;radius=radius>maxRadius?maxRadius:radius;context.beginPath();context.moveTo(rx,ry+radius);context.lineTo(rx,ry+height-radius);context.quadraticCurveTo(rx,ry+height,rx+radius,ry+height);context.lineTo(rx+width-radius,ry+height);context.quadraticCurveTo(rx+width,ry+height,rx+width,ry+height-radius);context.lineTo(rx+width,ry+radius);context.quadraticCurveTo(rx+width,ry,rx+width-radius,ry);context.lineTo(rx+radius,ry);context.quadraticCurveTo(rx,ry,rx,ry+radius);context.closePath();if(data.fillColor||data.fillColor===0){context.globalAlpha=data.fillAlpha*worldAlpha;context.fillStyle="#"+("00000"+(fillColor|0).toString(16)).substr(-6);context.fill()}if(data.lineWidth){context.globalAlpha=data.lineAlpha*worldAlpha;context.strokeStyle="#"+("00000"+(lineColor|0).toString(16)).substr(-6);context.stroke()}}}};CanvasGraphicsRenderer.prototype.updateGraphicsTint=function updateGraphicsTint(graphics){graphics._prevTint=graphics.tint;var tintR=(graphics.tint>>16&255)/255;var tintG=(graphics.tint>>8&255)/255;var tintB=(graphics.tint&255)/255;for(var i=0;i<graphics.graphicsData.length;++i){var data=graphics.graphicsData[i];var fillColor=data.fillColor|0;var lineColor=data.lineColor|0;data._fillTint=((fillColor>>16&255)/255*tintR*255<<16)+((fillColor>>8&255)/255*tintG*255<<8)+(fillColor&255)/255*tintB*255;data._lineTint=((lineColor>>16&255)/255*tintR*255<<16)+((lineColor>>8&255)/255*tintG*255<<8)+(lineColor&255)/255*tintB*255}};CanvasGraphicsRenderer.prototype.renderPolygon=function renderPolygon(points,close,context){context.moveTo(points[0],points[1]);for(var j=1;j<points.length/2;++j){context.lineTo(points[j*2],points[j*2+1])}if(close){context.closePath()}};CanvasGraphicsRenderer.prototype.destroy=function destroy(){this.renderer=null};return CanvasGraphicsRenderer}();exports.default=CanvasGraphicsRenderer;_CanvasRenderer2.default.registerPlugin("graphics",CanvasGraphicsRenderer)},{"../../const":102,"../../renderers/canvas/CanvasRenderer":133}],112:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=bezierCurveTo;function bezierCurveTo(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY,n){var path=arguments.length>9&&arguments[9]!==undefined?arguments[9]:[];var dt=0;var dt2=0;var dt3=0;var t2=0;var t3=0;path.push(fromX,fromY);for(var i=1,j=0;i<=n;++i){j=i/n;dt=1-j;dt2=dt*dt;dt3=dt2*dt;t2=j*j;t3=t2*j;path.push(dt3*fromX+3*dt2*j*cpX+3*dt*t2*cpX2+t3*toX,dt3*fromY+3*dt2*j*cpY+3*dt*t2*cpY2+t3*toY)}return path}},{}],113:[function(require,module,exports){"use strict";exports.__esModule=true;var _utils=require("../../utils");var _const=require("../../const");var _ObjectRenderer2=require("../../renderers/webgl/utils/ObjectRenderer");var _ObjectRenderer3=_interopRequireDefault(_ObjectRenderer2);var _WebGLRenderer=require("../../renderers/webgl/WebGLRenderer");var _WebGLRenderer2=_interopRequireDefault(_WebGLRenderer);var _WebGLGraphicsData=require("./WebGLGraphicsData");var _WebGLGraphicsData2=_interopRequireDefault(_WebGLGraphicsData);var _PrimitiveShader=require("./shaders/PrimitiveShader");var _PrimitiveShader2=_interopRequireDefault(_PrimitiveShader);var _buildPoly=require("./utils/buildPoly");var _buildPoly2=_interopRequireDefault(_buildPoly);var _buildRectangle=require("./utils/buildRectangle");var _buildRectangle2=_interopRequireDefault(_buildRectangle);var _buildRoundedRectangle=require("./utils/buildRoundedRectangle");var _buildRoundedRectangle2=_interopRequireDefault(_buildRoundedRectangle);var _buildCircle=require("./utils/buildCircle");var _buildCircle2=_interopRequireDefault(_buildCircle);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var GraphicsRenderer=function(_ObjectRenderer){_inherits(GraphicsRenderer,_ObjectRenderer);function GraphicsRenderer(renderer){_classCallCheck(this,GraphicsRenderer);var _this=_possibleConstructorReturn(this,_ObjectRenderer.call(this,renderer));_this.graphicsDataPool=[];_this.primitiveShader=null;_this.gl=renderer.gl;_this.CONTEXT_UID=0;return _this}GraphicsRenderer.prototype.onContextChange=function onContextChange(){this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID;this.primitiveShader=new _PrimitiveShader2.default(this.gl)};GraphicsRenderer.prototype.destroy=function destroy(){_ObjectRenderer3.default.prototype.destroy.call(this);for(var i=0;i<this.graphicsDataPool.length;++i){this.graphicsDataPool[i].destroy()}this.graphicsDataPool=null};GraphicsRenderer.prototype.render=function render(graphics){var renderer=this.renderer;var gl=renderer.gl;var webGLData=void 0;var webGL=graphics._webGL[this.CONTEXT_UID];if(!webGL||graphics.dirty!==webGL.dirty){this.updateGraphics(graphics);webGL=graphics._webGL[this.CONTEXT_UID]}var shader=this.primitiveShader;renderer.bindShader(shader);renderer.state.setBlendMode(graphics.blendMode);for(var i=0,n=webGL.data.length;i<n;i++){webGLData=webGL.data[i];var shaderTemp=webGLData.shader;renderer.bindShader(shaderTemp);shaderTemp.uniforms.translationMatrix=graphics.transform.worldTransform.toArray(true);shaderTemp.uniforms.tint=(0,_utils.hex2rgb)(graphics.tint);shaderTemp.uniforms.alpha=graphics.worldAlpha;renderer.bindVao(webGLData.vao);if(webGLData.nativeLines){gl.drawArrays(gl.LINES,0,webGLData.points.length/6)}else{webGLData.vao.draw(gl.TRIANGLE_STRIP,webGLData.indices.length)}}};GraphicsRenderer.prototype.updateGraphics=function updateGraphics(graphics){var gl=this.renderer.gl;var webGL=graphics._webGL[this.CONTEXT_UID];if(!webGL){webGL=graphics._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:gl,clearDirty:-1,dirty:-1}}webGL.dirty=graphics.dirty;if(graphics.clearDirty!==webGL.clearDirty){webGL.clearDirty=graphics.clearDirty;for(var i=0;i<webGL.data.length;i++){this.graphicsDataPool.push(webGL.data[i])}webGL.data.length=0;webGL.lastIndex=0}var webGLData=void 0;var webGLDataNativeLines=void 0;for(var _i=webGL.lastIndex;_i<graphics.graphicsData.length;_i++){var data=graphics.graphicsData[_i];webGLData=this.getWebGLData(webGL,0);if(data.nativeLines&&data.lineWidth){webGLDataNativeLines=this.getWebGLData(webGL,0,true);webGL.lastIndex++}if(data.type===_const.SHAPES.POLY){(0,_buildPoly2.default)(data,webGLData,webGLDataNativeLines)}if(data.type===_const.SHAPES.RECT){(0,_buildRectangle2.default)(data,webGLData,webGLDataNativeLines)}else if(data.type===_const.SHAPES.CIRC||data.type===_const.SHAPES.ELIP){(0,_buildCircle2.default)(data,webGLData,webGLDataNativeLines)}else if(data.type===_const.SHAPES.RREC){(0,_buildRoundedRectangle2.default)(data,webGLData,webGLDataNativeLines)}webGL.lastIndex++}this.renderer.bindVao(null);for(var _i2=0;_i2<webGL.data.length;_i2++){webGLData=webGL.data[_i2];if(webGLData.dirty){webGLData.upload()}}};GraphicsRenderer.prototype.getWebGLData=function getWebGLData(gl,type,nativeLines){var webGLData=gl.data[gl.data.length-1];if(!webGLData||webGLData.nativeLines!==nativeLines||webGLData.points.length>32e4){webGLData=this.graphicsDataPool.pop()||new _WebGLGraphicsData2.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState);webGLData.nativeLines=nativeLines;webGLData.reset(type);gl.data.push(webGLData)}webGLData.dirty=true;return webGLData};return GraphicsRenderer}(_ObjectRenderer3.default);exports.default=GraphicsRenderer;_WebGLRenderer2.default.registerPlugin("graphics",GraphicsRenderer)},{"../../const":102,"../../renderers/webgl/WebGLRenderer":140,"../../renderers/webgl/utils/ObjectRenderer":150,"../../utils":181,"./WebGLGraphicsData":114,"./shaders/PrimitiveShader":115,"./utils/buildCircle":116,"./utils/buildPoly":118,"./utils/buildRectangle":119,"./utils/buildRoundedRectangle":120}],114:[function(require,module,exports){"use strict";exports.__esModule=true;var _pixiGlCore=require("pixi-gl-core");var _pixiGlCore2=_interopRequireDefault(_pixiGlCore);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var WebGLGraphicsData=function(){function WebGLGraphicsData(gl,shader,attribsState){_classCallCheck(this,WebGLGraphicsData);this.gl=gl;this.color=[0,0,0];this.points=[];this.indices=[];this.buffer=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl);this.indexBuffer=_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl);this.dirty=true;this.nativeLines=false;this.glPoints=null;this.glIndices=null;this.shader=shader;this.vao=new _pixiGlCore2.default.VertexArrayObject(gl,attribsState).addIndex(this.indexBuffer).addAttribute(this.buffer,shader.attributes.aVertexPosition,gl.FLOAT,false,4*6,0).addAttribute(this.buffer,shader.attributes.aColor,gl.FLOAT,false,4*6,2*4)}WebGLGraphicsData.prototype.reset=function reset(){this.points.length=0;this.indices.length=0};WebGLGraphicsData.prototype.upload=function upload(){this.glPoints=new Float32Array(this.points);this.buffer.upload(this.glPoints);this.glIndices=new Uint16Array(this.indices);this.indexBuffer.upload(this.glIndices);this.dirty=false};WebGLGraphicsData.prototype.destroy=function destroy(){this.color=null;this.points=null;this.indices=null;this.vao.destroy();this.buffer.destroy();this.indexBuffer.destroy();this.gl=null;this.buffer=null;this.indexBuffer=null;this.glPoints=null;this.glIndices=null};return WebGLGraphicsData}();exports.default=WebGLGraphicsData},{"pixi-gl-core":85}],115:[function(require,module,exports){"use strict";exports.__esModule=true;var _Shader2=require("../../../Shader");var _Shader3=_interopRequireDefault(_Shader2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var PrimitiveShader=function(_Shader){_inherits(PrimitiveShader,_Shader);function PrimitiveShader(gl){_classCallCheck(this,PrimitiveShader);return _possibleConstructorReturn(this,_Shader.call(this,gl,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n")))}return PrimitiveShader}(_Shader3.default);exports.default=PrimitiveShader},{"../../../Shader":100}],116:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=buildCircle;var _buildLine=require("./buildLine");var _buildLine2=_interopRequireDefault(_buildLine);var _const=require("../../../const");var _utils=require("../../../utils");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function buildCircle(graphicsData,webGLData,webGLDataNativeLines){var circleData=graphicsData.shape;var x=circleData.x;var y=circleData.y;var width=void 0;var height=void 0;if(graphicsData.type===_const.SHAPES.CIRC){width=circleData.radius;height=circleData.radius}else{width=circleData.width;height=circleData.height}if(width===0||height===0){return}var totalSegs=Math.floor(30*Math.sqrt(circleData.radius))||Math.floor(15*Math.sqrt(circleData.width+circleData.height));var seg=Math.PI*2/totalSegs;if(graphicsData.fill){var color=(0,_utils.hex2rgb)(graphicsData.fillColor);var alpha=graphicsData.fillAlpha;var r=color[0]*alpha;var g=color[1]*alpha;var b=color[2]*alpha;var verts=webGLData.points;var indices=webGLData.indices;var vecPos=verts.length/6;indices.push(vecPos);for(var i=0;i<totalSegs+1;i++){verts.push(x,y,r,g,b,alpha);verts.push(x+Math.sin(seg*i)*width,y+Math.cos(seg*i)*height,r,g,b,alpha);indices.push(vecPos++,vecPos++)}indices.push(vecPos-1)}if(graphicsData.lineWidth){var tempPoints=graphicsData.points;graphicsData.points=[];for(var _i=0;_i<totalSegs+1;_i++){graphicsData.points.push(x+Math.sin(seg*-_i)*width,y+Math.cos(seg*-_i)*height)}(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines);graphicsData.points=tempPoints}}},{"../../../const":102,"../../../utils":181,"./buildLine":117}],117:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=function(graphicsData,webGLData,webGLDataNativeLines){if(graphicsData.nativeLines){buildNativeLine(graphicsData,webGLDataNativeLines)}else{buildLine(graphicsData,webGLData)}};var _math=require("../../../math");var _utils=require("../../../utils");function buildLine(graphicsData,webGLData){var points=graphicsData.points;if(points.length===0){return}var firstPoint=new _math.Point(points[0],points[1]);var lastPoint=new _math.Point(points[points.length-2],points[points.length-1]);if(firstPoint.x===lastPoint.x&&firstPoint.y===lastPoint.y){points=points.slice();points.pop();points.pop();lastPoint=new _math.Point(points[points.length-2],points[points.length-1]);var midPointX=lastPoint.x+(firstPoint.x-lastPoint.x)*.5;var midPointY=lastPoint.y+(firstPoint.y-lastPoint.y)*.5;points.unshift(midPointX,midPointY);points.push(midPointX,midPointY)}var verts=webGLData.points;var indices=webGLData.indices;var length=points.length/2;var indexCount=points.length;var indexStart=verts.length/6;var width=graphicsData.lineWidth/2;var color=(0,_utils.hex2rgb)(graphicsData.lineColor);var alpha=graphicsData.lineAlpha;var r=color[0]*alpha;var g=color[1]*alpha;var b=color[2]*alpha;var p1x=points[0];var p1y=points[1];var p2x=points[2];var p2y=points[3];var p3x=0;var p3y=0;var perpx=-(p1y-p2y);var perpy=p1x-p2x;var perp2x=0;var perp2y=0;var perp3x=0;var perp3y=0;var dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx/=dist;perpy/=dist;perpx*=width;perpy*=width;var ratio=graphicsData.lineAlignment;var r1=(1-ratio)*2;var r2=ratio*2;verts.push(p1x-perpx*r1,p1y-perpy*r1,r,g,b,alpha);verts.push(p1x+perpx*r2,p1y+perpy*r2,r,g,b,alpha);for(var i=1;i<length-1;++i){p1x=points[(i-1)*2];p1y=points[(i-1)*2+1];p2x=points[i*2];p2y=points[i*2+1];p3x=points[(i+1)*2];p3y=points[(i+1)*2+1];perpx=-(p1y-p2y);perpy=p1x-p2x;dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx/=dist;perpy/=dist;perpx*=width;perpy*=width;perp2x=-(p2y-p3y);perp2y=p2x-p3x;dist=Math.sqrt(perp2x*perp2x+perp2y*perp2y);perp2x/=dist;perp2y/=dist;perp2x*=width;perp2y*=width;var a1=-perpy+p1y-(-perpy+p2y);var b1=-perpx+p2x-(-perpx+p1x);var c1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);var a2=-perp2y+p3y-(-perp2y+p2y);var b2=-perp2x+p2x-(-perp2x+p3x);var c2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);var denom=a1*b2-a2*b1;if(Math.abs(denom)<.1){denom+=10.1;verts.push(p2x-perpx*r1,p2y-perpy*r1,r,g,b,alpha);verts.push(p2x+perpx*r2,p2y+perpy*r2,r,g,b,alpha);continue}var px=(b1*c2-b2*c1)/denom;var py=(a2*c1-a1*c2)/denom;var pdist=(px-p2x)*(px-p2x)+(py-p2y)*(py-p2y);if(pdist>196*width*width){perp3x=perpx-perp2x;perp3y=perpy-perp2y;dist=Math.sqrt(perp3x*perp3x+perp3y*perp3y);perp3x/=dist;perp3y/=dist;perp3x*=width;perp3y*=width;verts.push(p2x-perp3x*r1,p2y-perp3y*r1);verts.push(r,g,b,alpha);verts.push(p2x+perp3x*r2,p2y+perp3y*r2);verts.push(r,g,b,alpha);verts.push(p2x-perp3x*r2*r1,p2y-perp3y*r1);verts.push(r,g,b,alpha);indexCount++}else{verts.push(p2x+(px-p2x)*r1,p2y+(py-p2y)*r1);verts.push(r,g,b,alpha);verts.push(p2x-(px-p2x)*r2,p2y-(py-p2y)*r2);verts.push(r,g,b,alpha)}}p1x=points[(length-2)*2];p1y=points[(length-2)*2+1];p2x=points[(length-1)*2];p2y=points[(length-1)*2+1];perpx=-(p1y-p2y);perpy=p1x-p2x;dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx/=dist;perpy/=dist;perpx*=width;perpy*=width;verts.push(p2x-perpx*r1,p2y-perpy*r1);verts.push(r,g,b,alpha);verts.push(p2x+perpx*r2,p2y+perpy*r2);verts.push(r,g,b,alpha);indices.push(indexStart);for(var _i=0;_i<indexCount;++_i){indices.push(indexStart++)}indices.push(indexStart-1)}function buildNativeLine(graphicsData,webGLData){var i=0;var points=graphicsData.points;if(points.length===0)return;var verts=webGLData.points;var length=points.length/2;var color=(0,_utils.hex2rgb)(graphicsData.lineColor);var alpha=graphicsData.lineAlpha;var r=color[0]*alpha;var g=color[1]*alpha;var b=color[2]*alpha;for(i=1;i<length;i++){var p1x=points[(i-1)*2];var p1y=points[(i-1)*2+1];var p2x=points[i*2];var p2y=points[i*2+1];verts.push(p1x,p1y);verts.push(r,g,b,alpha);verts.push(p2x,p2y);verts.push(r,g,b,alpha)}}},{"../../../math":126,"../../../utils":181}],118:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=buildPoly;var _buildLine=require("./buildLine");var _buildLine2=_interopRequireDefault(_buildLine);var _utils=require("../../../utils");var _earcut=require("earcut");var _earcut2=_interopRequireDefault(_earcut);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function buildPoly(graphicsData,webGLData,webGLDataNativeLines){graphicsData.points=graphicsData.shape.points.slice();var points=graphicsData.points;if(graphicsData.fill&&points.length>=6){var holeArray=[];var holes=graphicsData.holes;for(var i=0;i<holes.length;i++){var hole=holes[i];holeArray.push(points.length/2);points=points.concat(hole.points)}var verts=webGLData.points;var indices=webGLData.indices;var length=points.length/2;var color=(0,_utils.hex2rgb)(graphicsData.fillColor);var alpha=graphicsData.fillAlpha;var r=color[0]*alpha;var g=color[1]*alpha;var b=color[2]*alpha;var triangles=(0,_earcut2.default)(points,holeArray,2);if(!triangles){return}var vertPos=verts.length/6;for(var _i=0;_i<triangles.length;_i+=3){indices.push(triangles[_i]+vertPos);indices.push(triangles[_i]+vertPos);indices.push(triangles[_i+1]+vertPos);indices.push(triangles[_i+2]+vertPos);indices.push(triangles[_i+2]+vertPos)}for(var _i2=0;_i2<length;_i2++){verts.push(points[_i2*2],points[_i2*2+1],r,g,b,alpha)}}if(graphicsData.lineWidth>0){(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines)}}},{"../../../utils":181,"./buildLine":117,earcut:61}],119:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=buildRectangle;var _buildLine=require("./buildLine");var _buildLine2=_interopRequireDefault(_buildLine);var _utils=require("../../../utils");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function buildRectangle(graphicsData,webGLData,webGLDataNativeLines){var rectData=graphicsData.shape;var x=rectData.x;var y=rectData.y;var width=rectData.width;var height=rectData.height;if(graphicsData.fill){var color=(0,_utils.hex2rgb)(graphicsData.fillColor);var alpha=graphicsData.fillAlpha;var r=color[0]*alpha;var g=color[1]*alpha;var b=color[2]*alpha;var verts=webGLData.points;var indices=webGLData.indices;var vertPos=verts.length/6;verts.push(x,y);verts.push(r,g,b,alpha);verts.push(x+width,y);verts.push(r,g,b,alpha);verts.push(x,y+height);verts.push(r,g,b,alpha);verts.push(x+width,y+height);verts.push(r,g,b,alpha);indices.push(vertPos,vertPos,vertPos+1,vertPos+2,vertPos+3,vertPos+3)}if(graphicsData.lineWidth){var tempPoints=graphicsData.points;graphicsData.points=[x,y,x+width,y,x+width,y+height,x,y+height,x,y];(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines);graphicsData.points=tempPoints}}},{"../../../utils":181,"./buildLine":117}],120:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=buildRoundedRectangle;var _earcut=require("earcut");var _earcut2=_interopRequireDefault(_earcut);var _buildLine=require("./buildLine");var _buildLine2=_interopRequireDefault(_buildLine);var _utils=require("../../../utils");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function buildRoundedRectangle(graphicsData,webGLData,webGLDataNativeLines){var rrectData=graphicsData.shape;var x=rrectData.x;var y=rrectData.y;var width=rrectData.width;var height=rrectData.height;var radius=rrectData.radius;var recPoints=[];recPoints.push(x,y+radius);quadraticBezierCurve(x,y+height-radius,x,y+height,x+radius,y+height,recPoints);quadraticBezierCurve(x+width-radius,y+height,x+width,y+height,x+width,y+height-radius,recPoints);quadraticBezierCurve(x+width,y+radius,x+width,y,x+width-radius,y,recPoints);quadraticBezierCurve(x+radius,y,x,y,x,y+radius+1e-10,recPoints);if(graphicsData.fill){var color=(0,_utils.hex2rgb)(graphicsData.fillColor);var alpha=graphicsData.fillAlpha;var r=color[0]*alpha;var g=color[1]*alpha;var b=color[2]*alpha;var verts=webGLData.points;var indices=webGLData.indices;var vecPos=verts.length/6;var triangles=(0,_earcut2.default)(recPoints,null,2);for(var i=0,j=triangles.length;i<j;i+=3){indices.push(triangles[i]+vecPos);indices.push(triangles[i]+vecPos);indices.push(triangles[i+1]+vecPos);indices.push(triangles[i+2]+vecPos);indices.push(triangles[i+2]+vecPos)}for(var _i=0,_j=recPoints.length;_i<_j;_i++){verts.push(recPoints[_i],recPoints[++_i],r,g,b,alpha)}}if(graphicsData.lineWidth){var tempPoints=graphicsData.points;graphicsData.points=recPoints;(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines);graphicsData.points=tempPoints}}function getPt(n1,n2,perc){var diff=n2-n1;return n1+diff*perc}function quadraticBezierCurve(fromX,fromY,cpX,cpY,toX,toY){var out=arguments.length>6&&arguments[6]!==undefined?arguments[6]:[];var n=20;var points=out;var xa=0;var ya=0;var xb=0;var yb=0;var x=0;var y=0;for(var i=0,j=0;i<=n;++i){j=i/n;xa=getPt(fromX,cpX,j);ya=getPt(fromY,cpY,j);xb=getPt(cpX,toX,j);yb=getPt(cpY,toY,j);x=getPt(xa,xb,j);y=getPt(ya,yb,j);points.push(x,y)}return points}},{"../../../utils":181,"./buildLine":117,earcut:61}],121:[function(require,module,exports){"use strict";exports.__esModule=true;exports.autoDetectRenderer=exports.Application=exports.Filter=exports.SpriteMaskFilter=exports.Quad=exports.RenderTarget=exports.ObjectRenderer=exports.WebGLManager=exports.Shader=exports.CanvasRenderTarget=exports.TextureUvs=exports.VideoBaseTexture=exports.BaseRenderTexture=exports.RenderTexture=exports.BaseTexture=exports.TextureMatrix=exports.Texture=exports.Spritesheet=exports.CanvasGraphicsRenderer=exports.GraphicsRenderer=exports.GraphicsData=exports.Graphics=exports.TextMetrics=exports.TextStyle=exports.Text=exports.SpriteRenderer=exports.CanvasTinter=exports.CanvasSpriteRenderer=exports.Sprite=exports.TransformBase=exports.TransformStatic=exports.Transform=exports.Container=exports.DisplayObject=exports.Bounds=exports.glCore=exports.WebGLRenderer=exports.CanvasRenderer=exports.ticker=exports.utils=exports.settings=undefined;var _const=require("./const");Object.keys(_const).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _const[key]}})});var _math=require("./math");Object.keys(_math).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _math[key]}})});var _pixiGlCore=require("pixi-gl-core");Object.defineProperty(exports,"glCore",{enumerable:true,get:function get(){return _interopRequireDefault(_pixiGlCore).default}});var _Bounds=require("./display/Bounds");Object.defineProperty(exports,"Bounds",{enumerable:true,get:function get(){return _interopRequireDefault(_Bounds).default}});var _DisplayObject=require("./display/DisplayObject");Object.defineProperty(exports,"DisplayObject",{enumerable:true,get:function get(){return _interopRequireDefault(_DisplayObject).default}});var _Container=require("./display/Container");Object.defineProperty(exports,"Container",{enumerable:true,get:function get(){return _interopRequireDefault(_Container).default}});var _Transform=require("./display/Transform");Object.defineProperty(exports,"Transform",{enumerable:true,get:function get(){return _interopRequireDefault(_Transform).default}});var _TransformStatic=require("./display/TransformStatic");Object.defineProperty(exports,"TransformStatic",{enumerable:true,get:function get(){return _interopRequireDefault(_TransformStatic).default}});var _TransformBase=require("./display/TransformBase");Object.defineProperty(exports,"TransformBase",{enumerable:true,get:function get(){return _interopRequireDefault(_TransformBase).default}});var _Sprite=require("./sprites/Sprite");Object.defineProperty(exports,"Sprite",{enumerable:true,get:function get(){return _interopRequireDefault(_Sprite).default}});var _CanvasSpriteRenderer=require("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(exports,"CanvasSpriteRenderer",{enumerable:true,get:function get(){return _interopRequireDefault(_CanvasSpriteRenderer).default}});var _CanvasTinter=require("./sprites/canvas/CanvasTinter");Object.defineProperty(exports,"CanvasTinter",{enumerable:true,get:function get(){return _interopRequireDefault(_CanvasTinter).default}});var _SpriteRenderer=require("./sprites/webgl/SpriteRenderer");Object.defineProperty(exports,"SpriteRenderer",{enumerable:true,get:function get(){return _interopRequireDefault(_SpriteRenderer).default}});var _Text=require("./text/Text");Object.defineProperty(exports,"Text",{enumerable:true,get:function get(){return _interopRequireDefault(_Text).default}});var _TextStyle=require("./text/TextStyle");Object.defineProperty(exports,"TextStyle",{enumerable:true,get:function get(){return _interopRequireDefault(_TextStyle).default}});var _TextMetrics=require("./text/TextMetrics");Object.defineProperty(exports,"TextMetrics",{enumerable:true,get:function get(){return _interopRequireDefault(_TextMetrics).default}});var _Graphics=require("./graphics/Graphics");Object.defineProperty(exports,"Graphics",{enumerable:true,get:function get(){return _interopRequireDefault(_Graphics).default}});var _GraphicsData=require("./graphics/GraphicsData");Object.defineProperty(exports,"GraphicsData",{enumerable:true,get:function get(){return _interopRequireDefault(_GraphicsData).default}});var _GraphicsRenderer=require("./graphics/webgl/GraphicsRenderer");Object.defineProperty(exports,"GraphicsRenderer",{enumerable:true,get:function get(){return _interopRequireDefault(_GraphicsRenderer).default}});var _CanvasGraphicsRenderer=require("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(exports,"CanvasGraphicsRenderer",{enumerable:true,get:function get(){return _interopRequireDefault(_CanvasGraphicsRenderer).default}});var _Spritesheet=require("./textures/Spritesheet");Object.defineProperty(exports,"Spritesheet",{enumerable:true,get:function get(){return _interopRequireDefault(_Spritesheet).default}});var _Texture=require("./textures/Texture");Object.defineProperty(exports,"Texture",{enumerable:true,get:function get(){return _interopRequireDefault(_Texture).default}});var _TextureMatrix=require("./textures/TextureMatrix");Object.defineProperty(exports,"TextureMatrix",{enumerable:true,get:function get(){return _interopRequireDefault(_TextureMatrix).default}});var _BaseTexture=require("./textures/BaseTexture");Object.defineProperty(exports,"BaseTexture",{enumerable:true,get:function get(){return _interopRequireDefault(_BaseTexture).default}});var _RenderTexture=require("./textures/RenderTexture");Object.defineProperty(exports,"RenderTexture",{enumerable:true,get:function get(){return _interopRequireDefault(_RenderTexture).default}});var _BaseRenderTexture=require("./textures/BaseRenderTexture");Object.defineProperty(exports,"BaseRenderTexture",{enumerable:true,get:function get(){return _interopRequireDefault(_BaseRenderTexture).default}});var _VideoBaseTexture=require("./textures/VideoBaseTexture");Object.defineProperty(exports,"VideoBaseTexture",{enumerable:true,get:function get(){return _interopRequireDefault(_VideoBaseTexture).default}});var _TextureUvs=require("./textures/TextureUvs");Object.defineProperty(exports,"TextureUvs",{enumerable:true,get:function get(){return _interopRequireDefault(_TextureUvs).default}});var _CanvasRenderTarget=require("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(exports,"CanvasRenderTarget",{enumerable:true,get:function get(){return _interopRequireDefault(_CanvasRenderTarget).default}});var _Shader=require("./Shader");Object.defineProperty(exports,"Shader",{enumerable:true,get:function get(){return _interopRequireDefault(_Shader).default}});var _WebGLManager=require("./renderers/webgl/managers/WebGLManager");Object.defineProperty(exports,"WebGLManager",{enumerable:true,get:function get(){return _interopRequireDefault(_WebGLManager).default}});var _ObjectRenderer=require("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(exports,"ObjectRenderer",{enumerable:true,get:function get(){return _interopRequireDefault(_ObjectRenderer).default}});var _RenderTarget=require("./renderers/webgl/utils/RenderTarget");Object.defineProperty(exports,"RenderTarget",{enumerable:true,get:function get(){return _interopRequireDefault(_RenderTarget).default}});var _Quad=require("./renderers/webgl/utils/Quad");Object.defineProperty(exports,"Quad",{enumerable:true,get:function get(){return _interopRequireDefault(_Quad).default}});var _SpriteMaskFilter=require("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(exports,"SpriteMaskFilter",{enumerable:true,get:function get(){return _interopRequireDefault(_SpriteMaskFilter).default}});var _Filter=require("./renderers/webgl/filters/Filter");Object.defineProperty(exports,"Filter",{enumerable:true,get:function get(){return _interopRequireDefault(_Filter).default}});var _Application=require("./Application");Object.defineProperty(exports,"Application",{enumerable:true,get:function get(){return _interopRequireDefault(_Application).default}});var _autoDetectRenderer=require("./autoDetectRenderer");Object.defineProperty(exports,"autoDetectRenderer",{enumerable:true,get:function get(){return _autoDetectRenderer.autoDetectRenderer}});var _utils=require("./utils");var utils=_interopRequireWildcard(_utils);var _ticker=require("./ticker");var ticker=_interopRequireWildcard(_ticker);var _settings=require("./settings");var _settings2=_interopRequireDefault(_settings);var _CanvasRenderer=require("./renderers/canvas/CanvasRenderer");var _CanvasRenderer2=_interopRequireDefault(_CanvasRenderer);var _WebGLRenderer=require("./renderers/webgl/WebGLRenderer");var _WebGLRenderer2=_interopRequireDefault(_WebGLRenderer);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.settings=_settings2.default;exports.utils=utils;exports.ticker=ticker;exports.CanvasRenderer=_CanvasRenderer2.default;exports.WebGLRenderer=_WebGLRenderer2.default},{"./Application":99,"./Shader":100,"./autoDetectRenderer":101,"./const":102,"./display/Bounds":103,"./display/Container":104,"./display/DisplayObject":105,"./display/Transform":106,"./display/TransformBase":107,"./display/TransformStatic":108,"./graphics/Graphics":109,"./graphics/GraphicsData":110,"./graphics/canvas/CanvasGraphicsRenderer":111,"./graphics/webgl/GraphicsRenderer":113,"./math":126,"./renderers/canvas/CanvasRenderer":133,"./renderers/canvas/utils/CanvasRenderTarget":135,"./renderers/webgl/WebGLRenderer":140,"./renderers/webgl/filters/Filter":142,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":145,"./renderers/webgl/managers/WebGLManager":149,"./renderers/webgl/utils/ObjectRenderer":150,"./renderers/webgl/utils/Quad":151,"./renderers/webgl/utils/RenderTarget":152,"./settings":157,"./sprites/Sprite":158,"./sprites/canvas/CanvasSpriteRenderer":159,"./sprites/canvas/CanvasTinter":160,"./sprites/webgl/SpriteRenderer":162,"./text/Text":164,"./text/TextMetrics":165,"./text/TextStyle":166,"./textures/BaseRenderTexture":167,"./textures/BaseTexture":168,"./textures/RenderTexture":169,"./textures/Spritesheet":170,"./textures/Texture":171,"./textures/TextureMatrix":172,"./textures/TextureUvs":173,"./textures/VideoBaseTexture":174,"./ticker":177,"./utils":181,"pixi-gl-core":85}],122:[function(require,module,exports){"use strict";exports.__esModule=true;var _Matrix=require("./Matrix");var _Matrix2=_interopRequireDefault(_Matrix);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1];var uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1];var vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1];var vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1];var tempMatrices=[];var mul=[];function signum(x){if(x<0){return-1}if(x>0){return 1}return 0}function init(){for(var i=0;i<16;i++){var row=[];mul.push(row);for(var j=0;j<16;j++){var _ux=signum(ux[i]*ux[j]+vx[i]*uy[j]);var _uy=signum(uy[i]*ux[j]+vy[i]*uy[j]);var _vx=signum(ux[i]*vx[j]+vx[i]*vy[j]);var _vy=signum(uy[i]*vx[j]+vy[i]*vy[j]);for(var k=0;k<16;k++){if(ux[k]===_ux&&uy[k]===_uy&&vx[k]===_vx&&vy[k]===_vy){row.push(k);break}}}}for(var _i=0;_i<16;_i++){var mat=new _Matrix2.default;mat.set(ux[_i],uy[_i],vx[_i],vy[_i],0,0);tempMatrices.push(mat)}}init();var GroupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function uX(ind){return ux[ind]},uY:function uY(ind){return uy[ind]},vX:function vX(ind){return vx[ind]},vY:function vY(ind){return vy[ind]},inv:function inv(rotation){if(rotation&8){return rotation&15}return-rotation&7},add:function add(rotationSecond,rotationFirst){return mul[rotationSecond][rotationFirst]},sub:function sub(rotationSecond,rotationFirst){return mul[rotationSecond][GroupD8.inv(rotationFirst)]},rotate180:function rotate180(rotation){return rotation^4},isVertical:function isVertical(rotation){return(rotation&3)===2},byDirection:function byDirection(dx,dy){if(Math.abs(dx)*2<=Math.abs(dy)){if(dy>=0){return GroupD8.S}return GroupD8.N}else if(Math.abs(dy)*2<=Math.abs(dx)){if(dx>0){return GroupD8.E}return GroupD8.W}else if(dy>0){if(dx>0){return GroupD8.SE}return GroupD8.SW}else if(dx>0){return GroupD8.NE}return GroupD8.NW},matrixAppendRotationInv:function matrixAppendRotationInv(matrix,rotation){var tx=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var ty=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var mat=tempMatrices[GroupD8.inv(rotation)];mat.tx=tx;mat.ty=ty;matrix.append(mat)}};exports.default=GroupD8},{"./Matrix":123}],123:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _Point=require("./Point");var _Point2=_interopRequireDefault(_Point);var _const=require("../const");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Matrix=function(){function Matrix(){var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var b=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var c=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var d=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;var tx=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var ty=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;_classCallCheck(this,Matrix);this.a=a;this.b=b;this.c=c;this.d=d;this.tx=tx;this.ty=ty;this.array=null}Matrix.prototype.fromArray=function fromArray(array){this.a=array[0];this.b=array[1];this.c=array[3];this.d=array[4];this.tx=array[2];this.ty=array[5]};Matrix.prototype.set=function set(a,b,c,d,tx,ty){this.a=a;this.b=b;this.c=c;this.d=d;this.tx=tx;this.ty=ty;return this};Matrix.prototype.toArray=function toArray(transpose,out){if(!this.array){this.array=new Float32Array(9)}var array=out||this.array;if(transpose){array[0]=this.a;array[1]=this.b;array[2]=0;array[3]=this.c;array[4]=this.d;array[5]=0;array[6]=this.tx;array[7]=this.ty;array[8]=1}else{array[0]=this.a;array[1]=this.c;array[2]=this.tx;array[3]=this.b;array[4]=this.d;array[5]=this.ty;array[6]=0;array[7]=0;array[8]=1}return array};Matrix.prototype.apply=function apply(pos,newPos){newPos=newPos||new _Point2.default;var x=pos.x;var y=pos.y;newPos.x=this.a*x+this.c*y+this.tx;newPos.y=this.b*x+this.d*y+this.ty;return newPos};Matrix.prototype.applyInverse=function applyInverse(pos,newPos){newPos=newPos||new _Point2.default;var id=1/(this.a*this.d+this.c*-this.b);var x=pos.x;var y=pos.y;newPos.x=this.d*id*x+-this.c*id*y+(this.ty*this.c-this.tx*this.d)*id;newPos.y=this.a*id*y+-this.b*id*x+(-this.ty*this.a+this.tx*this.b)*id;return newPos};Matrix.prototype.translate=function translate(x,y){this.tx+=x;this.ty+=y;return this};Matrix.prototype.scale=function scale(x,y){this.a*=x;this.d*=y;this.c*=x;this.b*=y;this.tx*=x;this.ty*=y;return this};Matrix.prototype.rotate=function rotate(angle){var cos=Math.cos(angle);var sin=Math.sin(angle);var a1=this.a;var c1=this.c;var tx1=this.tx;this.a=a1*cos-this.b*sin;this.b=a1*sin+this.b*cos;this.c=c1*cos-this.d*sin;this.d=c1*sin+this.d*cos;this.tx=tx1*cos-this.ty*sin;this.ty=tx1*sin+this.ty*cos;return this};Matrix.prototype.append=function append(matrix){var a1=this.a;var b1=this.b;var c1=this.c;var d1=this.d;this.a=matrix.a*a1+matrix.b*c1;this.b=matrix.a*b1+matrix.b*d1;this.c=matrix.c*a1+matrix.d*c1;this.d=matrix.c*b1+matrix.d*d1;this.tx=matrix.tx*a1+matrix.ty*c1+this.tx;this.ty=matrix.tx*b1+matrix.ty*d1+this.ty;return this};Matrix.prototype.setTransform=function setTransform(x,y,pivotX,pivotY,scaleX,scaleY,rotation,skewX,skewY){this.a=Math.cos(rotation+skewY)*scaleX;this.b=Math.sin(rotation+skewY)*scaleX;this.c=-Math.sin(rotation-skewX)*scaleY;this.d=Math.cos(rotation-skewX)*scaleY;this.tx=x-(pivotX*this.a+pivotY*this.c);this.ty=y-(pivotX*this.b+pivotY*this.d);return this};Matrix.prototype.prepend=function prepend(matrix){var tx1=this.tx;if(matrix.a!==1||matrix.b!==0||matrix.c!==0||matrix.d!==1){var a1=this.a;var c1=this.c;this.a=a1*matrix.a+this.b*matrix.c;this.b=a1*matrix.b+this.b*matrix.d;this.c=c1*matrix.a+this.d*matrix.c;this.d=c1*matrix.b+this.d*matrix.d}this.tx=tx1*matrix.a+this.ty*matrix.c+matrix.tx;this.ty=tx1*matrix.b+this.ty*matrix.d+matrix.ty;return this};Matrix.prototype.decompose=function decompose(transform){var a=this.a;var b=this.b;var c=this.c;var d=this.d;var skewX=-Math.atan2(-c,d);var skewY=Math.atan2(b,a);var delta=Math.abs(skewX+skewY);if(delta<1e-5||Math.abs(_const.PI_2-delta)<1e-5){transform.rotation=skewY;if(a<0&&d>=0){transform.rotation+=transform.rotation<=0?Math.PI:-Math.PI}transform.skew.x=transform.skew.y=0}else{transform.rotation=0;transform.skew.x=skewX;transform.skew.y=skewY}transform.scale.x=Math.sqrt(a*a+b*b);transform.scale.y=Math.sqrt(c*c+d*d);transform.position.x=this.tx;transform.position.y=this.ty;return transform};Matrix.prototype.invert=function invert(){var a1=this.a;var b1=this.b;var c1=this.c;var d1=this.d;var tx1=this.tx;var n=a1*d1-b1*c1;this.a=d1/n;this.b=-b1/n;this.c=-c1/n;this.d=a1/n;this.tx=(c1*this.ty-d1*tx1)/n;this.ty=-(a1*this.ty-b1*tx1)/n;return this};Matrix.prototype.identity=function identity(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0;return this};Matrix.prototype.clone=function clone(){var matrix=new Matrix;matrix.a=this.a;matrix.b=this.b;matrix.c=this.c;matrix.d=this.d;matrix.tx=this.tx;matrix.ty=this.ty;return matrix};Matrix.prototype.copy=function copy(matrix){matrix.a=this.a;matrix.b=this.b;matrix.c=this.c;matrix.d=this.d;matrix.tx=this.tx;matrix.ty=this.ty;return matrix};_createClass(Matrix,null,[{key:"IDENTITY",get:function get(){return new Matrix}},{key:"TEMP_MATRIX",get:function get(){return new Matrix}}]);return Matrix}();exports.default=Matrix},{"../const":102,"./Point":125}],124:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ObservablePoint=function(){function ObservablePoint(cb,scope){var x=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var y=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;_classCallCheck(this,ObservablePoint);this._x=x;this._y=y;this.cb=cb;this.scope=scope}ObservablePoint.prototype.set=function set(x,y){var _x=x||0;var _y=y||(y!==0?_x:0);if(this._x!==_x||this._y!==_y){this._x=_x;this._y=_y;this.cb.call(this.scope)}};ObservablePoint.prototype.copy=function copy(point){if(this._x!==point.x||this._y!==point.y){this._x=point.x;this._y=point.y;this.cb.call(this.scope)}};_createClass(ObservablePoint,[{key:"x",get:function get(){return this._x},set:function set(value){if(this._x!==value){this._x=value;this.cb.call(this.scope)}}},{key:"y",get:function get(){return this._y},set:function set(value){if(this._y!==value){this._y=value;this.cb.call(this.scope)}}}]);return ObservablePoint}();exports.default=ObservablePoint},{}],125:[function(require,module,exports){"use strict";exports.__esModule=true;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Point=function(){function Point(){var x=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;_classCallCheck(this,Point);this.x=x;this.y=y}Point.prototype.clone=function clone(){return new Point(this.x,this.y)};Point.prototype.copy=function copy(p){this.set(p.x,p.y)};Point.prototype.equals=function equals(p){return p.x===this.x&&p.y===this.y};Point.prototype.set=function set(x,y){this.x=x||0;this.y=y||(y!==0?this.x:0)};return Point}();exports.default=Point},{}],126:[function(require,module,exports){"use strict";exports.__esModule=true;var _Point=require("./Point");Object.defineProperty(exports,"Point",{enumerable:true,get:function get(){return _interopRequireDefault(_Point).default}});var _ObservablePoint=require("./ObservablePoint");Object.defineProperty(exports,"ObservablePoint",{enumerable:true,get:function get(){return _interopRequireDefault(_ObservablePoint).default}});var _Matrix=require("./Matrix");Object.defineProperty(exports,"Matrix",{enumerable:true,get:function get(){return _interopRequireDefault(_Matrix).default}});var _GroupD=require("./GroupD8");Object.defineProperty(exports,"GroupD8",{enumerable:true,get:function get(){return _interopRequireDefault(_GroupD).default}});var _Circle=require("./shapes/Circle");Object.defineProperty(exports,"Circle",{enumerable:true,get:function get(){return _interopRequireDefault(_Circle).default}});var _Ellipse=require("./shapes/Ellipse");Object.defineProperty(exports,"Ellipse",{enumerable:true,get:function get(){return _interopRequireDefault(_Ellipse).default}});var _Polygon=require("./shapes/Polygon");Object.defineProperty(exports,"Polygon",{enumerable:true,get:function get(){return _interopRequireDefault(_Polygon).default}});var _Rectangle=require("./shapes/Rectangle");Object.defineProperty(exports,"Rectangle",{enumerable:true,get:function get(){return _interopRequireDefault(_Rectangle).default}});var _RoundedRectangle=require("./shapes/RoundedRectangle");Object.defineProperty(exports,"RoundedRectangle",{enumerable:true,get:function get(){return _interopRequireDefault(_RoundedRectangle).default}});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./GroupD8":122,"./Matrix":123,"./ObservablePoint":124,"./Point":125,"./shapes/Circle":127,"./shapes/Ellipse":128,"./shapes/Polygon":129,"./shapes/Rectangle":130,"./shapes/RoundedRectangle":131}],127:[function(require,module,exports){"use strict";exports.__esModule=true;var _Rectangle=require("./Rectangle");var _Rectangle2=_interopRequireDefault(_Rectangle);var _const=require("../../const");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Circle=function(){function Circle(){var x=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var radius=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;_classCallCheck(this,Circle);this.x=x;this.y=y;this.radius=radius;this.type=_const.SHAPES.CIRC}Circle.prototype.clone=function clone(){return new Circle(this.x,this.y,this.radius)};Circle.prototype.contains=function contains(x,y){if(this.radius<=0){return false}var r2=this.radius*this.radius;var dx=this.x-x;var dy=this.y-y;dx*=dx;dy*=dy;return dx+dy<=r2};Circle.prototype.getBounds=function getBounds(){return new _Rectangle2.default(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)};return Circle}();exports.default=Circle},{"../../const":102,"./Rectangle":130}],128:[function(require,module,exports){"use strict";exports.__esModule=true;var _Rectangle=require("./Rectangle");var _Rectangle2=_interopRequireDefault(_Rectangle);var _const=require("../../const");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Ellipse=function(){function Ellipse(){var x=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var width=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var height=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;_classCallCheck(this,Ellipse);this.x=x;this.y=y;this.width=width;this.height=height;this.type=_const.SHAPES.ELIP}Ellipse.prototype.clone=function clone(){return new Ellipse(this.x,this.y,this.width,this.height)};Ellipse.prototype.contains=function contains(x,y){if(this.width<=0||this.height<=0){return false}var normx=(x-this.x)/this.width;var normy=(y-this.y)/this.height;normx*=normx;normy*=normy;return normx+normy<=1};Ellipse.prototype.getBounds=function getBounds(){return new _Rectangle2.default(this.x-this.width,this.y-this.height,this.width,this.height)};return Ellipse}();exports.default=Ellipse},{"../../const":102,"./Rectangle":130}],129:[function(require,module,exports){"use strict";exports.__esModule=true;var _Point=require("../Point");var _Point2=_interopRequireDefault(_Point);var _const=require("../../const");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Polygon=function(){function Polygon(){for(var _len=arguments.length,points=Array(_len),_key=0;_key<_len;_key++){points[_key]=arguments[_key]}_classCallCheck(this,Polygon);if(Array.isArray(points[0])){points=points[0]}if(points[0]instanceof _Point2.default){var p=[];for(var i=0,il=points.length;i<il;i++){p.push(points[i].x,points[i].y)}points=p}this.closed=true;this.points=points;this.type=_const.SHAPES.POLY}Polygon.prototype.clone=function clone(){return new Polygon(this.points.slice())};Polygon.prototype.close=function close(){var points=this.points;if(points[0]!==points[points.length-2]||points[1]!==points[points.length-1]){points.push(points[0],points[1])}};Polygon.prototype.contains=function contains(x,y){var inside=false;var length=this.points.length/2;for(var i=0,j=length-1;i<length;j=i++){var xi=this.points[i*2];var yi=this.points[i*2+1];var xj=this.points[j*2];var yj=this.points[j*2+1];var intersect=yi>y!==yj>y&&x<(xj-xi)*((y-yi)/(yj-yi))+xi;if(intersect){inside=!inside}}return inside};return Polygon}();exports.default=Polygon},{"../../const":102,"../Point":125}],130:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _const=require("../../const");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Rectangle=function(){function Rectangle(){var x=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var width=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var height=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;_classCallCheck(this,Rectangle);this.x=Number(x);this.y=Number(y);this.width=Number(width);this.height=Number(height);this.type=_const.SHAPES.RECT}Rectangle.prototype.clone=function clone(){return new Rectangle(this.x,this.y,this.width,this.height)};Rectangle.prototype.copy=function copy(rectangle){this.x=rectangle.x;this.y=rectangle.y;this.width=rectangle.width;this.height=rectangle.height;return this};Rectangle.prototype.contains=function contains(x,y){if(this.width<=0||this.height<=0){return false}if(x>=this.x&&x<this.x+this.width){if(y>=this.y&&y<this.y+this.height){return true}}return false};Rectangle.prototype.pad=function pad(paddingX,paddingY){paddingX=paddingX||0;paddingY=paddingY||(paddingY!==0?paddingX:0);this.x-=paddingX;this.y-=paddingY;this.width+=paddingX*2;this.height+=paddingY*2};Rectangle.prototype.fit=function fit(rectangle){if(this.x<rectangle.x){this.width+=this.x;if(this.width<0){this.width=0}this.x=rectangle.x}if(this.y<rectangle.y){this.height+=this.y;if(this.height<0){this.height=0}this.y=rectangle.y}if(this.x+this.width>rectangle.x+rectangle.width){this.width=rectangle.width-this.x;if(this.width<0){this.width=0}}if(this.y+this.height>rectangle.y+rectangle.height){this.height=rectangle.height-this.y;if(this.height<0){this.height=0}}};Rectangle.prototype.enlarge=function enlarge(rectangle){var x1=Math.min(this.x,rectangle.x);var x2=Math.max(this.x+this.width,rectangle.x+rectangle.width);var y1=Math.min(this.y,rectangle.y);var y2=Math.max(this.y+this.height,rectangle.y+rectangle.height);this.x=x1;this.width=x2-x1;this.y=y1;this.height=y2-y1};_createClass(Rectangle,[{key:"left",get:function get(){return this.x}},{key:"right",get:function get(){return this.x+this.width}},{key:"top",get:function get(){return this.y}},{key:"bottom",get:function get(){return this.y+this.height}}],[{key:"EMPTY",get:function get(){return new Rectangle(0,0,0,0)}}]);return Rectangle}();exports.default=Rectangle},{"../../const":102}],131:[function(require,module,exports){"use strict";exports.__esModule=true;var _const=require("../../const");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RoundedRectangle=function(){function RoundedRectangle(){var x=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var width=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var height=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var radius=arguments.length>4&&arguments[4]!==undefined?arguments[4]:20;_classCallCheck(this,RoundedRectangle);this.x=x;this.y=y;this.width=width;this.height=height;this.radius=radius;this.type=_const.SHAPES.RREC}RoundedRectangle.prototype.clone=function clone(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)};RoundedRectangle.prototype.contains=function contains(x,y){if(this.width<=0||this.height<=0){return false}if(x>=this.x&&x<=this.x+this.width){if(y>=this.y&&y<=this.y+this.height){if(y>=this.y+this.radius&&y<=this.y+this.height-this.radius||x>=this.x+this.radius&&x<=this.x+this.width-this.radius){return true}var dx=x-(this.x+this.radius);var dy=y-(this.y+this.radius);var radius2=this.radius*this.radius;if(dx*dx+dy*dy<=radius2){return true}dx=x-(this.x+this.width-this.radius);if(dx*dx+dy*dy<=radius2){return true}dy=y-(this.y+this.height-this.radius);if(dx*dx+dy*dy<=radius2){return true}dx=x-(this.x+this.radius);if(dx*dx+dy*dy<=radius2){return true}}}return false};return RoundedRectangle}();exports.default=RoundedRectangle},{"../../const":102}],132:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _utils=require("../utils");var _math=require("../math");var _const=require("../const");var _settings=require("../settings");var _settings2=_interopRequireDefault(_settings);var _Container=require("../display/Container");var _Container2=_interopRequireDefault(_Container);var _RenderTexture=require("../textures/RenderTexture");var _RenderTexture2=_interopRequireDefault(_RenderTexture);var _eventemitter=require("eventemitter3");var _eventemitter2=_interopRequireDefault(_eventemitter);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var tempMatrix=new _math.Matrix;var SystemRenderer=function(_EventEmitter){_inherits(SystemRenderer,_EventEmitter);function SystemRenderer(system,options,arg2,arg3){_classCallCheck(this,SystemRenderer);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));(0,_utils.sayHello)(system);if(typeof options==="number"){options=Object.assign({width:options,height:arg2||_settings2.default.RENDER_OPTIONS.height},arg3)}options=Object.assign({},_settings2.default.RENDER_OPTIONS,options);_this.options=options;_this.type=_const.RENDERER_TYPE.UNKNOWN;_this.screen=new _math.Rectangle(0,0,options.width,options.height);_this.view=options.view||document.createElement("canvas");_this.resolution=options.resolution||_settings2.default.RESOLUTION;_this.transparent=options.transparent;_this.autoResize=options.autoResize||false;_this.blendModes=null;_this.preserveDrawingBuffer=options.preserveDrawingBuffer;_this.clearBeforeRender=options.clearBeforeRender;_this.roundPixels=options.roundPixels;_this._backgroundColor=0;_this._backgroundColorRgba=[0,0,0,0];_this._backgroundColorString="#000000";_this.backgroundColor=options.backgroundColor||_this._backgroundColor;_this._tempDisplayObjectParent=new _Container2.default;_this._lastObjectRendered=_this._tempDisplayObjectParent;return _this}SystemRenderer.prototype.resize=function resize(screenWidth,screenHeight){this.screen.width=screenWidth;this.screen.height=screenHeight;this.view.width=screenWidth*this.resolution;this.view.height=screenHeight*this.resolution;if(this.autoResize){this.view.style.width=screenWidth+"px";this.view.style.height=screenHeight+"px"}};SystemRenderer.prototype.generateTexture=function generateTexture(displayObject,scaleMode,resolution,region){region=region||displayObject.getLocalBounds();var renderTexture=_RenderTexture2.default.create(region.width|0,region.height|0,scaleMode,resolution);tempMatrix.tx=-region.x;tempMatrix.ty=-region.y;this.render(displayObject,renderTexture,false,tempMatrix,true);return renderTexture};SystemRenderer.prototype.destroy=function destroy(removeView){if(removeView&&this.view.parentNode){this.view.parentNode.removeChild(this.view)}this.type=_const.RENDERER_TYPE.UNKNOWN;this.view=null;this.screen=null;this.resolution=0;this.transparent=false;this.autoResize=false;this.blendModes=null;this.options=null;this.preserveDrawingBuffer=false;this.clearBeforeRender=false;this.roundPixels=false;this._backgroundColor=0;this._backgroundColorRgba=null;this._backgroundColorString=null;this._tempDisplayObjectParent=null;this._lastObjectRendered=null};_createClass(SystemRenderer,[{key:"width",get:function get(){return this.view.width}},{key:"height",get:function get(){return this.view.height}},{key:"backgroundColor",get:function get(){return this._backgroundColor},set:function set(value){this._backgroundColor=value;this._backgroundColorString=(0,_utils.hex2string)(value);(0,_utils.hex2rgb)(value,this._backgroundColorRgba)}}]);return SystemRenderer}(_eventemitter2.default);exports.default=SystemRenderer},{"../const":102,"../display/Container":104,"../math":126,"../settings":157,"../textures/RenderTexture":169,"../utils":181,eventemitter3:62}],133:[function(require,module,exports){"use strict";exports.__esModule=true;var _SystemRenderer2=require("../SystemRenderer");var _SystemRenderer3=_interopRequireDefault(_SystemRenderer2);var _CanvasMaskManager=require("./utils/CanvasMaskManager");var _CanvasMaskManager2=_interopRequireDefault(_CanvasMaskManager);var _CanvasRenderTarget=require("./utils/CanvasRenderTarget");var _CanvasRenderTarget2=_interopRequireDefault(_CanvasRenderTarget);var _mapCanvasBlendModesToPixi=require("./utils/mapCanvasBlendModesToPixi");var _mapCanvasBlendModesToPixi2=_interopRequireDefault(_mapCanvasBlendModesToPixi);var _utils=require("../../utils");var _const=require("../../const");var _settings=require("../../settings");var _settings2=_interopRequireDefault(_settings);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var CanvasRenderer=function(_SystemRenderer){_inherits(CanvasRenderer,_SystemRenderer);function CanvasRenderer(options,arg2,arg3){_classCallCheck(this,CanvasRenderer);var _this=_possibleConstructorReturn(this,_SystemRenderer.call(this,"Canvas",options,arg2,arg3));_this.type=_const.RENDERER_TYPE.CANVAS;_this.rootContext=_this.view.getContext("2d",{alpha:_this.transparent});_this.context=_this.rootContext;_this.refresh=true;_this.maskManager=new _CanvasMaskManager2.default(_this);_this.smoothProperty="imageSmoothingEnabled";if(!_this.rootContext.imageSmoothingEnabled){if(_this.rootContext.webkitImageSmoothingEnabled){_this.smoothProperty="webkitImageSmoothingEnabled"}else if(_this.rootContext.mozImageSmoothingEnabled){_this.smoothProperty="mozImageSmoothingEnabled"}else if(_this.rootContext.oImageSmoothingEnabled){_this.smoothProperty="oImageSmoothingEnabled"}else if(_this.rootContext.msImageSmoothingEnabled){_this.smoothProperty="msImageSmoothingEnabled"}}_this.initPlugins();_this.blendModes=(0,_mapCanvasBlendModesToPixi2.default)();_this._activeBlendMode=null;_this.renderingToScreen=false;_this.resize(_this.options.width,_this.options.height);return _this}CanvasRenderer.prototype.render=function render(displayObject,renderTexture,clear,transform,skipUpdateTransform){if(!this.view){return}this.renderingToScreen=!renderTexture;this.emit("prerender");var rootResolution=this.resolution;if(renderTexture){renderTexture=renderTexture.baseTexture||renderTexture;if(!renderTexture._canvasRenderTarget){renderTexture._canvasRenderTarget=new _CanvasRenderTarget2.default(renderTexture.width,renderTexture.height,renderTexture.resolution);renderTexture.source=renderTexture._canvasRenderTarget.canvas;renderTexture.valid=true}this.context=renderTexture._canvasRenderTarget.context;this.resolution=renderTexture._canvasRenderTarget.resolution}else{this.context=this.rootContext}var context=this.context;if(!renderTexture){this._lastObjectRendered=displayObject}if(!skipUpdateTransform){var cacheParent=displayObject.parent;var tempWt=this._tempDisplayObjectParent.transform.worldTransform;if(transform){transform.copy(tempWt);this._tempDisplayObjectParent.transform._worldID=-1}else{tempWt.identity()}displayObject.parent=this._tempDisplayObjectParent;displayObject.updateTransform();displayObject.parent=cacheParent}context.save();context.setTransform(1,0,0,1,0,0);context.globalAlpha=1;this._activeBlendMode=_const.BLEND_MODES.NORMAL;context.globalCompositeOperation=this.blendModes[_const.BLEND_MODES.NORMAL];if(navigator.isCocoonJS&&this.view.screencanvas){context.fillStyle="black";context.clear()}if(clear!==undefined?clear:this.clearBeforeRender){if(this.renderingToScreen){if(this.transparent){context.clearRect(0,0,this.width,this.height)}else{context.fillStyle=this._backgroundColorString;context.fillRect(0,0,this.width,this.height)}}}var tempContext=this.context;this.context=context;displayObject.renderCanvas(this);this.context=tempContext;context.restore();this.resolution=rootResolution;this.emit("postrender")};CanvasRenderer.prototype.clear=function clear(clearColor){var context=this.context;clearColor=clearColor||this._backgroundColorString;if(!this.transparent&&clearColor){context.fillStyle=clearColor;context.fillRect(0,0,this.width,this.height)}else{context.clearRect(0,0,this.width,this.height)}};CanvasRenderer.prototype.setBlendMode=function setBlendMode(blendMode){if(this._activeBlendMode===blendMode){return}this._activeBlendMode=blendMode;this.context.globalCompositeOperation=this.blendModes[blendMode]};CanvasRenderer.prototype.destroy=function destroy(removeView){this.destroyPlugins();_SystemRenderer.prototype.destroy.call(this,removeView);this.context=null;this.refresh=true;this.maskManager.destroy();this.maskManager=null;this.smoothProperty=null};CanvasRenderer.prototype.resize=function resize(screenWidth,screenHeight){_SystemRenderer.prototype.resize.call(this,screenWidth,screenHeight);if(this.smoothProperty){this.rootContext[this.smoothProperty]=_settings2.default.SCALE_MODE===_const.SCALE_MODES.LINEAR}};CanvasRenderer.prototype.invalidateBlendMode=function invalidateBlendMode(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)};return CanvasRenderer}(_SystemRenderer3.default);exports.default=CanvasRenderer;_utils.pluginTarget.mixin(CanvasRenderer)},{"../../const":102,"../../settings":157,"../../utils":181,"../SystemRenderer":132,"./utils/CanvasMaskManager":134,"./utils/CanvasRenderTarget":135,"./utils/mapCanvasBlendModesToPixi":137}],134:[function(require,module,exports){"use strict";exports.__esModule=true;var _const=require("../../../const");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CanvasMaskManager=function(){function CanvasMaskManager(renderer){_classCallCheck(this,CanvasMaskManager);this.renderer=renderer}CanvasMaskManager.prototype.pushMask=function pushMask(maskData){var renderer=this.renderer;renderer.context.save();var cacheAlpha=maskData.alpha;var transform=maskData.transform.worldTransform;var resolution=renderer.resolution;renderer.context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution);if(!maskData._texture){this.renderGraphicsShape(maskData);renderer.context.clip()}maskData.worldAlpha=cacheAlpha};CanvasMaskManager.prototype.renderGraphicsShape=function renderGraphicsShape(graphics){var context=this.renderer.context;var len=graphics.graphicsData.length;if(len===0){return}context.beginPath();for(var i=0;i<len;i++){var data=graphics.graphicsData[i];var shape=data.shape;if(data.type===_const.SHAPES.POLY){var points=shape.points;context.moveTo(points[0],points[1]);for(var j=1;j<points.length/2;j++){context.lineTo(points[j*2],points[j*2+1])}if(points[0]===points[points.length-2]&&points[1]===points[points.length-1]){context.closePath()}}else if(data.type===_const.SHAPES.RECT){context.rect(shape.x,shape.y,shape.width,shape.height);context.closePath()}else if(data.type===_const.SHAPES.CIRC){context.arc(shape.x,shape.y,shape.radius,0,2*Math.PI);context.closePath()}else if(data.type===_const.SHAPES.ELIP){var w=shape.width*2;var h=shape.height*2;var x=shape.x-w/2;var y=shape.y-h/2;var kappa=.5522848;var ox=w/2*kappa;var oy=h/2*kappa;var xe=x+w;var ye=y+h;var xm=x+w/2;var ym=y+h/2;context.moveTo(x,ym);context.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y);context.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym);context.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye);context.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym);context.closePath()}else if(data.type===_const.SHAPES.RREC){var rx=shape.x;var ry=shape.y;var width=shape.width;var height=shape.height;var radius=shape.radius;var maxRadius=Math.min(width,height)/2|0;radius=radius>maxRadius?maxRadius:radius;context.moveTo(rx,ry+radius);context.lineTo(rx,ry+height-radius);context.quadraticCurveTo(rx,ry+height,rx+radius,ry+height);context.lineTo(rx+width-radius,ry+height);context.quadraticCurveTo(rx+width,ry+height,rx+width,ry+height-radius);context.lineTo(rx+width,ry+radius);context.quadraticCurveTo(rx+width,ry,rx+width-radius,ry);context.lineTo(rx+radius,ry);context.quadraticCurveTo(rx,ry,rx,ry+radius);context.closePath()}}};CanvasMaskManager.prototype.popMask=function popMask(renderer){renderer.context.restore();renderer.invalidateBlendMode()};CanvasMaskManager.prototype.destroy=function destroy(){};return CanvasMaskManager}();exports.default=CanvasMaskManager},{"../../../const":102}],135:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _settings=require("../../../settings");var _settings2=_interopRequireDefault(_settings);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CanvasRenderTarget=function(){function CanvasRenderTarget(width,height,resolution){_classCallCheck(this,CanvasRenderTarget);this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.resolution=resolution||_settings2.default.RESOLUTION;this.resize(width,height)}CanvasRenderTarget.prototype.clear=function clear(){this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.canvas.width,this.canvas.height)};CanvasRenderTarget.prototype.resize=function resize(width,height){this.canvas.width=width*this.resolution;this.canvas.height=height*this.resolution};CanvasRenderTarget.prototype.destroy=function destroy(){this.context=null;this.canvas=null};_createClass(CanvasRenderTarget,[{key:"width",get:function get(){return this.canvas.width},set:function set(val){this.canvas.width=val}},{key:"height",get:function get(){return this.canvas.height},set:function set(val){this.canvas.height=val}}]);return CanvasRenderTarget}();exports.default=CanvasRenderTarget},{"../../../settings":157}],136:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=canUseNewCanvasBlendModes;function createColoredCanvas(color){var canvas=document.createElement("canvas");canvas.width=6;canvas.height=1;var context=canvas.getContext("2d");context.fillStyle=color;context.fillRect(0,0,6,1);return canvas}function canUseNewCanvasBlendModes(){if(typeof document==="undefined"){return false}var magenta=createColoredCanvas("#ff00ff");var yellow=createColoredCanvas("#ffff00");var canvas=document.createElement("canvas");canvas.width=6;canvas.height=1;var context=canvas.getContext("2d");context.globalCompositeOperation="multiply";context.drawImage(magenta,0,0);context.drawImage(yellow,2,0);var imageData=context.getImageData(2,0,1,1);if(!imageData){return false}var data=imageData.data;return data[0]===255&&data[1]===0&&data[2]===0}},{}],137:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=mapCanvasBlendModesToPixi;var _const=require("../../../const");var _canUseNewCanvasBlendModes=require("./canUseNewCanvasBlendModes");var _canUseNewCanvasBlendModes2=_interopRequireDefault(_canUseNewCanvasBlendModes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function mapCanvasBlendModesToPixi(){var array=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if((0,_canUseNewCanvasBlendModes2.default)()){array[_const.BLEND_MODES.NORMAL]="source-over";array[_const.BLEND_MODES.ADD]="lighter";array[_const.BLEND_MODES.MULTIPLY]="multiply";array[_const.BLEND_MODES.SCREEN]="screen";array[_const.BLEND_MODES.OVERLAY]="overlay";array[_const.BLEND_MODES.DARKEN]="darken";array[_const.BLEND_MODES.LIGHTEN]="lighten";array[_const.BLEND_MODES.COLOR_DODGE]="color-dodge";array[_const.BLEND_MODES.COLOR_BURN]="color-burn";array[_const.BLEND_MODES.HARD_LIGHT]="hard-light";array[_const.BLEND_MODES.SOFT_LIGHT]="soft-light";array[_const.BLEND_MODES.DIFFERENCE]="difference";array[_const.BLEND_MODES.EXCLUSION]="exclusion";array[_const.BLEND_MODES.HUE]="hue";array[_const.BLEND_MODES.SATURATION]="saturate";array[_const.BLEND_MODES.COLOR]="color";array[_const.BLEND_MODES.LUMINOSITY]="luminosity"}else{array[_const.BLEND_MODES.NORMAL]="source-over";array[_const.BLEND_MODES.ADD]="lighter";array[_const.BLEND_MODES.MULTIPLY]="source-over";array[_const.BLEND_MODES.SCREEN]="source-over";array[_const.BLEND_MODES.OVERLAY]="source-over";array[_const.BLEND_MODES.DARKEN]="source-over";array[_const.BLEND_MODES.LIGHTEN]="source-over";array[_const.BLEND_MODES.COLOR_DODGE]="source-over";array[_const.BLEND_MODES.COLOR_BURN]="source-over";array[_const.BLEND_MODES.HARD_LIGHT]="source-over";array[_const.BLEND_MODES.SOFT_LIGHT]="source-over";array[_const.BLEND_MODES.DIFFERENCE]="source-over";array[_const.BLEND_MODES.EXCLUSION]="source-over";array[_const.BLEND_MODES.HUE]="source-over";array[_const.BLEND_MODES.SATURATION]="source-over";array[_const.BLEND_MODES.COLOR]="source-over";array[_const.BLEND_MODES.LUMINOSITY]="source-over"}array[_const.BLEND_MODES.NORMAL_NPM]=array[_const.BLEND_MODES.NORMAL];array[_const.BLEND_MODES.ADD_NPM]=array[_const.BLEND_MODES.ADD];array[_const.BLEND_MODES.SCREEN_NPM]=array[_const.BLEND_MODES.SCREEN];return array}},{"../../../const":102,"./canUseNewCanvasBlendModes":136}],138:[function(require,module,exports){"use strict";exports.__esModule=true;var _const=require("../../const");var _settings=require("../../settings");var _settings2=_interopRequireDefault(_settings);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TextureGarbageCollector=function(){function TextureGarbageCollector(renderer){_classCallCheck(this,TextureGarbageCollector);this.renderer=renderer;this.count=0;this.checkCount=0;this.maxIdle=_settings2.default.GC_MAX_IDLE;this.checkCountMax=_settings2.default.GC_MAX_CHECK_COUNT;this.mode=_settings2.default.GC_MODE}TextureGarbageCollector.prototype.update=function update(){this.count++;if(this.mode===_const.GC_MODES.MANUAL){return}this.checkCount++;if(this.checkCount>this.checkCountMax){this.checkCount=0;this.run()}};TextureGarbageCollector.prototype.run=function run(){var tm=this.renderer.textureManager;var managedTextures=tm._managedTextures;var wasRemoved=false;for(var i=0;i<managedTextures.length;i++){var texture=managedTextures[i];if(!texture._glRenderTargets&&this.count-texture.touched>this.maxIdle){tm.destroyTexture(texture,true);managedTextures[i]=null;wasRemoved=true}}if(wasRemoved){var j=0;for(var _i=0;_i<managedTextures.length;_i++){if(managedTextures[_i]!==null){managedTextures[j++]=managedTextures[_i]}}managedTextures.length=j}};TextureGarbageCollector.prototype.unload=function unload(displayObject){var tm=this.renderer.textureManager;if(displayObject._texture&&displayObject._texture._glRenderTargets){tm.destroyTexture(displayObject._texture,true)}for(var i=displayObject.children.length-1;i>=0;i--){this.unload(displayObject.children[i])}};return TextureGarbageCollector}();exports.default=TextureGarbageCollector},{"../../const":102,"../../settings":157}],139:[function(require,module,exports){"use strict";exports.__esModule=true;var _pixiGlCore=require("pixi-gl-core");var _const=require("../../const");var _RenderTarget=require("./utils/RenderTarget");var _RenderTarget2=_interopRequireDefault(_RenderTarget);var _utils=require("../../utils");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TextureManager=function(){function TextureManager(renderer){_classCallCheck(this,TextureManager);this.renderer=renderer;this.gl=renderer.gl;this._managedTextures=[]}TextureManager.prototype.bindTexture=function bindTexture(){};TextureManager.prototype.getTexture=function getTexture(){};TextureManager.prototype.updateTexture=function updateTexture(texture,location){var gl=this.gl;var isRenderTexture=!!texture._glRenderTargets;if(!texture.hasLoaded){return null}var boundTextures=this.renderer.boundTextures;if(location===undefined){location=0;for(var i=0;i<boundTextures.length;++i){if(boundTextures[i]===texture){location=i;break}}}boundTextures[location]=texture;gl.activeTexture(gl.TEXTURE0+location);var glTexture=texture._glTextures[this.renderer.CONTEXT_UID];if(!glTexture){if(isRenderTexture){var renderTarget=new _RenderTarget2.default(this.gl,texture.width,texture.height,texture.scaleMode,texture.resolution);renderTarget.resize(texture.width,texture.height);texture._glRenderTargets[this.renderer.CONTEXT_UID]=renderTarget;glTexture=renderTarget.texture}else{glTexture=new _pixiGlCore.GLTexture(this.gl,null,null,null,null);glTexture.bind(location);glTexture.premultiplyAlpha=true;glTexture.upload(texture.source)}texture._glTextures[this.renderer.CONTEXT_UID]=glTexture;texture.on("update",this.updateTexture,this);texture.on("dispose",this.destroyTexture,this);this._managedTextures.push(texture);if(texture.isPowerOfTwo){if(texture.mipmap){glTexture.enableMipmap()}if(texture.wrapMode===_const.WRAP_MODES.CLAMP){glTexture.enableWrapClamp()}else if(texture.wrapMode===_const.WRAP_MODES.REPEAT){glTexture.enableWrapRepeat()}else{glTexture.enableWrapMirrorRepeat()}}else{glTexture.enableWrapClamp()}if(texture.scaleMode===_const.SCALE_MODES.NEAREST){glTexture.enableNearestScaling()}else{glTexture.enableLinearScaling()}}else if(isRenderTexture){texture._glRenderTargets[this.renderer.CONTEXT_UID].resize(texture.width,texture.height)}else{glTexture.upload(texture.source)}return glTexture};TextureManager.prototype.destroyTexture=function destroyTexture(texture,skipRemove){texture=texture.baseTexture||texture;if(!texture.hasLoaded){return}var uid=this.renderer.CONTEXT_UID;var glTextures=texture._glTextures;var glRenderTargets=texture._glRenderTargets;if(glTextures[uid]){this.renderer.unbindTexture(texture);glTextures[uid].destroy();texture.off("update",this.updateTexture,this);texture.off("dispose",this.destroyTexture,this);delete glTextures[uid];if(!skipRemove){var i=this._managedTextures.indexOf(texture);if(i!==-1){(0,_utils.removeItems)(this._managedTextures,i,1)}}}if(glRenderTargets&&glRenderTargets[uid]){glRenderTargets[uid].destroy();delete glRenderTargets[uid]}};TextureManager.prototype.removeAll=function removeAll(){for(var i=0;i<this._managedTextures.length;++i){var texture=this._managedTextures[i];if(texture._glTextures[this.renderer.CONTEXT_UID]){delete texture._glTextures[this.renderer.CONTEXT_UID]}}};TextureManager.prototype.destroy=function destroy(){for(var i=0;i<this._managedTextures.length;++i){var texture=this._managedTextures[i];this.destroyTexture(texture,true);texture.off("update",this.updateTexture,this);texture.off("dispose",this.destroyTexture,this)}this._managedTextures=null};return TextureManager}();exports.default=TextureManager},{"../../const":102,"../../utils":181,"./utils/RenderTarget":152,"pixi-gl-core":85}],140:[function(require,module,exports){"use strict";exports.__esModule=true;var _SystemRenderer2=require("../SystemRenderer");var _SystemRenderer3=_interopRequireDefault(_SystemRenderer2);var _MaskManager=require("./managers/MaskManager");var _MaskManager2=_interopRequireDefault(_MaskManager);var _StencilManager=require("./managers/StencilManager");var _StencilManager2=_interopRequireDefault(_StencilManager);var _FilterManager=require("./managers/FilterManager");var _FilterManager2=_interopRequireDefault(_FilterManager);var _RenderTarget=require("./utils/RenderTarget");var _RenderTarget2=_interopRequireDefault(_RenderTarget);var _ObjectRenderer=require("./utils/ObjectRenderer");var _ObjectRenderer2=_interopRequireDefault(_ObjectRenderer);var _TextureManager=require("./TextureManager");var _TextureManager2=_interopRequireDefault(_TextureManager);var _BaseTexture=require("../../textures/BaseTexture");var _BaseTexture2=_interopRequireDefault(_BaseTexture);var _TextureGarbageCollector=require("./TextureGarbageCollector");var _TextureGarbageCollector2=_interopRequireDefault(_TextureGarbageCollector);var _WebGLState=require("./WebGLState");var _WebGLState2=_interopRequireDefault(_WebGLState);var _mapWebGLDrawModesToPixi=require("./utils/mapWebGLDrawModesToPixi");var _mapWebGLDrawModesToPixi2=_interopRequireDefault(_mapWebGLDrawModesToPixi);var _validateContext=require("./utils/validateContext");var _validateContext2=_interopRequireDefault(_validateContext);var _utils=require("../../utils");var _pixiGlCore=require("pixi-gl-core");var _pixiGlCore2=_interopRequireDefault(_pixiGlCore);var _const=require("../../const");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var CONTEXT_UID=0;var WebGLRenderer=function(_SystemRenderer){_inherits(WebGLRenderer,_SystemRenderer);function WebGLRenderer(options,arg2,arg3){_classCallCheck(this,WebGLRenderer);var _this=_possibleConstructorReturn(this,_SystemRenderer.call(this,"WebGL",options,arg2,arg3));_this.legacy=_this.options.legacy;if(_this.legacy){_pixiGlCore2.default.VertexArrayObject.FORCE_NATIVE=true}_this.type=_const.RENDERER_TYPE.WEBGL;_this.handleContextLost=_this.handleContextLost.bind(_this);_this.handleContextRestored=_this.handleContextRestored.bind(_this);_this.view.addEventListener("webglcontextlost",_this.handleContextLost,false);_this.view.addEventListener("webglcontextrestored",_this.handleContextRestored,false);_this._contextOptions={alpha:_this.transparent,antialias:_this.options.antialias,premultipliedAlpha:_this.transparent&&_this.transparent!=="notMultiplied",stencil:true,preserveDrawingBuffer:_this.options.preserveDrawingBuffer,powerPreference:_this.options.powerPreference};_this._backgroundColorRgba[3]=_this.transparent?0:1;_this.maskManager=new _MaskManager2.default(_this);_this.stencilManager=new _StencilManager2.default(_this);_this.emptyRenderer=new _ObjectRenderer2.default(_this);_this.currentRenderer=_this.emptyRenderer;_this.textureManager=null;_this.filterManager=null;_this.initPlugins();if(_this.options.context){(0,_validateContext2.default)(_this.options.context)}_this.gl=_this.options.context||_pixiGlCore2.default.createContext(_this.view,_this._contextOptions);_this.CONTEXT_UID=CONTEXT_UID++;_this.state=new _WebGLState2.default(_this.gl);_this.renderingToScreen=true;_this.boundTextures=null;_this._activeShader=null;_this._activeVao=null;_this._activeRenderTarget=null;_this._initContext();_this.drawModes=(0,_mapWebGLDrawModesToPixi2.default)(_this.gl);_this._nextTextureLocation=0;_this.setBlendMode(0);return _this}WebGLRenderer.prototype._initContext=function _initContext(){var gl=this.gl;if(gl.isContextLost()&&gl.getExtension("WEBGL_lose_context")){gl.getExtension("WEBGL_lose_context").restoreContext()}var maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null;this._activeVao=null;this.boundTextures=new Array(maxTextures);this.emptyTextures=new Array(maxTextures);this.textureManager=new _TextureManager2.default(this);this.filterManager=new _FilterManager2.default(this);this.textureGC=new _TextureGarbageCollector2.default(this);this.state.resetToDefault();this.rootRenderTarget=new _RenderTarget2.default(gl,this.width,this.height,null,this.resolution,true);this.rootRenderTarget.clearColor=this._backgroundColorRgba;this.bindRenderTarget(this.rootRenderTarget);var emptyGLTexture=new _pixiGlCore2.default.GLTexture.fromData(gl,null,1,1);var tempObj={_glTextures:{}};tempObj._glTextures[this.CONTEXT_UID]={};for(var i=0;i<maxTextures;i++){var empty=new _BaseTexture2.default;empty._glTextures[this.CONTEXT_UID]=emptyGLTexture;this.boundTextures[i]=tempObj;this.emptyTextures[i]=empty;this.bindTexture(null,i)}this.emit("context",gl);this.resize(this.screen.width,this.screen.height)};WebGLRenderer.prototype.render=function render(displayObject,renderTexture,clear,transform,skipUpdateTransform){this.renderingToScreen=!renderTexture;this.emit("prerender");if(!this.gl||this.gl.isContextLost()){return}this._nextTextureLocation=0;if(!renderTexture){this._lastObjectRendered=displayObject}if(!skipUpdateTransform){var cacheParent=displayObject.parent;displayObject.parent=this._tempDisplayObjectParent;displayObject.updateTransform();displayObject.parent=cacheParent}this.bindRenderTexture(renderTexture,transform);this.currentRenderer.start();if(clear!==undefined?clear:this.clearBeforeRender){this._activeRenderTarget.clear()}displayObject.renderWebGL(this);this.currentRenderer.flush();this.textureGC.update();this.emit("postrender")};WebGLRenderer.prototype.setObjectRenderer=function setObjectRenderer(objectRenderer){if(this.currentRenderer===objectRenderer){return}this.currentRenderer.stop();this.currentRenderer=objectRenderer;this.currentRenderer.start()};WebGLRenderer.prototype.flush=function flush(){this.setObjectRenderer(this.emptyRenderer)};WebGLRenderer.prototype.resize=function resize(screenWidth,screenHeight){_SystemRenderer3.default.prototype.resize.call(this,screenWidth,screenHeight);this.rootRenderTarget.resize(screenWidth,screenHeight);if(this._activeRenderTarget===this.rootRenderTarget){this.rootRenderTarget.activate();if(this._activeShader){this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(true)}}};WebGLRenderer.prototype.setBlendMode=function setBlendMode(blendMode){this.state.setBlendMode(blendMode)};WebGLRenderer.prototype.clear=function clear(clearColor){this._activeRenderTarget.clear(clearColor)};WebGLRenderer.prototype.setTransform=function setTransform(matrix){this._activeRenderTarget.transform=matrix};WebGLRenderer.prototype.clearRenderTexture=function clearRenderTexture(renderTexture,clearColor){var baseTexture=renderTexture.baseTexture;var renderTarget=baseTexture._glRenderTargets[this.CONTEXT_UID];if(renderTarget){renderTarget.clear(clearColor)}return this};WebGLRenderer.prototype.bindRenderTexture=function bindRenderTexture(renderTexture,transform){var renderTarget=void 0;if(renderTexture){var baseTexture=renderTexture.baseTexture;if(!baseTexture._glRenderTargets[this.CONTEXT_UID]){this.textureManager.updateTexture(baseTexture,0)}this.unbindTexture(baseTexture);renderTarget=baseTexture._glRenderTargets[this.CONTEXT_UID];renderTarget.setFrame(renderTexture.frame)}else{renderTarget=this.rootRenderTarget}renderTarget.transform=transform;this.bindRenderTarget(renderTarget);return this};WebGLRenderer.prototype.bindRenderTarget=function bindRenderTarget(renderTarget){if(renderTarget!==this._activeRenderTarget){this._activeRenderTarget=renderTarget;renderTarget.activate();if(this._activeShader){this._activeShader.uniforms.projectionMatrix=renderTarget.projectionMatrix.toArray(true)}this.stencilManager.setMaskStack(renderTarget.stencilMaskStack)}return this};WebGLRenderer.prototype.bindShader=function bindShader(shader,autoProject){if(this._activeShader!==shader){this._activeShader=shader;shader.bind();if(autoProject!==false){shader.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(true)}}return this};WebGLRenderer.prototype.bindTexture=function bindTexture(texture,location,forceLocation){texture=texture||this.emptyTextures[location];texture=texture.baseTexture||texture;texture.touched=this.textureGC.count;if(!forceLocation){for(var i=0;i<this.boundTextures.length;i++){if(this.boundTextures[i]===texture){return i}}if(location===undefined){this._nextTextureLocation++;this._nextTextureLocation%=this.boundTextures.length;location=this.boundTextures.length-this._nextTextureLocation-1}}else{location=location||0}var gl=this.gl;var glTexture=texture._glTextures[this.CONTEXT_UID];if(!glTexture){this.textureManager.updateTexture(texture,location)}else{this.boundTextures[location]=texture;gl.activeTexture(gl.TEXTURE0+location);gl.bindTexture(gl.TEXTURE_2D,glTexture.texture)}return location};WebGLRenderer.prototype.unbindTexture=function unbindTexture(texture){var gl=this.gl;texture=texture.baseTexture||texture;for(var i=0;i<this.boundTextures.length;i++){if(this.boundTextures[i]===texture){this.boundTextures[i]=this.emptyTextures[i];gl.activeTexture(gl.TEXTURE0+i);gl.bindTexture(gl.TEXTURE_2D,this.emptyTextures[i]._glTextures[this.CONTEXT_UID].texture)}}return this};WebGLRenderer.prototype.createVao=function createVao(){return new _pixiGlCore2.default.VertexArrayObject(this.gl,this.state.attribState)};WebGLRenderer.prototype.bindVao=function bindVao(vao){if(this._activeVao===vao){return this}if(vao){vao.bind()}else if(this._activeVao){this._activeVao.unbind()}this._activeVao=vao;return this};WebGLRenderer.prototype.reset=function reset(){this.setObjectRenderer(this.emptyRenderer);this.bindVao(null);this._activeShader=null;this._activeRenderTarget=this.rootRenderTarget;for(var i=0;i<this.boundTextures.length;i++){this.boundTextures[i]=this.emptyTextures[i]}this.rootRenderTarget.activate();this.state.resetToDefault();return this};WebGLRenderer.prototype.handleContextLost=function handleContextLost(event){event.preventDefault()};WebGLRenderer.prototype.handleContextRestored=function handleContextRestored(){this.textureManager.removeAll();this.filterManager.destroy(true);this._initContext()};WebGLRenderer.prototype.destroy=function destroy(removeView){this.destroyPlugins();this.view.removeEventListener("webglcontextlost",this.handleContextLost);this.view.removeEventListener("webglcontextrestored",this.handleContextRestored);this.textureManager.destroy();_SystemRenderer.prototype.destroy.call(this,removeView);this.uid=0;this.maskManager.destroy();this.stencilManager.destroy();this.filterManager.destroy();this.maskManager=null;this.filterManager=null;this.textureManager=null;this.currentRenderer=null;this.handleContextLost=null;this.handleContextRestored=null;this._contextOptions=null;this.gl.useProgram(null);if(this.gl.getExtension("WEBGL_lose_context")){this.gl.getExtension("WEBGL_lose_context").loseContext()}this.gl=null};return WebGLRenderer}(_SystemRenderer3.default);exports.default=WebGLRenderer;_utils.pluginTarget.mixin(WebGLRenderer)},{"../../const":102,"../../textures/BaseTexture":168,"../../utils":181,"../SystemRenderer":132,"./TextureGarbageCollector":138,"./TextureManager":139,"./WebGLState":141,"./managers/FilterManager":146,"./managers/MaskManager":147,"./managers/StencilManager":148,"./utils/ObjectRenderer":150,"./utils/RenderTarget":152,"./utils/mapWebGLDrawModesToPixi":155,"./utils/validateContext":156,"pixi-gl-core":85}],141:[function(require,module,exports){"use strict";exports.__esModule=true;var _mapWebGLBlendModesToPixi=require("./utils/mapWebGLBlendModesToPixi");var _mapWebGLBlendModesToPixi2=_interopRequireDefault(_mapWebGLBlendModesToPixi);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var BLEND=0;var DEPTH_TEST=1;var FRONT_FACE=2;var CULL_FACE=3;var BLEND_FUNC=4;var WebGLState=function(){function WebGLState(gl){_classCallCheck(this,WebGLState);this.activeState=new Uint8Array(16);this.defaultState=new Uint8Array(16);this.defaultState[0]=1;this.stackIndex=0;this.stack=[];this.gl=gl;this.maxAttribs=gl.getParameter(gl.MAX_VERTEX_ATTRIBS);this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)};this.blendModes=(0,_mapWebGLBlendModesToPixi2.default)(gl);this.nativeVaoExtension=gl.getExtension("OES_vertex_array_object")||gl.getExtension("MOZ_OES_vertex_array_object")||gl.getExtension("WEBKIT_OES_vertex_array_object")}WebGLState.prototype.push=function push(){var state=this.stack[this.stackIndex];if(!state){state=this.stack[this.stackIndex]=new Uint8Array(16)}++this.stackIndex;for(var i=0;i<this.activeState.length;i++){state[i]=this.activeState[i]}};WebGLState.prototype.pop=function pop(){var state=this.stack[--this.stackIndex];this.setState(state)};WebGLState.prototype.setState=function setState(state){this.setBlend(state[BLEND]);this.setDepthTest(state[DEPTH_TEST]);this.setFrontFace(state[FRONT_FACE]);this.setCullFace(state[CULL_FACE]);this.setBlendMode(state[BLEND_FUNC])};WebGLState.prototype.setBlend=function setBlend(value){value=value?1:0;if(this.activeState[BLEND]===value){return}this.activeState[BLEND]=value;this.gl[value?"enable":"disable"](this.gl.BLEND)};WebGLState.prototype.setBlendMode=function setBlendMode(value){if(value===this.activeState[BLEND_FUNC]){return}this.activeState[BLEND_FUNC]=value;var mode=this.blendModes[value];if(mode.length===2){this.gl.blendFunc(mode[0],mode[1])}else{this.gl.blendFuncSeparate(mode[0],mode[1],mode[2],mode[3])}};WebGLState.prototype.setDepthTest=function setDepthTest(value){value=value?1:0;if(this.activeState[DEPTH_TEST]===value){return}this.activeState[DEPTH_TEST]=value;this.gl[value?"enable":"disable"](this.gl.DEPTH_TEST)};WebGLState.prototype.setCullFace=function setCullFace(value){value=value?1:0;if(this.activeState[CULL_FACE]===value){return}this.activeState[CULL_FACE]=value;this.gl[value?"enable":"disable"](this.gl.CULL_FACE)};WebGLState.prototype.setFrontFace=function setFrontFace(value){value=value?1:0;if(this.activeState[FRONT_FACE]===value){return}this.activeState[FRONT_FACE]=value;this.gl.frontFace(this.gl[value?"CW":"CCW"])};WebGLState.prototype.resetAttributes=function resetAttributes(){for(var i=0;i<this.attribState.tempAttribState.length;i++){this.attribState.tempAttribState[i]=0}for(var _i=0;_i<this.attribState.attribState.length;_i++){this.attribState.attribState[_i]=0}for(var _i2=1;_i2<this.maxAttribs;_i2++){this.gl.disableVertexAttribArray(_i2)}};WebGLState.prototype.resetToDefault=function resetToDefault(){if(this.nativeVaoExtension){this.nativeVaoExtension.bindVertexArrayOES(null)}this.resetAttributes();for(var i=0;i<this.activeState.length;++i){this.activeState[i]=32}this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,false);this.setState(this.defaultState)};return WebGLState}();exports.default=WebGLState},{"./utils/mapWebGLBlendModesToPixi":154}],142:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _extractUniformsFromSrc=require("./extractUniformsFromSrc");var _extractUniformsFromSrc2=_interopRequireDefault(_extractUniformsFromSrc);var _utils=require("../../../utils");var _const=require("../../../const");var _settings=require("../../../settings");var _settings2=_interopRequireDefault(_settings);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SOURCE_KEY_MAP={};var Filter=function(){function Filter(vertexSrc,fragmentSrc,uniforms){_classCallCheck(this,Filter);this.vertexSrc=vertexSrc||Filter.defaultVertexSrc;this.fragmentSrc=fragmentSrc||Filter.defaultFragmentSrc;this._blendMode=_const.BLEND_MODES.NORMAL;this.uniformData=uniforms||(0,_extractUniformsFromSrc2.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler");this.uniforms={};for(var i in this.uniformData){this.uniforms[i]=this.uniformData[i].value;if(this.uniformData[i].type){this.uniformData[i].type=this.uniformData[i].type.toLowerCase()}}this.glShaders={};if(!SOURCE_KEY_MAP[this.vertexSrc+this.fragmentSrc]){SOURCE_KEY_MAP[this.vertexSrc+this.fragmentSrc]=(0,_utils.uid)()}this.glShaderKey=SOURCE_KEY_MAP[this.vertexSrc+this.fragmentSrc];this.padding=4;this.resolution=_settings2.default.FILTER_RESOLUTION;this.enabled=true;this.autoFit=true}Filter.prototype.apply=function apply(filterManager,input,output,clear,currentState){filterManager.applyFilter(this,input,output,clear)};_createClass(Filter,[{key:"blendMode",get:function get(){return this._blendMode},set:function set(value){this._blendMode=value}}],[{key:"defaultVertexSrc",get:function get(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n")}},{key:"defaultFragmentSrc",get:function get(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")}}]);return Filter}();exports.default=Filter},{"../../../const":102,"../../../settings":157,"../../../utils":181,"./extractUniformsFromSrc":143}],143:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=extractUniformsFromSrc;var _pixiGlCore=require("pixi-gl-core");var _pixiGlCore2=_interopRequireDefault(_pixiGlCore);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var defaultValue=_pixiGlCore2.default.shader.defaultValue;function extractUniformsFromSrc(vertexSrc,fragmentSrc,mask){var vertUniforms=extractUniformsFromString(vertexSrc,mask);var fragUniforms=extractUniformsFromString(fragmentSrc,mask);return Object.assign(vertUniforms,fragUniforms)}function extractUniformsFromString(string){var maskRegex=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$");var uniforms={};var nameSplit=void 0;var lines=string.replace(/\s+/g," ").split(/\s*;\s*/);for(var i=0;i<lines.length;i++){var line=lines[i].trim();if(line.indexOf("uniform")>-1){var splitLine=line.split(" ");var type=splitLine[1];var name=splitLine[2];var size=1;if(name.indexOf("[")>-1){nameSplit=name.split(/\[|]/);name=nameSplit[0];size*=Number(nameSplit[1])}if(!name.match(maskRegex)){uniforms[name]={value:defaultValue(type,size),name:name,type:type}}}}return uniforms}},{"pixi-gl-core":85}],144:[function(require,module,exports){"use strict";exports.__esModule=true;exports.calculateScreenSpaceMatrix=calculateScreenSpaceMatrix;exports.calculateNormalizedScreenSpaceMatrix=calculateNormalizedScreenSpaceMatrix;exports.calculateSpriteMatrix=calculateSpriteMatrix;var _math=require("../../../math");function calculateScreenSpaceMatrix(outputMatrix,filterArea,textureSize){var mappedMatrix=outputMatrix.identity();mappedMatrix.translate(filterArea.x/textureSize.width,filterArea.y/textureSize.height);mappedMatrix.scale(textureSize.width,textureSize.height);return mappedMatrix}function calculateNormalizedScreenSpaceMatrix(outputMatrix,filterArea,textureSize){var mappedMatrix=outputMatrix.identity();mappedMatrix.translate(filterArea.x/textureSize.width,filterArea.y/textureSize.height);var translateScaleX=textureSize.width/filterArea.width;var translateScaleY=textureSize.height/filterArea.height;mappedMatrix.scale(translateScaleX,translateScaleY);return mappedMatrix}function calculateSpriteMatrix(outputMatrix,filterArea,textureSize,sprite){var orig=sprite._texture.orig;var mappedMatrix=outputMatrix.set(textureSize.width,0,0,textureSize.height,filterArea.x,filterArea.y);var worldTransform=sprite.worldTransform.copy(_math.Matrix.TEMP_MATRIX);worldTransform.invert();mappedMatrix.prepend(worldTransform);mappedMatrix.scale(1/orig.width,1/orig.height);mappedMatrix.translate(sprite.anchor.x,sprite.anchor.y);return mappedMatrix}},{"../../../math":126}],145:[function(require,module,exports){"use strict";exports.__esModule=true;var _Filter2=require("../Filter");var _Filter3=_interopRequireDefault(_Filter2);var _math=require("../../../../math");var _path=require("path");var _TextureMatrix=require("../../../../textures/TextureMatrix");var _TextureMatrix2=_interopRequireDefault(_TextureMatrix);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var SpriteMaskFilter=function(_Filter){_inherits(SpriteMaskFilter,_Filter);function SpriteMaskFilter(sprite){_classCallCheck(this,SpriteMaskFilter);var maskMatrix=new _math.Matrix;var _this=_possibleConstructorReturn(this,_Filter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n"));sprite.renderable=false;_this.maskSprite=sprite;_this.maskMatrix=maskMatrix;return _this}SpriteMaskFilter.prototype.apply=function apply(filterManager,input,output){var maskSprite=this.maskSprite;var tex=this.maskSprite.texture;if(!tex.valid){return}if(!tex.transform){tex.transform=new _TextureMatrix2.default(tex,0)}tex.transform.update();this.uniforms.mask=tex;this.uniforms.otherMatrix=filterManager.calculateSpriteMatrix(this.maskMatrix,maskSprite).prepend(tex.transform.mapCoord);this.uniforms.alpha=maskSprite.worldAlpha;this.uniforms.maskClamp=tex.transform.uClampFrame;filterManager.applyFilter(this,input,output)};return SpriteMaskFilter}(_Filter3.default);exports.default=SpriteMaskFilter},{"../../../../math":126,"../../../../textures/TextureMatrix":172,"../Filter":142,path:78}],146:[function(require,module,exports){"use strict";exports.__esModule=true;var _WebGLManager2=require("./WebGLManager");var _WebGLManager3=_interopRequireDefault(_WebGLManager2);var _RenderTarget=require("../utils/RenderTarget");var _RenderTarget2=_interopRequireDefault(_RenderTarget);var _Quad=require("../utils/Quad");var _Quad2=_interopRequireDefault(_Quad);var _math=require("../../../math");var _Shader=require("../../../Shader");var _Shader2=_interopRequireDefault(_Shader);var _filterTransforms=require("../filters/filterTransforms");var filterTransforms=_interopRequireWildcard(_filterTransforms);var _bitTwiddle=require("bit-twiddle");var _bitTwiddle2=_interopRequireDefault(_bitTwiddle);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var FilterState=function(){function FilterState(){_classCallCheck(this,FilterState);this.renderTarget=null;this.target=null;this.resolution=1;this.sourceFrame=new _math.Rectangle;this.destinationFrame=new _math.Rectangle;this.filters=[]}FilterState.prototype.clear=function clear(){this.filters=null;this.target=null;this.renderTarget=null};return FilterState}();var screenKey="screen";var FilterManager=function(_WebGLManager){_inherits(FilterManager,_WebGLManager);function FilterManager(renderer){_classCallCheck(this,FilterManager);var _this=_possibleConstructorReturn(this,_WebGLManager.call(this,renderer));_this.gl=_this.renderer.gl;_this.quad=new _Quad2.default(_this.gl,renderer.state.attribState);_this.shaderCache={};_this.pool={};_this.filterData=null;_this.managedFilters=[];_this.renderer.on("prerender",_this.onPrerender,_this);_this._screenWidth=renderer.view.width;_this._screenHeight=renderer.view.height;return _this}FilterManager.prototype.pushFilter=function pushFilter(target,filters){var renderer=this.renderer;var filterData=this.filterData;if(!filterData){filterData=this.renderer._activeRenderTarget.filterStack;var filterState=new FilterState;filterState.sourceFrame=filterState.destinationFrame=this.renderer._activeRenderTarget.size;filterState.renderTarget=renderer._activeRenderTarget;this.renderer._activeRenderTarget.filterData=filterData={index:0,stack:[filterState]};this.filterData=filterData}var currentState=filterData.stack[++filterData.index];var renderTargetFrame=filterData.stack[0].destinationFrame;if(!currentState){currentState=filterData.stack[filterData.index]=new FilterState}var fullScreen=target.filterArea&&target.filterArea.x===0&&target.filterArea.y===0&&target.filterArea.width===renderer.screen.width&&target.filterArea.height===renderer.screen.height;var resolution=filters[0].resolution;var padding=filters[0].padding|0;var targetBounds=fullScreen?renderer.screen:target.filterArea||target.getBounds(true);var sourceFrame=currentState.sourceFrame;var destinationFrame=currentState.destinationFrame;sourceFrame.x=(targetBounds.x*resolution|0)/resolution;sourceFrame.y=(targetBounds.y*resolution|0)/resolution;sourceFrame.width=(targetBounds.width*resolution|0)/resolution;sourceFrame.height=(targetBounds.height*resolution|0)/resolution;if(!fullScreen){if(filterData.stack[0].renderTarget.transform){}else if(filters[0].autoFit){sourceFrame.fit(renderTargetFrame)}sourceFrame.pad(padding)}destinationFrame.width=sourceFrame.width;destinationFrame.height=sourceFrame.height;var renderTarget=this.getPotRenderTarget(renderer.gl,sourceFrame.width,sourceFrame.height,resolution);currentState.target=target;currentState.filters=filters;currentState.resolution=resolution;currentState.renderTarget=renderTarget;renderTarget.setFrame(destinationFrame,sourceFrame);renderer.bindRenderTarget(renderTarget);renderTarget.clear()};FilterManager.prototype.popFilter=function popFilter(){var filterData=this.filterData;var lastState=filterData.stack[filterData.index-1];var currentState=filterData.stack[filterData.index];this.quad.map(currentState.renderTarget.size,currentState.sourceFrame).upload();var filters=currentState.filters;if(filters.length===1){filters[0].apply(this,currentState.renderTarget,lastState.renderTarget,false,currentState);this.freePotRenderTarget(currentState.renderTarget)}else{var flip=currentState.renderTarget;var flop=this.getPotRenderTarget(this.renderer.gl,currentState.sourceFrame.width,currentState.sourceFrame.height,currentState.resolution);flop.setFrame(currentState.destinationFrame,currentState.sourceFrame);flop.clear();var i=0;for(i=0;i<filters.length-1;++i){filters[i].apply(this,flip,flop,true,currentState);var t=flip;flip=flop;flop=t}filters[i].apply(this,flip,lastState.renderTarget,false,currentState);this.freePotRenderTarget(flip);this.freePotRenderTarget(flop)}currentState.clear();filterData.index--;if(filterData.index===0){this.filterData=null}};FilterManager.prototype.applyFilter=function applyFilter(filter,input,output,clear){var renderer=this.renderer;var gl=renderer.gl;var shader=filter.glShaders[renderer.CONTEXT_UID];if(!shader){if(filter.glShaderKey){shader=this.shaderCache[filter.glShaderKey];if(!shader){shader=new _Shader2.default(this.gl,filter.vertexSrc,filter.fragmentSrc);filter.glShaders[renderer.CONTEXT_UID]=this.shaderCache[filter.glShaderKey]=shader;this.managedFilters.push(filter)}}else{shader=filter.glShaders[renderer.CONTEXT_UID]=new _Shader2.default(this.gl,filter.vertexSrc,filter.fragmentSrc);this.managedFilters.push(filter)}renderer.bindVao(null);this.quad.initVao(shader)}renderer.bindVao(this.quad.vao);renderer.bindRenderTarget(output);if(clear){gl.disable(gl.SCISSOR_TEST);renderer.clear();gl.enable(gl.SCISSOR_TEST)}if(output===renderer.maskManager.scissorRenderTarget){renderer.maskManager.pushScissorMask(null,renderer.maskManager.scissorData)}renderer.bindShader(shader);var tex=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=tex;this.syncUniforms(shader,filter);renderer.state.setBlendMode(filter.blendMode);gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,input.texture.texture);this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0);gl.bindTexture(gl.TEXTURE_2D,tex._glTextures[this.renderer.CONTEXT_UID].texture)};FilterManager.prototype.syncUniforms=function syncUniforms(shader,filter){var uniformData=filter.uniformData;var uniforms=filter.uniforms;var textureCount=1;var currentState=void 0;if(shader.uniforms.filterArea){currentState=this.filterData.stack[this.filterData.index];var filterArea=shader.uniforms.filterArea;filterArea[0]=currentState.renderTarget.size.width;filterArea[1]=currentState.renderTarget.size.height;filterArea[2]=currentState.sourceFrame.x;filterArea[3]=currentState.sourceFrame.y;shader.uniforms.filterArea=filterArea}if(shader.uniforms.filterClamp){currentState=currentState||this.filterData.stack[this.filterData.index];var filterClamp=shader.uniforms.filterClamp;filterClamp[0]=0;filterClamp[1]=0;filterClamp[2]=(currentState.sourceFrame.width-1)/currentState.renderTarget.size.width;filterClamp[3]=(currentState.sourceFrame.height-1)/currentState.renderTarget.size.height;shader.uniforms.filterClamp=filterClamp}for(var i in uniformData){var type=uniformData[i].type;if(type==="sampler2d"&&uniforms[i]!==0){if(uniforms[i].baseTexture){shader.uniforms[i]=this.renderer.bindTexture(uniforms[i].baseTexture,textureCount)}else{shader.uniforms[i]=textureCount;var gl=this.renderer.gl;this.renderer.boundTextures[textureCount]=this.renderer.emptyTextures[textureCount];gl.activeTexture(gl.TEXTURE0+textureCount);uniforms[i].texture.bind()}textureCount++}else if(type==="mat3"){if(uniforms[i].a!==undefined){shader.uniforms[i]=uniforms[i].toArray(true)}else{shader.uniforms[i]=uniforms[i]}}else if(type==="vec2"){if(uniforms[i].x!==undefined){var val=shader.uniforms[i]||new Float32Array(2);val[0]=uniforms[i].x;val[1]=uniforms[i].y;shader.uniforms[i]=val}else{shader.uniforms[i]=uniforms[i]}}else if(type==="float"){if(shader.uniforms.data[i].value!==uniformData[i]){shader.uniforms[i]=uniforms[i]}}else{shader.uniforms[i]=uniforms[i]}}};FilterManager.prototype.getRenderTarget=function getRenderTarget(clear,resolution){var currentState=this.filterData.stack[this.filterData.index];var renderTarget=this.getPotRenderTarget(this.renderer.gl,currentState.sourceFrame.width,currentState.sourceFrame.height,resolution||currentState.resolution);renderTarget.setFrame(currentState.destinationFrame,currentState.sourceFrame);return renderTarget};FilterManager.prototype.returnRenderTarget=function returnRenderTarget(renderTarget){this.freePotRenderTarget(renderTarget)};FilterManager.prototype.calculateScreenSpaceMatrix=function calculateScreenSpaceMatrix(outputMatrix){var currentState=this.filterData.stack[this.filterData.index];return filterTransforms.calculateScreenSpaceMatrix(outputMatrix,currentState.sourceFrame,currentState.renderTarget.size)};FilterManager.prototype.calculateNormalizedScreenSpaceMatrix=function calculateNormalizedScreenSpaceMatrix(outputMatrix){var currentState=this.filterData.stack[this.filterData.index];return filterTransforms.calculateNormalizedScreenSpaceMatrix(outputMatrix,currentState.sourceFrame,currentState.renderTarget.size,currentState.destinationFrame)};FilterManager.prototype.calculateSpriteMatrix=function calculateSpriteMatrix(outputMatrix,sprite){var currentState=this.filterData.stack[this.filterData.index];return filterTransforms.calculateSpriteMatrix(outputMatrix,currentState.sourceFrame,currentState.renderTarget.size,sprite)};FilterManager.prototype.destroy=function destroy(){var contextLost=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var renderer=this.renderer;var filters=this.managedFilters;renderer.off("prerender",this.onPrerender,this);for(var i=0;i<filters.length;i++){if(!contextLost){filters[i].glShaders[renderer.CONTEXT_UID].destroy()}delete filters[i].glShaders[renderer.CONTEXT_UID]}this.shaderCache={};if(!contextLost){this.emptyPool()}else{this.pool={}}};FilterManager.prototype.getPotRenderTarget=function getPotRenderTarget(gl,minWidth,minHeight,resolution){var key=screenKey;minWidth*=resolution;minHeight*=resolution;if(minWidth!==this._screenWidth||minHeight!==this._screenHeight){minWidth=_bitTwiddle2.default.nextPow2(minWidth);minHeight=_bitTwiddle2.default.nextPow2(minHeight);key=(minWidth&65535)<<16|minHeight&65535}if(!this.pool[key]){this.pool[key]=[]}var renderTarget=this.pool[key].pop();if(!renderTarget){var tex=this.renderer.boundTextures[0];gl.activeTexture(gl.TEXTURE0);renderTarget=new _RenderTarget2.default(gl,minWidth,minHeight,null,1);gl.bindTexture(gl.TEXTURE_2D,tex._glTextures[this.renderer.CONTEXT_UID].texture)}renderTarget.resolution=resolution;renderTarget.defaultFrame.width=renderTarget.size.width=minWidth/resolution;renderTarget.defaultFrame.height=renderTarget.size.height=minHeight/resolution;renderTarget.filterPoolKey=key;return renderTarget};FilterManager.prototype.emptyPool=function emptyPool(){for(var i in this.pool){var textures=this.pool[i];if(textures){for(var j=0;j<textures.length;j++){textures[j].destroy(true)}}}this.pool={}};FilterManager.prototype.freePotRenderTarget=function freePotRenderTarget(renderTarget){this.pool[renderTarget.filterPoolKey].push(renderTarget)};FilterManager.prototype.onPrerender=function onPrerender(){if(this._screenWidth!==this.renderer.view.width||this._screenHeight!==this.renderer.view.height){this._screenWidth=this.renderer.view.width;this._screenHeight=this.renderer.view.height;var textures=this.pool[screenKey];if(textures){for(var j=0;j<textures.length;j++){textures[j].destroy(true)}}this.pool[screenKey]=[]}};return FilterManager}(_WebGLManager3.default);exports.default=FilterManager},{"../../../Shader":100,"../../../math":126,"../filters/filterTransforms":144,"../utils/Quad":151,"../utils/RenderTarget":152,"./WebGLManager":149,"bit-twiddle":3}],147:[function(require,module,exports){"use strict";exports.__esModule=true;var _WebGLManager2=require("./WebGLManager");var _WebGLManager3=_interopRequireDefault(_WebGLManager2);var _SpriteMaskFilter=require("../filters/spriteMask/SpriteMaskFilter");var _SpriteMaskFilter2=_interopRequireDefault(_SpriteMaskFilter);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var MaskManager=function(_WebGLManager){_inherits(MaskManager,_WebGLManager);function MaskManager(renderer){_classCallCheck(this,MaskManager);var _this=_possibleConstructorReturn(this,_WebGLManager.call(this,renderer));_this.scissor=false;_this.scissorData=null;_this.scissorRenderTarget=null;_this.enableScissor=true;_this.alphaMaskPool=[];_this.alphaMaskIndex=0;return _this}MaskManager.prototype.pushMask=function pushMask(target,maskData){if(maskData.texture){this.pushSpriteMask(target,maskData)}else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&maskData.isFastRect()){var matrix=maskData.worldTransform;var rot=Math.atan2(matrix.b,matrix.a);rot=Math.round(rot*(180/Math.PI));if(rot%90){this.pushStencilMask(maskData)}else{this.pushScissorMask(target,maskData)}}else{this.pushStencilMask(maskData)}};MaskManager.prototype.popMask=function popMask(target,maskData){if(maskData.texture){this.popSpriteMask(target,maskData)}else if(this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length){this.popScissorMask(target,maskData)}else{this.popStencilMask(target,maskData)}};MaskManager.prototype.pushSpriteMask=function pushSpriteMask(target,maskData){var alphaMaskFilter=this.alphaMaskPool[this.alphaMaskIndex];if(!alphaMaskFilter){alphaMaskFilter=this.alphaMaskPool[this.alphaMaskIndex]=[new _SpriteMaskFilter2.default(maskData)]}alphaMaskFilter[0].resolution=this.renderer.resolution;alphaMaskFilter[0].maskSprite=maskData;target.filterArea=maskData.getBounds(true);this.renderer.filterManager.pushFilter(target,alphaMaskFilter);this.alphaMaskIndex++};MaskManager.prototype.popSpriteMask=function popSpriteMask(){this.renderer.filterManager.popFilter();this.alphaMaskIndex--};MaskManager.prototype.pushStencilMask=function pushStencilMask(maskData){this.renderer.currentRenderer.stop();this.renderer.stencilManager.pushStencil(maskData)};MaskManager.prototype.popStencilMask=function popStencilMask(){this.renderer.currentRenderer.stop();this.renderer.stencilManager.popStencil()};MaskManager.prototype.pushScissorMask=function pushScissorMask(target,maskData){maskData.renderable=true;var renderTarget=this.renderer._activeRenderTarget;var bounds=maskData.getBounds();bounds.fit(renderTarget.size);maskData.renderable=false;this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var resolution=this.renderer.resolution;this.renderer.gl.scissor(bounds.x*resolution,(renderTarget.root?renderTarget.size.height-bounds.y-bounds.height:bounds.y)*resolution,bounds.width*resolution,bounds.height*resolution);this.scissorRenderTarget=renderTarget;this.scissorData=maskData;this.scissor=true};MaskManager.prototype.popScissorMask=function popScissorMask(){this.scissorRenderTarget=null;this.scissorData=null;this.scissor=false;var gl=this.renderer.gl;gl.disable(gl.SCISSOR_TEST)};return MaskManager}(_WebGLManager3.default);exports.default=MaskManager},{"../filters/spriteMask/SpriteMaskFilter":145,"./WebGLManager":149}],148:[function(require,module,exports){"use strict";exports.__esModule=true;var _WebGLManager2=require("./WebGLManager");var _WebGLManager3=_interopRequireDefault(_WebGLManager2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var StencilManager=function(_WebGLManager){_inherits(StencilManager,_WebGLManager);function StencilManager(renderer){_classCallCheck(this,StencilManager);var _this=_possibleConstructorReturn(this,_WebGLManager.call(this,renderer));_this.stencilMaskStack=null;return _this}StencilManager.prototype.setMaskStack=function setMaskStack(stencilMaskStack){this.stencilMaskStack=stencilMaskStack;var gl=this.renderer.gl;if(stencilMaskStack.length===0){gl.disable(gl.STENCIL_TEST)}else{gl.enable(gl.STENCIL_TEST)}};StencilManager.prototype.pushStencil=function pushStencil(graphics){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);this.renderer._activeRenderTarget.attachStencilBuffer();var gl=this.renderer.gl;var prevMaskCount=this.stencilMaskStack.length;if(prevMaskCount===0){gl.enable(gl.STENCIL_TEST)}this.stencilMaskStack.push(graphics);gl.colorMask(false,false,false,false);gl.stencilFunc(gl.EQUAL,prevMaskCount,this._getBitwiseMask());gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR);this.renderer.plugins.graphics.render(graphics);this._useCurrent()};StencilManager.prototype.popStencil=function popStencil(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var gl=this.renderer.gl;var graphics=this.stencilMaskStack.pop();if(this.stencilMaskStack.length===0){gl.disable(gl.STENCIL_TEST);gl.clear(gl.STENCIL_BUFFER_BIT);gl.clearStencil(0)}else{gl.colorMask(false,false,false,false);gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR);this.renderer.plugins.graphics.render(graphics);this._useCurrent()}};StencilManager.prototype._useCurrent=function _useCurrent(){var gl=this.renderer.gl;gl.colorMask(true,true,true,true);gl.stencilFunc(gl.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask());gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP)};StencilManager.prototype._getBitwiseMask=function _getBitwiseMask(){return(1<<this.stencilMaskStack.length)-1};StencilManager.prototype.destroy=function destroy(){_WebGLManager3.default.prototype.destroy.call(this);this.stencilMaskStack.stencilStack=null};return StencilManager}(_WebGLManager3.default);exports.default=StencilManager},{"./WebGLManager":149}],149:[function(require,module,exports){"use strict";exports.__esModule=true;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var WebGLManager=function(){function WebGLManager(renderer){_classCallCheck(this,WebGLManager);this.renderer=renderer;this.renderer.on("context",this.onContextChange,this)}WebGLManager.prototype.onContextChange=function onContextChange(){};WebGLManager.prototype.destroy=function destroy(){this.renderer.off("context",this.onContextChange,this);this.renderer=null};return WebGLManager}();exports.default=WebGLManager},{}],150:[function(require,module,exports){"use strict";exports.__esModule=true;var _WebGLManager2=require("../managers/WebGLManager");var _WebGLManager3=_interopRequireDefault(_WebGLManager2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ObjectRenderer=function(_WebGLManager){_inherits(ObjectRenderer,_WebGLManager);function ObjectRenderer(){_classCallCheck(this,ObjectRenderer);return _possibleConstructorReturn(this,_WebGLManager.apply(this,arguments))}ObjectRenderer.prototype.start=function start(){};ObjectRenderer.prototype.stop=function stop(){this.flush()};ObjectRenderer.prototype.flush=function flush(){};ObjectRenderer.prototype.render=function render(object){};return ObjectRenderer}(_WebGLManager3.default);exports.default=ObjectRenderer},{"../managers/WebGLManager":149}],151:[function(require,module,exports){"use strict";exports.__esModule=true;var _pixiGlCore=require("pixi-gl-core");var _pixiGlCore2=_interopRequireDefault(_pixiGlCore);var _createIndicesForQuads=require("../../../utils/createIndicesForQuads");var _createIndicesForQuads2=_interopRequireDefault(_createIndicesForQuads);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Quad=function(){function Quad(gl,state){_classCallCheck(this,Quad);this.gl=gl;this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]);this.uvs=new Float32Array([0,0,1,0,1,1,0,1]);this.interleaved=new Float32Array(8*2);for(var i=0;i<4;i++){this.interleaved[i*4]=this.vertices[i*2];this.interleaved[i*4+1]=this.vertices[i*2+1];this.interleaved[i*4+2]=this.uvs[i*2];this.interleaved[i*4+3]=this.uvs[i*2+1]}this.indices=(0,_createIndicesForQuads2.default)(1);this.vertexBuffer=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,this.interleaved,gl.STATIC_DRAW);this.indexBuffer=_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl,this.indices,gl.STATIC_DRAW);this.vao=new _pixiGlCore2.default.VertexArrayObject(gl,state)}Quad.prototype.initVao=function initVao(shader){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,shader.attributes.aVertexPosition,this.gl.FLOAT,false,4*4,0).addAttribute(this.vertexBuffer,shader.attributes.aTextureCoord,this.gl.FLOAT,false,4*4,2*4)};Quad.prototype.map=function map(targetTextureFrame,destinationFrame){var x=0;var y=0;this.uvs[0]=x;this.uvs[1]=y;this.uvs[2]=x+destinationFrame.width/targetTextureFrame.width;this.uvs[3]=y;this.uvs[4]=x+destinationFrame.width/targetTextureFrame.width;this.uvs[5]=y+destinationFrame.height/targetTextureFrame.height;this.uvs[6]=x;this.uvs[7]=y+destinationFrame.height/targetTextureFrame.height;x=destinationFrame.x;y=destinationFrame.y;this.vertices[0]=x;this.vertices[1]=y;this.vertices[2]=x+destinationFrame.width;this.vertices[3]=y;this.vertices[4]=x+destinationFrame.width;this.vertices[5]=y+destinationFrame.height;this.vertices[6]=x;this.vertices[7]=y+destinationFrame.height;return this};Quad.prototype.upload=function upload(){for(var i=0;i<4;i++){this.interleaved[i*4]=this.vertices[i*2];this.interleaved[i*4+1]=this.vertices[i*2+1];this.interleaved[i*4+2]=this.uvs[i*2];this.interleaved[i*4+3]=this.uvs[i*2+1]}this.vertexBuffer.upload(this.interleaved);return this};Quad.prototype.destroy=function destroy(){var gl=this.gl;gl.deleteBuffer(this.vertexBuffer);gl.deleteBuffer(this.indexBuffer)};return Quad}();exports.default=Quad},{"../../../utils/createIndicesForQuads":179,"pixi-gl-core":85}],152:[function(require,module,exports){"use strict";exports.__esModule=true;var _math=require("../../../math");var _const=require("../../../const");var _settings=require("../../../settings");var _settings2=_interopRequireDefault(_settings);var _pixiGlCore=require("pixi-gl-core");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RenderTarget=function(){function RenderTarget(gl,width,height,scaleMode,resolution,root){_classCallCheck(this,RenderTarget);this.gl=gl;this.frameBuffer=null;this.texture=null;this.clearColor=[0,0,0,0];this.size=new _math.Rectangle(0,0,1,1);this.resolution=resolution||_settings2.default.RESOLUTION;this.projectionMatrix=new _math.Matrix;this.transform=null;this.frame=null;this.defaultFrame=new _math.Rectangle;this.destinationFrame=null;this.sourceFrame=null;this.stencilBuffer=null;this.stencilMaskStack=[];this.filterData=null;this.filterPoolKey="";this.scaleMode=scaleMode!==undefined?scaleMode:_settings2.default.SCALE_MODE;this.root=root;if(!this.root){this.frameBuffer=_pixiGlCore.GLFramebuffer.createRGBA(gl,100,100);if(this.scaleMode===_const.SCALE_MODES.NEAREST){this.frameBuffer.texture.enableNearestScaling()}else{this.frameBuffer.texture.enableLinearScaling()}this.texture=this.frameBuffer.texture}else{this.frameBuffer=new _pixiGlCore.GLFramebuffer(gl,100,100);this.frameBuffer.framebuffer=null}this.setFrame();this.resize(width,height)}RenderTarget.prototype.clear=function clear(clearColor){var cc=clearColor||this.clearColor;this.frameBuffer.clear(cc[0],cc[1],cc[2],cc[3])};RenderTarget.prototype.attachStencilBuffer=function attachStencilBuffer(){if(!this.root){this.frameBuffer.enableStencil()}};RenderTarget.prototype.setFrame=function setFrame(destinationFrame,sourceFrame){this.destinationFrame=destinationFrame||this.destinationFrame||this.defaultFrame;this.sourceFrame=sourceFrame||this.sourceFrame||this.destinationFrame};RenderTarget.prototype.activate=function activate(){var gl=this.gl;this.frameBuffer.bind();this.calculateProjection(this.destinationFrame,this.sourceFrame);if(this.transform){this.projectionMatrix.append(this.transform)}if(this.destinationFrame!==this.sourceFrame){gl.enable(gl.SCISSOR_TEST);gl.scissor(this.destinationFrame.x|0,this.destinationFrame.y|0,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)}else{gl.disable(gl.SCISSOR_TEST)}gl.viewport(this.destinationFrame.x|0,this.destinationFrame.y|0,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)};RenderTarget.prototype.calculateProjection=function calculateProjection(destinationFrame,sourceFrame){var pm=this.projectionMatrix;sourceFrame=sourceFrame||destinationFrame;pm.identity();if(!this.root){pm.a=1/destinationFrame.width*2;pm.d=1/destinationFrame.height*2;pm.tx=-1-sourceFrame.x*pm.a;pm.ty=-1-sourceFrame.y*pm.d}else{pm.a=1/destinationFrame.width*2;pm.d=-1/destinationFrame.height*2;pm.tx=-1-sourceFrame.x*pm.a;pm.ty=1-sourceFrame.y*pm.d}};RenderTarget.prototype.resize=function resize(width,height){width=width|0;height=height|0;if(this.size.width===width&&this.size.height===height){return}this.size.width=width;this.size.height=height;this.defaultFrame.width=width;this.defaultFrame.height=height;this.frameBuffer.resize(width*this.resolution,height*this.resolution);var projectionFrame=this.frame||this.size;this.calculateProjection(projectionFrame)};RenderTarget.prototype.destroy=function destroy(){this.frameBuffer.destroy();this.frameBuffer=null;this.texture=null};return RenderTarget}();exports.default=RenderTarget},{"../../../const":102,"../../../math":126,"../../../settings":157,"pixi-gl-core":85}],153:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=checkMaxIfStatmentsInShader;var _pixiGlCore=require("pixi-gl-core");var _pixiGlCore2=_interopRequireDefault(_pixiGlCore);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function checkMaxIfStatmentsInShader(maxIfs,gl){var createTempContext=!gl;if(maxIfs===0){throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`")}if(createTempContext){var tinyCanvas=document.createElement("canvas");tinyCanvas.width=1;tinyCanvas.height=1;gl=_pixiGlCore2.default.createContext(tinyCanvas)}var shader=gl.createShader(gl.FRAGMENT_SHADER);while(true){var fragmentSrc=fragTemplate.replace(/%forloop%/gi,generateIfTestSrc(maxIfs));gl.shaderSource(shader,fragmentSrc);gl.compileShader(shader);if(!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){maxIfs=maxIfs/2|0}else{break}}if(createTempContext){if(gl.getExtension("WEBGL_lose_context")){gl.getExtension("WEBGL_lose_context").loseContext()}}return maxIfs}function generateIfTestSrc(maxIfs){var src="";for(var i=0;i<maxIfs;++i){if(i>0){src+="\nelse "}if(i<maxIfs-1){src+="if(test == "+i+".0){}"}}return src}},{"pixi-gl-core":85}],154:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=mapWebGLBlendModesToPixi;var _const=require("../../../const");function mapWebGLBlendModesToPixi(gl){var array=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];array[_const.BLEND_MODES.NORMAL]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.ADD]=[gl.ONE,gl.DST_ALPHA];array[_const.BLEND_MODES.MULTIPLY]=[gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.SCREEN]=[gl.ONE,gl.ONE_MINUS_SRC_COLOR];array[_const.BLEND_MODES.OVERLAY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.DARKEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.LIGHTEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.COLOR_DODGE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.COLOR_BURN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.HARD_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.SOFT_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.DIFFERENCE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.EXCLUSION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.HUE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.SATURATION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.COLOR]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.LUMINOSITY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.NORMAL_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA];array[_const.BLEND_MODES.ADD_NPM]=[gl.SRC_ALPHA,gl.DST_ALPHA,gl.ONE,gl.DST_ALPHA];array[_const.BLEND_MODES.SCREEN_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_COLOR];return array}},{"../../../const":102}],155:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=mapWebGLDrawModesToPixi;var _const=require("../../../const");function mapWebGLDrawModesToPixi(gl){var object=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};object[_const.DRAW_MODES.POINTS]=gl.POINTS;object[_const.DRAW_MODES.LINES]=gl.LINES;object[_const.DRAW_MODES.LINE_LOOP]=gl.LINE_LOOP;object[_const.DRAW_MODES.LINE_STRIP]=gl.LINE_STRIP;object[_const.DRAW_MODES.TRIANGLES]=gl.TRIANGLES;object[_const.DRAW_MODES.TRIANGLE_STRIP]=gl.TRIANGLE_STRIP;object[_const.DRAW_MODES.TRIANGLE_FAN]=gl.TRIANGLE_FAN;return object}},{"../../../const":102}],156:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=validateContext;function validateContext(gl){var attributes=gl.getContextAttributes();if(!attributes.stencil){console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}}},{}],157:[function(require,module,exports){"use strict";exports.__esModule=true;var _maxRecommendedTextures=require("./utils/maxRecommendedTextures");var _maxRecommendedTextures2=_interopRequireDefault(_maxRecommendedTextures);var _canUploadSameBuffer=require("./utils/canUploadSameBuffer");var _canUploadSameBuffer2=_interopRequireDefault(_canUploadSameBuffer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:true,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,_maxRecommendedTextures2.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:false,forceFXAA:false,autoResize:false,transparent:false,backgroundColor:0,clearBeforeRender:true,preserveDrawingBuffer:false,roundPixels:false,width:800,height:600,legacy:false},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:60*60,GC_MAX_CHECK_COUNT:60*10,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,_canUploadSameBuffer2.default)(),MESH_CANVAS_PADDING:0}},{"./utils/canUploadSameBuffer":178,"./utils/maxRecommendedTextures":183}],158:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _math=require("../math");var _utils=require("../utils");var _const=require("../const");var _Texture=require("../textures/Texture");var _Texture2=_interopRequireDefault(_Texture);var _Container2=require("../display/Container");var _Container3=_interopRequireDefault(_Container2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var tempPoint=new _math.Point;var Sprite=function(_Container){_inherits(Sprite,_Container);function Sprite(texture){_classCallCheck(this,Sprite);var _this=_possibleConstructorReturn(this,_Container.call(this));_this._anchor=new _math.ObservablePoint(_this._onAnchorUpdate,_this);_this._texture=null;_this._width=0;_this._height=0;_this._tint=null;_this._tintRGB=null;_this.tint=16777215;_this.blendMode=_const.BLEND_MODES.NORMAL;_this.shader=null;_this.cachedTint=16777215;_this.texture=texture||_Texture2.default.EMPTY;_this.vertexData=new Float32Array(8);_this.vertexTrimmedData=null;_this._transformID=-1;_this._textureID=-1;_this._transformTrimmedID=-1;_this._textureTrimmedID=-1;_this.pluginName="sprite";return _this}Sprite.prototype._onTextureUpdate=function _onTextureUpdate(){this._textureID=-1;this._textureTrimmedID=-1;this.cachedTint=16777215;if(this._width){this.scale.x=(0,_utils.sign)(this.scale.x)*this._width/this._texture.orig.width}if(this._height){this.scale.y=(0,_utils.sign)(this.scale.y)*this._height/this._texture.orig.height}};Sprite.prototype._onAnchorUpdate=function _onAnchorUpdate(){this._transformID=-1;this._transformTrimmedID=-1};Sprite.prototype.calculateVertices=function calculateVertices(){if(this._transformID===this.transform._worldID&&this._textureID===this._texture._updateID){return}this._transformID=this.transform._worldID;this._textureID=this._texture._updateID;var texture=this._texture;var wt=this.transform.worldTransform;var a=wt.a;var b=wt.b;var c=wt.c;var d=wt.d;var tx=wt.tx;var ty=wt.ty;var vertexData=this.vertexData;var trim=texture.trim;var orig=texture.orig;var anchor=this._anchor;var w0=0;var w1=0;var h0=0;var h1=0;if(trim){w1=trim.x-anchor._x*orig.width;w0=w1+trim.width;h1=trim.y-anchor._y*orig.height;h0=h1+trim.height}else{w1=-anchor._x*orig.width;w0=w1+orig.width;h1=-anchor._y*orig.height;h0=h1+orig.height}vertexData[0]=a*w1+c*h1+tx;vertexData[1]=d*h1+b*w1+ty;vertexData[2]=a*w0+c*h1+tx;vertexData[3]=d*h1+b*w0+ty;vertexData[4]=a*w0+c*h0+tx;vertexData[5]=d*h0+b*w0+ty;vertexData[6]=a*w1+c*h0+tx;vertexData[7]=d*h0+b*w1+ty};Sprite.prototype.calculateTrimmedVertices=function calculateTrimmedVertices(){if(!this.vertexTrimmedData){this.vertexTrimmedData=new Float32Array(8)}else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID){return}this._transformTrimmedID=this.transform._worldID;this._textureTrimmedID=this._texture._updateID;var texture=this._texture;var vertexData=this.vertexTrimmedData;var orig=texture.orig;var anchor=this._anchor;var wt=this.transform.worldTransform;var a=wt.a;var b=wt.b;var c=wt.c;var d=wt.d;var tx=wt.tx;var ty=wt.ty;var w1=-anchor._x*orig.width;var w0=w1+orig.width;var h1=-anchor._y*orig.height;var h0=h1+orig.height;vertexData[0]=a*w1+c*h1+tx;vertexData[1]=d*h1+b*w1+ty;vertexData[2]=a*w0+c*h1+tx;vertexData[3]=d*h1+b*w0+ty;vertexData[4]=a*w0+c*h0+tx;vertexData[5]=d*h0+b*w0+ty;vertexData[6]=a*w1+c*h0+tx;vertexData[7]=d*h0+b*w1+ty};Sprite.prototype._renderWebGL=function _renderWebGL(renderer){this.calculateVertices();renderer.setObjectRenderer(renderer.plugins[this.pluginName]);renderer.plugins[this.pluginName].render(this)};Sprite.prototype._renderCanvas=function _renderCanvas(renderer){renderer.plugins[this.pluginName].render(this)};Sprite.prototype._calculateBounds=function _calculateBounds(){var trim=this._texture.trim;var orig=this._texture.orig;if(!trim||trim.width===orig.width&&trim.height===orig.height){this.calculateVertices();this._bounds.addQuad(this.vertexData)}else{this.calculateTrimmedVertices();this._bounds.addQuad(this.vertexTrimmedData)}};Sprite.prototype.getLocalBounds=function getLocalBounds(rect){if(this.children.length===0){this._bounds.minX=this._texture.orig.width*-this._anchor._x;this._bounds.minY=this._texture.orig.height*-this._anchor._y;this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x);this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y);if(!rect){if(!this._localBoundsRect){this._localBoundsRect=new _math.Rectangle}rect=this._localBoundsRect}return this._bounds.getRectangle(rect)}return _Container.prototype.getLocalBounds.call(this,rect)};Sprite.prototype.containsPoint=function containsPoint(point){this.worldTransform.applyInverse(point,tempPoint);var width=this._texture.orig.width;var height=this._texture.orig.height;var x1=-width*this.anchor.x;var y1=0;if(tempPoint.x>=x1&&tempPoint.x<x1+width){y1=-height*this.anchor.y;if(tempPoint.y>=y1&&tempPoint.y<y1+height){return true}}return false};Sprite.prototype.destroy=function destroy(options){_Container.prototype.destroy.call(this,options);this._texture.off("update",this._onTextureUpdate,this);this._anchor=null;var destroyTexture=typeof options==="boolean"?options:options&&options.texture;if(destroyTexture){var destroyBaseTexture=typeof options==="boolean"?options:options&&options.baseTexture;this._texture.destroy(!!destroyBaseTexture)}this._texture=null;this.shader=null};Sprite.from=function from(source){return new Sprite(_Texture2.default.from(source))};Sprite.fromFrame=function fromFrame(frameId){var texture=_utils.TextureCache[frameId];if(!texture){throw new Error('The frameId "'+frameId+'" does not exist in the texture cache')}return new Sprite(texture)};Sprite.fromImage=function fromImage(imageId,crossorigin,scaleMode){return new Sprite(_Texture2.default.fromImage(imageId,crossorigin,scaleMode))};_createClass(Sprite,[{key:"width",get:function get(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function set(value){var s=(0,_utils.sign)(this.scale.x)||1;this.scale.x=s*value/this._texture.orig.width;this._width=value}},{key:"height",get:function get(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function set(value){var s=(0,_utils.sign)(this.scale.y)||1;this.scale.y=s*value/this._texture.orig.height;this._height=value}},{key:"anchor",get:function get(){return this._anchor},set:function set(value){this._anchor.copy(value)}},{key:"tint",get:function get(){return this._tint},set:function set(value){this._tint=value;this._tintRGB=(value>>16)+(value&65280)+((value&255)<<16)}},{key:"texture",get:function get(){return this._texture},set:function set(value){if(this._texture===value){return}this._texture=value;this.cachedTint=16777215;this._textureID=-1;this._textureTrimmedID=-1;if(value){if(value.baseTexture.hasLoaded){this._onTextureUpdate()}else{value.once("update",this._onTextureUpdate,this)}}}}]);return Sprite}(_Container3.default);exports.default=Sprite},{"../const":102,"../display/Container":104,"../math":126,"../textures/Texture":171,"../utils":181}],159:[function(require,module,exports){"use strict";exports.__esModule=true;var _CanvasRenderer=require("../../renderers/canvas/CanvasRenderer");var _CanvasRenderer2=_interopRequireDefault(_CanvasRenderer);var _const=require("../../const");var _math=require("../../math");var _CanvasTinter=require("./CanvasTinter");var _CanvasTinter2=_interopRequireDefault(_CanvasTinter);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var canvasRenderWorldTransform=new _math.Matrix;var CanvasSpriteRenderer=function(){function CanvasSpriteRenderer(renderer){_classCallCheck(this,CanvasSpriteRenderer);this.renderer=renderer}CanvasSpriteRenderer.prototype.render=function render(sprite){var texture=sprite._texture;var renderer=this.renderer;var width=texture._frame.width;var height=texture._frame.height;var wt=sprite.transform.worldTransform;var dx=0;var dy=0;if(texture.orig.width<=0||texture.orig.height<=0||!texture.baseTexture.source){return}renderer.setBlendMode(sprite.blendMode);if(texture.valid){renderer.context.globalAlpha=sprite.worldAlpha;var smoothingEnabled=texture.baseTexture.scaleMode===_const.SCALE_MODES.LINEAR;if(renderer.smoothProperty&&renderer.context[renderer.smoothProperty]!==smoothingEnabled){renderer.context[renderer.smoothProperty]=smoothingEnabled}if(texture.trim){dx=texture.trim.width/2+texture.trim.x-sprite.anchor.x*texture.orig.width;dy=texture.trim.height/2+texture.trim.y-sprite.anchor.y*texture.orig.height}else{dx=(.5-sprite.anchor.x)*texture.orig.width;dy=(.5-sprite.anchor.y)*texture.orig.height}if(texture.rotate){wt.copy(canvasRenderWorldTransform);wt=canvasRenderWorldTransform;_math.GroupD8.matrixAppendRotationInv(wt,texture.rotate,dx,dy);dx=0;dy=0}dx-=width/2;dy-=height/2;if(renderer.roundPixels){renderer.context.setTransform(wt.a,wt.b,wt.c,wt.d,wt.tx*renderer.resolution|0,wt.ty*renderer.resolution|0);dx=dx|0;dy=dy|0}else{renderer.context.setTransform(wt.a,wt.b,wt.c,wt.d,wt.tx*renderer.resolution,wt.ty*renderer.resolution)}var resolution=texture.baseTexture.resolution;if(sprite.tint!==16777215){if(sprite.cachedTint!==sprite.tint||sprite.tintedTexture.tintId!==sprite._texture._updateID){sprite.cachedTint=sprite.tint;sprite.tintedTexture=_CanvasTinter2.default.getTintedTexture(sprite,sprite.tint)}renderer.context.drawImage(sprite.tintedTexture,0,0,width*resolution,height*resolution,dx*renderer.resolution,dy*renderer.resolution,width*renderer.resolution,height*renderer.resolution)}else{renderer.context.drawImage(texture.baseTexture.source,texture._frame.x*resolution,texture._frame.y*resolution,width*resolution,height*resolution,dx*renderer.resolution,dy*renderer.resolution,width*renderer.resolution,height*renderer.resolution)}}};CanvasSpriteRenderer.prototype.destroy=function destroy(){this.renderer=null};return CanvasSpriteRenderer}();exports.default=CanvasSpriteRenderer;_CanvasRenderer2.default.registerPlugin("sprite",CanvasSpriteRenderer)},{"../../const":102,"../../math":126,"../../renderers/canvas/CanvasRenderer":133,"./CanvasTinter":160}],160:[function(require,module,exports){"use strict";exports.__esModule=true;var _utils=require("../../utils");var _canUseNewCanvasBlendModes=require("../../renderers/canvas/utils/canUseNewCanvasBlendModes");var _canUseNewCanvasBlendModes2=_interopRequireDefault(_canUseNewCanvasBlendModes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CanvasTinter={getTintedTexture:function getTintedTexture(sprite,color){var texture=sprite._texture;color=CanvasTinter.roundColor(color);var stringColor="#"+("00000"+(color|0).toString(16)).substr(-6);texture.tintCache=texture.tintCache||{};var cachedTexture=texture.tintCache[stringColor];var canvas=void 0;if(cachedTexture){if(cachedTexture.tintId===texture._updateID){return texture.tintCache[stringColor]}canvas=texture.tintCache[stringColor]}else{canvas=CanvasTinter.canvas||document.createElement("canvas")}CanvasTinter.tintMethod(texture,color,canvas);canvas.tintId=texture._updateID;if(CanvasTinter.convertTintToImage){var tintImage=new Image;tintImage.src=canvas.toDataURL();texture.tintCache[stringColor]=tintImage}else{texture.tintCache[stringColor]=canvas;CanvasTinter.canvas=null}return canvas},tintWithMultiply:function tintWithMultiply(texture,color,canvas){var context=canvas.getContext("2d");var crop=texture._frame.clone();var resolution=texture.baseTexture.resolution;crop.x*=resolution;crop.y*=resolution;crop.width*=resolution;crop.height*=resolution;canvas.width=Math.ceil(crop.width);canvas.height=Math.ceil(crop.height);context.save();context.fillStyle="#"+("00000"+(color|0).toString(16)).substr(-6);context.fillRect(0,0,crop.width,crop.height);context.globalCompositeOperation="multiply";context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height);context.globalCompositeOperation="destination-atop";context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height);context.restore()},tintWithOverlay:function tintWithOverlay(texture,color,canvas){var context=canvas.getContext("2d");var crop=texture._frame.clone();var resolution=texture.baseTexture.resolution;crop.x*=resolution;crop.y*=resolution;crop.width*=resolution;crop.height*=resolution;canvas.width=Math.ceil(crop.width);canvas.height=Math.ceil(crop.height);context.save();context.globalCompositeOperation="copy";context.fillStyle="#"+("00000"+(color|0).toString(16)).substr(-6);context.fillRect(0,0,crop.width,crop.height);context.globalCompositeOperation="destination-atop";context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height);context.restore()},tintWithPerPixel:function tintWithPerPixel(texture,color,canvas){var context=canvas.getContext("2d");var crop=texture._frame.clone();var resolution=texture.baseTexture.resolution;crop.x*=resolution;crop.y*=resolution;crop.width*=resolution;crop.height*=resolution;canvas.width=Math.ceil(crop.width);canvas.height=Math.ceil(crop.height);context.save();context.globalCompositeOperation="copy";context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height);context.restore();var rgbValues=(0,_utils.hex2rgb)(color);var r=rgbValues[0];var g=rgbValues[1];var b=rgbValues[2];var pixelData=context.getImageData(0,0,crop.width,crop.height);var pixels=pixelData.data;for(var i=0;i<pixels.length;i+=4){pixels[i+0]*=r;pixels[i+1]*=g;pixels[i+2]*=b}context.putImageData(pixelData,0,0)},roundColor:function roundColor(color){var step=CanvasTinter.cacheStepsPerColorChannel;var rgbValues=(0,_utils.hex2rgb)(color);rgbValues[0]=Math.min(255,rgbValues[0]/step*step);rgbValues[1]=Math.min(255,rgbValues[1]/step*step);rgbValues[2]=Math.min(255,rgbValues[2]/step*step);return(0,_utils.rgb2hex)(rgbValues)},cacheStepsPerColorChannel:8,convertTintToImage:false,canUseMultiply:(0,_canUseNewCanvasBlendModes2.default)(),tintMethod:0};CanvasTinter.tintMethod=CanvasTinter.canUseMultiply?CanvasTinter.tintWithMultiply:CanvasTinter.tintWithPerPixel;exports.default=CanvasTinter},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":136,"../../utils":181}],161:[function(require,module,exports){"use strict";exports.__esModule=true;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Buffer=function(){function Buffer(size){_classCallCheck(this,Buffer);this.vertices=new ArrayBuffer(size);this.float32View=new Float32Array(this.vertices);this.uint32View=new Uint32Array(this.vertices)}Buffer.prototype.destroy=function destroy(){this.vertices=null;this.positions=null;this.uvs=null;this.colors=null};return Buffer}();exports.default=Buffer},{}],162:[function(require,module,exports){"use strict";exports.__esModule=true;var _ObjectRenderer2=require("../../renderers/webgl/utils/ObjectRenderer");var _ObjectRenderer3=_interopRequireDefault(_ObjectRenderer2);var _WebGLRenderer=require("../../renderers/webgl/WebGLRenderer");var _WebGLRenderer2=_interopRequireDefault(_WebGLRenderer);var _createIndicesForQuads=require("../../utils/createIndicesForQuads");var _createIndicesForQuads2=_interopRequireDefault(_createIndicesForQuads);var _generateMultiTextureShader=require("./generateMultiTextureShader");var _generateMultiTextureShader2=_interopRequireDefault(_generateMultiTextureShader);var _checkMaxIfStatmentsInShader=require("../../renderers/webgl/utils/checkMaxIfStatmentsInShader");var _checkMaxIfStatmentsInShader2=_interopRequireDefault(_checkMaxIfStatmentsInShader);var _BatchBuffer=require("./BatchBuffer");var _BatchBuffer2=_interopRequireDefault(_BatchBuffer);var _settings=require("../../settings");var _settings2=_interopRequireDefault(_settings);var _utils=require("../../utils");var _pixiGlCore=require("pixi-gl-core");var _pixiGlCore2=_interopRequireDefault(_pixiGlCore);var _bitTwiddle=require("bit-twiddle");var _bitTwiddle2=_interopRequireDefault(_bitTwiddle);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var TICK=0;var TEXTURE_TICK=0;var SpriteRenderer=function(_ObjectRenderer){_inherits(SpriteRenderer,_ObjectRenderer);function SpriteRenderer(renderer){_classCallCheck(this,SpriteRenderer);var _this=_possibleConstructorReturn(this,_ObjectRenderer.call(this,renderer));_this.vertSize=5;_this.vertByteSize=_this.vertSize*4;_this.size=_settings2.default.SPRITE_BATCH_SIZE;_this.buffers=[];for(var i=1;i<=_bitTwiddle2.default.nextPow2(_this.size);i*=2){_this.buffers.push(new _BatchBuffer2.default(i*4*_this.vertByteSize))}_this.indices=(0,_createIndicesForQuads2.default)(_this.size);_this.shader=null;_this.currentIndex=0;_this.groups=[];for(var k=0;k<_this.size;k++){_this.groups[k]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0}}_this.sprites=[];_this.vertexBuffers=[];_this.vaos=[];_this.vaoMax=2;_this.vertexCount=0;_this.renderer.on("prerender",_this.onPrerender,_this);return _this}SpriteRenderer.prototype.onContextChange=function onContextChange(){var gl=this.renderer.gl;if(this.renderer.legacy){this.MAX_TEXTURES=1}else{this.MAX_TEXTURES=Math.min(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS),_settings2.default.SPRITE_MAX_TEXTURES);this.MAX_TEXTURES=(0,_checkMaxIfStatmentsInShader2.default)(this.MAX_TEXTURES,gl)}this.shader=(0,_generateMultiTextureShader2.default)(gl,this.MAX_TEXTURES);this.indexBuffer=_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl,this.indices,gl.STATIC_DRAW);this.renderer.bindVao(null);var attrs=this.shader.attributes;for(var i=0;i<this.vaoMax;i++){var vertexBuffer=this.vertexBuffers[i]=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,null,gl.STREAM_DRAW);var vao=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(vertexBuffer,attrs.aVertexPosition,gl.FLOAT,false,this.vertByteSize,0).addAttribute(vertexBuffer,attrs.aTextureCoord,gl.UNSIGNED_SHORT,true,this.vertByteSize,2*4).addAttribute(vertexBuffer,attrs.aColor,gl.UNSIGNED_BYTE,true,this.vertByteSize,3*4);if(attrs.aTextureId){vao.addAttribute(vertexBuffer,attrs.aTextureId,gl.FLOAT,false,this.vertByteSize,4*4)}this.vaos[i]=vao}this.vao=this.vaos[0];this.currentBlendMode=99999;this.boundTextures=new Array(this.MAX_TEXTURES)};SpriteRenderer.prototype.onPrerender=function onPrerender(){this.vertexCount=0};SpriteRenderer.prototype.render=function render(sprite){if(this.currentIndex>=this.size){this.flush()}if(!sprite._texture._uvs){return}this.sprites[this.currentIndex++]=sprite};SpriteRenderer.prototype.flush=function flush(){if(this.currentIndex===0){return}var gl=this.renderer.gl;var MAX_TEXTURES=this.MAX_TEXTURES;var np2=_bitTwiddle2.default.nextPow2(this.currentIndex);var log2=_bitTwiddle2.default.log2(np2);var buffer=this.buffers[log2];var sprites=this.sprites;var groups=this.groups;var float32View=buffer.float32View;var uint32View=buffer.uint32View;var boundTextures=this.boundTextures;var rendererBoundTextures=this.renderer.boundTextures;var touch=this.renderer.textureGC.count;var index=0;var nextTexture=void 0;var currentTexture=void 0;var groupCount=1;var textureCount=0;var currentGroup=groups[0];var vertexData=void 0;var uvs=void 0;var blendMode=_utils.premultiplyBlendMode[sprites[0]._texture.baseTexture.premultipliedAlpha?1:0][sprites[0].blendMode];currentGroup.textureCount=0;currentGroup.start=0;currentGroup.blend=blendMode;TICK++;var i=void 0;for(i=0;i<MAX_TEXTURES;++i){var bt=rendererBoundTextures[i];if(bt._enabled===TICK){boundTextures[i]=this.renderer.emptyTextures[i];continue}boundTextures[i]=bt;bt._virtalBoundId=i;bt._enabled=TICK}TICK++;for(i=0;i<this.currentIndex;++i){var sprite=sprites[i];sprites[i]=null;nextTexture=sprite._texture.baseTexture;var spriteBlendMode=_utils.premultiplyBlendMode[Number(nextTexture.premultipliedAlpha)][sprite.blendMode];if(blendMode!==spriteBlendMode){blendMode=spriteBlendMode;currentTexture=null;textureCount=MAX_TEXTURES;TICK++}if(currentTexture!==nextTexture){currentTexture=nextTexture;if(nextTexture._enabled!==TICK){if(textureCount===MAX_TEXTURES){TICK++;currentGroup.size=i-currentGroup.start;textureCount=0;currentGroup=groups[groupCount++];currentGroup.blend=blendMode;currentGroup.textureCount=0;currentGroup.start=i}nextTexture.touched=touch;if(nextTexture._virtalBoundId===-1){for(var j=0;j<MAX_TEXTURES;++j){var tIndex=(j+TEXTURE_TICK)%MAX_TEXTURES;var t=boundTextures[tIndex];if(t._enabled!==TICK){TEXTURE_TICK++;t._virtalBoundId=-1;nextTexture._virtalBoundId=tIndex;boundTextures[tIndex]=nextTexture;break}}}nextTexture._enabled=TICK;currentGroup.textureCount++;currentGroup.ids[textureCount]=nextTexture._virtalBoundId;currentGroup.textures[textureCount++]=nextTexture}}vertexData=sprite.vertexData;uvs=sprite._texture._uvs.uvsUint32;if(this.renderer.roundPixels){var resolution=this.renderer.resolution;float32View[index]=(vertexData[0]*resolution|0)/resolution;float32View[index+1]=(vertexData[1]*resolution|0)/resolution;float32View[index+5]=(vertexData[2]*resolution|0)/resolution;float32View[index+6]=(vertexData[3]*resolution|0)/resolution;float32View[index+10]=(vertexData[4]*resolution|0)/resolution;float32View[index+11]=(vertexData[5]*resolution|0)/resolution;float32View[index+15]=(vertexData[6]*resolution|0)/resolution;float32View[index+16]=(vertexData[7]*resolution|0)/resolution}else{float32View[index]=vertexData[0];float32View[index+1]=vertexData[1];float32View[index+5]=vertexData[2];float32View[index+6]=vertexData[3];float32View[index+10]=vertexData[4];float32View[index+11]=vertexData[5];float32View[index+15]=vertexData[6];float32View[index+16]=vertexData[7]}uint32View[index+2]=uvs[0];uint32View[index+7]=uvs[1];uint32View[index+12]=uvs[2];uint32View[index+17]=uvs[3];var alpha=Math.min(sprite.worldAlpha,1);var argb=alpha<1&&nextTexture.premultipliedAlpha?(0,_utils.premultiplyTint)(sprite._tintRGB,alpha):sprite._tintRGB+(alpha*255<<24);uint32View[index+3]=uint32View[index+8]=uint32View[index+13]=uint32View[index+18]=argb;float32View[index+4]=float32View[index+9]=float32View[index+14]=float32View[index+19]=nextTexture._virtalBoundId;index+=20}currentGroup.size=i-currentGroup.start;if(!_settings2.default.CAN_UPLOAD_SAME_BUFFER){if(this.vaoMax<=this.vertexCount){this.vaoMax++;var attrs=this.shader.attributes;var vertexBuffer=this.vertexBuffers[this.vertexCount]=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,null,gl.STREAM_DRAW);var vao=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(vertexBuffer,attrs.aVertexPosition,gl.FLOAT,false,this.vertByteSize,0).addAttribute(vertexBuffer,attrs.aTextureCoord,gl.UNSIGNED_SHORT,true,this.vertByteSize,2*4).addAttribute(vertexBuffer,attrs.aColor,gl.UNSIGNED_BYTE,true,this.vertByteSize,3*4);if(attrs.aTextureId){vao.addAttribute(vertexBuffer,attrs.aTextureId,gl.FLOAT,false,this.vertByteSize,4*4)}this.vaos[this.vertexCount]=vao}this.renderer.bindVao(this.vaos[this.vertexCount]);this.vertexBuffers[this.vertexCount].upload(buffer.vertices,0,false);this.vertexCount++}else{this.vertexBuffers[this.vertexCount].upload(buffer.vertices,0,true)}for(i=0;i<MAX_TEXTURES;++i){rendererBoundTextures[i]._virtalBoundId=-1}for(i=0;i<groupCount;++i){var group=groups[i];var groupTextureCount=group.textureCount;for(var _j=0;_j<groupTextureCount;_j++){currentTexture=group.textures[_j];if(rendererBoundTextures[group.ids[_j]]!==currentTexture){this.renderer.bindTexture(currentTexture,group.ids[_j],true)}currentTexture._virtalBoundId=-1}this.renderer.state.setBlendMode(group.blend);gl.drawElements(gl.TRIANGLES,group.size*6,gl.UNSIGNED_SHORT,group.start*6*2)}this.currentIndex=0};SpriteRenderer.prototype.start=function start(){this.renderer.bindShader(this.shader);if(_settings2.default.CAN_UPLOAD_SAME_BUFFER){this.renderer.bindVao(this.vaos[this.vertexCount]);this.vertexBuffers[this.vertexCount].bind()}};SpriteRenderer.prototype.stop=function stop(){this.flush()};SpriteRenderer.prototype.destroy=function destroy(){for(var i=0;i<this.vaoMax;i++){if(this.vertexBuffers[i]){this.vertexBuffers[i].destroy()}if(this.vaos[i]){this.vaos[i].destroy()}}if(this.indexBuffer){this.indexBuffer.destroy()}this.renderer.off("prerender",this.onPrerender,this);_ObjectRenderer.prototype.destroy.call(this);if(this.shader){this.shader.destroy();this.shader=null}this.vertexBuffers=null;this.vaos=null;this.indexBuffer=null;this.indices=null;this.sprites=null;for(var _i=0;_i<this.buffers.length;++_i){this.buffers[_i].destroy()}};return SpriteRenderer}(_ObjectRenderer3.default);exports.default=SpriteRenderer;_WebGLRenderer2.default.registerPlugin("sprite",SpriteRenderer)},{"../../renderers/webgl/WebGLRenderer":140,"../../renderers/webgl/utils/ObjectRenderer":150,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":153,"../../settings":157,"../../utils":181,"../../utils/createIndicesForQuads":179,"./BatchBuffer":161,"./generateMultiTextureShader":163,"bit-twiddle":3,"pixi-gl-core":85}],163:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=generateMultiTextureShader;var _Shader=require("../../Shader");var _Shader2=_interopRequireDefault(_Shader);var _path=require("path");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var fragTemplate=["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","float textureId = floor(vTextureId+0.5);","%forloop%","gl_FragColor = color * vColor;","}"].join("\n");function generateMultiTextureShader(gl,maxTextures){var vertexSrc="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n";var fragmentSrc=fragTemplate;fragmentSrc=fragmentSrc.replace(/%count%/gi,maxTextures);fragmentSrc=fragmentSrc.replace(/%forloop%/gi,generateSampleSrc(maxTextures));var shader=new _Shader2.default(gl,vertexSrc,fragmentSrc);var sampleValues=[];for(var i=0;i<maxTextures;i++){sampleValues[i]=i}shader.bind();shader.uniforms.uSamplers=sampleValues;return shader}function generateSampleSrc(maxTextures){var src="";src+="\n";src+="\n";for(var i=0;i<maxTextures;i++){if(i>0){src+="\nelse "}if(i<maxTextures-1){src+="if(textureId == "+i+".0)"}src+="\n{";src+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);";src+="\n}"}src+="\n";src+="\n";return src}},{"../../Shader":100,path:78}],164:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _Sprite2=require("../sprites/Sprite");var _Sprite3=_interopRequireDefault(_Sprite2);var _Texture=require("../textures/Texture");var _Texture2=_interopRequireDefault(_Texture);var _math=require("../math");var _utils=require("../utils");var _const=require("../const");var _settings=require("../settings");var _settings2=_interopRequireDefault(_settings);var _TextStyle=require("./TextStyle");var _TextStyle2=_interopRequireDefault(_TextStyle);var _TextMetrics=require("./TextMetrics");var _TextMetrics2=_interopRequireDefault(_TextMetrics);var _trimCanvas=require("../utils/trimCanvas");var _trimCanvas2=_interopRequireDefault(_trimCanvas);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var defaultDestroyOptions={texture:true,children:false,baseTexture:true};var Text=function(_Sprite){_inherits(Text,_Sprite);function Text(text,style,canvas){_classCallCheck(this,Text);canvas=canvas||document.createElement("canvas");canvas.width=3;canvas.height=3;var texture=_Texture2.default.fromCanvas(canvas,_settings2.default.SCALE_MODE,"text");texture.orig=new _math.Rectangle;texture.trim=new _math.Rectangle;var _this=_possibleConstructorReturn(this,_Sprite.call(this,texture));_Texture2.default.addToCache(_this._texture,_this._texture.baseTexture.textureCacheIds[0]);_this.canvas=canvas;_this.context=_this.canvas.getContext("2d");_this.resolution=_settings2.default.RESOLUTION;_this._text=null;_this._style=null;_this._styleListener=null;_this._font="";_this.text=text;_this.style=style;_this.localStyleID=-1;return _this}Text.prototype.updateText=function updateText(respectDirty){var style=this._style;if(this.localStyleID!==style.styleID){this.dirty=true;this.localStyleID=style.styleID}if(!this.dirty&&respectDirty){return}this._font=this._style.toFontString();var context=this.context;var measured=_TextMetrics2.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas);var width=measured.width;var height=measured.height;var lines=measured.lines;var lineHeight=measured.lineHeight;var lineWidths=measured.lineWidths;var maxLineWidth=measured.maxLineWidth;var fontProperties=measured.fontProperties;this.canvas.width=Math.ceil((Math.max(1,width)+style.padding*2)*this.resolution);this.canvas.height=Math.ceil((Math.max(1,height)+style.padding*2)*this.resolution);context.scale(this.resolution,this.resolution);context.clearRect(0,0,this.canvas.width,this.canvas.height);context.font=this._font;context.strokeStyle=style.stroke;context.lineWidth=style.strokeThickness;context.textBaseline=style.textBaseline;context.lineJoin=style.lineJoin;context.miterLimit=style.miterLimit;var linePositionX=void 0;var linePositionY=void 0;if(style.dropShadow){context.fillStyle=style.dropShadowColor;context.globalAlpha=style.dropShadowAlpha;context.shadowBlur=style.dropShadowBlur;if(style.dropShadowBlur>0){context.shadowColor=style.dropShadowColor}var xShadowOffset=Math.cos(style.dropShadowAngle)*style.dropShadowDistance;var yShadowOffset=Math.sin(style.dropShadowAngle)*style.dropShadowDistance;for(var i=0;i<lines.length;i++){linePositionX=style.strokeThickness/2;linePositionY=style.strokeThickness/2+i*lineHeight+fontProperties.ascent;if(style.align==="right"){linePositionX+=maxLineWidth-lineWidths[i]}else if(style.align==="center"){linePositionX+=(maxLineWidth-lineWidths[i])/2}if(style.fill){this.drawLetterSpacing(lines[i],linePositionX+xShadowOffset+style.padding,linePositionY+yShadowOffset+style.padding);if(style.stroke&&style.strokeThickness){context.strokeStyle=style.dropShadowColor;this.drawLetterSpacing(lines[i],linePositionX+xShadowOffset+style.padding,linePositionY+yShadowOffset+style.padding,true);context.strokeStyle=style.stroke}}}}context.shadowBlur=0;context.globalAlpha=1;context.fillStyle=this._generateFillStyle(style,lines);for(var _i=0;_i<lines.length;_i++){linePositionX=style.strokeThickness/2;linePositionY=style.strokeThickness/2+_i*lineHeight+fontProperties.ascent;if(style.align==="right"){linePositionX+=maxLineWidth-lineWidths[_i]}else if(style.align==="center"){linePositionX+=(maxLineWidth-lineWidths[_i])/2}if(style.stroke&&style.strokeThickness){this.drawLetterSpacing(lines[_i],linePositionX+style.padding,linePositionY+style.padding,true)}if(style.fill){this.drawLetterSpacing(lines[_i],linePositionX+style.padding,linePositionY+style.padding)}}this.updateTexture()};Text.prototype.drawLetterSpacing=function drawLetterSpacing(text,x,y){var isStroke=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var style=this._style;var letterSpacing=style.letterSpacing;if(letterSpacing===0){if(isStroke){this.context.strokeText(text,x,y)}else{this.context.fillText(text,x,y)}return}var characters=String.prototype.split.call(text,"");var currentPosition=x;var index=0;var current="";while(index<text.length){current=characters[index++];if(isStroke){this.context.strokeText(current,currentPosition,y)}else{this.context.fillText(current,currentPosition,y)}currentPosition+=this.context.measureText(current).width+letterSpacing}};Text.prototype.updateTexture=function updateTexture(){var canvas=this.canvas;if(this._style.trim){var trimmed=(0,_trimCanvas2.default)(canvas);canvas.width=trimmed.width;canvas.height=trimmed.height;this.context.putImageData(trimmed.data,0,0)}var texture=this._texture;var style=this._style;var padding=style.trim?0:style.padding;var baseTexture=texture.baseTexture;baseTexture.hasLoaded=true;baseTexture.resolution=this.resolution;baseTexture.realWidth=canvas.width;baseTexture.realHeight=canvas.height;baseTexture.width=canvas.width/this.resolution;baseTexture.height=canvas.height/this.resolution;texture.trim.width=texture._frame.width=canvas.width/this.resolution;texture.trim.height=texture._frame.height=canvas.height/this.resolution;texture.trim.x=-padding;texture.trim.y=-padding;texture.orig.width=texture._frame.width-padding*2;texture.orig.height=texture._frame.height-padding*2;this._onTextureUpdate();baseTexture.emit("update",baseTexture);this.dirty=false};Text.prototype.renderWebGL=function renderWebGL(renderer){if(this.resolution!==renderer.resolution){this.resolution=renderer.resolution;this.dirty=true}this.updateText(true);_Sprite.prototype.renderWebGL.call(this,renderer)};Text.prototype._renderCanvas=function _renderCanvas(renderer){if(this.resolution!==renderer.resolution){this.resolution=renderer.resolution;this.dirty=true}this.updateText(true);_Sprite.prototype._renderCanvas.call(this,renderer)};Text.prototype.getLocalBounds=function getLocalBounds(rect){this.updateText(true);return _Sprite.prototype.getLocalBounds.call(this,rect)};Text.prototype._calculateBounds=function _calculateBounds(){this.updateText(true);this.calculateVertices();this._bounds.addQuad(this.vertexData)};Text.prototype._onStyleChange=function _onStyleChange(){this.dirty=true};Text.prototype._generateFillStyle=function _generateFillStyle(style,lines){if(!Array.isArray(style.fill)){return style.fill}if(navigator.isCocoonJS){return style.fill[0]}var gradient=void 0;var totalIterations=void 0;var currentIteration=void 0;var stop=void 0;var width=this.canvas.width/this.resolution;var height=this.canvas.height/this.resolution;var fill=style.fill.slice();var fillGradientStops=style.fillGradientStops.slice();if(!fillGradientStops.length){var lengthPlus1=fill.length+1;for(var i=1;i<lengthPlus1;++i){fillGradientStops.push(i/lengthPlus1)}}fill.unshift(style.fill[0]);fillGradientStops.unshift(0);fill.push(style.fill[style.fill.length-1]);fillGradientStops.push(1);if(style.fillGradientType===_const.TEXT_GRADIENT.LINEAR_VERTICAL){gradient=this.context.createLinearGradient(width/2,0,width/2,height);totalIterations=(fill.length+1)*lines.length;currentIteration=0;for(var _i2=0;_i2<lines.length;_i2++){currentIteration+=1;for(var j=0;j<fill.length;j++){if(typeof fillGradientStops[j]==="number"){stop=fillGradientStops[j]/lines.length+_i2/lines.length}else{stop=currentIteration/totalIterations}gradient.addColorStop(stop,fill[j]);currentIteration++}}}else{gradient=this.context.createLinearGradient(0,height/2,width,height/2);totalIterations=fill.length+1;currentIteration=1;for(var _i3=0;_i3<fill.length;_i3++){if(typeof fillGradientStops[_i3]==="number"){stop=fillGradientStops[_i3]}else{stop=currentIteration/totalIterations}gradient.addColorStop(stop,fill[_i3]);currentIteration++}}return gradient};Text.prototype.destroy=function destroy(options){if(typeof options==="boolean"){options={children:options}}options=Object.assign({},defaultDestroyOptions,options);_Sprite.prototype.destroy.call(this,options);this.context=null;this.canvas=null;this._style=null};_createClass(Text,[{key:"width",get:function get(){this.updateText(true);return Math.abs(this.scale.x)*this._texture.orig.width},set:function set(value){this.updateText(true);var s=(0,_utils.sign)(this.scale.x)||1;this.scale.x=s*value/this._texture.orig.width;this._width=value}},{key:"height",get:function get(){this.updateText(true);return Math.abs(this.scale.y)*this._texture.orig.height},set:function set(value){this.updateText(true);var s=(0,_utils.sign)(this.scale.y)||1;this.scale.y=s*value/this._texture.orig.height;this._height=value}},{key:"style",get:function get(){return this._style},set:function set(style){style=style||{};if(style instanceof _TextStyle2.default){this._style=style}else{this._style=new _TextStyle2.default(style)}this.localStyleID=-1;this.dirty=true}},{key:"text",get:function get(){return this._text},set:function set(text){text=String(text===""||text===null||text===undefined?" ":text);if(this._text===text){return}this._text=text;this.dirty=true}}]);return Text}(_Sprite3.default);exports.default=Text},{"../const":102,"../math":126,"../settings":157,"../sprites/Sprite":158,"../textures/Texture":171,"../utils":181,"../utils/trimCanvas":186,"./TextMetrics":165,"./TextStyle":166}],165:[function(require,module,exports){"use strict";exports.__esModule=true;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TextMetrics=function(){function TextMetrics(text,style,width,height,lines,lineWidths,lineHeight,maxLineWidth,fontProperties){_classCallCheck(this,TextMetrics);this.text=text;this.style=style;this.width=width;this.height=height;this.lines=lines;this.lineWidths=lineWidths;this.lineHeight=lineHeight;this.maxLineWidth=maxLineWidth;this.fontProperties=fontProperties}TextMetrics.measureText=function measureText(text,style,wordWrap){var canvas=arguments.length>3&&arguments[3]!==undefined?arguments[3]:TextMetrics._canvas;wordWrap=wordWrap||style.wordWrap;var font=style.toFontString();var fontProperties=TextMetrics.measureFont(font);var context=canvas.getContext("2d");context.font=font;var outputText=wordWrap?TextMetrics.wordWrap(text,style,canvas):text;var lines=outputText.split(/(?:\r\n|\r|\n)/);var lineWidths=new Array(lines.length);var maxLineWidth=0;for(var i=0;i<lines.length;i++){var lineWidth=context.measureText(lines[i]).width+(lines[i].length-1)*style.letterSpacing;lineWidths[i]=lineWidth;maxLineWidth=Math.max(maxLineWidth,lineWidth)}var width=maxLineWidth+style.strokeThickness;if(style.dropShadow){width+=style.dropShadowDistance}var lineHeight=style.lineHeight||fontProperties.fontSize+style.strokeThickness;var height=Math.max(lineHeight,fontProperties.fontSize+style.strokeThickness)+(lines.length-1)*(lineHeight+style.leading);if(style.dropShadow){height+=style.dropShadowDistance}return new TextMetrics(text,style,width,height,lines,lineWidths,lineHeight+style.leading,maxLineWidth,fontProperties)};TextMetrics.wordWrap=function wordWrap(text,style){var canvas=arguments.length>2&&arguments[2]!==undefined?arguments[2]:TextMetrics._canvas;var context=canvas.getContext("2d");var width=0;var line="";var lines="";var cache={};var letterSpacing=style.letterSpacing,whiteSpace=style.whiteSpace;var collapseSpaces=TextMetrics.collapseSpaces(whiteSpace);var collapseNewlines=TextMetrics.collapseNewlines(whiteSpace);var canPrependSpaces=!collapseSpaces;var wordWrapWidth=style.wordWrapWidth+letterSpacing;var tokens=TextMetrics.tokenize(text);for(var i=0;i<tokens.length;i++){var token=tokens[i];if(TextMetrics.isNewline(token)){if(!collapseNewlines){lines+=TextMetrics.addLine(line);canPrependSpaces=!collapseSpaces;line="";width=0;continue}token=" "}if(collapseSpaces){var currIsBreakingSpace=TextMetrics.isBreakingSpace(token);var lastIsBreakingSpace=TextMetrics.isBreakingSpace(line[line.length-1]);if(currIsBreakingSpace&&lastIsBreakingSpace){continue}}var tokenWidth=TextMetrics.getFromCache(token,letterSpacing,cache,context);if(tokenWidth>wordWrapWidth){if(line!==""){lines+=TextMetrics.addLine(line);line="";width=0}if(TextMetrics.canBreakWords(token,style.breakWords)){var characters=token.split("");for(var j=0;j<characters.length;j++){var char=characters[j];var k=1;while(characters[j+k]){var nextChar=characters[j+k];var lastChar=char[char.length-1];if(!TextMetrics.canBreakChars(lastChar,nextChar,token,j,style.breakWords)){char+=nextChar}else{break}k++}j+=char.length-1;var characterWidth=TextMetrics.getFromCache(char,letterSpacing,cache,context);if(characterWidth+width>wordWrapWidth){lines+=TextMetrics.addLine(line);canPrependSpaces=false;line="";width=0}line+=char;width+=characterWidth}}else{if(line.length>0){lines+=TextMetrics.addLine(line);line="";width=0}var isLastToken=i===tokens.length-1;lines+=TextMetrics.addLine(token,!isLastToken);canPrependSpaces=false;line="";width=0}}else{if(tokenWidth+width>wordWrapWidth){canPrependSpaces=false;lines+=TextMetrics.addLine(line);line="";width=0}if(line.length>0||!TextMetrics.isBreakingSpace(token)||canPrependSpaces){line+=token;width+=tokenWidth}}}lines+=TextMetrics.addLine(line,false);return lines};TextMetrics.addLine=function addLine(line){var newLine=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;line=TextMetrics.trimRight(line);line=newLine?line+"\n":line;return line};TextMetrics.getFromCache=function getFromCache(key,letterSpacing,cache,context){var width=cache[key];if(width===undefined){var spacing=key.length*letterSpacing;width=context.measureText(key).width+spacing;cache[key]=width}return width};TextMetrics.collapseSpaces=function collapseSpaces(whiteSpace){return whiteSpace==="normal"||whiteSpace==="pre-line"};TextMetrics.collapseNewlines=function collapseNewlines(whiteSpace){return whiteSpace==="normal"};TextMetrics.trimRight=function trimRight(text){if(typeof text!=="string"){return""}for(var i=text.length-1;i>=0;i--){var char=text[i];if(!TextMetrics.isBreakingSpace(char)){break}text=text.slice(0,-1)}return text};TextMetrics.isNewline=function isNewline(char){if(typeof char!=="string"){return false}return TextMetrics._newlines.indexOf(char.charCodeAt(0))>=0};TextMetrics.isBreakingSpace=function isBreakingSpace(char){if(typeof char!=="string"){return false}return TextMetrics._breakingSpaces.indexOf(char.charCodeAt(0))>=0};TextMetrics.tokenize=function tokenize(text){var tokens=[];var token="";if(typeof text!=="string"){return tokens}for(var i=0;i<text.length;i++){var char=text[i];if(TextMetrics.isBreakingSpace(char)||TextMetrics.isNewline(char)){if(token!==""){tokens.push(token);token=""}tokens.push(char);continue}token+=char}if(token!==""){tokens.push(token)}return tokens};TextMetrics.canBreakWords=function canBreakWords(token,breakWords){return breakWords};TextMetrics.canBreakChars=function canBreakChars(char,nextChar,token,index,breakWords){return true};TextMetrics.measureFont=function measureFont(font){if(TextMetrics._fonts[font]){return TextMetrics._fonts[font]}var properties={};var canvas=TextMetrics._canvas;var context=TextMetrics._context;context.font=font;var metricsString=TextMetrics.METRICS_STRING+TextMetrics.BASELINE_SYMBOL;var width=Math.ceil(context.measureText(metricsString).width);var baseline=Math.ceil(context.measureText(TextMetrics.BASELINE_SYMBOL).width);var height=2*baseline;baseline=baseline*TextMetrics.BASELINE_MULTIPLIER|0;canvas.width=width;canvas.height=height;context.fillStyle="#f00";context.fillRect(0,0,width,height);context.font=font;context.textBaseline="alphabetic";context.fillStyle="#000";context.fillText(metricsString,0,baseline);var imagedata=context.getImageData(0,0,width,height).data;var pixels=imagedata.length;var line=width*4;var i=0;var idx=0;var stop=false;for(i=0;i<baseline;++i){for(var j=0;j<line;j+=4){if(imagedata[idx+j]!==255){stop=true;break}}if(!stop){idx+=line}else{break}}properties.ascent=baseline-i;idx=pixels-line;stop=false;for(i=height;i>baseline;--i){for(var _j=0;_j<line;_j+=4){if(imagedata[idx+_j]!==255){stop=true;break}}if(!stop){idx-=line}else{break}}properties.descent=i-baseline;properties.fontSize=properties.ascent+properties.descent;TextMetrics._fonts[font]=properties;return properties};TextMetrics.clearMetrics=function clearMetrics(){var font=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";if(font){delete TextMetrics._fonts[font]}else{TextMetrics._fonts={}}};return TextMetrics}();exports.default=TextMetrics;var canvas=document.createElement("canvas");canvas.width=canvas.height=10;TextMetrics._canvas=canvas;TextMetrics._context=canvas.getContext("2d");TextMetrics._fonts={};TextMetrics.METRICS_STRING="|Éq";TextMetrics.BASELINE_SYMBOL="M";TextMetrics.BASELINE_MULTIPLIER=1.4;TextMetrics._newlines=[10,13];TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},{}],166:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _const=require("../const");var _utils=require("../utils");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var defaultStyle={align:"left",breakWords:false,dropShadow:false,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:_const.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:false,whiteSpace:"pre",wordWrap:false,wordWrapWidth:100,leading:0};var TextStyle=function(){function TextStyle(style){_classCallCheck(this,TextStyle);this.styleID=0;this.reset();deepCopyProperties(this,style,style)}TextStyle.prototype.clone=function clone(){var clonedProperties={};deepCopyProperties(clonedProperties,this,defaultStyle);return new TextStyle(clonedProperties)};TextStyle.prototype.reset=function reset(){deepCopyProperties(this,defaultStyle,defaultStyle)};TextStyle.prototype.toFontString=function toFontString(){var fontSizeString=typeof this.fontSize==="number"?this.fontSize+"px":this.fontSize;var fontFamilies=this.fontFamily;if(!Array.isArray(this.fontFamily)){fontFamilies=this.fontFamily.split(",")}for(var i=fontFamilies.length-1;i>=0;i--){var fontFamily=fontFamilies[i].trim();if(!/([\"\'])[^\'\"]+\1/.test(fontFamily)){fontFamily='"'+fontFamily+'"'}fontFamilies[i]=fontFamily}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+fontSizeString+" "+fontFamilies.join(",")};_createClass(TextStyle,[{key:"align",get:function get(){return this._align},set:function set(align){if(this._align!==align){this._align=align;this.styleID++}}},{key:"breakWords",get:function get(){return this._breakWords},set:function set(breakWords){if(this._breakWords!==breakWords){this._breakWords=breakWords;this.styleID++}}},{key:"dropShadow",get:function get(){return this._dropShadow},set:function set(dropShadow){if(this._dropShadow!==dropShadow){this._dropShadow=dropShadow;this.styleID++}}},{key:"dropShadowAlpha",get:function get(){return this._dropShadowAlpha},set:function set(dropShadowAlpha){if(this._dropShadowAlpha!==dropShadowAlpha){this._dropShadowAlpha=dropShadowAlpha;this.styleID++}}},{key:"dropShadowAngle",get:function get(){return this._dropShadowAngle},set:function set(dropShadowAngle){if(this._dropShadowAngle!==dropShadowAngle){this._dropShadowAngle=dropShadowAngle;this.styleID++}}},{key:"dropShadowBlur",get:function get(){return this._dropShadowBlur},set:function set(dropShadowBlur){if(this._dropShadowBlur!==dropShadowBlur){this._dropShadowBlur=dropShadowBlur;this.styleID++}}},{key:"dropShadowColor",get:function get(){return this._dropShadowColor},set:function set(dropShadowColor){var outputColor=getColor(dropShadowColor);if(this._dropShadowColor!==outputColor){this._dropShadowColor=outputColor;this.styleID++}}},{key:"dropShadowDistance",get:function get(){return this._dropShadowDistance},set:function set(dropShadowDistance){if(this._dropShadowDistance!==dropShadowDistance){this._dropShadowDistance=dropShadowDistance;this.styleID++}}},{key:"fill",get:function get(){return this._fill},set:function set(fill){var outputColor=getColor(fill);if(this._fill!==outputColor){this._fill=outputColor;this.styleID++}}},{key:"fillGradientType",get:function get(){return this._fillGradientType},set:function set(fillGradientType){if(this._fillGradientType!==fillGradientType){this._fillGradientType=fillGradientType;this.styleID++}}},{key:"fillGradientStops",get:function get(){return this._fillGradientStops},set:function set(fillGradientStops){if(!areArraysEqual(this._fillGradientStops,fillGradientStops)){this._fillGradientStops=fillGradientStops;this.styleID++}}},{key:"fontFamily",get:function get(){return this._fontFamily},set:function set(fontFamily){if(this.fontFamily!==fontFamily){this._fontFamily=fontFamily;this.styleID++}}},{key:"fontSize",get:function get(){return this._fontSize},set:function set(fontSize){if(this._fontSize!==fontSize){this._fontSize=fontSize;this.styleID++}}},{key:"fontStyle",get:function get(){return this._fontStyle},set:function set(fontStyle){if(this._fontStyle!==fontStyle){this._fontStyle=fontStyle;this.styleID++}}},{key:"fontVariant",get:function get(){return this._fontVariant},set:function set(fontVariant){if(this._fontVariant!==fontVariant){this._fontVariant=fontVariant;this.styleID++}}},{key:"fontWeight",get:function get(){return this._fontWeight},set:function set(fontWeight){if(this._fontWeight!==fontWeight){this._fontWeight=fontWeight;this.styleID++}}},{key:"letterSpacing",get:function get(){return this._letterSpacing},set:function set(letterSpacing){if(this._letterSpacing!==letterSpacing){this._letterSpacing=letterSpacing;this.styleID++}}},{key:"lineHeight",get:function get(){return this._lineHeight},set:function set(lineHeight){if(this._lineHeight!==lineHeight){this._lineHeight=lineHeight;this.styleID++}}},{key:"leading",get:function get(){return this._leading},set:function set(leading){if(this._leading!==leading){this._leading=leading;this.styleID++}}},{key:"lineJoin",get:function get(){return this._lineJoin},set:function set(lineJoin){if(this._lineJoin!==lineJoin){this._lineJoin=lineJoin;this.styleID++}}},{key:"miterLimit",get:function get(){return this._miterLimit},set:function set(miterLimit){if(this._miterLimit!==miterLimit){this._miterLimit=miterLimit;this.styleID++}}},{key:"padding",get:function get(){return this._padding},set:function set(padding){if(this._padding!==padding){this._padding=padding;this.styleID++}}},{key:"stroke",get:function get(){return this._stroke},set:function set(stroke){var outputColor=getColor(stroke);if(this._stroke!==outputColor){this._stroke=outputColor;this.styleID++}}},{key:"strokeThickness",get:function get(){return this._strokeThickness},set:function set(strokeThickness){if(this._strokeThickness!==strokeThickness){this._strokeThickness=strokeThickness;this.styleID++}}},{key:"textBaseline",get:function get(){return this._textBaseline},set:function set(textBaseline){if(this._textBaseline!==textBaseline){this._textBaseline=textBaseline;this.styleID++}}},{key:"trim",get:function get(){return this._trim},set:function set(trim){if(this._trim!==trim){this._trim=trim;this.styleID++}}},{key:"whiteSpace",get:function get(){return this._whiteSpace},set:function set(whiteSpace){if(this._whiteSpace!==whiteSpace){this._whiteSpace=whiteSpace;this.styleID++}}},{key:"wordWrap",get:function get(){return this._wordWrap},set:function set(wordWrap){if(this._wordWrap!==wordWrap){this._wordWrap=wordWrap;this.styleID++}}},{key:"wordWrapWidth",get:function get(){return this._wordWrapWidth},set:function set(wordWrapWidth){if(this._wordWrapWidth!==wordWrapWidth){this._wordWrapWidth=wordWrapWidth;this.styleID++}}}]);return TextStyle}();exports.default=TextStyle;function getSingleColor(color){if(typeof color==="number"){return(0,_utils.hex2string)(color)}else if(typeof color==="string"){if(color.indexOf("0x")===0){color=color.replace("0x","#")}}return color}function getColor(color){if(!Array.isArray(color)){return getSingleColor(color)}else{for(var i=0;i<color.length;++i){color[i]=getSingleColor(color[i])}return color}}function areArraysEqual(array1,array2){if(!Array.isArray(array1)||!Array.isArray(array2)){return false}if(array1.length!==array2.length){return false}for(var i=0;i<array1.length;++i){if(array1[i]!==array2[i]){return false}}return true}function deepCopyProperties(target,source,propertyObj){for(var prop in propertyObj){if(Array.isArray(source[prop])){target[prop]=source[prop].slice()}else{target[prop]=source[prop]}}}},{"../const":102,"../utils":181}],167:[function(require,module,exports){"use strict";exports.__esModule=true;var _BaseTexture2=require("./BaseTexture");var _BaseTexture3=_interopRequireDefault(_BaseTexture2);var _settings=require("../settings");var _settings2=_interopRequireDefault(_settings);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var BaseRenderTexture=function(_BaseTexture){_inherits(BaseRenderTexture,_BaseTexture);function BaseRenderTexture(){var width=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;var height=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100;var scaleMode=arguments[2];var resolution=arguments[3];_classCallCheck(this,BaseRenderTexture);var _this=_possibleConstructorReturn(this,_BaseTexture.call(this,null,scaleMode));_this.resolution=resolution||_settings2.default.RESOLUTION;_this.width=Math.ceil(width);_this.height=Math.ceil(height);_this.realWidth=_this.width*_this.resolution;_this.realHeight=_this.height*_this.resolution;_this.scaleMode=scaleMode!==undefined?scaleMode:_settings2.default.SCALE_MODE;_this.hasLoaded=true;_this._glRenderTargets={};_this._canvasRenderTarget=null;_this.valid=false;return _this}BaseRenderTexture.prototype.resize=function resize(width,height){width=Math.ceil(width);height=Math.ceil(height);if(width===this.width&&height===this.height){return}this.valid=width>0&&height>0;this.width=width;this.height=height;this.realWidth=this.width*this.resolution;this.realHeight=this.height*this.resolution;if(!this.valid){return}this.emit("update",this)};BaseRenderTexture.prototype.destroy=function destroy(){_BaseTexture.prototype.destroy.call(this,true);this.renderer=null};return BaseRenderTexture}(_BaseTexture3.default);exports.default=BaseRenderTexture},{"../settings":157,"./BaseTexture":168}],168:[function(require,module,exports){"use strict";exports.__esModule=true;var _utils=require("../utils");var _settings=require("../settings");var _settings2=_interopRequireDefault(_settings);var _eventemitter=require("eventemitter3");var _eventemitter2=_interopRequireDefault(_eventemitter);var _determineCrossOrigin=require("../utils/determineCrossOrigin");var _determineCrossOrigin2=_interopRequireDefault(_determineCrossOrigin);var _bitTwiddle=require("bit-twiddle");var _bitTwiddle2=_interopRequireDefault(_bitTwiddle);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var BaseTexture=function(_EventEmitter){_inherits(BaseTexture,_EventEmitter);function BaseTexture(source,scaleMode,resolution){_classCallCheck(this,BaseTexture);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));_this.uid=(0,_utils.uid)();_this.touched=0;_this.resolution=resolution||_settings2.default.RESOLUTION;_this.width=100;_this.height=100;_this.realWidth=100;_this.realHeight=100;_this.scaleMode=scaleMode!==undefined?scaleMode:_settings2.default.SCALE_MODE;_this.hasLoaded=false;_this.isLoading=false;_this.source=null;_this.origSource=null;_this.imageType=null;_this.sourceScale=1;_this.premultipliedAlpha=true;_this.imageUrl=null;_this.isPowerOfTwo=false;_this.mipmap=_settings2.default.MIPMAP_TEXTURES;_this.wrapMode=_settings2.default.WRAP_MODE;_this._glTextures={};_this._enabled=0;_this._virtalBoundId=-1;_this._destroyed=false;_this.textureCacheIds=[];if(source){_this.loadSource(source)}return _this}BaseTexture.prototype.update=function update(){if(this.imageType!=="svg"){this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width;this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height;this._updateDimensions()}this.emit("update",this)};BaseTexture.prototype._updateDimensions=function _updateDimensions(){this.width=this.realWidth/this.resolution;this.height=this.realHeight/this.resolution;this.isPowerOfTwo=_bitTwiddle2.default.isPow2(this.realWidth)&&_bitTwiddle2.default.isPow2(this.realHeight)};BaseTexture.prototype.loadSource=function loadSource(source){var wasLoading=this.isLoading;this.hasLoaded=false;this.isLoading=false;if(wasLoading&&this.source){this.source.onload=null;this.source.onerror=null}var firstSourceLoaded=!this.source;this.source=source;if((source.src&&source.complete||source.getContext)&&source.width&&source.height){this._updateImageType();if(this.imageType==="svg"){this._loadSvgSource()}else{this._sourceLoaded()}if(firstSourceLoaded){this.emit("loaded",this)}}else if(!source.getContext){this.isLoading=true;var scope=this;source.onload=function(){scope._updateImageType();source.onload=null;source.onerror=null;if(!scope.isLoading){return}scope.isLoading=false;scope._sourceLoaded();if(scope.imageType==="svg"){scope._loadSvgSource();return}scope.emit("loaded",scope)};source.onerror=function(){source.onload=null;source.onerror=null;if(!scope.isLoading){return}scope.isLoading=false;scope.emit("error",scope)};if(source.complete&&source.src){source.onload=null;source.onerror=null;if(scope.imageType==="svg"){scope._loadSvgSource();return}this.isLoading=false;if(source.width&&source.height){this._sourceLoaded();if(wasLoading){this.emit("loaded",this)}}else if(wasLoading){this.emit("error",this)}}}};BaseTexture.prototype._updateImageType=function _updateImageType(){if(!this.imageUrl){return}var dataUri=(0,_utils.decomposeDataUri)(this.imageUrl);var imageType=void 0;if(dataUri&&dataUri.mediaType==="image"){var firstSubType=dataUri.subType.split("+")[0];imageType=(0,_utils.getUrlFileExtension)("."+firstSubType);if(!imageType){throw new Error("Invalid image type in data URI.")}}else{imageType=(0,_utils.getUrlFileExtension)(this.imageUrl);if(!imageType){imageType="png"}}this.imageType=imageType};BaseTexture.prototype._loadSvgSource=function _loadSvgSource(){if(this.imageType!=="svg"){return}var dataUri=(0,_utils.decomposeDataUri)(this.imageUrl);if(dataUri){this._loadSvgSourceUsingDataUri(dataUri)}else{this._loadSvgSourceUsingXhr()}};BaseTexture.prototype._loadSvgSourceUsingDataUri=function _loadSvgSourceUsingDataUri(dataUri){var svgString=void 0;if(dataUri.encoding==="base64"){if(!atob){throw new Error("Your browser doesn't support base64 conversions.")}svgString=atob(dataUri.data)}else{svgString=dataUri.data}this._loadSvgSourceUsingString(svgString)};BaseTexture.prototype._loadSvgSourceUsingXhr=function _loadSvgSourceUsingXhr(){var _this2=this;var svgXhr=new XMLHttpRequest;svgXhr.onload=function(){if(svgXhr.readyState!==svgXhr.DONE||svgXhr.status!==200){throw new Error("Failed to load SVG using XHR.")}_this2._loadSvgSourceUsingString(svgXhr.response)};svgXhr.onerror=function(){return _this2.emit("error",_this2)};svgXhr.open("GET",this.imageUrl,true);svgXhr.send()};BaseTexture.prototype._loadSvgSourceUsingString=function _loadSvgSourceUsingString(svgString){var svgSize=(0,_utils.getSvgSize)(svgString);var svgWidth=svgSize.width;var svgHeight=svgSize.height;if(!svgWidth||!svgHeight){throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.")}this.realWidth=Math.round(svgWidth*this.sourceScale);this.realHeight=Math.round(svgHeight*this.sourceScale);this._updateDimensions();var canvas=document.createElement("canvas");canvas.width=this.realWidth;canvas.height=this.realHeight;canvas._pixiId="canvas_"+(0,_utils.uid)();canvas.getContext("2d").drawImage(this.source,0,0,svgWidth,svgHeight,0,0,this.realWidth,this.realHeight);this.origSource=this.source;this.source=canvas;BaseTexture.addToCache(this,canvas._pixiId);this.isLoading=false;this._sourceLoaded();this.emit("loaded",this)};BaseTexture.prototype._sourceLoaded=function _sourceLoaded(){this.hasLoaded=true;this.update()};BaseTexture.prototype.destroy=function destroy(){if(this.imageUrl){delete _utils.TextureCache[this.imageUrl];this.imageUrl=null;if(!navigator.isCocoonJS){this.source.src=""}}this.source=null;this.dispose();BaseTexture.removeFromCache(this);this.textureCacheIds=null;this._destroyed=true};BaseTexture.prototype.dispose=function dispose(){this.emit("dispose",this)};BaseTexture.prototype.updateSourceImage=function updateSourceImage(newSrc){this.source.src=newSrc;this.loadSource(this.source)};BaseTexture.fromImage=function fromImage(imageUrl,crossorigin,scaleMode,sourceScale){var baseTexture=_utils.BaseTextureCache[imageUrl];if(!baseTexture){var image=new Image;if(crossorigin===undefined&&imageUrl.indexOf("data:")!==0){image.crossOrigin=(0,_determineCrossOrigin2.default)(imageUrl)}else if(crossorigin){image.crossOrigin=typeof crossorigin==="string"?crossorigin:"anonymous"}baseTexture=new BaseTexture(image,scaleMode);baseTexture.imageUrl=imageUrl;if(sourceScale){baseTexture.sourceScale=sourceScale}baseTexture.resolution=(0,_utils.getResolutionOfUrl)(imageUrl);image.src=imageUrl;BaseTexture.addToCache(baseTexture,imageUrl)}return baseTexture};BaseTexture.fromCanvas=function fromCanvas(canvas,scaleMode){var origin=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"canvas";if(!canvas._pixiId){canvas._pixiId=origin+"_"+(0,_utils.uid)()}var baseTexture=_utils.BaseTextureCache[canvas._pixiId];if(!baseTexture){baseTexture=new BaseTexture(canvas,scaleMode);BaseTexture.addToCache(baseTexture,canvas._pixiId)}return baseTexture};BaseTexture.from=function from(source,scaleMode,sourceScale){if(typeof source==="string"){return BaseTexture.fromImage(source,undefined,scaleMode,sourceScale)}else if(source instanceof HTMLImageElement){var imageUrl=source.src;var baseTexture=_utils.BaseTextureCache[imageUrl];if(!baseTexture){baseTexture=new BaseTexture(source,scaleMode);baseTexture.imageUrl=imageUrl;if(sourceScale){baseTexture.sourceScale=sourceScale}baseTexture.resolution=(0,_utils.getResolutionOfUrl)(imageUrl);BaseTexture.addToCache(baseTexture,imageUrl)}return baseTexture}else if(source instanceof HTMLCanvasElement){return BaseTexture.fromCanvas(source,scaleMode)}return source};BaseTexture.addToCache=function addToCache(baseTexture,id){if(id){if(baseTexture.textureCacheIds.indexOf(id)===-1){baseTexture.textureCacheIds.push(id)}if(_utils.BaseTextureCache[id]){console.warn("BaseTexture added to the cache with an id ["+id+"] that already had an entry")}_utils.BaseTextureCache[id]=baseTexture}};BaseTexture.removeFromCache=function removeFromCache(baseTexture){if(typeof baseTexture==="string"){var baseTextureFromCache=_utils.BaseTextureCache[baseTexture];if(baseTextureFromCache){var index=baseTextureFromCache.textureCacheIds.indexOf(baseTexture);if(index>-1){baseTextureFromCache.textureCacheIds.splice(index,1)}delete _utils.BaseTextureCache[baseTexture];return baseTextureFromCache}}else if(baseTexture&&baseTexture.textureCacheIds){for(var i=0;i<baseTexture.textureCacheIds.length;++i){delete _utils.BaseTextureCache[baseTexture.textureCacheIds[i]]}baseTexture.textureCacheIds.length=0;return baseTexture}return null};return BaseTexture}(_eventemitter2.default);exports.default=BaseTexture},{"../settings":157,"../utils":181,"../utils/determineCrossOrigin":180,"bit-twiddle":3,eventemitter3:62}],169:[function(require,module,exports){"use strict";exports.__esModule=true;var _BaseRenderTexture=require("./BaseRenderTexture");var _BaseRenderTexture2=_interopRequireDefault(_BaseRenderTexture);var _Texture2=require("./Texture");var _Texture3=_interopRequireDefault(_Texture2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var RenderTexture=function(_Texture){_inherits(RenderTexture,_Texture);function RenderTexture(baseRenderTexture,frame){_classCallCheck(this,RenderTexture);var _legacyRenderer=null;if(!(baseRenderTexture instanceof _BaseRenderTexture2.default)){var width=arguments[1];var height=arguments[2];var scaleMode=arguments[3];var resolution=arguments[4];console.warn("Please use RenderTexture.create("+width+", "+height+") instead of the ctor directly.");_legacyRenderer=arguments[0];frame=null;baseRenderTexture=new _BaseRenderTexture2.default(width,height,scaleMode,resolution)}var _this=_possibleConstructorReturn(this,_Texture.call(this,baseRenderTexture,frame));_this.legacyRenderer=_legacyRenderer;_this.valid=true;_this._updateUvs();return _this}RenderTexture.prototype.resize=function resize(width,height,doNotResizeBaseTexture){width=Math.ceil(width);height=Math.ceil(height);this.valid=width>0&&height>0;this._frame.width=this.orig.width=width;this._frame.height=this.orig.height=height;if(!doNotResizeBaseTexture){this.baseTexture.resize(width,height)}this._updateUvs()};RenderTexture.create=function create(width,height,scaleMode,resolution){return new RenderTexture(new _BaseRenderTexture2.default(width,height,scaleMode,resolution))};return RenderTexture}(_Texture3.default);exports.default=RenderTexture},{"./BaseRenderTexture":167,"./Texture":171}],170:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _=require("../");var _utils=require("../utils");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Spritesheet=function(){_createClass(Spritesheet,null,[{key:"BATCH_SIZE",get:function get(){return 1e3}}]);function Spritesheet(baseTexture,data){var resolutionFilename=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;_classCallCheck(this,Spritesheet);this.baseTexture=baseTexture;this.textures={};this.data=data;this.resolution=this._updateResolution(resolutionFilename||this.baseTexture.imageUrl);this._frames=this.data.frames;this._frameKeys=Object.keys(this._frames);this._batchIndex=0;this._callback=null}Spritesheet.prototype._updateResolution=function _updateResolution(resolutionFilename){var scale=this.data.meta.scale;var resolution=(0,_utils.getResolutionOfUrl)(resolutionFilename,null);if(resolution===null){resolution=scale!==undefined?parseFloat(scale):1}if(resolution!==1){this.baseTexture.resolution=resolution;this.baseTexture.update()}return resolution};Spritesheet.prototype.parse=function parse(callback){this._batchIndex=0;this._callback=callback;if(this._frameKeys.length<=Spritesheet.BATCH_SIZE){this._processFrames(0);this._parseComplete()}else{this._nextBatch()}};Spritesheet.prototype._processFrames=function _processFrames(initialFrameIndex){var frameIndex=initialFrameIndex;var maxFrames=Spritesheet.BATCH_SIZE;var sourceScale=this.baseTexture.sourceScale;while(frameIndex-initialFrameIndex<maxFrames&&frameIndex<this._frameKeys.length){var i=this._frameKeys[frameIndex];var data=this._frames[i];var rect=data.frame;if(rect){var frame=null;var trim=null;var sourceSize=data.trimmed!==false&&data.sourceSize?data.sourceSize:data.frame;var orig=new _.Rectangle(0,0,Math.floor(sourceSize.w*sourceScale)/this.resolution,Math.floor(sourceSize.h*sourceScale)/this.resolution);if(data.rotated){frame=new _.Rectangle(Math.floor(rect.x*sourceScale)/this.resolution,Math.floor(rect.y*sourceScale)/this.resolution,Math.floor(rect.h*sourceScale)/this.resolution,Math.floor(rect.w*sourceScale)/this.resolution)}else{frame=new _.Rectangle(Math.floor(rect.x*sourceScale)/this.resolution,Math.floor(rect.y*sourceScale)/this.resolution,Math.floor(rect.w*sourceScale)/this.resolution,Math.floor(rect.h*sourceScale)/this.resolution)}if(data.trimmed!==false&&data.spriteSourceSize){trim=new _.Rectangle(Math.floor(data.spriteSourceSize.x*sourceScale)/this.resolution,Math.floor(data.spriteSourceSize.y*sourceScale)/this.resolution,Math.floor(rect.w*sourceScale)/this.resolution,Math.floor(rect.h*sourceScale)/this.resolution)}this.textures[i]=new _.Texture(this.baseTexture,frame,orig,trim,data.rotated?2:0);_.Texture.addToCache(this.textures[i],i)}frameIndex++}};Spritesheet.prototype._parseComplete=function _parseComplete(){var callback=this._callback;this._callback=null;this._batchIndex=0;callback.call(this,this.textures)};Spritesheet.prototype._nextBatch=function _nextBatch(){var _this=this;this._processFrames(this._batchIndex*Spritesheet.BATCH_SIZE);this._batchIndex++;setTimeout(function(){if(_this._batchIndex*Spritesheet.BATCH_SIZE<_this._frameKeys.length){_this._nextBatch()}else{_this._parseComplete()}},0)};Spritesheet.prototype.destroy=function destroy(){var destroyBase=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;for(var i in this.textures){this.textures[i].destroy()}this._frames=null;this._frameKeys=null;this.data=null;this.textures=null;if(destroyBase){this.baseTexture.destroy()}this.baseTexture=null};return Spritesheet}();exports.default=Spritesheet},{"../":121,"../utils":181}],171:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _BaseTexture=require("./BaseTexture");var _BaseTexture2=_interopRequireDefault(_BaseTexture);var _VideoBaseTexture=require("./VideoBaseTexture");var _VideoBaseTexture2=_interopRequireDefault(_VideoBaseTexture);var _TextureUvs=require("./TextureUvs");var _TextureUvs2=_interopRequireDefault(_TextureUvs);var _eventemitter=require("eventemitter3");var _eventemitter2=_interopRequireDefault(_eventemitter);var _math=require("../math");var _utils=require("../utils");var _settings=require("../settings");var _settings2=_interopRequireDefault(_settings);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Texture=function(_EventEmitter){_inherits(Texture,_EventEmitter);function Texture(baseTexture,frame,orig,trim,rotate){_classCallCheck(this,Texture);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));_this.noFrame=false;if(!frame){_this.noFrame=true;frame=new _math.Rectangle(0,0,1,1)}if(baseTexture instanceof Texture){baseTexture=baseTexture.baseTexture}_this.baseTexture=baseTexture;_this._frame=frame;_this.trim=trim;_this.valid=false;_this.requiresUpdate=false;_this._uvs=null;_this.orig=orig||frame;_this._rotate=Number(rotate||0);if(rotate===true){_this._rotate=2}else if(_this._rotate%2!==0){throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually")}if(baseTexture.hasLoaded){if(_this.noFrame){frame=new _math.Rectangle(0,0,baseTexture.width,baseTexture.height);baseTexture.on("update",_this.onBaseTextureUpdated,_this)}_this.frame=frame}else{baseTexture.once("loaded",_this.onBaseTextureLoaded,_this)}_this._updateID=0;_this.transform=null;_this.textureCacheIds=[];return _this}Texture.prototype.update=function update(){this.baseTexture.update()};Texture.prototype.onBaseTextureLoaded=function onBaseTextureLoaded(baseTexture){this._updateID++;if(this.noFrame){this.frame=new _math.Rectangle(0,0,baseTexture.width,baseTexture.height)}else{this.frame=this._frame}this.baseTexture.on("update",this.onBaseTextureUpdated,this);this.emit("update",this)};Texture.prototype.onBaseTextureUpdated=function onBaseTextureUpdated(baseTexture){this._updateID++;this._frame.width=baseTexture.width;this._frame.height=baseTexture.height;this.emit("update",this)};Texture.prototype.destroy=function destroy(destroyBase){if(this.baseTexture){if(destroyBase){if(_utils.TextureCache[this.baseTexture.imageUrl]){Texture.removeFromCache(this.baseTexture.imageUrl)}this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this);this.baseTexture.off("loaded",this.onBaseTextureLoaded,this);this.baseTexture=null}this._frame=null;this._uvs=null;this.trim=null;this.orig=null;this.valid=false;Texture.removeFromCache(this);this.textureCacheIds=null};Texture.prototype.clone=function clone(){return new Texture(this.baseTexture,this.frame,this.orig,this.trim,this.rotate)};Texture.prototype._updateUvs=function _updateUvs(){if(!this._uvs){this._uvs=new _TextureUvs2.default}this._uvs.set(this._frame,this.baseTexture,this.rotate);this._updateID++};Texture.fromImage=function fromImage(imageUrl,crossorigin,scaleMode,sourceScale){var texture=_utils.TextureCache[imageUrl];if(!texture){texture=new Texture(_BaseTexture2.default.fromImage(imageUrl,crossorigin,scaleMode,sourceScale));Texture.addToCache(texture,imageUrl)}return texture};Texture.fromFrame=function fromFrame(frameId){var texture=_utils.TextureCache[frameId];if(!texture){throw new Error('The frameId "'+frameId+'" does not exist in the texture cache')}return texture};Texture.fromCanvas=function fromCanvas(canvas,scaleMode){var origin=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"canvas";return new Texture(_BaseTexture2.default.fromCanvas(canvas,scaleMode,origin))};Texture.fromVideo=function fromVideo(video,scaleMode){if(typeof video==="string"){return Texture.fromVideoUrl(video,scaleMode)}return new Texture(_VideoBaseTexture2.default.fromVideo(video,scaleMode))};Texture.fromVideoUrl=function fromVideoUrl(videoUrl,scaleMode){return new Texture(_VideoBaseTexture2.default.fromUrl(videoUrl,scaleMode))};Texture.from=function from(source){if(typeof source==="string"){var texture=_utils.TextureCache[source];if(!texture){var isVideo=source.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)!==null;if(isVideo){return Texture.fromVideoUrl(source)}return Texture.fromImage(source)}return texture}else if(source instanceof HTMLImageElement){return new Texture(_BaseTexture2.default.from(source))}else if(source instanceof HTMLCanvasElement){return Texture.fromCanvas(source,_settings2.default.SCALE_MODE,"HTMLCanvasElement")}else if(source instanceof HTMLVideoElement){return Texture.fromVideo(source)}else if(source instanceof _BaseTexture2.default){return new Texture(source)}return source};Texture.fromLoader=function fromLoader(source,imageUrl,name){var baseTexture=new _BaseTexture2.default(source,undefined,(0,_utils.getResolutionOfUrl)(imageUrl));var texture=new Texture(baseTexture);baseTexture.imageUrl=imageUrl;if(!name){name=imageUrl}_BaseTexture2.default.addToCache(texture.baseTexture,name);Texture.addToCache(texture,name);if(name!==imageUrl){_BaseTexture2.default.addToCache(texture.baseTexture,imageUrl);Texture.addToCache(texture,imageUrl)}return texture};Texture.addToCache=function addToCache(texture,id){if(id){if(texture.textureCacheIds.indexOf(id)===-1){texture.textureCacheIds.push(id)}if(_utils.TextureCache[id]){console.warn("Texture added to the cache with an id ["+id+"] that already had an entry")}_utils.TextureCache[id]=texture}};Texture.removeFromCache=function removeFromCache(texture){if(typeof texture==="string"){var textureFromCache=_utils.TextureCache[texture];if(textureFromCache){var index=textureFromCache.textureCacheIds.indexOf(texture);if(index>-1){textureFromCache.textureCacheIds.splice(index,1)}delete _utils.TextureCache[texture];return textureFromCache}}else if(texture&&texture.textureCacheIds){for(var i=0;i<texture.textureCacheIds.length;++i){if(_utils.TextureCache[texture.textureCacheIds[i]]===texture){delete _utils.TextureCache[texture.textureCacheIds[i]]}}texture.textureCacheIds.length=0;return texture}return null};_createClass(Texture,[{key:"frame",get:function get(){return this._frame},set:function set(frame){this._frame=frame;this.noFrame=false;var x=frame.x,y=frame.y,width=frame.width,height=frame.height;var xNotFit=x+width>this.baseTexture.width;var yNotFit=y+height>this.baseTexture.height;if(xNotFit||yNotFit){var relationship=xNotFit&&yNotFit?"and":"or";var errorX="X: "+x+" + "+width+" = "+(x+width)+" > "+this.baseTexture.width;var errorY="Y: "+y+" + "+height+" = "+(y+height)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+(errorX+" "+relationship+" "+errorY))}this.valid=width&&height&&this.baseTexture.hasLoaded;if(!this.trim&&!this.rotate){this.orig=frame}if(this.valid){this._updateUvs()}}},{key:"rotate",get:function get(){return this._rotate},set:function set(rotate){this._rotate=rotate;if(this.valid){this._updateUvs()}}},{key:"width",get:function get(){return this.orig.width}},{key:"height",get:function get(){return this.orig.height}}]);return Texture}(_eventemitter2.default);exports.default=Texture;function createWhiteTexture(){var canvas=document.createElement("canvas");canvas.width=10;canvas.height=10;var context=canvas.getContext("2d");context.fillStyle="white";context.fillRect(0,0,10,10);return new Texture(new _BaseTexture2.default(canvas))}function removeAllHandlers(tex){tex.destroy=function _emptyDestroy(){};tex.on=function _emptyOn(){};tex.once=function _emptyOnce(){};tex.emit=function _emptyEmit(){}}Texture.EMPTY=new Texture(new _BaseTexture2.default);removeAllHandlers(Texture.EMPTY);removeAllHandlers(Texture.EMPTY.baseTexture);Texture.WHITE=createWhiteTexture();removeAllHandlers(Texture.WHITE);removeAllHandlers(Texture.WHITE.baseTexture)},{"../math":126,"../settings":157,"../utils":181,"./BaseTexture":168,"./TextureUvs":173,"./VideoBaseTexture":174,eventemitter3:62}],172:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _Matrix=require("../math/Matrix");var _Matrix2=_interopRequireDefault(_Matrix);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var tempMat=new _Matrix2.default;var TextureMatrix=function(){function TextureMatrix(texture,clampMargin){_classCallCheck(this,TextureMatrix);this._texture=texture;this.mapCoord=new _Matrix2.default;this.uClampFrame=new Float32Array(4);this.uClampOffset=new Float32Array(2);this._lastTextureID=-1;this.clampOffset=0;this.clampMargin=typeof clampMargin==="undefined"?.5:clampMargin}TextureMatrix.prototype.multiplyUvs=function multiplyUvs(uvs,out){if(out===undefined){out=uvs}var mat=this.mapCoord;for(var i=0;i<uvs.length;i+=2){var x=uvs[i];var y=uvs[i+1];out[i]=x*mat.a+y*mat.c+mat.tx;out[i+1]=x*mat.b+y*mat.d+mat.ty}return out};TextureMatrix.prototype.update=function update(forceUpdate){var tex=this._texture;if(!tex||!tex.valid){return false}if(!forceUpdate&&this._lastTextureID===tex._updateID){return false}this._lastTextureID=tex._updateID;var uvs=tex._uvs;this.mapCoord.set(uvs.x1-uvs.x0,uvs.y1-uvs.y0,uvs.x3-uvs.x0,uvs.y3-uvs.y0,uvs.x0,uvs.y0);var orig=tex.orig;var trim=tex.trim;if(trim){tempMat.set(orig.width/trim.width,0,0,orig.height/trim.height,-trim.x/trim.width,-trim.y/trim.height);this.mapCoord.append(tempMat)}var texBase=tex.baseTexture;var frame=this.uClampFrame;var margin=this.clampMargin/texBase.resolution;var offset=this.clampOffset;frame[0]=(tex._frame.x+margin+offset)/texBase.width;frame[1]=(tex._frame.y+margin+offset)/texBase.height;frame[2]=(tex._frame.x+tex._frame.width-margin+offset)/texBase.width;frame[3]=(tex._frame.y+tex._frame.height-margin+offset)/texBase.height;this.uClampOffset[0]=offset/texBase.realWidth;this.uClampOffset[1]=offset/texBase.realHeight;return true};_createClass(TextureMatrix,[{key:"texture",get:function get(){return this._texture},set:function set(value){this._texture=value;this._lastTextureID=-1}}]);return TextureMatrix}();exports.default=TextureMatrix},{"../math/Matrix":123}],173:[function(require,module,exports){"use strict";exports.__esModule=true;var _GroupD=require("../math/GroupD8");var _GroupD2=_interopRequireDefault(_GroupD);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TextureUvs=function(){function TextureUvs(){_classCallCheck(this,TextureUvs);this.x0=0;this.y0=0;this.x1=1;this.y1=0;this.x2=1;this.y2=1;this.x3=0;this.y3=1;this.uvsUint32=new Uint32Array(4)}TextureUvs.prototype.set=function set(frame,baseFrame,rotate){var tw=baseFrame.width;var th=baseFrame.height;if(rotate){var w2=frame.width/2/tw;var h2=frame.height/2/th;var cX=frame.x/tw+w2;var cY=frame.y/th+h2;rotate=_GroupD2.default.add(rotate,_GroupD2.default.NW);this.x0=cX+w2*_GroupD2.default.uX(rotate);this.y0=cY+h2*_GroupD2.default.uY(rotate);rotate=_GroupD2.default.add(rotate,2);this.x1=cX+w2*_GroupD2.default.uX(rotate);this.y1=cY+h2*_GroupD2.default.uY(rotate);rotate=_GroupD2.default.add(rotate,2);this.x2=cX+w2*_GroupD2.default.uX(rotate);this.y2=cY+h2*_GroupD2.default.uY(rotate);rotate=_GroupD2.default.add(rotate,2);this.x3=cX+w2*_GroupD2.default.uX(rotate);this.y3=cY+h2*_GroupD2.default.uY(rotate)}else{this.x0=frame.x/tw;this.y0=frame.y/th;this.x1=(frame.x+frame.width)/tw;this.y1=frame.y/th;this.x2=(frame.x+frame.width)/tw;this.y2=(frame.y+frame.height)/th;this.x3=frame.x/tw;this.y3=(frame.y+frame.height)/th}this.uvsUint32[0]=(this.y0*65535&65535)<<16|this.x0*65535&65535;this.uvsUint32[1]=(this.y1*65535&65535)<<16|this.x1*65535&65535;this.uvsUint32[2]=(this.y2*65535&65535)<<16|this.x2*65535&65535;this.uvsUint32[3]=(this.y3*65535&65535)<<16|this.x3*65535&65535};return TextureUvs}();exports.default=TextureUvs},{"../math/GroupD8":122}],174:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _BaseTexture2=require("./BaseTexture");var _BaseTexture3=_interopRequireDefault(_BaseTexture2);var _utils=require("../utils");var _ticker=require("../ticker");var _const=require("../const");var _determineCrossOrigin=require("../utils/determineCrossOrigin");var _determineCrossOrigin2=_interopRequireDefault(_determineCrossOrigin);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var VideoBaseTexture=function(_BaseTexture){_inherits(VideoBaseTexture,_BaseTexture);function VideoBaseTexture(source,scaleMode){_classCallCheck(this,VideoBaseTexture);if(!source){throw new Error("No video source element specified.")}if((source.readyState===source.HAVE_ENOUGH_DATA||source.readyState===source.HAVE_FUTURE_DATA)&&source.width&&source.height){source.complete=true}var _this=_possibleConstructorReturn(this,_BaseTexture.call(this,source,scaleMode));_this.width=source.videoWidth;_this.height=source.videoHeight;_this._autoUpdate=true;_this._isAutoUpdating=false;_this.autoPlay=true;_this.update=_this.update.bind(_this);_this._onCanPlay=_this._onCanPlay.bind(_this);source.addEventListener("play",_this._onPlayStart.bind(_this));source.addEventListener("pause",_this._onPlayStop.bind(_this));_this.hasLoaded=false;_this.__loaded=false;if(!_this._isSourceReady()){source.addEventListener("canplay",_this._onCanPlay);source.addEventListener("canplaythrough",_this._onCanPlay)}else{_this._onCanPlay()}return _this}VideoBaseTexture.prototype._isSourcePlaying=function _isSourcePlaying(){var source=this.source;return source.currentTime>0&&source.paused===false&&source.ended===false&&source.readyState>2};VideoBaseTexture.prototype._isSourceReady=function _isSourceReady(){return this.source.readyState===3||this.source.readyState===4};VideoBaseTexture.prototype._onPlayStart=function _onPlayStart(){if(!this.hasLoaded){this._onCanPlay()}if(!this._isAutoUpdating&&this.autoUpdate){_ticker.shared.add(this.update,this,_const.UPDATE_PRIORITY.HIGH);this._isAutoUpdating=true}};VideoBaseTexture.prototype._onPlayStop=function _onPlayStop(){if(this._isAutoUpdating){_ticker.shared.remove(this.update,this);this._isAutoUpdating=false}};VideoBaseTexture.prototype._onCanPlay=function _onCanPlay(){this.hasLoaded=true;if(this.source){this.source.removeEventListener("canplay",this._onCanPlay);this.source.removeEventListener("canplaythrough",this._onCanPlay);this.width=this.source.videoWidth;this.height=this.source.videoHeight;if(!this.__loaded){this.__loaded=true;this.emit("loaded",this)}if(this._isSourcePlaying()){this._onPlayStart()}else if(this.autoPlay){this.source.play()}}};VideoBaseTexture.prototype.destroy=function destroy(){if(this._isAutoUpdating){_ticker.shared.remove(this.update,this)}if(this.source&&this.source._pixiId){_BaseTexture3.default.removeFromCache(this.source._pixiId);delete this.source._pixiId;this.source.pause();this.source.src="";this.source.load()}_BaseTexture.prototype.destroy.call(this)};VideoBaseTexture.fromVideo=function fromVideo(video,scaleMode){if(!video._pixiId){video._pixiId="video_"+(0,_utils.uid)()}var baseTexture=_utils.BaseTextureCache[video._pixiId];if(!baseTexture){baseTexture=new VideoBaseTexture(video,scaleMode);_BaseTexture3.default.addToCache(baseTexture,video._pixiId)}return baseTexture};VideoBaseTexture.fromUrl=function fromUrl(videoSrc,scaleMode,crossorigin){var video=document.createElement("video");video.setAttribute("webkit-playsinline","");video.setAttribute("playsinline","");var url=Array.isArray(videoSrc)?videoSrc[0].src||videoSrc[0]:videoSrc.src||videoSrc;if(crossorigin===undefined&&url.indexOf("data:")!==0){video.crossOrigin=(0,_determineCrossOrigin2.default)(url)}else if(crossorigin){video.crossOrigin=typeof crossorigin==="string"?crossorigin:"anonymous"}if(Array.isArray(videoSrc)){for(var i=0;i<videoSrc.length;++i){video.appendChild(createSource(videoSrc[i].src||videoSrc[i],videoSrc[i].mime))}}else{video.appendChild(createSource(url,videoSrc.mime))}video.load();return VideoBaseTexture.fromVideo(video,scaleMode)};_createClass(VideoBaseTexture,[{key:"autoUpdate",get:function get(){return this._autoUpdate},set:function set(value){if(value!==this._autoUpdate){this._autoUpdate=value;if(!this._autoUpdate&&this._isAutoUpdating){_ticker.shared.remove(this.update,this);this._isAutoUpdating=false}else if(this._autoUpdate&&!this._isAutoUpdating){_ticker.shared.add(this.update,this,_const.UPDATE_PRIORITY.HIGH);this._isAutoUpdating=true}}}}]);return VideoBaseTexture}(_BaseTexture3.default);exports.default=VideoBaseTexture;VideoBaseTexture.fromUrls=VideoBaseTexture.fromUrl;function createSource(path,type){if(!type){type="video/"+path.substr(path.lastIndexOf(".")+1)}var source=document.createElement("source");source.src=path;source.type=type;return source}},{"../const":102,"../ticker":177,"../utils":181,"../utils/determineCrossOrigin":180,"./BaseTexture":168}],175:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _settings=require("../settings");var _settings2=_interopRequireDefault(_settings);var _const=require("../const");var _TickerListener=require("./TickerListener");var _TickerListener2=_interopRequireDefault(_TickerListener);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Ticker=function(){function Ticker(){var _this=this;_classCallCheck(this,Ticker);this._head=new _TickerListener2.default(null,null,Infinity);this._requestId=null;this._maxElapsedMS=100;this.autoStart=false;this.deltaTime=1;this.elapsedMS=1/_settings2.default.TARGET_FPMS;this.lastTime=-1;this.speed=1;this.started=false;this._tick=function(time){_this._requestId=null;if(_this.started){_this.update(time);if(_this.started&&_this._requestId===null&&_this._head.next){_this._requestId=requestAnimationFrame(_this._tick)}}}}Ticker.prototype._requestIfNeeded=function _requestIfNeeded(){if(this._requestId===null&&this._head.next){this.lastTime=performance.now();this._requestId=requestAnimationFrame(this._tick)}};Ticker.prototype._cancelIfNeeded=function _cancelIfNeeded(){if(this._requestId!==null){cancelAnimationFrame(this._requestId);this._requestId=null}};Ticker.prototype._startIfPossible=function _startIfPossible(){if(this.started){this._requestIfNeeded()}else if(this.autoStart){this.start()}};Ticker.prototype.add=function add(fn,context){var priority=arguments.length>2&&arguments[2]!==undefined?arguments[2]:_const.UPDATE_PRIORITY.NORMAL;return this._addListener(new _TickerListener2.default(fn,context,priority))};Ticker.prototype.addOnce=function addOnce(fn,context){var priority=arguments.length>2&&arguments[2]!==undefined?arguments[2]:_const.UPDATE_PRIORITY.NORMAL;return this._addListener(new _TickerListener2.default(fn,context,priority,true))};Ticker.prototype._addListener=function _addListener(listener){var current=this._head.next;var previous=this._head;if(!current){listener.connect(previous)}else{while(current){if(listener.priority>current.priority){listener.connect(previous);break}previous=current;current=current.next}if(!listener.previous){listener.connect(previous)}}this._startIfPossible();return this};Ticker.prototype.remove=function remove(fn,context){var listener=this._head.next;while(listener){if(listener.match(fn,context)){listener=listener.destroy()}else{listener=listener.next}}if(!this._head.next){this._cancelIfNeeded()}return this};Ticker.prototype.start=function start(){if(!this.started){this.started=true;this._requestIfNeeded()}};Ticker.prototype.stop=function stop(){if(this.started){this.started=false;this._cancelIfNeeded()}};Ticker.prototype.destroy=function destroy(){this.stop();var listener=this._head.next;while(listener){listener=listener.destroy(true)}this._head.destroy();this._head=null};Ticker.prototype.update=function update(){var currentTime=arguments.length>0&&arguments[0]!==undefined?arguments[0]:performance.now();var elapsedMS=void 0;if(currentTime>this.lastTime){elapsedMS=this.elapsedMS=currentTime-this.lastTime;if(elapsedMS>this._maxElapsedMS){elapsedMS=this._maxElapsedMS}this.deltaTime=elapsedMS*_settings2.default.TARGET_FPMS*this.speed;var head=this._head;var listener=head.next;while(listener){listener=listener.emit(this.deltaTime)}if(!head.next){this._cancelIfNeeded()}}else{this.deltaTime=this.elapsedMS=0}this.lastTime=currentTime};_createClass(Ticker,[{key:"FPS",get:function get(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function get(){return 1e3/this._maxElapsedMS},set:function set(fps){var minFPMS=Math.min(Math.max(0,fps)/1e3,_settings2.default.TARGET_FPMS);this._maxElapsedMS=1/minFPMS}}]);return Ticker}();exports.default=Ticker},{"../const":102,"../settings":157,"./TickerListener":176}],176:[function(require,module,exports){"use strict";exports.__esModule=true;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TickerListener=function(){function TickerListener(fn){var context=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var priority=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var once=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;_classCallCheck(this,TickerListener);this.fn=fn;this.context=context;this.priority=priority;this.once=once;this.next=null;this.previous=null;this._destroyed=false}TickerListener.prototype.match=function match(fn,context){context=context||null;return this.fn===fn&&this.context===context};TickerListener.prototype.emit=function emit(deltaTime){if(this.fn){if(this.context){this.fn.call(this.context,deltaTime)}else{this.fn(deltaTime)}}var redirect=this.next;if(this.once){this.destroy(true)}if(this._destroyed){this.next=null}return redirect};TickerListener.prototype.connect=function connect(previous){this.previous=previous;if(previous.next){previous.next.previous=this}this.next=previous.next;previous.next=this};TickerListener.prototype.destroy=function destroy(){var hard=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this._destroyed=true;this.fn=null;this.context=null;if(this.previous){this.previous.next=this.next}if(this.next){this.next.previous=this.previous}var redirect=this.next;this.next=hard?null:redirect;this.previous=null;return redirect};return TickerListener}();exports.default=TickerListener},{}],177:[function(require,module,exports){"use strict";exports.__esModule=true;exports.Ticker=exports.shared=undefined;var _Ticker=require("./Ticker");var _Ticker2=_interopRequireDefault(_Ticker);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var shared=new _Ticker2.default;shared.autoStart=true;shared.destroy=function(){};exports.shared=shared;exports.Ticker=_Ticker2.default},{"./Ticker":175}],178:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=canUploadSameBuffer;function canUploadSameBuffer(){var ios=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);return!ios}},{}],179:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=createIndicesForQuads;function createIndicesForQuads(size){var totalIndices=size*6;var indices=new Uint16Array(totalIndices);for(var i=0,j=0;i<totalIndices;i+=6,j+=4){indices[i+0]=j+0;indices[i+1]=j+1;indices[i+2]=j+2;indices[i+3]=j+0;indices[i+4]=j+2;indices[i+5]=j+3}return indices}},{}],180:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=determineCrossOrigin;var _url2=require("url");var _url3=_interopRequireDefault(_url2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var tempAnchor=void 0;function determineCrossOrigin(url){var loc=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window.location;if(url.indexOf("data:")===0){return""}loc=loc||window.location;if(!tempAnchor){tempAnchor=document.createElement("a")}tempAnchor.href=url;url=_url3.default.parse(tempAnchor.href);var samePort=!url.port&&loc.port===""||url.port===loc.port;if(url.hostname!==loc.hostname||!samePort||url.protocol!==loc.protocol){return"anonymous"}return""}},{url:259}],181:[function(require,module,exports){"use strict";exports.__esModule=true;exports.premultiplyBlendMode=exports.BaseTextureCache=exports.TextureCache=exports.earcut=exports.mixins=exports.pluginTarget=exports.EventEmitter=exports.removeItems=exports.isMobile=undefined;exports.uid=uid;exports.hex2rgb=hex2rgb;exports.hex2string=hex2string;exports.rgb2hex=rgb2hex;exports.getResolutionOfUrl=getResolutionOfUrl;exports.decomposeDataUri=decomposeDataUri;exports.getUrlFileExtension=getUrlFileExtension;exports.getSvgSize=getSvgSize;exports.skipHello=skipHello;exports.sayHello=sayHello;exports.isWebGLSupported=isWebGLSupported;exports.sign=sign;exports.destroyTextureCache=destroyTextureCache;exports.clearTextureCache=clearTextureCache;exports.correctBlendMode=correctBlendMode;exports.premultiplyTint=premultiplyTint;exports.premultiplyRgba=premultiplyRgba;exports.premultiplyTintToRgba=premultiplyTintToRgba;var _const=require("../const");var _settings=require("../settings");var _settings2=_interopRequireDefault(_settings);var _eventemitter=require("eventemitter3");var _eventemitter2=_interopRequireDefault(_eventemitter);var _pluginTarget=require("./pluginTarget");var _pluginTarget2=_interopRequireDefault(_pluginTarget);var _mixin=require("./mixin");var mixins=_interopRequireWildcard(_mixin);var _ismobilejs=require("ismobilejs");var isMobile=_interopRequireWildcard(_ismobilejs);var _removeArrayItems=require("remove-array-items");var _removeArrayItems2=_interopRequireDefault(_removeArrayItems);var _mapPremultipliedBlendModes=require("./mapPremultipliedBlendModes");var _mapPremultipliedBlendModes2=_interopRequireDefault(_mapPremultipliedBlendModes);var _earcut=require("earcut");var _earcut2=_interopRequireDefault(_earcut);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var nextUid=0;var saidHello=false;exports.isMobile=isMobile;exports.removeItems=_removeArrayItems2.default;exports.EventEmitter=_eventemitter2.default;exports.pluginTarget=_pluginTarget2.default;exports.mixins=mixins;exports.earcut=_earcut2.default;function uid(){return++nextUid}function hex2rgb(hex,out){out=out||[];out[0]=(hex>>16&255)/255;out[1]=(hex>>8&255)/255;out[2]=(hex&255)/255;return out}function hex2string(hex){hex=hex.toString(16);hex="000000".substr(0,6-hex.length)+hex;return"#"+hex}function rgb2hex(rgb){return(rgb[0]*255<<16)+(rgb[1]*255<<8)+(rgb[2]*255|0)}function getResolutionOfUrl(url,defaultValue){var resolution=_settings2.default.RETINA_PREFIX.exec(url);if(resolution){return parseFloat(resolution[1])}return defaultValue!==undefined?defaultValue:1}function decomposeDataUri(dataUri){var dataUriMatch=_const.DATA_URI.exec(dataUri);if(dataUriMatch){return{mediaType:dataUriMatch[1]?dataUriMatch[1].toLowerCase():undefined,subType:dataUriMatch[2]?dataUriMatch[2].toLowerCase():undefined,charset:dataUriMatch[3]?dataUriMatch[3].toLowerCase():undefined,encoding:dataUriMatch[4]?dataUriMatch[4].toLowerCase():undefined,data:dataUriMatch[5]}}return undefined}function getUrlFileExtension(url){var extension=_const.URL_FILE_EXTENSION.exec(url);if(extension){return extension[1].toLowerCase()}return undefined}function getSvgSize(svgString){var sizeMatch=_const.SVG_SIZE.exec(svgString);var size={};if(sizeMatch){size[sizeMatch[1]]=Math.round(parseFloat(sizeMatch[3]));size[sizeMatch[5]]=Math.round(parseFloat(sizeMatch[7]))}return size}function skipHello(){saidHello=true}function sayHello(type){if(saidHello){return}if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var args=["\n %c %c %c PixiJS "+_const.VERSION+" - ✰ "+type+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,args)}else if(window.console){window.console.log("PixiJS "+_const.VERSION+" - "+type+" - http://www.pixijs.com/")}saidHello=true}function isWebGLSupported(){var contextOptions={stencil:true,failIfMajorPerformanceCaveat:true};try{if(!window.WebGLRenderingContext){return false}var canvas=document.createElement("canvas");var gl=canvas.getContext("webgl",contextOptions)||canvas.getContext("experimental-webgl",contextOptions);var success=!!(gl&&gl.getContextAttributes().stencil);if(gl){var loseContext=gl.getExtension("WEBGL_lose_context");if(loseContext){loseContext.loseContext()}}gl=null;return success}catch(e){return false}}function sign(n){if(n===0)return 0;return n<0?-1:1}var TextureCache=exports.TextureCache=Object.create(null);var BaseTextureCache=exports.BaseTextureCache=Object.create(null);function destroyTextureCache(){var key=void 0;for(key in TextureCache){TextureCache[key].destroy()}for(key in BaseTextureCache){BaseTextureCache[key].destroy()}}function clearTextureCache(){var key=void 0;for(key in TextureCache){delete TextureCache[key]}for(key in BaseTextureCache){delete BaseTextureCache[key]}}var premultiplyBlendMode=exports.premultiplyBlendMode=(0,_mapPremultipliedBlendModes2.default)();function correctBlendMode(blendMode,premultiplied){return premultiplyBlendMode[premultiplied?1:0][blendMode]}function premultiplyTint(tint,alpha){if(alpha===1){return(alpha*255<<24)+tint}if(alpha===0){return 0}var R=tint>>16&255;var G=tint>>8&255;var B=tint&255;R=R*alpha+.5|0;G=G*alpha+.5|0;B=B*alpha+.5|0;return(alpha*255<<24)+(R<<16)+(G<<8)+B}function premultiplyRgba(rgb,alpha,out,premultiply){out=out||new Float32Array(4);if(premultiply||premultiply===undefined){out[0]=rgb[0]*alpha;out[1]=rgb[1]*alpha;out[2]=rgb[2]*alpha}else{out[0]=rgb[0];out[1]=rgb[1];out[2]=rgb[2]}out[3]=alpha;return out}function premultiplyTintToRgba(tint,alpha,out,premultiply){out=out||new Float32Array(4);out[0]=(tint>>16&255)/255;out[1]=(tint>>8&255)/255;out[2]=(tint&255)/255;if(premultiply||premultiply===undefined){out[0]*=alpha;out[1]*=alpha;out[2]*=alpha}out[3]=alpha;return out}},{"../const":102,"../settings":157,"./mapPremultipliedBlendModes":182,"./mixin":184,"./pluginTarget":185,earcut:61,eventemitter3:62,ismobilejs:63,"remove-array-items":251}],182:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=mapPremultipliedBlendModes;var _const=require("../const");function mapPremultipliedBlendModes(){var pm=[];var npm=[];for(var i=0;i<32;i++){pm[i]=i;npm[i]=i}pm[_const.BLEND_MODES.NORMAL_NPM]=_const.BLEND_MODES.NORMAL;pm[_const.BLEND_MODES.ADD_NPM]=_const.BLEND_MODES.ADD;pm[_const.BLEND_MODES.SCREEN_NPM]=_const.BLEND_MODES.SCREEN;npm[_const.BLEND_MODES.NORMAL]=_const.BLEND_MODES.NORMAL_NPM;npm[_const.BLEND_MODES.ADD]=_const.BLEND_MODES.ADD_NPM;npm[_const.BLEND_MODES.SCREEN]=_const.BLEND_MODES.SCREEN_NPM;var array=[];array.push(npm);array.push(pm);return array}},{"../const":102}],183:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=maxRecommendedTextures;var _ismobilejs=require("ismobilejs");var _ismobilejs2=_interopRequireDefault(_ismobilejs);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function maxRecommendedTextures(max){if(_ismobilejs2.default.tablet||_ismobilejs2.default.phone){return 4}return max}},{ismobilejs:63}],184:[function(require,module,exports){"use strict";exports.__esModule=true;exports.mixin=mixin;exports.delayMixin=delayMixin;exports.performMixins=performMixins;function mixin(target,source){if(!target||!source)return;var keys=Object.keys(source);for(var i=0;i<keys.length;++i){var propertyName=keys[i];Object.defineProperty(target,propertyName,Object.getOwnPropertyDescriptor(source,propertyName))}}var mixins=[];function delayMixin(target,source){mixins.push(target,source)}function performMixins(){for(var i=0;i<mixins.length;i+=2){mixin(mixins[i],mixins[i+1])}mixins.length=0}},{}],185:[function(require,module,exports){"use strict";exports.__esModule=true;function pluginTarget(obj){obj.__plugins={};obj.registerPlugin=function registerPlugin(pluginName,ctor){obj.__plugins[pluginName]=ctor};obj.prototype.initPlugins=function initPlugins(){this.plugins=this.plugins||{};for(var o in obj.__plugins){this.plugins[o]=new obj.__plugins[o](this)}};obj.prototype.destroyPlugins=function destroyPlugins(){for(var o in this.plugins){this.plugins[o].destroy();this.plugins[o]=null}this.plugins=null}}exports.default={mixin:function mixin(obj){pluginTarget(obj)}}},{}],186:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=trimCanvas;function trimCanvas(canvas){var width=canvas.width;var height=canvas.height;var context=canvas.getContext("2d");var imageData=context.getImageData(0,0,width,height);var pixels=imageData.data;var len=pixels.length;var bound={top:null,left:null,right:null,bottom:null};var i=void 0;var x=void 0;var y=void 0;for(i=0;i<len;i+=4){if(pixels[i+3]!==0){x=i/4%width;y=~~(i/4/width);if(bound.top===null){bound.top=y}if(bound.left===null){bound.left=x}else if(x<bound.left){bound.left=x}if(bound.right===null){bound.right=x+1}else if(bound.right<x){bound.right=x+1}if(bound.bottom===null){bound.bottom=y}else if(bound.bottom<y){bound.bottom=y}}}width=bound.right-bound.left;height=bound.bottom-bound.top+1;var data=context.getImageData(bound.left,bound.top,width,height);return{height:height,width:width,data:data}}},{}],187:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=deprecation;var warnings={};function warn(msg){if(warnings[msg]){return}var stack=(new Error).stack;if(typeof stack==="undefined"){console.warn("Deprecation Warning: ",msg)}else{stack=stack.split("\n").splice(3).join("\n");if(console.groupCollapsed){console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",msg);console.warn(stack);console.groupEnd()}else{console.warn("Deprecation Warning: ",msg);console.warn(stack)}}warnings[msg]=true}function deprecation(core){var mesh=core.mesh,particles=core.particles,extras=core.extras,filters=core.filters,prepare=core.prepare,loaders=core.loaders,interaction=core.interaction;Object.defineProperties(core,{SpriteBatch:{get:function get(){throw new ReferenceError("SpriteBatch does not exist any more, "+"please use the new ParticleContainer instead.")}},AssetLoader:{get:function get(){throw new ReferenceError("The loader system was overhauled in PixiJS v3, "+"please see the new PIXI.loaders.Loader class.")}},Stage:{get:function get(){warn("You do not need to use a PIXI Stage any more, you can simply render any container.");return core.Container}},DisplayObjectContainer:{get:function get(){warn("DisplayObjectContainer has been shortened to Container, please use Container from now on.");return core.Container}},Strip:{get:function get(){warn("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on.");return mesh.Mesh}},Rope:{get:function get(){warn("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on.");return mesh.Rope}},ParticleContainer:{get:function get(){warn("The ParticleContainer class has been moved to particles.ParticleContainer, "+"please use particles.ParticleContainer from now on.");return particles.ParticleContainer}},MovieClip:{get:function get(){warn("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite.");return extras.AnimatedSprite}},TilingSprite:{get:function get(){warn("The TilingSprite class has been moved to extras.TilingSprite, "+"please use extras.TilingSprite from now on.");return extras.TilingSprite}},BitmapText:{get:function get(){warn("The BitmapText class has been moved to extras.BitmapText, "+"please use extras.BitmapText from now on.");return extras.BitmapText}},blendModes:{get:function get(){warn("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on.");return core.BLEND_MODES}},scaleModes:{get:function get(){warn("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on.");return core.SCALE_MODES}},BaseTextureCache:{get:function get(){warn("The BaseTextureCache class has been moved to utils.BaseTextureCache, "+"please use utils.BaseTextureCache from now on.");return core.utils.BaseTextureCache}},TextureCache:{get:function get(){warn("The TextureCache class has been moved to utils.TextureCache, "+"please use utils.TextureCache from now on.");return core.utils.TextureCache}},math:{get:function get(){warn("The math namespace is deprecated, please access members already accessible on PIXI.");return core}},AbstractFilter:{get:function get(){warn("AstractFilter has been renamed to Filter, please use PIXI.Filter");return core.Filter}},TransformManual:{get:function get(){warn("TransformManual has been renamed to TransformBase, please update your pixi-spine");return core.TransformBase}},TARGET_FPMS:{get:function get(){warn("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS");return core.settings.TARGET_FPMS},set:function set(value){warn("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS");core.settings.TARGET_FPMS=value}},FILTER_RESOLUTION:{get:function get(){warn("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION");return core.settings.FILTER_RESOLUTION},set:function set(value){warn("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION");core.settings.FILTER_RESOLUTION=value}},RESOLUTION:{get:function get(){warn("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION");return core.settings.RESOLUTION},set:function set(value){warn("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION");core.settings.RESOLUTION=value}},MIPMAP_TEXTURES:{get:function get(){warn("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES");return core.settings.MIPMAP_TEXTURES},set:function set(value){warn("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES");core.settings.MIPMAP_TEXTURES=value}},SPRITE_BATCH_SIZE:{get:function get(){warn("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE");return core.settings.SPRITE_BATCH_SIZE},set:function set(value){warn("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE");core.settings.SPRITE_BATCH_SIZE=value}},SPRITE_MAX_TEXTURES:{get:function get(){warn("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES");return core.settings.SPRITE_MAX_TEXTURES},set:function set(value){warn("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES");core.settings.SPRITE_MAX_TEXTURES=value}},RETINA_PREFIX:{get:function get(){warn("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX");return core.settings.RETINA_PREFIX},set:function set(value){warn("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX");core.settings.RETINA_PREFIX=value}},DEFAULT_RENDER_OPTIONS:{get:function get(){warn("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS");return core.settings.RENDER_OPTIONS}}});var defaults=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION_FRAGMENT"}];var _loop=function _loop(i){var deprecation=defaults[i];Object.defineProperty(core[deprecation.parent],"DEFAULT",{get:function get(){warn("PIXI."+deprecation.parent+".DEFAULT has been deprecated, "+("please use PIXI.settings."+deprecation.target));return core.settings[deprecation.target]},set:function set(value){warn("PIXI."+deprecation.parent+".DEFAULT has been deprecated, "+("please use PIXI.settings."+deprecation.target));core.settings[deprecation.target]=value}})};for(var i=0;i<defaults.length;i++){_loop(i)}Object.defineProperties(core.settings,{PRECISION:{get:function get(){warn("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT");return core.settings.PRECISION_FRAGMENT},set:function set(value){warn("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT");core.settings.PRECISION_FRAGMENT=value}}});if(extras.AnimatedSprite){Object.defineProperties(extras,{MovieClip:{get:function get(){warn("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on.");return extras.AnimatedSprite}}})}if(extras){Object.defineProperties(extras,{TextureTransform:{get:function get(){warn("The TextureTransform class has been renamed to TextureMatrix, "+"please use PIXI.TextureMatrix from now on.");return core.TextureMatrix}}})}core.DisplayObject.prototype.generateTexture=function generateTexture(renderer,scaleMode,resolution){warn("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)");return renderer.generateTexture(this,scaleMode,resolution)};core.Graphics.prototype.generateTexture=function generateTexture(scaleMode,resolution){warn("graphics generate texture has moved to the renderer. "+"Or to render a graphics to a texture using canvas please use generateCanvasTexture");return this.generateCanvasTexture(scaleMode,resolution)};core.GroupD8.isSwapWidthHeight=function isSwapWidthHeight(rotation){warn("GroupD8.isSwapWidthHeight was renamed to GroupD8.isVertical");return core.GroupD8.isVertical(rotation)};core.RenderTexture.prototype.render=function render(displayObject,matrix,clear,updateTransform){this.legacyRenderer.render(displayObject,this,clear,matrix,!updateTransform);warn("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")};core.RenderTexture.prototype.getImage=function getImage(target){warn("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)");return this.legacyRenderer.extract.image(target)};core.RenderTexture.prototype.getBase64=function getBase64(target){warn("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)");return this.legacyRenderer.extract.base64(target)};core.RenderTexture.prototype.getCanvas=function getCanvas(target){warn("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)");return this.legacyRenderer.extract.canvas(target)};core.RenderTexture.prototype.getPixels=function getPixels(target){warn("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)");return this.legacyRenderer.pixels(target)};core.Sprite.prototype.setTexture=function setTexture(texture){this.texture=texture;warn("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")};if(extras.BitmapText){extras.BitmapText.prototype.setText=function setText(text){this.text=text;warn("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")}}core.Text.prototype.setText=function setText(text){this.text=text;warn("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")};core.Text.calculateFontProperties=function calculateFontProperties(font){warn("Text.calculateFontProperties is now deprecated, please use the TextMetrics.measureFont");return core.TextMetrics.measureFont(font)};Object.defineProperties(core.Text,{fontPropertiesCache:{get:function get(){warn("Text.fontPropertiesCache is deprecated");return core.TextMetrics._fonts}},fontPropertiesCanvas:{get:function get(){warn("Text.fontPropertiesCanvas is deprecated");return core.TextMetrics._canvas}},fontPropertiesContext:{get:function get(){warn("Text.fontPropertiesContext is deprecated");return core.TextMetrics._context}}});core.Text.prototype.setStyle=function setStyle(style){this.style=style;warn("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")};core.Text.prototype.determineFontProperties=function determineFontProperties(fontStyle){warn("determineFontProperties is now deprecated, please use TextMetrics.measureFont method");return core.TextMetrics.measureFont(fontStyle)};core.Text.getFontStyle=function getFontStyle(style){warn("getFontStyle is now deprecated, please use TextStyle.toFontString() instead");style=style||{};if(!(style instanceof core.TextStyle)){style=new core.TextStyle(style)}return style.toFontString()};Object.defineProperties(core.TextStyle.prototype,{font:{get:function get(){warn("text style property 'font' is now deprecated, please use the "+"'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");var fontSizeString=typeof this._fontSize==="number"?this._fontSize+"px":this._fontSize;return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+fontSizeString+" "+this._fontFamily},set:function set(font){warn("text style property 'font' is now deprecated, please use the "+"'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on");if(font.indexOf("italic")>1){this._fontStyle="italic"}else if(font.indexOf("oblique")>-1){this._fontStyle="oblique"}else{this._fontStyle="normal"}if(font.indexOf("small-caps")>-1){this._fontVariant="small-caps"}else{this._fontVariant="normal"}var splits=font.split(" ");var fontSizeIndex=-1;this._fontSize=26;for(var i=0;i<splits.length;++i){if(splits[i].match(/(px|pt|em|%)/)){fontSizeIndex=i;this._fontSize=splits[i];break}}this._fontWeight="normal";for(var _i=0;_i<fontSizeIndex;++_i){if(splits[_i].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=splits[_i];break}}if(fontSizeIndex>-1&&fontSizeIndex<splits.length-1){this._fontFamily="";for(var _i2=fontSizeIndex+1;_i2<splits.length;++_i2){this._fontFamily+=splits[_i2]+" "}this._fontFamily=this._fontFamily.slice(0,-1)}else{this._fontFamily="Arial"}this.styleID++}}});core.Texture.prototype.setFrame=function setFrame(frame){this.frame=frame;warn("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")};core.Texture.addTextureToCache=function addTextureToCache(texture,id){core.Texture.addToCache(texture,id);warn("Texture.addTextureToCache is deprecated, please use Texture.addToCache from now on.")};core.Texture.removeTextureFromCache=function removeTextureFromCache(id){warn("Texture.removeTextureFromCache is deprecated, please use Texture.removeFromCache from now on. "+"Be aware that Texture.removeFromCache does not automatically its BaseTexture from the BaseTextureCache. "+"For that, use BaseTexture.removeFromCache");core.BaseTexture.removeFromCache(id);return core.Texture.removeFromCache(id)};Object.defineProperties(filters,{AbstractFilter:{get:function get(){warn("AstractFilter has been renamed to Filter, please use PIXI.Filter");return core.AbstractFilter}},SpriteMaskFilter:{get:function get(){warn("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on.");return core.SpriteMaskFilter}},VoidFilter:{get:function get(){warn("VoidFilter has been renamed to AlphaFilter, please use PIXI.filters.AlphaFilter");return filters.AlphaFilter}}});core.utils.uuid=function(){warn("utils.uuid() is deprecated, please use utils.uid() from now on.");return core.utils.uid()};core.utils.canUseNewCanvasBlendModes=function(){warn("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on");return core.CanvasTinter.canUseMultiply};var saidHello=true;Object.defineProperty(core.utils,"_saidHello",{set:function set(bool){if(bool){warn("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()");this.skipHello()}saidHello=bool},get:function get(){return saidHello}});if(prepare.BasePrepare){prepare.BasePrepare.prototype.register=function register(addHook,uploadHook){warn("renderer.plugins.prepare.register is now deprecated, "+"please use renderer.plugins.prepare.registerFindHook & renderer.plugins.prepare.registerUploadHook");if(addHook){this.registerFindHook(addHook)}if(uploadHook){this.registerUploadHook(uploadHook)}return this}}if(prepare.canvas){Object.defineProperty(prepare.canvas,"UPLOADS_PER_FRAME",{set:function set(){warn("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set "+"renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function get(){warn("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use "+"renderer.plugins.prepare.limiter");return NaN}})}if(prepare.webgl){Object.defineProperty(prepare.webgl,"UPLOADS_PER_FRAME",{set:function set(){warn("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set "+"renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function get(){warn("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use "+"renderer.plugins.prepare.limiter");return NaN}})}if(loaders.Loader){var Resource=loaders.Resource;var Loader=loaders.Loader;Object.defineProperties(Resource.prototype,{isJson:{get:function get(){warn("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`.");return this.type===Resource.TYPE.JSON}},isXml:{get:function get(){warn("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`.");return this.type===Resource.TYPE.XML}},isImage:{get:function get(){warn("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`.");return this.type===Resource.TYPE.IMAGE}},isAudio:{get:function get(){warn("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`.");return this.type===Resource.TYPE.AUDIO}},isVideo:{get:function get(){warn("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`.");return this.type===Resource.TYPE.VIDEO}}});Object.defineProperties(Loader.prototype,{before:{get:function get(){warn("The before() method is deprecated, please use pre().");return this.pre}},after:{get:function get(){warn("The after() method is deprecated, please use use().");return this.use}}})}if(interaction.interactiveTarget){Object.defineProperty(interaction.interactiveTarget,"defaultCursor",{set:function set(value){warn("Property defaultCursor has been replaced with 'cursor'. ");this.cursor=value},get:function get(){warn("Property defaultCursor has been replaced with 'cursor'. ");return this.cursor}})}if(interaction.InteractionManager){Object.defineProperty(interaction.InteractionManager,"defaultCursorStyle",{set:function set(value){warn("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. ");this.cursorStyles.default=value},get:function get(){warn("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. ");return this.cursorStyles.default}});Object.defineProperty(interaction.InteractionManager,"currentCursorStyle",{set:function set(value){warn("Property currentCursorStyle has been removed."+"See the currentCursorMode property, which works differently.");this.currentCursorMode=value},get:function get(){warn("Property currentCursorStyle has been removed."+"See the currentCursorMode property, which works differently.");return this.currentCursorMode}})}}},{}],188:[function(require,module,exports){"use strict";exports.__esModule=true;var _core=require("../../core");var core=_interopRequireWildcard(_core);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TEMP_RECT=new core.Rectangle;var CanvasExtract=function(){function CanvasExtract(renderer){_classCallCheck(this,CanvasExtract);this.renderer=renderer;renderer.extract=this}CanvasExtract.prototype.image=function image(target){var image=new Image;image.src=this.base64(target);return image};CanvasExtract.prototype.base64=function base64(target){return this.canvas(target).toDataURL()};CanvasExtract.prototype.canvas=function canvas(target){var renderer=this.renderer;var context=void 0;var resolution=void 0;var frame=void 0;var renderTexture=void 0;if(target){if(target instanceof core.RenderTexture){renderTexture=target}else{renderTexture=renderer.generateTexture(target)}}if(renderTexture){context=renderTexture.baseTexture._canvasRenderTarget.context;resolution=renderTexture.baseTexture._canvasRenderTarget.resolution;frame=renderTexture.frame}else{context=renderer.rootContext;frame=TEMP_RECT;frame.width=this.renderer.width;frame.height=this.renderer.height}var width=frame.width*resolution;var height=frame.height*resolution;var canvasBuffer=new core.CanvasRenderTarget(width,height);var canvasData=context.getImageData(frame.x*resolution,frame.y*resolution,width,height);canvasBuffer.context.putImageData(canvasData,0,0);return canvasBuffer.canvas};CanvasExtract.prototype.pixels=function pixels(target){var renderer=this.renderer;var context=void 0;var resolution=void 0;var frame=void 0;var renderTexture=void 0;if(target){if(target instanceof core.RenderTexture){renderTexture=target}else{renderTexture=renderer.generateTexture(target)}}if(renderTexture){context=renderTexture.baseTexture._canvasRenderTarget.context;resolution=renderTexture.baseTexture._canvasRenderTarget.resolution;frame=renderTexture.frame}else{context=renderer.rootContext;frame=TEMP_RECT;frame.width=renderer.width;frame.height=renderer.height}return context.getImageData(0,0,frame.width*resolution,frame.height*resolution).data};CanvasExtract.prototype.destroy=function destroy(){this.renderer.extract=null;this.renderer=null};return CanvasExtract}();exports.default=CanvasExtract;core.CanvasRenderer.registerPlugin("extract",CanvasExtract)},{"../../core":121}],189:[function(require,module,exports){"use strict";exports.__esModule=true;var _WebGLExtract=require("./webgl/WebGLExtract");Object.defineProperty(exports,"webgl",{enumerable:true,get:function get(){return _interopRequireDefault(_WebGLExtract).default}});var _CanvasExtract=require("./canvas/CanvasExtract");Object.defineProperty(exports,"canvas",{enumerable:true,get:function get(){return _interopRequireDefault(_CanvasExtract).default}});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./canvas/CanvasExtract":188,"./webgl/WebGLExtract":190}],190:[function(require,module,exports){"use strict";exports.__esModule=true;var _core=require("../../core");var core=_interopRequireWildcard(_core);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TEMP_RECT=new core.Rectangle;var BYTES_PER_PIXEL=4;var WebGLExtract=function(){function WebGLExtract(renderer){_classCallCheck(this,WebGLExtract);this.renderer=renderer;renderer.extract=this}WebGLExtract.prototype.image=function image(target){var image=new Image;image.src=this.base64(target);return image};WebGLExtract.prototype.base64=function base64(target){return this.canvas(target).toDataURL()};WebGLExtract.prototype.canvas=function canvas(target){var renderer=this.renderer;var textureBuffer=void 0;var resolution=void 0;var frame=void 0;var flipY=false;var renderTexture=void 0;var generated=false;if(target){if(target instanceof core.RenderTexture){renderTexture=target}else{renderTexture=this.renderer.generateTexture(target);generated=true}}if(renderTexture){textureBuffer=renderTexture.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID];resolution=textureBuffer.resolution;frame=renderTexture.frame;flipY=false}else{textureBuffer=this.renderer.rootRenderTarget;resolution=textureBuffer.resolution;flipY=true;frame=TEMP_RECT;frame.width=textureBuffer.size.width;frame.height=textureBuffer.size.height}var width=frame.width*resolution;var height=frame.height*resolution;var canvasBuffer=new core.CanvasRenderTarget(width,height);if(textureBuffer){renderer.bindRenderTarget(textureBuffer);var webglPixels=new Uint8Array(BYTES_PER_PIXEL*width*height);var gl=renderer.gl;gl.readPixels(frame.x*resolution,frame.y*resolution,width,height,gl.RGBA,gl.UNSIGNED_BYTE,webglPixels);var canvasData=canvasBuffer.context.getImageData(0,0,width,height);canvasData.data.set(webglPixels);canvasBuffer.context.putImageData(canvasData,0,0);if(flipY){canvasBuffer.context.scale(1,-1);canvasBuffer.context.drawImage(canvasBuffer.canvas,0,-height)}}if(generated){renderTexture.destroy(true)}return canvasBuffer.canvas};WebGLExtract.prototype.pixels=function pixels(target){var renderer=this.renderer;var textureBuffer=void 0;var resolution=void 0;var frame=void 0;var renderTexture=void 0;var generated=false;if(target){if(target instanceof core.RenderTexture){renderTexture=target}else{renderTexture=this.renderer.generateTexture(target);generated=true}}if(renderTexture){textureBuffer=renderTexture.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID];resolution=textureBuffer.resolution;frame=renderTexture.frame}else{textureBuffer=this.renderer.rootRenderTarget;resolution=textureBuffer.resolution;frame=TEMP_RECT;frame.width=textureBuffer.size.width;frame.height=textureBuffer.size.height}var width=frame.width*resolution;var height=frame.height*resolution;var webglPixels=new Uint8Array(BYTES_PER_PIXEL*width*height);if(textureBuffer){renderer.bindRenderTarget(textureBuffer);var gl=renderer.gl;gl.readPixels(frame.x*resolution,frame.y*resolution,width,height,gl.RGBA,gl.UNSIGNED_BYTE,webglPixels)}if(generated){renderTexture.destroy(true)}return webglPixels};WebGLExtract.prototype.destroy=function destroy(){this.renderer.extract=null;this.renderer=null};return WebGLExtract}();exports.default=WebGLExtract;core.WebGLRenderer.registerPlugin("extract",WebGLExtract)},{"../../core":121}],191:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../core");var core=_interopRequireWildcard(_core);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var AnimatedSprite=function(_core$Sprite){_inherits(AnimatedSprite,_core$Sprite);function AnimatedSprite(textures,autoUpdate){_classCallCheck(this,AnimatedSprite);var _this=_possibleConstructorReturn(this,_core$Sprite.call(this,textures[0]instanceof core.Texture?textures[0]:textures[0].texture));_this._textures=null;_this._durations=null;_this.textures=textures;_this._autoUpdate=autoUpdate!==false;_this.animationSpeed=1;_this.loop=true;_this.onComplete=null;_this.onFrameChange=null;_this.onLoop=null;_this._currentTime=0;_this.playing=false;return _this}AnimatedSprite.prototype.stop=function stop(){if(!this.playing){return}this.playing=false;if(this._autoUpdate){core.ticker.shared.remove(this.update,this)}};AnimatedSprite.prototype.play=function play(){if(this.playing){return}this.playing=true;if(this._autoUpdate){core.ticker.shared.add(this.update,this,core.UPDATE_PRIORITY.HIGH)}};AnimatedSprite.prototype.gotoAndStop=function gotoAndStop(frameNumber){this.stop();var previousFrame=this.currentFrame;this._currentTime=frameNumber;if(previousFrame!==this.currentFrame){this.updateTexture()}};AnimatedSprite.prototype.gotoAndPlay=function gotoAndPlay(frameNumber){var previousFrame=this.currentFrame;this._currentTime=frameNumber;if(previousFrame!==this.currentFrame){this.updateTexture()}this.play()};AnimatedSprite.prototype.update=function update(deltaTime){var elapsed=this.animationSpeed*deltaTime;var previousFrame=this.currentFrame;if(this._durations!==null){var lag=this._currentTime%1*this._durations[this.currentFrame];lag+=elapsed/60*1e3;while(lag<0){this._currentTime--;lag+=this._durations[this.currentFrame]}var sign=Math.sign(this.animationSpeed*deltaTime);this._currentTime=Math.floor(this._currentTime);while(lag>=this._durations[this.currentFrame]){lag-=this._durations[this.currentFrame]*sign;this._currentTime+=sign}this._currentTime+=lag/this._durations[this.currentFrame]}else{this._currentTime+=elapsed}if(this._currentTime<0&&!this.loop){this.gotoAndStop(0);if(this.onComplete){this.onComplete()}}else if(this._currentTime>=this._textures.length&&!this.loop){this.gotoAndStop(this._textures.length-1);if(this.onComplete){this.onComplete()}}else if(previousFrame!==this.currentFrame){if(this.loop&&this.onLoop){if(this.animationSpeed>0&&this.currentFrame<previousFrame){this.onLoop()}else if(this.animationSpeed<0&&this.currentFrame>previousFrame){this.onLoop()}}this.updateTexture()}};AnimatedSprite.prototype.updateTexture=function updateTexture(){this._texture=this._textures[this.currentFrame];this._textureID=-1;this.cachedTint=16777215;if(this.onFrameChange){this.onFrameChange(this.currentFrame)}};AnimatedSprite.prototype.destroy=function destroy(options){this.stop();_core$Sprite.prototype.destroy.call(this,options)};AnimatedSprite.fromFrames=function fromFrames(frames){var textures=[];for(var i=0;i<frames.length;++i){textures.push(core.Texture.fromFrame(frames[i]))}return new AnimatedSprite(textures)};AnimatedSprite.fromImages=function fromImages(images){var textures=[];for(var i=0;i<images.length;++i){textures.push(core.Texture.fromImage(images[i]))}return new AnimatedSprite(textures)};_createClass(AnimatedSprite,[{key:"totalFrames",get:function get(){return this._textures.length}},{key:"textures",get:function get(){return this._textures},set:function set(value){if(value[0]instanceof core.Texture){this._textures=value;this._durations=null}else{this._textures=[];this._durations=[];for(var i=0;i<value.length;i++){this._textures.push(value[i].texture);this._durations.push(value[i].time)}}this.gotoAndStop(0);this.updateTexture()}},{key:"currentFrame",get:function get(){var currentFrame=Math.floor(this._currentTime)%this._textures.length;if(currentFrame<0){currentFrame+=this._textures.length}return currentFrame}}]);return AnimatedSprite}(core.Sprite);exports.default=AnimatedSprite},{"../core":121}],192:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../core");var core=_interopRequireWildcard(_core);var _ObservablePoint=require("../core/math/ObservablePoint");var _ObservablePoint2=_interopRequireDefault(_ObservablePoint);var _utils=require("../core/utils");var _settings=require("../core/settings");var _settings2=_interopRequireDefault(_settings);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var BitmapText=function(_core$Container){_inherits(BitmapText,_core$Container);function BitmapText(text){var style=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,BitmapText);var _this=_possibleConstructorReturn(this,_core$Container.call(this));_this._textWidth=0;_this._textHeight=0;_this._glyphs=[];_this._font={tint:style.tint!==undefined?style.tint:16777215,align:style.align||"left",name:null,size:0};_this.font=style.font;_this._text=text;_this._maxWidth=0;_this._maxLineHeight=0;_this._letterSpacing=0;_this._anchor=new _ObservablePoint2.default(function(){_this.dirty=true},_this,0,0);_this.dirty=false;_this.updateText();return _this}BitmapText.prototype.updateText=function updateText(){var data=BitmapText.fonts[this._font.name];var scale=this._font.size/data.size;var pos=new core.Point;var chars=[];var lineWidths=[];var text=this.text.replace(/(?:\r\n|\r)/g,"\n");var textLength=text.length;var maxWidth=this._maxWidth*data.size/this._font.size;var prevCharCode=null;var lastLineWidth=0;var maxLineWidth=0;var line=0;var lastBreakPos=-1;var lastBreakWidth=0;var spacesRemoved=0;var maxLineHeight=0;for(var i=0;i<textLength;i++){var charCode=text.charCodeAt(i);var char=text.charAt(i);if(/(?:\s)/.test(char)){lastBreakPos=i;lastBreakWidth=lastLineWidth}if(char==="\r"||char==="\n"){lineWidths.push(lastLineWidth);maxLineWidth=Math.max(maxLineWidth,lastLineWidth);++line;++spacesRemoved;pos.x=0;pos.y+=data.lineHeight;prevCharCode=null;continue}var charData=data.chars[charCode];if(!charData){continue}if(prevCharCode&&charData.kerning[prevCharCode]){pos.x+=charData.kerning[prevCharCode]}chars.push({texture:charData.texture,line:line,charCode:charCode,position:new core.Point(pos.x+charData.xOffset+this._letterSpacing/2,pos.y+charData.yOffset)});pos.x+=charData.xAdvance+this._letterSpacing;lastLineWidth=pos.x;maxLineHeight=Math.max(maxLineHeight,charData.yOffset+charData.texture.height);prevCharCode=charCode;if(lastBreakPos!==-1&&maxWidth>0&&pos.x>maxWidth){++spacesRemoved;core.utils.removeItems(chars,1+lastBreakPos-spacesRemoved,1+i-lastBreakPos);i=lastBreakPos;lastBreakPos=-1;lineWidths.push(lastBreakWidth);maxLineWidth=Math.max(maxLineWidth,lastBreakWidth);line++;pos.x=0;pos.y+=data.lineHeight;prevCharCode=null}}var lastChar=text.charAt(text.length-1);if(lastChar!=="\r"&&lastChar!=="\n"){if(/(?:\s)/.test(lastChar)){lastLineWidth=lastBreakWidth}lineWidths.push(lastLineWidth);maxLineWidth=Math.max(maxLineWidth,lastLineWidth)}var lineAlignOffsets=[];for(var _i=0;_i<=line;_i++){var alignOffset=0;if(this._font.align==="right"){alignOffset=maxLineWidth-lineWidths[_i]}else if(this._font.align==="center"){alignOffset=(maxLineWidth-lineWidths[_i])/2}lineAlignOffsets.push(alignOffset)}var lenChars=chars.length;var tint=this.tint;for(var _i2=0;_i2<lenChars;_i2++){var c=this._glyphs[_i2];if(c){c.texture=chars[_i2].texture}else{c=new core.Sprite(chars[_i2].texture);this._glyphs.push(c)}c.position.x=(chars[_i2].position.x+lineAlignOffsets[chars[_i2].line])*scale;c.position.y=chars[_i2].position.y*scale;c.scale.x=c.scale.y=scale;c.tint=tint;if(!c.parent){this.addChild(c)}}for(var _i3=lenChars;_i3<this._glyphs.length;++_i3){this.removeChild(this._glyphs[_i3])}this._textWidth=maxLineWidth*scale;this._textHeight=(pos.y+data.lineHeight)*scale;if(this.anchor.x!==0||this.anchor.y!==0){for(var _i4=0;_i4<lenChars;_i4++){this._glyphs[_i4].x-=this._textWidth*this.anchor.x;this._glyphs[_i4].y-=this._textHeight*this.anchor.y}}this._maxLineHeight=maxLineHeight*scale};BitmapText.prototype.updateTransform=function updateTransform(){this.validate();this.containerUpdateTransform()};BitmapText.prototype.getLocalBounds=function getLocalBounds(){this.validate();return _core$Container.prototype.getLocalBounds.call(this)};BitmapText.prototype.validate=function validate(){if(this.dirty){this.updateText();this.dirty=false}};BitmapText.registerFont=function registerFont(xml,textures){var data={};var info=xml.getElementsByTagName("info")[0];var common=xml.getElementsByTagName("common")[0];var pages=xml.getElementsByTagName("page");var res=(0,_utils.getResolutionOfUrl)(pages[0].getAttribute("file"),_settings2.default.RESOLUTION);var pagesTextures={};data.font=info.getAttribute("face");data.size=parseInt(info.getAttribute("size"),10);data.lineHeight=parseInt(common.getAttribute("lineHeight"),10)/res;data.chars={};if(textures instanceof core.Texture){textures=[textures]}for(var i=0;i<pages.length;i++){var id=pages[i].getAttribute("id");var file=pages[i].getAttribute("file");pagesTextures[id]=textures instanceof Array?textures[i]:textures[file]}var letters=xml.getElementsByTagName("char");for(var _i5=0;_i5<letters.length;_i5++){var letter=letters[_i5];var charCode=parseInt(letter.getAttribute("id"),10);var page=letter.getAttribute("page")||0;var textureRect=new core.Rectangle(parseInt(letter.getAttribute("x"),10)/res+pagesTextures[page].frame.x/res,parseInt(letter.getAttribute("y"),10)/res+pagesTextures[page].frame.y/res,parseInt(letter.getAttribute("width"),10)/res,parseInt(letter.getAttribute("height"),10)/res);data.chars[charCode]={xOffset:parseInt(letter.getAttribute("xoffset"),10)/res,yOffset:parseInt(letter.getAttribute("yoffset"),10)/res,xAdvance:parseInt(letter.getAttribute("xadvance"),10)/res,kerning:{},texture:new core.Texture(pagesTextures[page].baseTexture,textureRect),page:page}}var kernings=xml.getElementsByTagName("kerning");for(var _i6=0;_i6<kernings.length;_i6++){var kerning=kernings[_i6];var first=parseInt(kerning.getAttribute("first"),10)/res;var second=parseInt(kerning.getAttribute("second"),10)/res;var amount=parseInt(kerning.getAttribute("amount"),10)/res;if(data.chars[second]){data.chars[second].kerning[first]=amount}}BitmapText.fonts[data.font]=data;return data};_createClass(BitmapText,[{key:"tint",get:function get(){return this._font.tint},set:function set(value){this._font.tint=typeof value==="number"&&value>=0?value:16777215;this.dirty=true}},{key:"align",get:function get(){return this._font.align},set:function set(value){this._font.align=value||"left";this.dirty=true}},{key:"anchor",get:function get(){return this._anchor},set:function set(value){if(typeof value==="number"){this._anchor.set(value)}else{this._anchor.copy(value)}}},{key:"font",get:function get(){return this._font},set:function set(value){if(!value){return}if(typeof value==="string"){value=value.split(" ");this._font.name=value.length===1?value[0]:value.slice(1).join(" ");this._font.size=value.length>=2?parseInt(value[0],10):BitmapText.fonts[this._font.name].size}else{this._font.name=value.name;this._font.size=typeof value.size==="number"?value.size:parseInt(value.size,10)}this.dirty=true}},{key:"text",get:function get(){return this._text},set:function set(value){value=value.toString()||" ";if(this._text===value){return}this._text=value;this.dirty=true}},{key:"maxWidth",get:function get(){return this._maxWidth},set:function set(value){if(this._maxWidth===value){return}this._maxWidth=value;this.dirty=true}},{key:"maxLineHeight",get:function get(){this.validate();return this._maxLineHeight}},{key:"textWidth",get:function get(){this.validate();return this._textWidth}},{key:"letterSpacing",get:function get(){return this._letterSpacing},set:function set(value){if(this._letterSpacing!==value){this._letterSpacing=value;this.dirty=true}}},{key:"textHeight",get:function get(){this.validate();return this._textHeight}}]);return BitmapText}(core.Container);exports.default=BitmapText;BitmapText.fonts={}},{"../core":121,"../core/math/ObservablePoint":124,"../core/settings":157,"../core/utils":181}],193:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../core");var core=_interopRequireWildcard(_core);var _CanvasTinter=require("../core/sprites/canvas/CanvasTinter");var _CanvasTinter2=_interopRequireDefault(_CanvasTinter);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var tempPoint=new core.Point;var TilingSprite=function(_core$Sprite){_inherits(TilingSprite,_core$Sprite);function TilingSprite(texture){var width=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100;var height=arguments.length>2&&arguments[2]!==undefined?arguments[2]:100;_classCallCheck(this,TilingSprite);var _this=_possibleConstructorReturn(this,_core$Sprite.call(this,texture));_this.tileTransform=new core.TransformStatic;_this._width=width;_this._height=height;_this._canvasPattern=null;_this.uvTransform=texture.transform||new core.TextureMatrix(texture);_this.pluginName="tilingSprite";_this.uvRespectAnchor=false;return _this}TilingSprite.prototype._onTextureUpdate=function _onTextureUpdate(){if(this.uvTransform){this.uvTransform.texture=this._texture}this.cachedTint=16777215};TilingSprite.prototype._renderWebGL=function _renderWebGL(renderer){var texture=this._texture;if(!texture||!texture.valid){return}this.tileTransform.updateLocalTransform();this.uvTransform.update();renderer.setObjectRenderer(renderer.plugins[this.pluginName]);renderer.plugins[this.pluginName].render(this)};TilingSprite.prototype._renderCanvas=function _renderCanvas(renderer){var texture=this._texture;if(!texture.baseTexture.hasLoaded){return}var context=renderer.context;var transform=this.worldTransform;var resolution=renderer.resolution;var baseTexture=texture.baseTexture;var baseTextureResolution=baseTexture.resolution;var modX=this.tilePosition.x/this.tileScale.x%texture._frame.width*baseTextureResolution;var modY=this.tilePosition.y/this.tileScale.y%texture._frame.height*baseTextureResolution;if(this._textureID!==this._texture._updateID||this.cachedTint!==this.tint){this._textureID=this._texture._updateID;var tempCanvas=new core.CanvasRenderTarget(texture._frame.width,texture._frame.height,baseTextureResolution);if(this.tint!==16777215){this.tintedTexture=_CanvasTinter2.default.getTintedTexture(this,this.tint);tempCanvas.context.drawImage(this.tintedTexture,0,0)}else{tempCanvas.context.drawImage(baseTexture.source,-texture._frame.x*baseTextureResolution,-texture._frame.y*baseTextureResolution)}this.cachedTint=this.tint;this._canvasPattern=tempCanvas.context.createPattern(tempCanvas.canvas,"repeat")}context.globalAlpha=this.worldAlpha;context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution);renderer.setBlendMode(this.blendMode);context.fillStyle=this._canvasPattern;context.scale(this.tileScale.x/baseTextureResolution,this.tileScale.y/baseTextureResolution);var anchorX=this.anchor.x*-this._width;var anchorY=this.anchor.y*-this._height;if(this.uvRespectAnchor){context.translate(modX,modY);context.fillRect(-modX+anchorX,-modY+anchorY,this._width/this.tileScale.x*baseTextureResolution,this._height/this.tileScale.y*baseTextureResolution)}else{context.translate(modX+anchorX,modY+anchorY);context.fillRect(-modX,-modY,this._width/this.tileScale.x*baseTextureResolution,this._height/this.tileScale.y*baseTextureResolution)}};TilingSprite.prototype._calculateBounds=function _calculateBounds(){var minX=this._width*-this._anchor._x;var minY=this._height*-this._anchor._y;var maxX=this._width*(1-this._anchor._x);var maxY=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,minX,minY,maxX,maxY)};TilingSprite.prototype.getLocalBounds=function getLocalBounds(rect){if(this.children.length===0){this._bounds.minX=this._width*-this._anchor._x;this._bounds.minY=this._height*-this._anchor._y;this._bounds.maxX=this._width*(1-this._anchor._x);this._bounds.maxY=this._height*(1-this._anchor._y);if(!rect){if(!this._localBoundsRect){this._localBoundsRect=new core.Rectangle}rect=this._localBoundsRect}return this._bounds.getRectangle(rect)}return _core$Sprite.prototype.getLocalBounds.call(this,rect)};TilingSprite.prototype.containsPoint=function containsPoint(point){this.worldTransform.applyInverse(point,tempPoint);var width=this._width;var height=this._height;var x1=-width*this.anchor._x;if(tempPoint.x>=x1&&tempPoint.x<x1+width){var y1=-height*this.anchor._y;if(tempPoint.y>=y1&&tempPoint.y<y1+height){return true}}return false};TilingSprite.prototype.destroy=function destroy(options){_core$Sprite.prototype.destroy.call(this,options);this.tileTransform=null;this.uvTransform=null};TilingSprite.from=function from(source,width,height){return new TilingSprite(core.Texture.from(source),width,height)};TilingSprite.fromFrame=function fromFrame(frameId,width,height){var texture=core.utils.TextureCache[frameId];if(!texture){throw new Error('The frameId "'+frameId+'" does not exist in the texture cache '+this)}return new TilingSprite(texture,width,height)};TilingSprite.fromImage=function fromImage(imageId,width,height,crossorigin,scaleMode){return new TilingSprite(core.Texture.fromImage(imageId,crossorigin,scaleMode),width,height)};_createClass(TilingSprite,[{key:"clampMargin",get:function get(){return this.uvTransform.clampMargin},set:function set(value){this.uvTransform.clampMargin=value;this.uvTransform.update(true)}},{key:"tileScale",get:function get(){return this.tileTransform.scale},set:function set(value){this.tileTransform.scale.copy(value)}},{key:"tilePosition",get:function get(){return this.tileTransform.position},set:function set(value){this.tileTransform.position.copy(value)}},{key:"width",get:function get(){return this._width},set:function set(value){this._width=value}},{key:"height",get:function get(){return this._height},set:function set(value){this._height=value}}]);return TilingSprite}(core.Sprite);exports.default=TilingSprite},{"../core":121,"../core/sprites/canvas/CanvasTinter":160}],194:[function(require,module,exports){"use strict";var _core=require("../core");var core=_interopRequireWildcard(_core);var _Texture=require("../core/textures/Texture");var _Texture2=_interopRequireDefault(_Texture);var _BaseTexture=require("../core/textures/BaseTexture");var _BaseTexture2=_interopRequireDefault(_BaseTexture);var _utils=require("../core/utils");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var DisplayObject=core.DisplayObject;var _tempMatrix=new core.Matrix;DisplayObject.prototype._cacheAsBitmap=false;DisplayObject.prototype._cacheData=false;var CacheData=function CacheData(){_classCallCheck(this,CacheData);this.textureCacheId=null;this.originalRenderWebGL=null;this.originalRenderCanvas=null;this.originalCalculateBounds=null;this.originalGetLocalBounds=null;this.originalUpdateTransform=null;this.originalHitTest=null;this.originalDestroy=null;this.originalMask=null;this.originalFilterArea=null;this.sprite=null};Object.defineProperties(DisplayObject.prototype,{cacheAsBitmap:{get:function get(){return this._cacheAsBitmap},set:function set(value){if(this._cacheAsBitmap===value){return}this._cacheAsBitmap=value;var data=void 0;if(value){if(!this._cacheData){this._cacheData=new CacheData}data=this._cacheData;data.originalRenderWebGL=this.renderWebGL;data.originalRenderCanvas=this.renderCanvas;data.originalUpdateTransform=this.updateTransform;data.originalCalculateBounds=this._calculateBounds;data.originalGetLocalBounds=this.getLocalBounds;data.originalDestroy=this.destroy;data.originalContainsPoint=this.containsPoint;data.originalMask=this._mask;data.originalFilterArea=this.filterArea;this.renderWebGL=this._renderCachedWebGL;this.renderCanvas=this._renderCachedCanvas;this.destroy=this._cacheAsBitmapDestroy}else{data=this._cacheData;if(data.sprite){this._destroyCachedDisplayObject()}this.renderWebGL=data.originalRenderWebGL;this.renderCanvas=data.originalRenderCanvas;this._calculateBounds=data.originalCalculateBounds;this.getLocalBounds=data.originalGetLocalBounds;this.destroy=data.originalDestroy;this.updateTransform=data.originalUpdateTransform;this.containsPoint=data.originalContainsPoint;this._mask=data.originalMask;this.filterArea=data.originalFilterArea}}}});DisplayObject.prototype._renderCachedWebGL=function _renderCachedWebGL(renderer){if(!this.visible||this.worldAlpha<=0||!this.renderable){return}this._initCachedDisplayObject(renderer);this._cacheData.sprite._transformID=-1;this._cacheData.sprite.worldAlpha=this.worldAlpha;this._cacheData.sprite._renderWebGL(renderer)};DisplayObject.prototype._initCachedDisplayObject=function _initCachedDisplayObject(renderer){if(this._cacheData&&this._cacheData.sprite){return}var cacheAlpha=this.alpha;this.alpha=1;renderer.currentRenderer.flush();var bounds=this.getLocalBounds().clone();if(this._filters){var padding=this._filters[0].padding;bounds.pad(padding)}var cachedRenderTarget=renderer._activeRenderTarget;var stack=renderer.filterManager.filterStack;var renderTexture=core.RenderTexture.create(bounds.width|0,bounds.height|0);var textureCacheId="cacheAsBitmap_"+(0,_utils.uid)();this._cacheData.textureCacheId=textureCacheId;_BaseTexture2.default.addToCache(renderTexture.baseTexture,textureCacheId);_Texture2.default.addToCache(renderTexture,textureCacheId);var m=_tempMatrix;m.tx=-bounds.x;m.ty=-bounds.y;this.transform.worldTransform.identity();this.renderWebGL=this._cacheData.originalRenderWebGL;renderer.render(this,renderTexture,true,m,true);renderer.bindRenderTarget(cachedRenderTarget);renderer.filterManager.filterStack=stack;this.renderWebGL=this._renderCachedWebGL;this.updateTransform=this.displayObjectUpdateTransform;this._mask=null;this.filterArea=null;var cachedSprite=new core.Sprite(renderTexture);cachedSprite.transform.worldTransform=this.transform.worldTransform;cachedSprite.anchor.x=-(bounds.x/bounds.width);cachedSprite.anchor.y=-(bounds.y/bounds.height);cachedSprite.alpha=cacheAlpha;cachedSprite._bounds=this._bounds;this._calculateBounds=this._calculateCachedBounds;this.getLocalBounds=this._getCachedLocalBounds;this._cacheData.sprite=cachedSprite;this.transform._parentID=-1;if(!this.parent){this.parent=renderer._tempDisplayObjectParent;this.updateTransform();this.parent=null}else{this.updateTransform()}this.containsPoint=cachedSprite.containsPoint.bind(cachedSprite)};DisplayObject.prototype._renderCachedCanvas=function _renderCachedCanvas(renderer){if(!this.visible||this.worldAlpha<=0||!this.renderable){return}this._initCachedDisplayObjectCanvas(renderer);this._cacheData.sprite.worldAlpha=this.worldAlpha;this._cacheData.sprite.renderCanvas(renderer)};DisplayObject.prototype._initCachedDisplayObjectCanvas=function _initCachedDisplayObjectCanvas(renderer){if(this._cacheData&&this._cacheData.sprite){return}var bounds=this.getLocalBounds();var cacheAlpha=this.alpha;this.alpha=1;var cachedRenderTarget=renderer.context;var renderTexture=core.RenderTexture.create(bounds.width|0,bounds.height|0);var textureCacheId="cacheAsBitmap_"+(0,_utils.uid)();this._cacheData.textureCacheId=textureCacheId;_BaseTexture2.default.addToCache(renderTexture.baseTexture,textureCacheId);_Texture2.default.addToCache(renderTexture,textureCacheId);var m=_tempMatrix;this.transform.localTransform.copy(m);m.invert();m.tx-=bounds.x;m.ty-=bounds.y;this.renderCanvas=this._cacheData.originalRenderCanvas;renderer.render(this,renderTexture,true,m,false);renderer.context=cachedRenderTarget;this.renderCanvas=this._renderCachedCanvas;this._calculateBounds=this._calculateCachedBounds;this._mask=null;this.filterArea=null;var cachedSprite=new core.Sprite(renderTexture);cachedSprite.transform.worldTransform=this.transform.worldTransform;cachedSprite.anchor.x=-(bounds.x/bounds.width);cachedSprite.anchor.y=-(bounds.y/bounds.height);cachedSprite._bounds=this._bounds;cachedSprite.alpha=cacheAlpha;if(!this.parent){this.parent=renderer._tempDisplayObjectParent;this.updateTransform();this.parent=null}else{this.updateTransform()}this.updateTransform=this.displayObjectUpdateTransform;this._cacheData.sprite=cachedSprite;this.containsPoint=cachedSprite.containsPoint.bind(cachedSprite)};DisplayObject.prototype._calculateCachedBounds=function _calculateCachedBounds(){this._cacheData.sprite._calculateBounds()};DisplayObject.prototype._getCachedLocalBounds=function _getCachedLocalBounds(){return this._cacheData.sprite.getLocalBounds()};DisplayObject.prototype._destroyCachedDisplayObject=function _destroyCachedDisplayObject(){this._cacheData.sprite._texture.destroy(true);this._cacheData.sprite=null;_BaseTexture2.default.removeFromCache(this._cacheData.textureCacheId);_Texture2.default.removeFromCache(this._cacheData.textureCacheId);this._cacheData.textureCacheId=null};DisplayObject.prototype._cacheAsBitmapDestroy=function _cacheAsBitmapDestroy(options){this.cacheAsBitmap=false;this.destroy(options)}},{"../core":121,"../core/textures/BaseTexture":168,"../core/textures/Texture":171,"../core/utils":181}],195:[function(require,module,exports){"use strict";var _core=require("../core");var core=_interopRequireWildcard(_core);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}core.DisplayObject.prototype.name=null;core.Container.prototype.getChildByName=function getChildByName(name){for(var i=0;i<this.children.length;i++){if(this.children[i].name===name){return this.children[i]}}return null}},{"../core":121}],196:[function(require,module,exports){"use strict";var _core=require("../core");var core=_interopRequireWildcard(_core);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}core.DisplayObject.prototype.getGlobalPosition=function getGlobalPosition(){var point=arguments.length>0&&arguments[0]!==undefined?arguments[0]:new core.Point;var skipUpdate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(this.parent){this.parent.toGlobal(this.position,point,skipUpdate)}else{point.x=this.position.x;point.y=this.position.y}return point}},{"../core":121}],197:[function(require,module,exports){"use strict";exports.__esModule=true;exports.BitmapText=exports.TilingSpriteRenderer=exports.TilingSprite=exports.AnimatedSprite=undefined;var _AnimatedSprite=require("./AnimatedSprite");Object.defineProperty(exports,"AnimatedSprite",{enumerable:true,get:function get(){return _interopRequireDefault(_AnimatedSprite).default}});var _TilingSprite=require("./TilingSprite");Object.defineProperty(exports,"TilingSprite",{enumerable:true,get:function get(){return _interopRequireDefault(_TilingSprite).default}});var _TilingSpriteRenderer=require("./webgl/TilingSpriteRenderer");Object.defineProperty(exports,"TilingSpriteRenderer",{enumerable:true,get:function get(){return _interopRequireDefault(_TilingSpriteRenderer).default}});var _BitmapText=require("./BitmapText");Object.defineProperty(exports,"BitmapText",{enumerable:true,get:function get(){return _interopRequireDefault(_BitmapText).default}});require("./cacheAsBitmap");require("./getChildByName");require("./getGlobalPosition");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./AnimatedSprite":191,"./BitmapText":192,"./TilingSprite":193,"./cacheAsBitmap":194,"./getChildByName":195,"./getGlobalPosition":196,"./webgl/TilingSpriteRenderer":198}],198:[function(require,module,exports){"use strict";exports.__esModule=true;var _core=require("../../core");var core=_interopRequireWildcard(_core);var _const=require("../../core/const");var _path=require("path");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var tempMat=new core.Matrix;var TilingSpriteRenderer=function(_core$ObjectRenderer){_inherits(TilingSpriteRenderer,_core$ObjectRenderer);function TilingSpriteRenderer(renderer){_classCallCheck(this,TilingSpriteRenderer);var _this=_possibleConstructorReturn(this,_core$ObjectRenderer.call(this,renderer));_this.shader=null;_this.simpleShader=null;_this.quad=null;return _this}TilingSpriteRenderer.prototype.onContextChange=function onContextChange(){var gl=this.renderer.gl;this.shader=new core.Shader(gl,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n");this.simpleShader=new core.Shader(gl,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n");this.renderer.bindVao(null);this.quad=new core.Quad(gl,this.renderer.state.attribState);this.quad.initVao(this.shader)};TilingSpriteRenderer.prototype.render=function render(ts){var renderer=this.renderer;var quad=this.quad;renderer.bindVao(quad.vao);var vertices=quad.vertices;vertices[0]=vertices[6]=ts._width*-ts.anchor.x;vertices[1]=vertices[3]=ts._height*-ts.anchor.y;vertices[2]=vertices[4]=ts._width*(1-ts.anchor.x);vertices[5]=vertices[7]=ts._height*(1-ts.anchor.y);if(ts.uvRespectAnchor){vertices=quad.uvs;vertices[0]=vertices[6]=-ts.anchor.x;vertices[1]=vertices[3]=-ts.anchor.y;vertices[2]=vertices[4]=1-ts.anchor.x;vertices[5]=vertices[7]=1-ts.anchor.y}quad.upload();var tex=ts._texture;var baseTex=tex.baseTexture;var lt=ts.tileTransform.localTransform;var uv=ts.uvTransform;var isSimple=baseTex.isPowerOfTwo&&tex.frame.width===baseTex.width&&tex.frame.height===baseTex.height;if(isSimple){if(!baseTex._glTextures[renderer.CONTEXT_UID]){if(baseTex.wrapMode===_const.WRAP_MODES.CLAMP){baseTex.wrapMode=_const.WRAP_MODES.REPEAT}}else{isSimple=baseTex.wrapMode!==_const.WRAP_MODES.CLAMP}}var shader=isSimple?this.simpleShader:this.shader;renderer.bindShader(shader);var w=tex.width;var h=tex.height;var W=ts._width;var H=ts._height;tempMat.set(lt.a*w/W,lt.b*w/H,lt.c*h/W,lt.d*h/H,lt.tx/W,lt.ty/H);tempMat.invert();if(isSimple){tempMat.prepend(uv.mapCoord)}else{shader.uniforms.uMapCoord=uv.mapCoord.toArray(true);shader.uniforms.uClampFrame=uv.uClampFrame;shader.uniforms.uClampOffset=uv.uClampOffset}shader.uniforms.uTransform=tempMat.toArray(true);shader.uniforms.uColor=core.utils.premultiplyTintToRgba(ts.tint,ts.worldAlpha,shader.uniforms.uColor,baseTex.premultipliedAlpha);shader.uniforms.translationMatrix=ts.transform.worldTransform.toArray(true);shader.uniforms.uSampler=renderer.bindTexture(tex);renderer.setBlendMode(core.utils.correctBlendMode(ts.blendMode,baseTex.premultipliedAlpha));quad.vao.draw(this.renderer.gl.TRIANGLES,6,0)};return TilingSpriteRenderer}(core.ObjectRenderer);exports.default=TilingSpriteRenderer;core.WebGLRenderer.registerPlugin("tilingSprite",TilingSpriteRenderer)},{"../../core":121,"../../core/const":102,path:78}],199:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../../core");var core=_interopRequireWildcard(_core);var _path=require("path");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var AlphaFilter=function(_core$Filter){_inherits(AlphaFilter,_core$Filter);function AlphaFilter(){var alpha=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;_classCallCheck(this,AlphaFilter);var _this=_possibleConstructorReturn(this,_core$Filter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n"));_this.alpha=alpha;_this.glShaderKey="alpha";return _this}_createClass(AlphaFilter,[{key:"alpha",get:function get(){return this.uniforms.uAlpha},set:function set(value){this.uniforms.uAlpha=value}}]);return AlphaFilter}(core.Filter);exports.default=AlphaFilter},{"../../core":121,path:78}],200:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../../core");var core=_interopRequireWildcard(_core);var _BlurXFilter=require("./BlurXFilter");var _BlurXFilter2=_interopRequireDefault(_BlurXFilter);var _BlurYFilter=require("./BlurYFilter");var _BlurYFilter2=_interopRequireDefault(_BlurYFilter);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var BlurFilter=function(_core$Filter){_inherits(BlurFilter,_core$Filter);function BlurFilter(strength,quality,resolution,kernelSize){_classCallCheck(this,BlurFilter);var _this=_possibleConstructorReturn(this,_core$Filter.call(this));_this.blurXFilter=new _BlurXFilter2.default(strength,quality,resolution,kernelSize);_this.blurYFilter=new _BlurYFilter2.default(strength,quality,resolution,kernelSize);_this.padding=0;_this.resolution=resolution||core.settings.RESOLUTION;_this.quality=quality||4;_this.blur=strength||8;return _this}BlurFilter.prototype.apply=function apply(filterManager,input,output){var renderTarget=filterManager.getRenderTarget(true);this.blurXFilter.apply(filterManager,input,renderTarget,true);this.blurYFilter.apply(filterManager,renderTarget,output,false);filterManager.returnRenderTarget(renderTarget)};_createClass(BlurFilter,[{key:"blur",get:function get(){return this.blurXFilter.blur},set:function set(value){this.blurXFilter.blur=this.blurYFilter.blur=value;this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}},{key:"quality",get:function get(){return this.blurXFilter.quality},set:function set(value){this.blurXFilter.quality=this.blurYFilter.quality=value}},{key:"blurX",get:function get(){return this.blurXFilter.blur},set:function set(value){this.blurXFilter.blur=value;this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}},{key:"blurY",get:function get(){return this.blurYFilter.blur},set:function set(value){this.blurYFilter.blur=value;this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}},{key:"blendMode",get:function get(){return this.blurYFilter._blendMode},set:function set(value){this.blurYFilter._blendMode=value}}]);return BlurFilter}(core.Filter);exports.default=BlurFilter},{"../../core":121,"./BlurXFilter":201,"./BlurYFilter":202}],201:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../../core");var core=_interopRequireWildcard(_core);var _generateBlurVertSource=require("./generateBlurVertSource");var _generateBlurVertSource2=_interopRequireDefault(_generateBlurVertSource);var _generateBlurFragSource=require("./generateBlurFragSource");var _generateBlurFragSource2=_interopRequireDefault(_generateBlurFragSource);var _getMaxBlurKernelSize=require("./getMaxBlurKernelSize");var _getMaxBlurKernelSize2=_interopRequireDefault(_getMaxBlurKernelSize);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var BlurXFilter=function(_core$Filter){_inherits(BlurXFilter,_core$Filter);function BlurXFilter(strength,quality,resolution,kernelSize){_classCallCheck(this,BlurXFilter);kernelSize=kernelSize||5;var vertSrc=(0,_generateBlurVertSource2.default)(kernelSize,true);var fragSrc=(0,_generateBlurFragSource2.default)(kernelSize);var _this=_possibleConstructorReturn(this,_core$Filter.call(this,vertSrc,fragSrc));_this.resolution=resolution||core.settings.RESOLUTION;_this._quality=0;_this.quality=quality||4;_this.strength=strength||8;_this.firstRun=true;return _this}BlurXFilter.prototype.apply=function apply(filterManager,input,output,clear){if(this.firstRun){var gl=filterManager.renderer.gl;var kernelSize=(0,_getMaxBlurKernelSize2.default)(gl);this.vertexSrc=(0,_generateBlurVertSource2.default)(kernelSize,true);this.fragmentSrc=(0,_generateBlurFragSource2.default)(kernelSize);this.firstRun=false}this.uniforms.strength=1/output.size.width*(output.size.width/input.size.width);this.uniforms.strength*=this.strength;this.uniforms.strength/=this.passes;if(this.passes===1){filterManager.applyFilter(this,input,output,clear)}else{var renderTarget=filterManager.getRenderTarget(true);var flip=input;var flop=renderTarget;for(var i=0;i<this.passes-1;i++){filterManager.applyFilter(this,flip,flop,true);var temp=flop;flop=flip;flip=temp}filterManager.applyFilter(this,flip,output,clear);filterManager.returnRenderTarget(renderTarget)}};_createClass(BlurXFilter,[{key:"blur",get:function get(){return this.strength},set:function set(value){this.padding=Math.abs(value)*2;this.strength=value}},{key:"quality",get:function get(){return this._quality},set:function set(value){this._quality=value;this.passes=value}}]);return BlurXFilter}(core.Filter);exports.default=BlurXFilter},{"../../core":121,"./generateBlurFragSource":203,"./generateBlurVertSource":204,"./getMaxBlurKernelSize":205}],202:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../../core");var core=_interopRequireWildcard(_core);var _generateBlurVertSource=require("./generateBlurVertSource");var _generateBlurVertSource2=_interopRequireDefault(_generateBlurVertSource);var _generateBlurFragSource=require("./generateBlurFragSource");var _generateBlurFragSource2=_interopRequireDefault(_generateBlurFragSource);var _getMaxBlurKernelSize=require("./getMaxBlurKernelSize");var _getMaxBlurKernelSize2=_interopRequireDefault(_getMaxBlurKernelSize);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var BlurYFilter=function(_core$Filter){_inherits(BlurYFilter,_core$Filter);function BlurYFilter(strength,quality,resolution,kernelSize){_classCallCheck(this,BlurYFilter);kernelSize=kernelSize||5;var vertSrc=(0,_generateBlurVertSource2.default)(kernelSize,false);var fragSrc=(0,_generateBlurFragSource2.default)(kernelSize);var _this=_possibleConstructorReturn(this,_core$Filter.call(this,vertSrc,fragSrc));_this.resolution=resolution||core.settings.RESOLUTION;_this._quality=0;_this.quality=quality||4;_this.strength=strength||8;_this.firstRun=true;return _this}BlurYFilter.prototype.apply=function apply(filterManager,input,output,clear){if(this.firstRun){var gl=filterManager.renderer.gl;var kernelSize=(0,_getMaxBlurKernelSize2.default)(gl);this.vertexSrc=(0,_generateBlurVertSource2.default)(kernelSize,false);this.fragmentSrc=(0,_generateBlurFragSource2.default)(kernelSize);this.firstRun=false}this.uniforms.strength=1/output.size.height*(output.size.height/input.size.height);this.uniforms.strength*=this.strength;this.uniforms.strength/=this.passes;if(this.passes===1){filterManager.applyFilter(this,input,output,clear)}else{var renderTarget=filterManager.getRenderTarget(true);var flip=input;var flop=renderTarget;for(var i=0;i<this.passes-1;i++){filterManager.applyFilter(this,flip,flop,true);var temp=flop;flop=flip;flip=temp}filterManager.applyFilter(this,flip,output,clear);filterManager.returnRenderTarget(renderTarget)}};_createClass(BlurYFilter,[{key:"blur",get:function get(){return this.strength},set:function set(value){this.padding=Math.abs(value)*2;this.strength=value}},{key:"quality",get:function get(){return this._quality},set:function set(value){this._quality=value;this.passes=value}}]);return BlurYFilter}(core.Filter);exports.default=BlurYFilter},{"../../core":121,"./generateBlurFragSource":203,"./generateBlurVertSource":204,"./getMaxBlurKernelSize":205}],203:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=generateFragBlurSource;var GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]};var fragTemplate=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");function generateFragBlurSource(kernelSize){var kernel=GAUSSIAN_VALUES[kernelSize];var halfLength=kernel.length;var fragSource=fragTemplate;var blurLoop="";var template="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";var value=void 0;for(var i=0;i<kernelSize;i++){var blur=template.replace("%index%",i);value=i;if(i>=halfLength){value=kernelSize-i-1}blur=blur.replace("%value%",kernel[value]);blurLoop+=blur;blurLoop+="\n"}fragSource=fragSource.replace("%blur%",blurLoop);fragSource=fragSource.replace("%size%",kernelSize);return fragSource}},{}],204:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=generateVertBlurSource;var vertTemplate=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join("\n");function generateVertBlurSource(kernelSize,x){var halfLength=Math.ceil(kernelSize/2);var vertSource=vertTemplate;var blurLoop="";var template=void 0;if(x){template="vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);"}else{template="vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);"}for(var i=0;i<kernelSize;i++){var blur=template.replace("%index%",i);blur=blur.replace("%sampleIndex%",i-(halfLength-1)+".0");blurLoop+=blur;blurLoop+="\n"}vertSource=vertSource.replace("%blur%",blurLoop);vertSource=vertSource.replace("%size%",kernelSize);return vertSource}},{}],205:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=getMaxKernelSize;function getMaxKernelSize(gl){var maxVaryings=gl.getParameter(gl.MAX_VARYING_VECTORS);var kernelSize=15;while(kernelSize>maxVaryings){kernelSize-=2}return kernelSize}},{}],206:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../../core");var core=_interopRequireWildcard(_core);var _path=require("path");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ColorMatrixFilter=function(_core$Filter){_inherits(ColorMatrixFilter,_core$Filter);function ColorMatrixFilter(){_classCallCheck(this,ColorMatrixFilter);var _this=_possibleConstructorReturn(this,_core$Filter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n"));_this.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];_this.alpha=1;return _this}ColorMatrixFilter.prototype._loadMatrix=function _loadMatrix(matrix){var multiply=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var newMatrix=matrix;if(multiply){this._multiply(newMatrix,this.uniforms.m,matrix);newMatrix=this._colorMatrix(newMatrix)}this.uniforms.m=newMatrix};ColorMatrixFilter.prototype._multiply=function _multiply(out,a,b){out[0]=a[0]*b[0]+a[1]*b[5]+a[2]*b[10]+a[3]*b[15];out[1]=a[0]*b[1]+a[1]*b[6]+a[2]*b[11]+a[3]*b[16];out[2]=a[0]*b[2]+a[1]*b[7]+a[2]*b[12]+a[3]*b[17];out[3]=a[0]*b[3]+a[1]*b[8]+a[2]*b[13]+a[3]*b[18];out[4]=a[0]*b[4]+a[1]*b[9]+a[2]*b[14]+a[3]*b[19]+a[4];out[5]=a[5]*b[0]+a[6]*b[5]+a[7]*b[10]+a[8]*b[15];out[6]=a[5]*b[1]+a[6]*b[6]+a[7]*b[11]+a[8]*b[16];out[7]=a[5]*b[2]+a[6]*b[7]+a[7]*b[12]+a[8]*b[17];out[8]=a[5]*b[3]+a[6]*b[8]+a[7]*b[13]+a[8]*b[18];out[9]=a[5]*b[4]+a[6]*b[9]+a[7]*b[14]+a[8]*b[19]+a[9];out[10]=a[10]*b[0]+a[11]*b[5]+a[12]*b[10]+a[13]*b[15];out[11]=a[10]*b[1]+a[11]*b[6]+a[12]*b[11]+a[13]*b[16];out[12]=a[10]*b[2]+a[11]*b[7]+a[12]*b[12]+a[13]*b[17];out[13]=a[10]*b[3]+a[11]*b[8]+a[12]*b[13]+a[13]*b[18];out[14]=a[10]*b[4]+a[11]*b[9]+a[12]*b[14]+a[13]*b[19]+a[14];out[15]=a[15]*b[0]+a[16]*b[5]+a[17]*b[10]+a[18]*b[15];out[16]=a[15]*b[1]+a[16]*b[6]+a[17]*b[11]+a[18]*b[16];out[17]=a[15]*b[2]+a[16]*b[7]+a[17]*b[12]+a[18]*b[17];out[18]=a[15]*b[3]+a[16]*b[8]+a[17]*b[13]+a[18]*b[18];out[19]=a[15]*b[4]+a[16]*b[9]+a[17]*b[14]+a[18]*b[19]+a[19];return out};ColorMatrixFilter.prototype._colorMatrix=function _colorMatrix(matrix){var m=new Float32Array(matrix);m[4]/=255;m[9]/=255;m[14]/=255;m[19]/=255;return m};ColorMatrixFilter.prototype.brightness=function brightness(b,multiply){var matrix=[b,0,0,0,0,0,b,0,0,0,0,0,b,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.greyscale=function greyscale(scale,multiply){var matrix=[scale,scale,scale,0,0,scale,scale,scale,0,0,scale,scale,scale,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.blackAndWhite=function blackAndWhite(multiply){var matrix=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.hue=function hue(rotation,multiply){rotation=(rotation||0)/180*Math.PI;var cosR=Math.cos(rotation);var sinR=Math.sin(rotation);var sqrt=Math.sqrt;var w=1/3;var sqrW=sqrt(w);var a00=cosR+(1-cosR)*w;var a01=w*(1-cosR)-sqrW*sinR;var a02=w*(1-cosR)+sqrW*sinR;var a10=w*(1-cosR)+sqrW*sinR;var a11=cosR+w*(1-cosR);var a12=w*(1-cosR)-sqrW*sinR;var a20=w*(1-cosR)-sqrW*sinR;var a21=w*(1-cosR)+sqrW*sinR;var a22=cosR+w*(1-cosR);var matrix=[a00,a01,a02,0,0,a10,a11,a12,0,0,a20,a21,a22,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.contrast=function contrast(amount,multiply){var v=(amount||0)+1;var o=-.5*(v-1);var matrix=[v,0,0,0,o,0,v,0,0,o,0,0,v,0,o,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.saturate=function saturate(){var amount=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var multiply=arguments[1];var x=amount*2/3+1;var y=(x-1)*-.5;var matrix=[x,y,y,0,0,y,x,y,0,0,y,y,x,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.desaturate=function desaturate(){this.saturate(-1)};ColorMatrixFilter.prototype.negative=function negative(multiply){var matrix=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.sepia=function sepia(multiply){var matrix=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.technicolor=function technicolor(multiply){var matrix=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.polaroid=function polaroid(multiply){var matrix=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.toBGR=function toBGR(multiply){var matrix=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.kodachrome=function kodachrome(multiply){var matrix=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.browni=function browni(multiply){var matrix=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.vintage=function vintage(multiply){var matrix=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.colorTone=function colorTone(desaturation,toned,lightColor,darkColor,multiply){desaturation=desaturation||.2;toned=toned||.15;lightColor=lightColor||16770432;darkColor=darkColor||3375104;var lR=(lightColor>>16&255)/255;var lG=(lightColor>>8&255)/255;var lB=(lightColor&255)/255;var dR=(darkColor>>16&255)/255;var dG=(darkColor>>8&255)/255;var dB=(darkColor&255)/255;var matrix=[.3,.59,.11,0,0,lR,lG,lB,desaturation,0,dR,dG,dB,toned,0,lR-dR,lG-dG,lB-dB,0,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.night=function night(intensity,multiply){intensity=intensity||.1;var matrix=[intensity*-2,-intensity,0,0,0,-intensity,0,intensity,0,0,0,intensity,intensity*2,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.predator=function predator(amount,multiply){var matrix=[11.224130630493164*amount,-4.794486999511719*amount,-2.8746118545532227*amount,0*amount,.40342438220977783*amount,-3.6330697536468506*amount,9.193157196044922*amount,-2.951810836791992*amount,0*amount,-1.316135048866272*amount,-3.2184197902679443*amount,-4.2375030517578125*amount,7.476448059082031*amount,0*amount,.8044459223747253*amount,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.lsd=function lsd(multiply){var matrix=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)};ColorMatrixFilter.prototype.reset=function reset(){var matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(matrix,false)};_createClass(ColorMatrixFilter,[{key:"matrix",get:function get(){return this.uniforms.m},set:function set(value){this.uniforms.m=value}},{key:"alpha",get:function get(){return this.uniforms.uAlpha},set:function set(value){this.uniforms.uAlpha=value}}]);return ColorMatrixFilter}(core.Filter);exports.default=ColorMatrixFilter;ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale},{"../../core":121,path:78}],207:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../../core");var core=_interopRequireWildcard(_core);var _path=require("path");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var DisplacementFilter=function(_core$Filter){_inherits(DisplacementFilter,_core$Filter);function DisplacementFilter(sprite,scale){_classCallCheck(this,DisplacementFilter);var maskMatrix=new core.Matrix;sprite.renderable=false;var _this=_possibleConstructorReturn(this,_core$Filter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy *= scale / filterArea.xy;\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n"));_this.maskSprite=sprite;_this.maskMatrix=maskMatrix;_this.uniforms.mapSampler=sprite._texture;_this.uniforms.filterMatrix=maskMatrix;_this.uniforms.scale={x:1,y:1};if(scale===null||scale===undefined){scale=20}_this.scale=new core.Point(scale,scale);return _this}DisplacementFilter.prototype.apply=function apply(filterManager,input,output){this.uniforms.filterMatrix=filterManager.calculateSpriteMatrix(this.maskMatrix,this.maskSprite);this.uniforms.scale.x=this.scale.x;this.uniforms.scale.y=this.scale.y;filterManager.applyFilter(this,input,output)};_createClass(DisplacementFilter,[{key:"map",get:function get(){return this.uniforms.mapSampler},set:function set(value){this.uniforms.mapSampler=value}}]);return DisplacementFilter}(core.Filter);exports.default=DisplacementFilter},{"../../core":121,path:78}],208:[function(require,module,exports){"use strict";exports.__esModule=true;var _core=require("../../core");var core=_interopRequireWildcard(_core);var _path=require("path");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var FXAAFilter=function(_core$Filter){_inherits(FXAAFilter,_core$Filter);function FXAAFilter(){_classCallCheck(this,FXAAFilter);return _possibleConstructorReturn(this,_core$Filter.call(this,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'))}return FXAAFilter}(core.Filter);exports.default=FXAAFilter},{"../../core":121,path:78}],209:[function(require,module,exports){"use strict";exports.__esModule=true;var _FXAAFilter=require("./fxaa/FXAAFilter");Object.defineProperty(exports,"FXAAFilter",{enumerable:true,get:function get(){return _interopRequireDefault(_FXAAFilter).default}});var _NoiseFilter=require("./noise/NoiseFilter");Object.defineProperty(exports,"NoiseFilter",{enumerable:true,get:function get(){return _interopRequireDefault(_NoiseFilter).default}});var _DisplacementFilter=require("./displacement/DisplacementFilter");Object.defineProperty(exports,"DisplacementFilter",{enumerable:true,get:function get(){return _interopRequireDefault(_DisplacementFilter).default}});var _BlurFilter=require("./blur/BlurFilter");Object.defineProperty(exports,"BlurFilter",{enumerable:true,get:function get(){return _interopRequireDefault(_BlurFilter).default}});var _BlurXFilter=require("./blur/BlurXFilter");Object.defineProperty(exports,"BlurXFilter",{enumerable:true,get:function get(){return _interopRequireDefault(_BlurXFilter).default}});var _BlurYFilter=require("./blur/BlurYFilter");Object.defineProperty(exports,"BlurYFilter",{enumerable:true,get:function get(){return _interopRequireDefault(_BlurYFilter).default}});var _ColorMatrixFilter=require("./colormatrix/ColorMatrixFilter");Object.defineProperty(exports,"ColorMatrixFilter",{enumerable:true,get:function get(){return _interopRequireDefault(_ColorMatrixFilter).default}});var _AlphaFilter=require("./alpha/AlphaFilter");Object.defineProperty(exports,"AlphaFilter",{enumerable:true,get:function get(){return _interopRequireDefault(_AlphaFilter).default}});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./alpha/AlphaFilter":199,"./blur/BlurFilter":200,"./blur/BlurXFilter":201,"./blur/BlurYFilter":202,"./colormatrix/ColorMatrixFilter":206,"./displacement/DisplacementFilter":207,"./fxaa/FXAAFilter":208,"./noise/NoiseFilter":210}],210:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../../core");var core=_interopRequireWildcard(_core);var _path=require("path");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var NoiseFilter=function(_core$Filter){_inherits(NoiseFilter,_core$Filter);function NoiseFilter(){var noise=arguments.length>0&&arguments[0]!==undefined?arguments[0]:.5;var seed=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Math.random();_classCallCheck(this,NoiseFilter);var _this=_possibleConstructorReturn(this,_core$Filter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n"));_this.noise=noise;_this.seed=seed;return _this}_createClass(NoiseFilter,[{key:"noise",get:function get(){return this.uniforms.uNoise},set:function set(value){this.uniforms.uNoise=value}},{key:"seed",get:function get(){return this.uniforms.uSeed},set:function set(value){this.uniforms.uSeed=value}}]);return NoiseFilter}(core.Filter);exports.default=NoiseFilter},{"../../core":121,path:78}],211:[function(require,module,exports){(function(global){"use strict";exports.__esModule=true;exports.loader=exports.prepare=exports.particles=exports.mesh=exports.loaders=exports.interaction=exports.filters=exports.extras=exports.extract=exports.accessibility=undefined;var _polyfill=require("./polyfill");Object.keys(_polyfill).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _polyfill[key]}})});var _core=require("./core");Object.keys(_core).forEach(function(key){if(key==="default"||key==="__esModule")return;Object.defineProperty(exports,key,{enumerable:true,get:function get(){return _core[key]}})});var _deprecation=require("./deprecation");var _deprecation2=_interopRequireDefault(_deprecation);var _accessibility=require("./accessibility");var accessibility=_interopRequireWildcard(_accessibility);var _extract=require("./extract");var extract=_interopRequireWildcard(_extract);var _extras=require("./extras");var extras=_interopRequireWildcard(_extras);var _filters=require("./filters");var filters=_interopRequireWildcard(_filters);var _interaction=require("./interaction");var interaction=_interopRequireWildcard(_interaction);var _loaders=require("./loaders");var loaders=_interopRequireWildcard(_loaders);var _mesh=require("./mesh");var mesh=_interopRequireWildcard(_mesh);var _particles=require("./particles");var particles=_interopRequireWildcard(_particles);var _prepare=require("./prepare");var prepare=_interopRequireWildcard(_prepare);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_core.utils.mixins.performMixins();var loader=loaders.shared||null;exports.accessibility=accessibility;exports.extract=extract;exports.extras=extras;exports.filters=filters;exports.interaction=interaction;exports.loaders=loaders;exports.mesh=mesh;exports.particles=particles;exports.prepare=prepare;exports.loader=loader;if(typeof _deprecation2.default==="function"){(0,_deprecation2.default)(exports)}global.PIXI=exports}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./accessibility":98,"./core":121,"./deprecation":187,"./extract":189,"./extras":197,"./filters":209,"./interaction":216,"./loaders":219,"./mesh":228,"./particles":231,"./polyfill":238,"./prepare":242}],212:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../core");var core=_interopRequireWildcard(_core);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var InteractionData=function(){function InteractionData(){_classCallCheck(this,InteractionData);this.global=new core.Point;this.target=null;this.originalEvent=null;this.identifier=null;this.isPrimary=false;this.button=0;this.buttons=0;this.width=0;this.height=0;this.tiltX=0;this.tiltY=0;this.pointerType=null;this.pressure=0;this.rotationAngle=0;this.twist=0;this.tangentialPressure=0}InteractionData.prototype.getLocalPosition=function getLocalPosition(displayObject,point,globalPos){return displayObject.worldTransform.applyInverse(globalPos||this.global,point)};InteractionData.prototype.copyEvent=function copyEvent(event){if(event.isPrimary){this.isPrimary=true}this.button=event.button;this.buttons=Number.isInteger(event.buttons)?event.buttons:event.which;this.width=event.width;this.height=event.height;this.tiltX=event.tiltX;this.tiltY=event.tiltY;this.pointerType=event.pointerType;this.pressure=event.pressure;this.rotationAngle=event.rotationAngle;this.twist=event.twist||0;this.tangentialPressure=event.tangentialPressure||0};InteractionData.prototype.reset=function reset(){this.isPrimary=false};_createClass(InteractionData,[{key:"pointerId",get:function get(){return this.identifier}}]);return InteractionData}();exports.default=InteractionData},{"../core":121}],213:[function(require,module,exports){"use strict";exports.__esModule=true;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var InteractionEvent=function(){function InteractionEvent(){_classCallCheck(this,InteractionEvent);this.stopped=false;this.target=null;this.currentTarget=null;this.type=null;this.data=null}InteractionEvent.prototype.stopPropagation=function stopPropagation(){this.stopped=true};InteractionEvent.prototype.reset=function reset(){this.stopped=false;this.currentTarget=null;this.target=null};return InteractionEvent}();exports.default=InteractionEvent},{}],214:[function(require,module,exports){"use strict";exports.__esModule=true;var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _core=require("../core");var core=_interopRequireWildcard(_core);var _InteractionData=require("./InteractionData");var _InteractionData2=_interopRequireDefault(_InteractionData);var _InteractionEvent=require("./InteractionEvent");var _InteractionEvent2=_interopRequireDefault(_InteractionEvent);var _InteractionTrackingData=require("./InteractionTrackingData");var _InteractionTrackingData2=_interopRequireDefault(_InteractionTrackingData);var _eventemitter=require("eventemitter3");var _eventemitter2=_interopRequireDefault(_eventemitter);var _interactiveTarget=require("./interactiveTarget");var _interactiveTarget2=_interopRequireDefault(_interactiveTarget);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}core.utils.mixins.delayMixin(core.DisplayObject.prototype,_interactiveTarget2.default);var MOUSE_POINTER_ID=1;var hitTestEvent={target:null,data:{global:null}};var InteractionManager=function(_EventEmitter){_inherits(InteractionManager,_EventEmitter);function InteractionManager(renderer,options){_classCallCheck(this,InteractionManager);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));options=options||{};_this.renderer=renderer;_this.autoPreventDefault=options.autoPreventDefault!==undefined?options.autoPreventDefault:true;_this.interactionFrequency=options.interactionFrequency||10;_this.mouse=new _InteractionData2.default;_this.mouse.identifier=MOUSE_POINTER_ID;_this.mouse.global.set(-999999);_this.activeInteractionData={};_this.activeInteractionData[MOUSE_POINTER_ID]=_this.mouse;_this.interactionDataPool=[];_this.eventData=new _InteractionEvent2.default;_this.interactionDOMElement=null;_this.moveWhenInside=false;_this.eventsAdded=false;_this.mouseOverRenderer=false;_this.supportsTouchEvents="ontouchstart"in window;_this.supportsPointerEvents=!!window.PointerEvent;_this.onPointerUp=_this.onPointerUp.bind(_this);_this.processPointerUp=_this.processPointerUp.bind(_this);_this.onPointerCancel=_this.onPointerCancel.bind(_this);_this.processPointerCancel=_this.processPointerCancel.bind(_this);_this.onPointerDown=_this.onPointerDown.bind(_this);_this.processPointerDown=_this.processPointerDown.bind(_this);_this.onPointerMove=_this.onPointerMove.bind(_this);_this.processPointerMove=_this.processPointerMove.bind(_this);_this.onPointerOut=_this.onPointerOut.bind(_this);_this.processPointerOverOut=_this.processPointerOverOut.bind(_this);_this.onPointerOver=_this.onPointerOver.bind(_this);_this.cursorStyles={default:"inherit",pointer:"pointer"};_this.currentCursorMode=null;_this.cursor=null;_this._tempPoint=new core.Point;_this.resolution=1;_this.setTargetElement(_this.renderer.view,_this.renderer.resolution);return _this}InteractionManager.prototype.hitTest=function hitTest(globalPoint,root){hitTestEvent.target=null;hitTestEvent.data.global=globalPoint;if(!root){root=this.renderer._lastObjectRendered}this.processInteractive(hitTestEvent,root,null,true);return hitTestEvent.target};InteractionManager.prototype.setTargetElement=function setTargetElement(element){var resolution=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this.removeEvents();this.interactionDOMElement=element;this.resolution=resolution;this.addEvents()};InteractionManager.prototype.addEvents=function addEvents(){if(!this.interactionDOMElement){return}core.ticker.shared.add(this.update,this,core.UPDATE_PRIORITY.INTERACTION);if(window.navigator.msPointerEnabled){this.interactionDOMElement.style["-ms-content-zooming"]="none";this.interactionDOMElement.style["-ms-touch-action"]="none"}else if(this.supportsPointerEvents){this.interactionDOMElement.style["touch-action"]="none"}if(this.supportsPointerEvents){window.document.addEventListener("pointermove",this.onPointerMove,true);this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,true);this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,true);this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,true);window.addEventListener("pointercancel",this.onPointerCancel,true);window.addEventListener("pointerup",this.onPointerUp,true)}else{window.document.addEventListener("mousemove",this.onPointerMove,true);this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,true);this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,true);this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,true);window.addEventListener("mouseup",this.onPointerUp,true)}if(this.supportsTouchEvents){this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,true);this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,true);this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,true);this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,true)}this.eventsAdded=true};InteractionManager.prototype.removeEvents=function removeEvents(){if(!this.interactionDOMElement){return}core.ticker.shared.remove(this.update,this);if(window.navigator.msPointerEnabled){this.interactionDOMElement.style["-ms-content-zooming"]="";this.interactionDOMElement.style["-ms-touch-action"]=""}else if(this.supportsPointerEvents){this.interactionDOMElement.style["touch-action"]=""}if(this.supportsPointerEvents){window.document.removeEventListener("pointermove",this.onPointerMove,true);this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,true);this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,true);this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,true);window.removeEventListener("pointercancel",this.onPointerCancel,true);window.removeEventListener("pointerup",this.onPointerUp,true)}else{window.document.removeEventListener("mousemove",this.onPointerMove,true);this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,true);this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,true);this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,true);window.removeEventListener("mouseup",this.onPointerUp,true)}if(this.supportsTouchEvents){this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,true);this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,true);this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,true);this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,true)}this.interactionDOMElement=null;this.eventsAdded=false};InteractionManager.prototype.update=function update(deltaTime){this._deltaTime+=deltaTime;if(this._deltaTime<this.interactionFrequency){return}this._deltaTime=0;if(!this.interactionDOMElement){return}if(this.didMove){this.didMove=false;return}this.cursor=null;for(var k in this.activeInteractionData){if(this.activeInteractionData.hasOwnProperty(k)){var interactionData=this.activeInteractionData[k];if(interactionData.originalEvent&&interactionData.pointerType!=="touch"){var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,interactionData.originalEvent,interactionData);this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerOverOut,true)}}}this.setCursorMode(this.cursor)};InteractionManager.prototype.setCursorMode=function setCursorMode(mode){mode=mode||"default";if(this.currentCursorMode===mode){return}this.currentCursorMode=mode;var style=this.cursorStyles[mode];if(style){switch(typeof style==="undefined"?"undefined":_typeof(style)){case"string":this.interactionDOMElement.style.cursor=style;break;case"function":style(mode);break;case"object":Object.assign(this.interactionDOMElement.style,style);break}}else if(typeof mode==="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,mode)){this.interactionDOMElement.style.cursor=mode}};InteractionManager.prototype.dispatchEvent=function dispatchEvent(displayObject,eventString,eventData){if(!eventData.stopped){eventData.currentTarget=displayObject;eventData.type=eventString;displayObject.emit(eventString,eventData);if(displayObject[eventString]){displayObject[eventString](eventData)}}};InteractionManager.prototype.mapPositionToPoint=function mapPositionToPoint(point,x,y){var rect=void 0;if(!this.interactionDOMElement.parentElement){rect={x:0,y:0,width:0,height:0}}else{rect=this.interactionDOMElement.getBoundingClientRect()}var resolutionMultiplier=navigator.isCocoonJS?this.resolution:1/this.resolution;point.x=(x-rect.left)*(this.interactionDOMElement.width/rect.width)*resolutionMultiplier;point.y=(y-rect.top)*(this.interactionDOMElement.height/rect.height)*resolutionMultiplier};InteractionManager.prototype.processInteractive=function processInteractive(interactionEvent,displayObject,func,hitTest,interactive){if(!displayObject||!displayObject.visible){return false}var point=interactionEvent.data.global;interactive=displayObject.interactive||interactive;var hit=false;var interactiveParent=interactive;var hitTestChildren=true;if(displayObject.hitArea){if(hitTest){displayObject.worldTransform.applyInverse(point,this._tempPoint);if(!displayObject.hitArea.contains(this._tempPoint.x,this._tempPoint.y)){hitTest=false;hitTestChildren=false}else{hit=true}}interactiveParent=false}else if(displayObject._mask){if(hitTest){if(!displayObject._mask.containsPoint(point)){hitTest=false;hitTestChildren=false}}}if(hitTestChildren&&displayObject.interactiveChildren&&displayObject.children){var children=displayObject.children;for(var i=children.length-1;i>=0;i--){var child=children[i];var childHit=this.processInteractive(interactionEvent,child,func,hitTest,interactiveParent);if(childHit){if(!child.parent){continue}interactiveParent=false;if(childHit){if(interactionEvent.target){hitTest=false}hit=true}}}}if(interactive){if(hitTest&&!interactionEvent.target){if(!displayObject.hitArea&&displayObject.containsPoint){if(displayObject.containsPoint(point)){hit=true}}}if(displayObject.interactive){if(hit&&!interactionEvent.target){interactionEvent.target=displayObject}if(func){func(interactionEvent,displayObject,!!hit)}}}return hit};InteractionManager.prototype.onPointerDown=function onPointerDown(originalEvent){if(this.supportsTouchEvents&&originalEvent.pointerType==="touch")return;var events=this.normalizeToPointerData(originalEvent);if(this.autoPreventDefault&&events[0].isNormalized){originalEvent.preventDefault()}var eventLen=events.length;for(var i=0;i<eventLen;i++){var event=events[i];var interactionData=this.getInteractionDataForPointerId(event);var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=originalEvent;this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerDown,true);this.emit("pointerdown",interactionEvent);if(event.pointerType==="touch"){this.emit("touchstart",interactionEvent)}else if(event.pointerType==="mouse"||event.pointerType==="pen"){var isRightButton=event.button===2;this.emit(isRightButton?"rightdown":"mousedown",this.eventData)}}};InteractionManager.prototype.processPointerDown=function processPointerDown(interactionEvent,displayObject,hit){var data=interactionEvent.data;var id=interactionEvent.data.identifier;if(hit){if(!displayObject.trackedPointers[id]){displayObject.trackedPointers[id]=new _InteractionTrackingData2.default(id)}this.dispatchEvent(displayObject,"pointerdown",interactionEvent);if(data.pointerType==="touch"){this.dispatchEvent(displayObject,"touchstart",interactionEvent)}else if(data.pointerType==="mouse"||data.pointerType==="pen"){var isRightButton=data.button===2;if(isRightButton){displayObject.trackedPointers[id].rightDown=true}else{displayObject.trackedPointers[id].leftDown=true}this.dispatchEvent(displayObject,isRightButton?"rightdown":"mousedown",interactionEvent)}}};InteractionManager.prototype.onPointerComplete=function onPointerComplete(originalEvent,cancelled,func){var events=this.normalizeToPointerData(originalEvent);var eventLen=events.length;var eventAppend=originalEvent.target!==this.interactionDOMElement?"outside":"";for(var i=0;i<eventLen;i++){var event=events[i];var interactionData=this.getInteractionDataForPointerId(event);var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=originalEvent;this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,func,cancelled||!eventAppend);this.emit(cancelled?"pointercancel":"pointerup"+eventAppend,interactionEvent);if(event.pointerType==="mouse"||event.pointerType==="pen"){var isRightButton=event.button===2;this.emit(isRightButton?"rightup"+eventAppend:"mouseup"+eventAppend,interactionEvent)}else if(event.pointerType==="touch"){this.emit(cancelled?"touchcancel":"touchend"+eventAppend,interactionEvent);this.releaseInteractionDataForPointerId(event.pointerId,interactionData)}}};InteractionManager.prototype.onPointerCancel=function onPointerCancel(event){if(this.supportsTouchEvents&&event.pointerType==="touch")return;this.onPointerComplete(event,true,this.processPointerCancel)};InteractionManager.prototype.processPointerCancel=function processPointerCancel(interactionEvent,displayObject){var data=interactionEvent.data;var id=interactionEvent.data.identifier;if(displayObject.trackedPointers[id]!==undefined){delete displayObject.trackedPointers[id];this.dispatchEvent(displayObject,"pointercancel",interactionEvent);if(data.pointerType==="touch"){this.dispatchEvent(displayObject,"touchcancel",interactionEvent)}}};InteractionManager.prototype.onPointerUp=function onPointerUp(event){if(this.supportsTouchEvents&&event.pointerType==="touch")return;this.onPointerComplete(event,false,this.processPointerUp)};InteractionManager.prototype.processPointerUp=function processPointerUp(interactionEvent,displayObject,hit){var data=interactionEvent.data;var id=interactionEvent.data.identifier;var trackingData=displayObject.trackedPointers[id];var isTouch=data.pointerType==="touch";var isMouse=data.pointerType==="mouse"||data.pointerType==="pen";var isMouseTap=false;if(isMouse){var isRightButton=data.button===2;var flags=_InteractionTrackingData2.default.FLAGS;var test=isRightButton?flags.RIGHT_DOWN:flags.LEFT_DOWN;var isDown=trackingData!==undefined&&trackingData.flags&test;if(hit){this.dispatchEvent(displayObject,isRightButton?"rightup":"mouseup",interactionEvent);if(isDown){this.dispatchEvent(displayObject,isRightButton?"rightclick":"click",interactionEvent);isMouseTap=true}}else if(isDown){this.dispatchEvent(displayObject,isRightButton?"rightupoutside":"mouseupoutside",interactionEvent)}if(trackingData){if(isRightButton){trackingData.rightDown=false}else{trackingData.leftDown=false}}}if(hit){this.dispatchEvent(displayObject,"pointerup",interactionEvent);if(isTouch)this.dispatchEvent(displayObject,"touchend",interactionEvent);if(trackingData){if(!isMouse||isMouseTap){this.dispatchEvent(displayObject,"pointertap",interactionEvent)}if(isTouch){this.dispatchEvent(displayObject,"tap",interactionEvent);trackingData.over=false}}}else if(trackingData){this.dispatchEvent(displayObject,"pointerupoutside",interactionEvent);if(isTouch)this.dispatchEvent(displayObject,"touchendoutside",interactionEvent)}if(trackingData&&trackingData.none){delete displayObject.trackedPointers[id]}};InteractionManager.prototype.onPointerMove=function onPointerMove(originalEvent){if(this.supportsTouchEvents&&originalEvent.pointerType==="touch")return;var events=this.normalizeToPointerData(originalEvent);if(events[0].pointerType==="mouse"||events[0].pointerType==="pen"){this.didMove=true;this.cursor=null}var eventLen=events.length;for(var i=0;i<eventLen;i++){var event=events[i];var interactionData=this.getInteractionDataForPointerId(event);var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=originalEvent;var interactive=event.pointerType==="touch"?this.moveWhenInside:true;this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerMove,interactive);this.emit("pointermove",interactionEvent);if(event.pointerType==="touch")this.emit("touchmove",interactionEvent);if(event.pointerType==="mouse"||event.pointerType==="pen")this.emit("mousemove",interactionEvent)}if(events[0].pointerType==="mouse"){this.setCursorMode(this.cursor)}};InteractionManager.prototype.processPointerMove=function processPointerMove(interactionEvent,displayObject,hit){var data=interactionEvent.data;var isTouch=data.pointerType==="touch";var isMouse=data.pointerType==="mouse"||data.pointerType==="pen";if(isMouse){this.processPointerOverOut(interactionEvent,displayObject,hit)}if(!this.moveWhenInside||hit){this.dispatchEvent(displayObject,"pointermove",interactionEvent);if(isTouch)this.dispatchEvent(displayObject,"touchmove",interactionEvent);if(isMouse)this.dispatchEvent(displayObject,"mousemove",interactionEvent)}};InteractionManager.prototype.onPointerOut=function onPointerOut(originalEvent){if(this.supportsTouchEvents&&originalEvent.pointerType==="touch")return;var events=this.normalizeToPointerData(originalEvent);var event=events[0];if(event.pointerType==="mouse"){this.mouseOverRenderer=false;this.setCursorMode(null)}var interactionData=this.getInteractionDataForPointerId(event);var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=event;this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerOverOut,false);this.emit("pointerout",interactionEvent);if(event.pointerType==="mouse"||event.pointerType==="pen"){this.emit("mouseout",interactionEvent)}else{this.releaseInteractionDataForPointerId(interactionData.identifier)}};InteractionManager.prototype.processPointerOverOut=function processPointerOverOut(interactionEvent,displayObject,hit){var data=interactionEvent.data;var id=interactionEvent.data.identifier;var isMouse=data.pointerType==="mouse"||data.pointerType==="pen";var trackingData=displayObject.trackedPointers[id];if(hit&&!trackingData){trackingData=displayObject.trackedPointers[id]=new _InteractionTrackingData2.default(id)}if(trackingData===undefined)return;if(hit&&this.mouseOverRenderer){if(!trackingData.over){trackingData.over=true;this.dispatchEvent(displayObject,"pointerover",interactionEvent);if(isMouse){this.dispatchEvent(displayObject,"mouseover",interactionEvent)}}if(isMouse&&this.cursor===null){this.cursor=displayObject.cursor}}else if(trackingData.over){trackingData.over=false;this.dispatchEvent(displayObject,"pointerout",this.eventData);if(isMouse){this.dispatchEvent(displayObject,"mouseout",interactionEvent)}if(trackingData.none){delete displayObject.trackedPointers[id]}}};InteractionManager.prototype.onPointerOver=function onPointerOver(originalEvent){var events=this.normalizeToPointerData(originalEvent);var event=events[0];var interactionData=this.getInteractionDataForPointerId(event);var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=event;if(event.pointerType==="mouse"){this.mouseOverRenderer=true}this.emit("pointerover",interactionEvent);if(event.pointerType==="mouse"||event.pointerType==="pen"){this.emit("mouseover",interactionEvent)}};InteractionManager.prototype.getInteractionDataForPointerId=function getInteractionDataForPointerId(event){var pointerId=event.pointerId;var interactionData=void 0;if(pointerId===MOUSE_POINTER_ID||event.pointerType==="mouse"){interactionData=this.mouse}else if(this.activeInteractionData[pointerId]){interactionData=this.activeInteractionData[pointerId]}else{interactionData=this.interactionDataPool.pop()||new _InteractionData2.default;interactionData.identifier=pointerId;this.activeInteractionData[pointerId]=interactionData}interactionData.copyEvent(event);return interactionData};InteractionManager.prototype.releaseInteractionDataForPointerId=function releaseInteractionDataForPointerId(pointerId){var interactionData=this.activeInteractionData[pointerId];if(interactionData){delete this.activeInteractionData[pointerId];interactionData.reset();this.interactionDataPool.push(interactionData)}};InteractionManager.prototype.configureInteractionEventForDOMEvent=function configureInteractionEventForDOMEvent(interactionEvent,pointerEvent,interactionData){interactionEvent.data=interactionData;this.mapPositionToPoint(interactionData.global,pointerEvent.clientX,pointerEvent.clientY);if(navigator.isCocoonJS&&pointerEvent.pointerType==="touch"){interactionData.global.x=interactionData.global.x/this.resolution;interactionData.global.y=interactionData.global.y/this.resolution}if(pointerEvent.pointerType==="touch"){pointerEvent.globalX=interactionData.global.x;pointerEvent.globalY=interactionData.global.y}interactionData.originalEvent=pointerEvent;interactionEvent.reset();return interactionEvent};InteractionManager.prototype.normalizeToPointerData=function normalizeToPointerData(event){var normalizedEvents=[];if(this.supportsTouchEvents&&event instanceof TouchEvent){for(var i=0,li=event.changedTouches.length;i<li;i++){var touch=event.changedTouches[i];if(typeof touch.button==="undefined")touch.button=event.touches.length?1:0;if(typeof touch.buttons==="undefined")touch.buttons=event.touches.length?1:0;if(typeof touch.isPrimary==="undefined"){touch.isPrimary=event.touches.length===1&&event.type==="touchstart"}if(typeof touch.width==="undefined")touch.width=touch.radiusX||1;if(typeof touch.height==="undefined")touch.height=touch.radiusY||1;if(typeof touch.tiltX==="undefined")touch.tiltX=0;if(typeof touch.tiltY==="undefined")touch.tiltY=0;if(typeof touch.pointerType==="undefined")touch.pointerType="touch";if(typeof touch.pointerId==="undefined")touch.pointerId=touch.identifier||0;if(typeof touch.pressure==="undefined")touch.pressure=touch.force||.5;touch.twist=0;touch.tangentialPressure=0;if(typeof touch.layerX==="undefined")touch.layerX=touch.offsetX=touch.clientX;if(typeof touch.layerY==="undefined")touch.layerY=touch.offsetY=touch.clientY;touch.isNormalized=true;normalizedEvents.push(touch)}}else if(event instanceof MouseEvent&&(!this.supportsPointerEvents||!(event instanceof window.PointerEvent))){if(typeof event.isPrimary==="undefined")event.isPrimary=true;if(typeof event.width==="undefined")event.width=1;if(typeof event.height==="undefined")event.height=1;if(typeof event.tiltX==="undefined")event.tiltX=0;if(typeof event.tiltY==="undefined")event.tiltY=0;if(typeof event.pointerType==="undefined")event.pointerType="mouse";if(typeof event.pointerId==="undefined")event.pointerId=MOUSE_POINTER_ID;if(typeof event.pressure==="undefined")event.pressure=.5;event.twist=0;event.tangentialPressure=0;event.isNormalized=true;normalizedEvents.push(event)}else{normalizedEvents.push(event)}return normalizedEvents};InteractionManager.prototype.destroy=function destroy(){this.removeEvents();this.removeAllListeners();this.renderer=null;this.mouse=null;this.eventData=null;this.interactionDOMElement=null;this.onPointerDown=null;this.processPointerDown=null;this.onPointerUp=null;this.processPointerUp=null;this.onPointerCancel=null;this.processPointerCancel=null;this.onPointerMove=null;this.processPointerMove=null;this.onPointerOut=null;this.processPointerOverOut=null;this.onPointerOver=null;this._tempPoint=null};return InteractionManager}(_eventemitter2.default);exports.default=InteractionManager;core.WebGLRenderer.registerPlugin("interaction",InteractionManager);core.CanvasRenderer.registerPlugin("interaction",InteractionManager)},{"../core":121,"./InteractionData":212,"./InteractionEvent":213,"./InteractionTrackingData":215,"./interactiveTarget":217,eventemitter3:62}],215:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var InteractionTrackingData=function(){function InteractionTrackingData(pointerId){_classCallCheck(this,InteractionTrackingData);this._pointerId=pointerId;this._flags=InteractionTrackingData.FLAGS.NONE}InteractionTrackingData.prototype._doSet=function _doSet(flag,yn){if(yn){this._flags=this._flags|flag}else{this._flags=this._flags&~flag}};_createClass(InteractionTrackingData,[{key:"pointerId",get:function get(){return this._pointerId}},{key:"flags",get:function get(){return this._flags},set:function set(flags){this._flags=flags}},{key:"none",get:function get(){return this._flags===this.constructor.FLAGS.NONE}},{key:"over",get:function get(){return(this._flags&this.constructor.FLAGS.OVER)!==0},set:function set(yn){this._doSet(this.constructor.FLAGS.OVER,yn)}},{key:"rightDown",get:function get(){return(this._flags&this.constructor.FLAGS.RIGHT_DOWN)!==0},set:function set(yn){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,yn)}},{key:"leftDown",get:function get(){return(this._flags&this.constructor.FLAGS.LEFT_DOWN)!==0},set:function set(yn){this._doSet(this.constructor.FLAGS.LEFT_DOWN,yn)}}]);return InteractionTrackingData}();exports.default=InteractionTrackingData;InteractionTrackingData.FLAGS=Object.freeze({NONE:0,OVER:1<<0,LEFT_DOWN:1<<1,RIGHT_DOWN:1<<2})},{}],216:[function(require,module,exports){"use strict";exports.__esModule=true;var _InteractionData=require("./InteractionData");Object.defineProperty(exports,"InteractionData",{enumerable:true,get:function get(){return _interopRequireDefault(_InteractionData).default}});var _InteractionManager=require("./InteractionManager");Object.defineProperty(exports,"InteractionManager",{enumerable:true,get:function get(){return _interopRequireDefault(_InteractionManager).default}});var _interactiveTarget=require("./interactiveTarget");Object.defineProperty(exports,"interactiveTarget",{enumerable:true,get:function get(){return _interopRequireDefault(_interactiveTarget).default}});var _InteractionTrackingData=require("./InteractionTrackingData");Object.defineProperty(exports,"InteractionTrackingData",{enumerable:true,get:function get(){return _interopRequireDefault(_InteractionTrackingData).default}});var _InteractionEvent=require("./InteractionEvent");Object.defineProperty(exports,"InteractionEvent",{enumerable:true,get:function get(){return _interopRequireDefault(_InteractionEvent).default}});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./InteractionData":212,"./InteractionEvent":213,"./InteractionManager":214,"./InteractionTrackingData":215,"./interactiveTarget":217}],217:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default={interactive:false,interactiveChildren:true,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(value){if(value){this.cursor="pointer"}else if(this.cursor==="pointer"){this.cursor=null}},cursor:null,get trackedPointers(){if(this._trackedPointers===undefined)this._trackedPointers={};return this._trackedPointers},_trackedPointers:undefined}},{}],218:[function(require,module,exports){"use strict";exports.__esModule=true;exports.parse=parse;exports.default=function(){return function bitmapFontParser(resource,next){if(!resource.data||resource.type!==_resourceLoader.Resource.TYPE.XML){next();return}if(resource.data.getElementsByTagName("page").length===0||resource.data.getElementsByTagName("info").length===0||resource.data.getElementsByTagName("info")[0].getAttribute("face")===null){next();return}var xmlUrl=!resource.isDataUrl?path.dirname(resource.url):"";if(resource.isDataUrl){if(xmlUrl==="."){xmlUrl=""}if(this.baseUrl&&xmlUrl){if(this.baseUrl.charAt(this.baseUrl.length-1)==="/"){xmlUrl+="/"}}}xmlUrl=xmlUrl.replace(this.baseUrl,"");if(xmlUrl&&xmlUrl.charAt(xmlUrl.length-1)!=="/"){xmlUrl+="/"}var pages=resource.data.getElementsByTagName("page");var textures={};var completed=function completed(page){textures[page.metadata.pageFile]=page.texture;if(Object.keys(textures).length===pages.length){parse(resource,textures);next()}};for(var i=0;i<pages.length;++i){var pageFile=pages[i].getAttribute("file");var url=xmlUrl+pageFile;var exists=false;for(var name in this.resources){if(this.resources[name].url===url){this.resources[name].metadata.pageFile=pageFile;completed(this.resources[name]);exists=true;break}}if(!exists){var options={crossOrigin:resource.crossOrigin,loadType:_resourceLoader.Resource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:pageFile},resource.metadata.imageMetadata),parentResource:resource};this.add(url,options,completed)}}}};var _path=require("path");var path=_interopRequireWildcard(_path);var _resourceLoader=require("resource-loader");var _extras=require("../extras");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function parse(resource,textures){resource.bitmapFont=_extras.BitmapText.registerFont(resource.data,textures)}},{"../extras":197,path:78,"resource-loader":256}],219:[function(require,module,exports){"use strict";exports.__esModule=true;exports.shared=exports.Resource=exports.textureParser=exports.getResourcePath=exports.spritesheetParser=exports.parseBitmapFontData=exports.bitmapFontParser=exports.Loader=undefined;var _bitmapFontParser=require("./bitmapFontParser");Object.defineProperty(exports,"bitmapFontParser",{enumerable:true,get:function get(){return _interopRequireDefault(_bitmapFontParser).default}});Object.defineProperty(exports,"parseBitmapFontData",{enumerable:true,get:function get(){return _bitmapFontParser.parse}});var _spritesheetParser=require("./spritesheetParser");Object.defineProperty(exports,"spritesheetParser",{enumerable:true,get:function get(){return _interopRequireDefault(_spritesheetParser).default}});Object.defineProperty(exports,"getResourcePath",{enumerable:true,get:function get(){return _spritesheetParser.getResourcePath}});var _textureParser=require("./textureParser");Object.defineProperty(exports,"textureParser",{enumerable:true,get:function get(){return _interopRequireDefault(_textureParser).default}});var _resourceLoader=require("resource-loader");Object.defineProperty(exports,"Resource",{enumerable:true,get:function get(){return _resourceLoader.Resource}});var _Application=require("../core/Application");var _Application2=_interopRequireDefault(_Application);var _loader=require("./loader");var _loader2=_interopRequireDefault(_loader);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.Loader=_loader2.default;var shared=new _loader2.default;shared.destroy=function(){};exports.shared=shared;var AppPrototype=_Application2.default.prototype;AppPrototype._loader=null;Object.defineProperty(AppPrototype,"loader",{get:function get(){if(!this._loader){var sharedLoader=this._options.sharedLoader;this._loader=sharedLoader?shared:new _loader2.default}return this._loader}});AppPrototype._parentDestroy=AppPrototype.destroy;AppPrototype.destroy=function destroy(removeView,stageOptions){if(this._loader){this._loader.destroy();this._loader=null}this._parentDestroy(removeView,stageOptions)}},{"../core/Application":99,"./bitmapFontParser":218,"./loader":220,"./spritesheetParser":221,"./textureParser":222,"resource-loader":256}],220:[function(require,module,exports){"use strict";exports.__esModule=true;var _resourceLoader=require("resource-loader");var _resourceLoader2=_interopRequireDefault(_resourceLoader);var _blob=require("resource-loader/lib/middlewares/parsing/blob");var _eventemitter=require("eventemitter3");var _eventemitter2=_interopRequireDefault(_eventemitter);var _textureParser=require("./textureParser");var _textureParser2=_interopRequireDefault(_textureParser);var _spritesheetParser=require("./spritesheetParser");var _spritesheetParser2=_interopRequireDefault(_spritesheetParser);var _bitmapFontParser=require("./bitmapFontParser");var _bitmapFontParser2=_interopRequireDefault(_bitmapFontParser);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Loader=function(_ResourceLoader){_inherits(Loader,_ResourceLoader);function Loader(baseUrl,concurrency){_classCallCheck(this,Loader);var _this=_possibleConstructorReturn(this,_ResourceLoader.call(this,baseUrl,concurrency));_eventemitter2.default.call(_this);for(var i=0;i<Loader._pixiMiddleware.length;++i){_this.use(Loader._pixiMiddleware[i]())}_this.onStart.add(function(l){return _this.emit("start",l)});_this.onProgress.add(function(l,r){return _this.emit("progress",l,r)});_this.onError.add(function(e,l,r){return _this.emit("error",e,l,r)});_this.onLoad.add(function(l,r){return _this.emit("load",l,r)});_this.onComplete.add(function(l,r){return _this.emit("complete",l,r)});return _this}Loader.addPixiMiddleware=function addPixiMiddleware(fn){Loader._pixiMiddleware.push(fn)};Loader.prototype.destroy=function destroy(){this.removeAllListeners();this.reset()};return Loader}(_resourceLoader2.default);exports.default=Loader;for(var k in _eventemitter2.default.prototype){Loader.prototype[k]=_eventemitter2.default.prototype[k]}Loader._pixiMiddleware=[_blob.blobMiddlewareFactory,_textureParser2.default,_spritesheetParser2.default,_bitmapFontParser2.default];var Resource=_resourceLoader2.default.Resource;Resource.setExtensionXhrType("fnt",Resource.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":218,"./spritesheetParser":221,"./textureParser":222,eventemitter3:62,"resource-loader":256,"resource-loader/lib/middlewares/parsing/blob":257}],221:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=function(){return function spritesheetParser(resource,next){var imageResourceName=resource.name+"_image";if(!resource.data||resource.type!==_resourceLoader.Resource.TYPE.JSON||!resource.data.frames||this.resources[imageResourceName]){next();return}var loadOptions={crossOrigin:resource.crossOrigin,metadata:resource.metadata.imageMetadata,parentResource:resource};var resourcePath=getResourcePath(resource,this.baseUrl);this.add(imageResourceName,resourcePath,loadOptions,function onImageLoad(res){if(res.error){next(res.error);return}var spritesheet=new _core.Spritesheet(res.texture.baseTexture,resource.data,resource.url);spritesheet.parse(function(){resource.spritesheet=spritesheet;resource.textures=spritesheet.textures;next()})})}};exports.getResourcePath=getResourcePath;var _resourceLoader=require("resource-loader");var _url=require("url");var _url2=_interopRequireDefault(_url);var _core=require("../core");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getResourcePath(resource,baseUrl){if(resource.isDataUrl){return resource.data.meta.image}return _url2.default.resolve(resource.url.replace(baseUrl,""),resource.data.meta.image)}},{"../core":121,"resource-loader":256,url:259}],222:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=function(){return function textureParser(resource,next){if(resource.data&&resource.type===_resourceLoader.Resource.TYPE.IMAGE){resource.texture=_Texture2.default.fromLoader(resource.data,resource.url,resource.name)}next()}};var _resourceLoader=require("resource-loader");var _Texture=require("../core/textures/Texture");var _Texture2=_interopRequireDefault(_Texture);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"../core/textures/Texture":171,"resource-loader":256}],223:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../core");var core=_interopRequireWildcard(_core);var _Texture=require("../core/textures/Texture");var _Texture2=_interopRequireDefault(_Texture);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var tempPoint=new core.Point;var tempPolygon=new core.Polygon;var Mesh=function(_core$Container){_inherits(Mesh,_core$Container);function Mesh(texture,vertices,uvs,indices,drawMode){_classCallCheck(this,Mesh);var _this=_possibleConstructorReturn(this,_core$Container.call(this));_this._texture=texture||_Texture2.default.EMPTY;_this.uvs=uvs||new Float32Array([0,0,1,0,1,1,0,1]);_this.vertices=vertices||new Float32Array([0,0,100,0,100,100,0,100]);_this.indices=indices||new Uint16Array([0,1,3,2]);_this.dirty=0;_this.indexDirty=0;_this.vertexDirty=0;_this.autoUpdate=true;_this.blendMode=core.BLEND_MODES.NORMAL;_this.canvasPadding=core.settings.MESH_CANVAS_PADDING;_this.drawMode=drawMode||Mesh.DRAW_MODES.TRIANGLE_MESH;_this.shader=null;_this.tintRgb=new Float32Array([1,1,1]);_this._glDatas={};_this._uvTransform=new core.TextureMatrix(_this._texture);_this.uploadUvTransform=false;_this.pluginName="mesh";return _this}Mesh.prototype._renderWebGL=function _renderWebGL(renderer){this.refresh();renderer.setObjectRenderer(renderer.plugins[this.pluginName]);renderer.plugins[this.pluginName].render(this)};Mesh.prototype._renderCanvas=function _renderCanvas(renderer){this.refresh();renderer.plugins[this.pluginName].render(this)};Mesh.prototype._onTextureUpdate=function _onTextureUpdate(){this._uvTransform.texture=this._texture;this.refresh()};Mesh.prototype.multiplyUvs=function multiplyUvs(){if(!this.uploadUvTransform){this._uvTransform.multiplyUvs(this.uvs)}};Mesh.prototype.refresh=function refresh(forceUpdate){if(this.autoUpdate){this.vertexDirty++}if(this._uvTransform.update(forceUpdate)){this._refresh()}};Mesh.prototype._refresh=function _refresh(){};Mesh.prototype._calculateBounds=function _calculateBounds(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)};Mesh.prototype.containsPoint=function containsPoint(point){if(!this.getBounds().contains(point.x,point.y)){return false}this.worldTransform.applyInverse(point,tempPoint);var vertices=this.vertices;var points=tempPolygon.points;var indices=this.indices;var len=this.indices.length;var step=this.drawMode===Mesh.DRAW_MODES.TRIANGLES?3:1;for(var i=0;i+2<len;i+=step){var ind0=indices[i]*2;var ind1=indices[i+1]*2;var ind2=indices[i+2]*2;points[0]=vertices[ind0];points[1]=vertices[ind0+1];points[2]=vertices[ind1];points[3]=vertices[ind1+1];points[4]=vertices[ind2];points[5]=vertices[ind2+1];if(tempPolygon.contains(tempPoint.x,tempPoint.y)){return true}}return false};Mesh.prototype.destroy=function destroy(options){for(var id in this._glDatas){var data=this._glDatas[id];if(data.destroy){data.destroy()}else{if(data.vertexBuffer){data.vertexBuffer.destroy();data.vertexBuffer=null}if(data.indexBuffer){data.indexBuffer.destroy();data.indexBuffer=null}if(data.uvBuffer){data.uvBuffer.destroy();data.uvBuffer=null}if(data.vao){data.vao.destroy();data.vao=null}}}this._glDatas=null;_core$Container.prototype.destroy.call(this,options)};_createClass(Mesh,[{key:"texture",get:function get(){return this._texture},set:function set(value){if(this._texture===value){return}this._texture=value;if(value){if(value.baseTexture.hasLoaded){this._onTextureUpdate()}else{value.once("update",this._onTextureUpdate,this)}}}},{key:"tint",get:function get(){return core.utils.rgb2hex(this.tintRgb)},set:function set(value){this.tintRgb=core.utils.hex2rgb(value,this.tintRgb)}}]);return Mesh}(core.Container);exports.default=Mesh;Mesh.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":121,"../core/textures/Texture":171}],224:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _Plane2=require("./Plane");var _Plane3=_interopRequireDefault(_Plane2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var DEFAULT_BORDER_SIZE=10;var NineSlicePlane=function(_Plane){_inherits(NineSlicePlane,_Plane);function NineSlicePlane(texture,leftWidth,topHeight,rightWidth,bottomHeight){_classCallCheck(this,NineSlicePlane);var _this=_possibleConstructorReturn(this,_Plane.call(this,texture,4,4));_this._origWidth=texture.orig.width;_this._origHeight=texture.orig.height;_this._width=_this._origWidth;_this._height=_this._origHeight;_this._leftWidth=typeof leftWidth!=="undefined"?leftWidth:DEFAULT_BORDER_SIZE;_this._rightWidth=typeof rightWidth!=="undefined"?rightWidth:DEFAULT_BORDER_SIZE;_this._topHeight=typeof topHeight!=="undefined"?topHeight:DEFAULT_BORDER_SIZE;_this._bottomHeight=typeof bottomHeight!=="undefined"?bottomHeight:DEFAULT_BORDER_SIZE;_this.refresh(true);return _this}NineSlicePlane.prototype.updateHorizontalVertices=function updateHorizontalVertices(){var vertices=this.vertices;var h=this._topHeight+this._bottomHeight;var scale=this._height>h?1:this._height/h;vertices[9]=vertices[11]=vertices[13]=vertices[15]=this._topHeight*scale;vertices[17]=vertices[19]=vertices[21]=vertices[23]=this._height-this._bottomHeight*scale;vertices[25]=vertices[27]=vertices[29]=vertices[31]=this._height};NineSlicePlane.prototype.updateVerticalVertices=function updateVerticalVertices(){var vertices=this.vertices;var w=this._leftWidth+this._rightWidth;var scale=this._width>w?1:this._width/w;vertices[2]=vertices[10]=vertices[18]=vertices[26]=this._leftWidth*scale;vertices[4]=vertices[12]=vertices[20]=vertices[28]=this._width-this._rightWidth*scale;vertices[6]=vertices[14]=vertices[22]=vertices[30]=this._width};NineSlicePlane.prototype._renderCanvas=function _renderCanvas(renderer){var context=renderer.context;context.globalAlpha=this.worldAlpha;renderer.setBlendMode(this.blendMode);var transform=this.worldTransform;var res=renderer.resolution;if(renderer.roundPixels){context.setTransform(transform.a*res,transform.b*res,transform.c*res,transform.d*res,transform.tx*res|0,transform.ty*res|0)}else{context.setTransform(transform.a*res,transform.b*res,transform.c*res,transform.d*res,transform.tx*res,transform.ty*res)}var base=this._texture.baseTexture;var textureSource=base.source;var w=base.width*base.resolution;var h=base.height*base.resolution;this.drawSegment(context,textureSource,w,h,0,1,10,11);this.drawSegment(context,textureSource,w,h,2,3,12,13);this.drawSegment(context,textureSource,w,h,4,5,14,15);this.drawSegment(context,textureSource,w,h,8,9,18,19);this.drawSegment(context,textureSource,w,h,10,11,20,21);this.drawSegment(context,textureSource,w,h,12,13,22,23);this.drawSegment(context,textureSource,w,h,16,17,26,27);this.drawSegment(context,textureSource,w,h,18,19,28,29);this.drawSegment(context,textureSource,w,h,20,21,30,31)};NineSlicePlane.prototype.drawSegment=function drawSegment(context,textureSource,w,h,x1,y1,x2,y2){var uvs=this.uvs;var vertices=this.vertices;var sw=(uvs[x2]-uvs[x1])*w;var sh=(uvs[y2]-uvs[y1])*h;var dw=vertices[x2]-vertices[x1];var dh=vertices[y2]-vertices[y1];if(sw<1){sw=1}if(sh<1){sh=1}if(dw<1){dw=1}if(dh<1){dh=1}context.drawImage(textureSource,uvs[x1]*w,uvs[y1]*h,sw,sh,vertices[x1],vertices[y1],dw,dh)};NineSlicePlane.prototype._refresh=function _refresh(){_Plane.prototype._refresh.call(this);var uvs=this.uvs;var texture=this._texture;this._origWidth=texture.orig.width;this._origHeight=texture.orig.height;var _uvw=1/this._origWidth;var _uvh=1/this._origHeight;uvs[0]=uvs[8]=uvs[16]=uvs[24]=0;uvs[1]=uvs[3]=uvs[5]=uvs[7]=0;uvs[6]=uvs[14]=uvs[22]=uvs[30]=1;uvs[25]=uvs[27]=uvs[29]=uvs[31]=1;uvs[2]=uvs[10]=uvs[18]=uvs[26]=_uvw*this._leftWidth;uvs[4]=uvs[12]=uvs[20]=uvs[28]=1-_uvw*this._rightWidth;uvs[9]=uvs[11]=uvs[13]=uvs[15]=_uvh*this._topHeight;uvs[17]=uvs[19]=uvs[21]=uvs[23]=1-_uvh*this._bottomHeight;this.updateHorizontalVertices();this.updateVerticalVertices();this.dirty++;this.multiplyUvs()};_createClass(NineSlicePlane,[{key:"width",get:function get(){return this._width},set:function set(value){this._width=value;this._refresh()}},{key:"height",get:function get(){return this._height},set:function set(value){this._height=value;this._refresh()}},{key:"leftWidth",get:function get(){return this._leftWidth},set:function set(value){this._leftWidth=value;this._refresh()}},{key:"rightWidth",get:function get(){return this._rightWidth},set:function set(value){this._rightWidth=value;this._refresh()}},{key:"topHeight",get:function get(){return this._topHeight},set:function set(value){this._topHeight=value;this._refresh()}},{key:"bottomHeight",get:function get(){return this._bottomHeight},set:function set(value){this._bottomHeight=value;this._refresh()}}]);return NineSlicePlane}(_Plane3.default);exports.default=NineSlicePlane},{"./Plane":225}],225:[function(require,module,exports){"use strict";exports.__esModule=true;var _Mesh2=require("./Mesh");var _Mesh3=_interopRequireDefault(_Mesh2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Plane=function(_Mesh){_inherits(Plane,_Mesh);function Plane(texture,verticesX,verticesY){_classCallCheck(this,Plane);var _this=_possibleConstructorReturn(this,_Mesh.call(this,texture));_this._ready=true;_this.verticesX=verticesX||10;_this.verticesY=verticesY||10;_this.drawMode=_Mesh3.default.DRAW_MODES.TRIANGLES;_this.refresh();return _this}Plane.prototype._refresh=function _refresh(){var texture=this._texture;var total=this.verticesX*this.verticesY;var verts=[];var colors=[];var uvs=[];var indices=[];var segmentsX=this.verticesX-1;var segmentsY=this.verticesY-1;var sizeX=texture.width/segmentsX;var sizeY=texture.height/segmentsY;for(var i=0;i<total;i++){var x=i%this.verticesX;var y=i/this.verticesX|0;verts.push(x*sizeX,y*sizeY);uvs.push(x/segmentsX,y/segmentsY)}var totalSub=segmentsX*segmentsY;for(var _i=0;_i<totalSub;_i++){var xpos=_i%segmentsX;var ypos=_i/segmentsX|0;var value=ypos*this.verticesX+xpos;var value2=ypos*this.verticesX+xpos+1;var value3=(ypos+1)*this.verticesX+xpos;var value4=(ypos+1)*this.verticesX+xpos+1;indices.push(value,value2,value3);indices.push(value2,value4,value3)}this.vertices=new Float32Array(verts);this.uvs=new Float32Array(uvs);this.colors=new Float32Array(colors);this.indices=new Uint16Array(indices);this.dirty++;this.indexDirty++;this.multiplyUvs()};Plane.prototype._onTextureUpdate=function _onTextureUpdate(){_Mesh3.default.prototype._onTextureUpdate.call(this);if(this._ready){this.refresh()}};return Plane}(_Mesh3.default);exports.default=Plane},{"./Mesh":223}],226:[function(require,module,exports){"use strict";exports.__esModule=true;var _Mesh2=require("./Mesh");var _Mesh3=_interopRequireDefault(_Mesh2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Rope=function(_Mesh){_inherits(Rope,_Mesh);function Rope(texture,points){_classCallCheck(this,Rope);var _this=_possibleConstructorReturn(this,_Mesh.call(this,texture));_this.points=points;_this.vertices=new Float32Array(points.length*4);_this.uvs=new Float32Array(points.length*4);_this.colors=new Float32Array(points.length*2);_this.indices=new Uint16Array(points.length*2);_this.autoUpdate=true;_this.refresh();return _this}Rope.prototype._refresh=function _refresh(){var points=this.points;if(points.length<1||!this._texture._uvs){return}if(this.vertices.length/4!==points.length){this.vertices=new Float32Array(points.length*4);this.uvs=new Float32Array(points.length*4);this.colors=new Float32Array(points.length*2);this.indices=new Uint16Array(points.length*2)}var uvs=this.uvs;var indices=this.indices;var colors=this.colors;uvs[0]=0;uvs[1]=0;uvs[2]=0;uvs[3]=1;colors[0]=1;colors[1]=1;indices[0]=0;indices[1]=1;var total=points.length;for(var i=1;i<total;i++){var index=i*4;var amount=i/(total-1);uvs[index]=amount;uvs[index+1]=0;uvs[index+2]=amount;uvs[index+3]=1;index=i*2;colors[index]=1;colors[index+1]=1;index=i*2;indices[index]=index;indices[index+1]=index+1}this.dirty++;this.indexDirty++;this.multiplyUvs();this.refreshVertices()};Rope.prototype.refreshVertices=function refreshVertices(){var points=this.points;if(points.length<1){return}var lastPoint=points[0];var nextPoint=void 0;var perpX=0;var perpY=0;var vertices=this.vertices;var total=points.length;for(var i=0;i<total;i++){var point=points[i];var index=i*4;if(i<points.length-1){nextPoint=points[i+1]}else{nextPoint=point}perpY=-(nextPoint.x-lastPoint.x);perpX=nextPoint.y-lastPoint.y;var ratio=(1-i/(total-1))*10;if(ratio>1){ratio=1}var perpLength=Math.sqrt(perpX*perpX+perpY*perpY);var num=this._texture.height/2;perpX/=perpLength;perpY/=perpLength;perpX*=num;perpY*=num;vertices[index]=point.x+perpX;vertices[index+1]=point.y+perpY;vertices[index+2]=point.x-perpX;vertices[index+3]=point.y-perpY;lastPoint=point}};Rope.prototype.updateTransform=function updateTransform(){if(this.autoUpdate){this.refreshVertices()}this.containerUpdateTransform()};return Rope}(_Mesh3.default);exports.default=Rope},{"./Mesh":223}],227:[function(require,module,exports){"use strict";exports.__esModule=true;var _core=require("../../core");var core=_interopRequireWildcard(_core);var _Mesh=require("../Mesh");var _Mesh2=_interopRequireDefault(_Mesh);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var MeshSpriteRenderer=function(){function MeshSpriteRenderer(renderer){_classCallCheck(this,MeshSpriteRenderer);this.renderer=renderer}MeshSpriteRenderer.prototype.render=function render(mesh){var renderer=this.renderer;var context=renderer.context;var transform=mesh.worldTransform;var res=renderer.resolution;if(renderer.roundPixels){context.setTransform(transform.a*res,transform.b*res,transform.c*res,transform.d*res,transform.tx*res|0,transform.ty*res|0)}else{context.setTransform(transform.a*res,transform.b*res,transform.c*res,transform.d*res,transform.tx*res,transform.ty*res)}renderer.context.globalAlpha=mesh.worldAlpha;renderer.setBlendMode(mesh.blendMode);if(mesh.drawMode===_Mesh2.default.DRAW_MODES.TRIANGLE_MESH){this._renderTriangleMesh(mesh)}else{this._renderTriangles(mesh)}};MeshSpriteRenderer.prototype._renderTriangleMesh=function _renderTriangleMesh(mesh){var length=mesh.vertices.length/2;for(var i=0;i<length-2;i++){var index=i*2;this._renderDrawTriangle(mesh,index,index+2,index+4)}};MeshSpriteRenderer.prototype._renderTriangles=function _renderTriangles(mesh){var indices=mesh.indices;var length=indices.length;for(var i=0;i<length;i+=3){var index0=indices[i]*2;var index1=indices[i+1]*2;var index2=indices[i+2]*2;this._renderDrawTriangle(mesh,index0,index1,index2)}};MeshSpriteRenderer.prototype._renderDrawTriangle=function _renderDrawTriangle(mesh,index0,index1,index2){var context=this.renderer.context;var uvs=mesh.uvs;var vertices=mesh.vertices;var texture=mesh._texture;if(!texture.valid){return}var base=texture.baseTexture;var textureSource=base.source;var textureWidth=base.width;var textureHeight=base.height;var u0=void 0;var u1=void 0;var u2=void 0;var v0=void 0;var v1=void 0;var v2=void 0;if(mesh.uploadUvTransform){var ut=mesh._uvTransform.mapCoord;u0=(uvs[index0]*ut.a+uvs[index0+1]*ut.c+ut.tx)*base.width;u1=(uvs[index1]*ut.a+uvs[index1+1]*ut.c+ut.tx)*base.width;u2=(uvs[index2]*ut.a+uvs[index2+1]*ut.c+ut.tx)*base.width;v0=(uvs[index0]*ut.b+uvs[index0+1]*ut.d+ut.ty)*base.height;v1=(uvs[index1]*ut.b+uvs[index1+1]*ut.d+ut.ty)*base.height;v2=(uvs[index2]*ut.b+uvs[index2+1]*ut.d+ut.ty)*base.height}else{u0=uvs[index0]*base.width;u1=uvs[index1]*base.width;u2=uvs[index2]*base.width;v0=uvs[index0+1]*base.height;v1=uvs[index1+1]*base.height;v2=uvs[index2+1]*base.height}var x0=vertices[index0];var x1=vertices[index1];var x2=vertices[index2];var y0=vertices[index0+1];var y1=vertices[index1+1];var y2=vertices[index2+1];var canvasPadding=mesh.canvasPadding/this.renderer.resolution;if(canvasPadding>0){var paddingX=canvasPadding/Math.abs(mesh.worldTransform.a);var paddingY=canvasPadding/Math.abs(mesh.worldTransform.d);var centerX=(x0+x1+x2)/3;var centerY=(y0+y1+y2)/3;var normX=x0-centerX;var normY=y0-centerY;var dist=Math.sqrt(normX*normX+normY*normY);x0=centerX+normX/dist*(dist+paddingX);y0=centerY+normY/dist*(dist+paddingY);normX=x1-centerX;normY=y1-centerY;dist=Math.sqrt(normX*normX+normY*normY);x1=centerX+normX/dist*(dist+paddingX);y1=centerY+normY/dist*(dist+paddingY);normX=x2-centerX;normY=y2-centerY;dist=Math.sqrt(normX*normX+normY*normY);x2=centerX+normX/dist*(dist+paddingX);y2=centerY+normY/dist*(dist+paddingY)}context.save();context.beginPath();context.moveTo(x0,y0);context.lineTo(x1,y1);context.lineTo(x2,y2);context.closePath();context.clip();var delta=u0*v1+v0*u2+u1*v2-v1*u2-v0*u1-u0*v2;var deltaA=x0*v1+v0*x2+x1*v2-v1*x2-v0*x1-x0*v2;var deltaB=u0*x1+x0*u2+u1*x2-x1*u2-x0*u1-u0*x2;var deltaC=u0*v1*x2+v0*x1*u2+x0*u1*v2-x0*v1*u2-v0*u1*x2-u0*x1*v2;var deltaD=y0*v1+v0*y2+y1*v2-v1*y2-v0*y1-y0*v2;var deltaE=u0*y1+y0*u2+u1*y2-y1*u2-y0*u1-u0*y2;var deltaF=u0*v1*y2+v0*y1*u2+y0*u1*v2-y0*v1*u2-v0*u1*y2-u0*y1*v2;context.transform(deltaA/delta,deltaD/delta,deltaB/delta,deltaE/delta,deltaC/delta,deltaF/delta);context.drawImage(textureSource,0,0,textureWidth*base.resolution,textureHeight*base.resolution,0,0,textureWidth,textureHeight);context.restore();this.renderer.invalidateBlendMode()};MeshSpriteRenderer.prototype.renderMeshFlat=function renderMeshFlat(mesh){var context=this.renderer.context;var vertices=mesh.vertices;var length=vertices.length/2;context.beginPath();for(var i=1;i<length-2;++i){var index=i*2;var x0=vertices[index];var y0=vertices[index+1];var x1=vertices[index+2];var y1=vertices[index+3];var x2=vertices[index+4];var y2=vertices[index+5];context.moveTo(x0,y0);context.lineTo(x1,y1);context.lineTo(x2,y2)}context.fillStyle="#FF0000";context.fill();context.closePath()};MeshSpriteRenderer.prototype.destroy=function destroy(){this.renderer=null};return MeshSpriteRenderer}();exports.default=MeshSpriteRenderer;core.CanvasRenderer.registerPlugin("mesh",MeshSpriteRenderer)},{"../../core":121,"../Mesh":223}],228:[function(require,module,exports){"use strict";exports.__esModule=true;var _Mesh=require("./Mesh");Object.defineProperty(exports,"Mesh",{enumerable:true,get:function get(){return _interopRequireDefault(_Mesh).default}});var _MeshRenderer=require("./webgl/MeshRenderer");Object.defineProperty(exports,"MeshRenderer",{enumerable:true,get:function get(){return _interopRequireDefault(_MeshRenderer).default}});var _CanvasMeshRenderer=require("./canvas/CanvasMeshRenderer");Object.defineProperty(exports,"CanvasMeshRenderer",{enumerable:true,get:function get(){return _interopRequireDefault(_CanvasMeshRenderer).default}});var _Plane=require("./Plane");Object.defineProperty(exports,"Plane",{enumerable:true,get:function get(){return _interopRequireDefault(_Plane).default}});var _NineSlicePlane=require("./NineSlicePlane");Object.defineProperty(exports,"NineSlicePlane",{enumerable:true,get:function get(){return _interopRequireDefault(_NineSlicePlane).default}});var _Rope=require("./Rope");Object.defineProperty(exports,"Rope",{enumerable:true,get:function get(){return _interopRequireDefault(_Rope).default}});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./Mesh":223,"./NineSlicePlane":224,"./Plane":225,"./Rope":226,"./canvas/CanvasMeshRenderer":227,"./webgl/MeshRenderer":229}],229:[function(require,module,exports){"use strict";exports.__esModule=true;var _core=require("../../core");var core=_interopRequireWildcard(_core);var _pixiGlCore=require("pixi-gl-core");var _pixiGlCore2=_interopRequireDefault(_pixiGlCore);var _Mesh=require("../Mesh");var _Mesh2=_interopRequireDefault(_Mesh);var _path=require("path");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var matrixIdentity=core.Matrix.IDENTITY;var MeshRenderer=function(_core$ObjectRenderer){_inherits(MeshRenderer,_core$ObjectRenderer);function MeshRenderer(renderer){_classCallCheck(this,MeshRenderer);var _this=_possibleConstructorReturn(this,_core$ObjectRenderer.call(this,renderer));_this.shader=null;return _this}MeshRenderer.prototype.onContextChange=function onContextChange(){var gl=this.renderer.gl;this.shader=new core.Shader(gl,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n")};MeshRenderer.prototype.render=function render(mesh){var renderer=this.renderer;var gl=renderer.gl;var texture=mesh._texture;if(!texture.valid){return}var glData=mesh._glDatas[renderer.CONTEXT_UID];if(!glData){renderer.bindVao(null);glData={shader:this.shader,vertexBuffer:_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,mesh.vertices,gl.STREAM_DRAW),uvBuffer:_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,mesh.uvs,gl.STREAM_DRAW),indexBuffer:_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl,mesh.indices,gl.STATIC_DRAW),vao:null,dirty:mesh.dirty,indexDirty:mesh.indexDirty,vertexDirty:mesh.vertexDirty};glData.vao=new _pixiGlCore2.default.VertexArrayObject(gl).addIndex(glData.indexBuffer).addAttribute(glData.vertexBuffer,glData.shader.attributes.aVertexPosition,gl.FLOAT,false,2*4,0).addAttribute(glData.uvBuffer,glData.shader.attributes.aTextureCoord,gl.FLOAT,false,2*4,0);mesh._glDatas[renderer.CONTEXT_UID]=glData}renderer.bindVao(glData.vao);if(mesh.dirty!==glData.dirty){glData.dirty=mesh.dirty;glData.uvBuffer.upload(mesh.uvs)}if(mesh.indexDirty!==glData.indexDirty){glData.indexDirty=mesh.indexDirty;glData.indexBuffer.upload(mesh.indices)}if(mesh.vertexDirty!==glData.vertexDirty){glData.vertexDirty=mesh.vertexDirty;glData.vertexBuffer.upload(mesh.vertices)}renderer.bindShader(glData.shader);glData.shader.uniforms.uSampler=renderer.bindTexture(texture);renderer.state.setBlendMode(core.utils.correctBlendMode(mesh.blendMode,texture.baseTexture.premultipliedAlpha));if(glData.shader.uniforms.uTransform){if(mesh.uploadUvTransform){glData.shader.uniforms.uTransform=mesh._uvTransform.mapCoord.toArray(true)}else{glData.shader.uniforms.uTransform=matrixIdentity.toArray(true)}}glData.shader.uniforms.translationMatrix=mesh.worldTransform.toArray(true);glData.shader.uniforms.uColor=core.utils.premultiplyRgba(mesh.tintRgb,mesh.worldAlpha,glData.shader.uniforms.uColor,texture.baseTexture.premultipliedAlpha);var drawMode=mesh.drawMode===_Mesh2.default.DRAW_MODES.TRIANGLE_MESH?gl.TRIANGLE_STRIP:gl.TRIANGLES;glData.vao.draw(drawMode,mesh.indices.length,0)};return MeshRenderer}(core.ObjectRenderer);exports.default=MeshRenderer;core.WebGLRenderer.registerPlugin("mesh",MeshRenderer)},{"../../core":121,"../Mesh":223,path:78,"pixi-gl-core":85}],230:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _core=require("../core");var core=_interopRequireWildcard(_core);var _utils=require("../core/utils");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ParticleContainer=function(_core$Container){_inherits(ParticleContainer,_core$Container);function ParticleContainer(){var maxSize=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1500;var properties=arguments[1];var batchSize=arguments.length>2&&arguments[2]!==undefined?arguments[2]:16384;var autoResize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;_classCallCheck(this,ParticleContainer);var _this=_possibleConstructorReturn(this,_core$Container.call(this));var maxBatchSize=16384;if(batchSize>maxBatchSize){batchSize=maxBatchSize}if(batchSize>maxSize){batchSize=maxSize}_this._properties=[false,true,false,false,false];_this._maxSize=maxSize;_this._batchSize=batchSize;_this._glBuffers={};_this._bufferUpdateIDs=[];_this._updateID=0;_this.interactiveChildren=false;_this.blendMode=core.BLEND_MODES.NORMAL;_this.autoResize=autoResize;_this.roundPixels=true;_this.baseTexture=null;_this.setProperties(properties);_this._tint=0;_this.tintRgb=new Float32Array(4);_this.tint=16777215;return _this}ParticleContainer.prototype.setProperties=function setProperties(properties){if(properties){this._properties[0]="vertices"in properties||"scale"in properties?!!properties.vertices||!!properties.scale:this._properties[0];this._properties[1]="position"in properties?!!properties.position:this._properties[1];this._properties[2]="rotation"in properties?!!properties.rotation:this._properties[2];this._properties[3]="uvs"in properties?!!properties.uvs:this._properties[3];this._properties[4]="tint"in properties||"alpha"in properties?!!properties.tint||!!properties.alpha:this._properties[4]}};ParticleContainer.prototype.updateTransform=function updateTransform(){this.displayObjectUpdateTransform()};ParticleContainer.prototype.renderWebGL=function renderWebGL(renderer){var _this2=this;if(!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable){return}if(!this.baseTexture){this.baseTexture=this.children[0]._texture.baseTexture;if(!this.baseTexture.hasLoaded){this.baseTexture.once("update",function(){return _this2.onChildrenChange(0)})}}renderer.setObjectRenderer(renderer.plugins.particle);renderer.plugins.particle.render(this)};ParticleContainer.prototype.onChildrenChange=function onChildrenChange(smallestChildIndex){var bufferIndex=Math.floor(smallestChildIndex/this._batchSize);while(this._bufferUpdateIDs.length<bufferIndex){this._bufferUpdateIDs.push(0)}this._bufferUpdateIDs[bufferIndex]=++this._updateID};ParticleContainer.prototype.renderCanvas=function renderCanvas(renderer){if(!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable){return}var context=renderer.context;var transform=this.worldTransform;var isRotated=true;var positionX=0;var positionY=0;var finalWidth=0;var finalHeight=0;renderer.setBlendMode(this.blendMode);context.globalAlpha=this.worldAlpha;this.displayObjectUpdateTransform();for(var i=0;i<this.children.length;++i){var child=this.children[i];if(!child.visible){continue}var frame=child._texture.frame;context.globalAlpha=this.worldAlpha*child.alpha;if(child.rotation%(Math.PI*2)===0){if(isRotated){context.setTransform(transform.a,transform.b,transform.c,transform.d,transform.tx*renderer.resolution,transform.ty*renderer.resolution);isRotated=false}positionX=child.anchor.x*(-frame.width*child.scale.x)+child.position.x+.5;positionY=child.anchor.y*(-frame.height*child.scale.y)+child.position.y+.5;finalWidth=frame.width*child.scale.x;finalHeight=frame.height*child.scale.y}else{if(!isRotated){isRotated=true}child.displayObjectUpdateTransform();var childTransform=child.worldTransform;if(renderer.roundPixels){context.setTransform(childTransform.a,childTransform.b,childTransform.c,childTransform.d,childTransform.tx*renderer.resolution|0,childTransform.ty*renderer.resolution|0)}else{context.setTransform(childTransform.a,childTransform.b,childTransform.c,childTransform.d,childTransform.tx*renderer.resolution,childTransform.ty*renderer.resolution)}positionX=child.anchor.x*-frame.width+.5;positionY=child.anchor.y*-frame.height+.5;finalWidth=frame.width;finalHeight=frame.height}var resolution=child._texture.baseTexture.resolution;context.drawImage(child._texture.baseTexture.source,frame.x*resolution,frame.y*resolution,frame.width*resolution,frame.height*resolution,positionX*renderer.resolution,positionY*renderer.resolution,finalWidth*renderer.resolution,finalHeight*renderer.resolution)}};ParticleContainer.prototype.destroy=function destroy(options){_core$Container.prototype.destroy.call(this,options);if(this._buffers){for(var i=0;i<this._buffers.length;++i){this._buffers[i].destroy()}}this._properties=null;this._buffers=null;this._bufferUpdateIDs=null};_createClass(ParticleContainer,[{key:"tint",get:function get(){return this._tint},set:function set(value){this._tint=value;(0,_utils.hex2rgb)(value,this.tintRgb)}}]);return ParticleContainer}(core.Container);exports.default=ParticleContainer},{"../core":121,"../core/utils":181}],231:[function(require,module,exports){"use strict";exports.__esModule=true;var _ParticleContainer=require("./ParticleContainer");Object.defineProperty(exports,"ParticleContainer",{enumerable:true,get:function get(){return _interopRequireDefault(_ParticleContainer).default}});var _ParticleRenderer=require("./webgl/ParticleRenderer");Object.defineProperty(exports,"ParticleRenderer",{enumerable:true,get:function get(){return _interopRequireDefault(_ParticleRenderer).default}});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./ParticleContainer":230,"./webgl/ParticleRenderer":233}],232:[function(require,module,exports){"use strict";exports.__esModule=true;var _pixiGlCore=require("pixi-gl-core");var _pixiGlCore2=_interopRequireDefault(_pixiGlCore);var _createIndicesForQuads=require("../../core/utils/createIndicesForQuads");var _createIndicesForQuads2=_interopRequireDefault(_createIndicesForQuads);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ParticleBuffer=function(){function ParticleBuffer(gl,properties,dynamicPropertyFlags,size){_classCallCheck(this,ParticleBuffer);this.gl=gl;this.size=size;this.dynamicProperties=[];this.staticProperties=[];for(var i=0;i<properties.length;++i){var property=properties[i];property={attribute:property.attribute,size:property.size,uploadFunction:property.uploadFunction,unsignedByte:property.unsignedByte,offset:property.offset};if(dynamicPropertyFlags[i]){this.dynamicProperties.push(property)}else{this.staticProperties.push(property)}}this.staticStride=0;this.staticBuffer=null;this.staticData=null;this.staticDataUint32=null;this.dynamicStride=0;this.dynamicBuffer=null;this.dynamicData=null;this.dynamicDataUint32=null;this._updateID=0;this.initBuffers()}ParticleBuffer.prototype.initBuffers=function initBuffers(){var gl=this.gl;var dynamicOffset=0;this.indices=(0,_createIndicesForQuads2.default)(this.size);this.indexBuffer=_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl,this.indices,gl.STATIC_DRAW);this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){var property=this.dynamicProperties[i];property.offset=dynamicOffset;dynamicOffset+=property.size;this.dynamicStride+=property.size}var dynBuffer=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(dynBuffer);this.dynamicDataUint32=new Uint32Array(dynBuffer);this.dynamicBuffer=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,dynBuffer,gl.STREAM_DRAW);var staticOffset=0;this.staticStride=0;for(var _i=0;_i<this.staticProperties.length;++_i){var _property=this.staticProperties[_i];_property.offset=staticOffset;staticOffset+=_property.size;this.staticStride+=_property.size}var statBuffer=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(statBuffer);this.staticDataUint32=new Uint32Array(statBuffer);this.staticBuffer=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,statBuffer,gl.STATIC_DRAW);this.vao=new _pixiGlCore2.default.VertexArrayObject(gl).addIndex(this.indexBuffer);for(var _i2=0;_i2<this.dynamicProperties.length;++_i2){var _property2=this.dynamicProperties[_i2];if(_property2.unsignedByte){this.vao.addAttribute(this.dynamicBuffer,_property2.attribute,gl.UNSIGNED_BYTE,true,this.dynamicStride*4,_property2.offset*4)}else{this.vao.addAttribute(this.dynamicBuffer,_property2.attribute,gl.FLOAT,false,this.dynamicStride*4,_property2.offset*4)}}for(var _i3=0;_i3<this.staticProperties.length;++_i3){var _property3=this.staticProperties[_i3];if(_property3.unsignedByte){this.vao.addAttribute(this.staticBuffer,_property3.attribute,gl.UNSIGNED_BYTE,true,this.staticStride*4,_property3.offset*4)}else{this.vao.addAttribute(this.staticBuffer,_property3.attribute,gl.FLOAT,false,this.staticStride*4,_property3.offset*4)}}};ParticleBuffer.prototype.uploadDynamic=function uploadDynamic(children,startIndex,amount){for(var i=0;i<this.dynamicProperties.length;i++){var property=this.dynamicProperties[i];property.uploadFunction(children,startIndex,amount,property.unsignedByte?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,property.offset)}this.dynamicBuffer.upload()};ParticleBuffer.prototype.uploadStatic=function uploadStatic(children,startIndex,amount){for(var i=0;i<this.staticProperties.length;i++){var property=this.staticProperties[i];property.uploadFunction(children,startIndex,amount,property.unsignedByte?this.staticDataUint32:this.staticData,this.staticStride,property.offset)}this.staticBuffer.upload()};ParticleBuffer.prototype.destroy=function destroy(){this.dynamicProperties=null;this.dynamicBuffer.destroy();this.dynamicBuffer=null;this.dynamicData=null;this.dynamicDataUint32=null;this.staticProperties=null;this.staticBuffer.destroy();this.staticBuffer=null;this.staticData=null;this.staticDataUint32=null};return ParticleBuffer}();exports.default=ParticleBuffer},{"../../core/utils/createIndicesForQuads":179,"pixi-gl-core":85}],233:[function(require,module,exports){"use strict";exports.__esModule=true;var _core=require("../../core");var core=_interopRequireWildcard(_core);var _ParticleShader=require("./ParticleShader");var _ParticleShader2=_interopRequireDefault(_ParticleShader);var _ParticleBuffer=require("./ParticleBuffer");var _ParticleBuffer2=_interopRequireDefault(_ParticleBuffer);var _utils=require("../../core/utils");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ParticleRenderer=function(_core$ObjectRenderer){_inherits(ParticleRenderer,_core$ObjectRenderer);function ParticleRenderer(renderer){_classCallCheck(this,ParticleRenderer);var _this=_possibleConstructorReturn(this,_core$ObjectRenderer.call(this,renderer));_this.shader=null;_this.indexBuffer=null;_this.properties=null;_this.tempMatrix=new core.Matrix;_this.CONTEXT_UID=0;return _this}ParticleRenderer.prototype.onContextChange=function onContextChange(){var gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID;this.shader=new _ParticleShader2.default(gl);this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,unsignedByte:true,uploadFunction:this.uploadTint,offset:0}]};ParticleRenderer.prototype.start=function start(){this.renderer.bindShader(this.shader)};ParticleRenderer.prototype.render=function render(container){var children=container.children;var maxSize=container._maxSize;var batchSize=container._batchSize;var renderer=this.renderer;var totalChildren=children.length;if(totalChildren===0){return}else if(totalChildren>maxSize){totalChildren=maxSize}var buffers=container._glBuffers[renderer.CONTEXT_UID];if(!buffers){buffers=container._glBuffers[renderer.CONTEXT_UID]=this.generateBuffers(container)}var baseTexture=children[0]._texture.baseTexture;this.renderer.setBlendMode(core.utils.correctBlendMode(container.blendMode,baseTexture.premultipliedAlpha));var gl=renderer.gl;var m=container.worldTransform.copy(this.tempMatrix);m.prepend(renderer._activeRenderTarget.projectionMatrix);this.shader.uniforms.projectionMatrix=m.toArray(true);this.shader.uniforms.uColor=core.utils.premultiplyRgba(container.tintRgb,container.worldAlpha,this.shader.uniforms.uColor,baseTexture.premultipliedAlpha);this.shader.uniforms.uSampler=renderer.bindTexture(baseTexture);var updateStatic=false;for(var i=0,j=0;i<totalChildren;i+=batchSize,j+=1){var amount=totalChildren-i;if(amount>batchSize){amount=batchSize}if(j>=buffers.length){if(!container.autoResize){break}buffers.push(this._generateOneMoreBuffer(container))}var buffer=buffers[j];buffer.uploadDynamic(children,i,amount);var bid=container._bufferUpdateIDs[j]||0;updateStatic=updateStatic||buffer._updateID<bid;if(updateStatic){buffer._updateID=container._updateID;buffer.uploadStatic(children,i,amount)}renderer.bindVao(buffer.vao);buffer.vao.draw(gl.TRIANGLES,amount*6)}};ParticleRenderer.prototype.generateBuffers=function generateBuffers(container){var gl=this.renderer.gl;var buffers=[];var size=container._maxSize;var batchSize=container._batchSize;var dynamicPropertyFlags=container._properties;for(var i=0;i<size;i+=batchSize){buffers.push(new _ParticleBuffer2.default(gl,this.properties,dynamicPropertyFlags,batchSize))}return buffers};ParticleRenderer.prototype._generateOneMoreBuffer=function _generateOneMoreBuffer(container){var gl=this.renderer.gl;var batchSize=container._batchSize;var dynamicPropertyFlags=container._properties;return new _ParticleBuffer2.default(gl,this.properties,dynamicPropertyFlags,batchSize)};ParticleRenderer.prototype.uploadVertices=function uploadVertices(children,startIndex,amount,array,stride,offset){var w0=0;var w1=0;var h0=0;var h1=0;for(var i=0;i<amount;++i){var sprite=children[startIndex+i];var texture=sprite._texture;var sx=sprite.scale.x;var sy=sprite.scale.y;var trim=texture.trim;var orig=texture.orig;if(trim){w1=trim.x-sprite.anchor.x*orig.width;w0=w1+trim.width;h1=trim.y-sprite.anchor.y*orig.height;h0=h1+trim.height}else{w0=orig.width*(1-sprite.anchor.x);w1=orig.width*-sprite.anchor.x;h0=orig.height*(1-sprite.anchor.y);h1=orig.height*-sprite.anchor.y}array[offset]=w1*sx;array[offset+1]=h1*sy;array[offset+stride]=w0*sx;array[offset+stride+1]=h1*sy;array[offset+stride*2]=w0*sx;array[offset+stride*2+1]=h0*sy;array[offset+stride*3]=w1*sx;array[offset+stride*3+1]=h0*sy;offset+=stride*4}};ParticleRenderer.prototype.uploadPosition=function uploadPosition(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;i++){var spritePosition=children[startIndex+i].position;array[offset]=spritePosition.x;array[offset+1]=spritePosition.y;array[offset+stride]=spritePosition.x;array[offset+stride+1]=spritePosition.y;array[offset+stride*2]=spritePosition.x;array[offset+stride*2+1]=spritePosition.y;array[offset+stride*3]=spritePosition.x;array[offset+stride*3+1]=spritePosition.y;offset+=stride*4}};ParticleRenderer.prototype.uploadRotation=function uploadRotation(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;i++){var spriteRotation=children[startIndex+i].rotation;array[offset]=spriteRotation;array[offset+stride]=spriteRotation;array[offset+stride*2]=spriteRotation;array[offset+stride*3]=spriteRotation;offset+=stride*4}};ParticleRenderer.prototype.uploadUvs=function uploadUvs(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;++i){var textureUvs=children[startIndex+i]._texture._uvs;if(textureUvs){array[offset]=textureUvs.x0;array[offset+1]=textureUvs.y0;array[offset+stride]=textureUvs.x1;array[offset+stride+1]=textureUvs.y1;array[offset+stride*2]=textureUvs.x2;array[offset+stride*2+1]=textureUvs.y2;array[offset+stride*3]=textureUvs.x3;array[offset+stride*3+1]=textureUvs.y3;offset+=stride*4}else{array[offset]=0;array[offset+1]=0;array[offset+stride]=0;array[offset+stride+1]=0;array[offset+stride*2]=0;array[offset+stride*2+1]=0;array[offset+stride*3]=0;array[offset+stride*3+1]=0;offset+=stride*4}}};ParticleRenderer.prototype.uploadTint=function uploadTint(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;++i){var sprite=children[startIndex+i];var premultiplied=sprite._texture.baseTexture.premultipliedAlpha;var alpha=sprite.alpha;var argb=alpha<1&&premultiplied?(0,_utils.premultiplyTint)(sprite._tintRGB,alpha):sprite._tintRGB+(alpha*255<<24);array[offset]=argb;array[offset+stride]=argb;array[offset+stride*2]=argb;array[offset+stride*3]=argb;offset+=stride*4}};ParticleRenderer.prototype.destroy=function destroy(){if(this.renderer.gl){this.renderer.gl.deleteBuffer(this.indexBuffer)}_core$ObjectRenderer.prototype.destroy.call(this);this.shader.destroy();this.indices=null;this.tempMatrix=null};return ParticleRenderer}(core.ObjectRenderer);exports.default=ParticleRenderer;core.WebGLRenderer.registerPlugin("particle",ParticleRenderer)},{"../../core":121,"../../core/utils":181,"./ParticleBuffer":232,"./ParticleShader":234}],234:[function(require,module,exports){"use strict";exports.__esModule=true;var _Shader2=require("../../core/Shader");var _Shader3=_interopRequireDefault(_Shader2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ParticleShader=function(_Shader){_inherits(ParticleShader,_Shader);function ParticleShader(gl){_classCallCheck(this,ParticleShader);return _possibleConstructorReturn(this,_Shader.call(this,gl,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","attribute vec2 aPositionCoord;","attribute float aRotation;","uniform mat3 projectionMatrix;","uniform vec4 uColor;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   vec2 v = vec2(x, y);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor * uColor;","}"].join("\n"),["varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor;","  gl_FragColor = color;","}"].join("\n")))}return ParticleShader}(_Shader3.default);exports.default=ParticleShader},{"../../core/Shader":100}],235:[function(require,module,exports){"use strict";if(!Math.sign){Math.sign=function mathSign(x){x=Number(x);if(x===0||isNaN(x)){return x}return x>0?1:-1}}},{}],236:[function(require,module,exports){"use strict";if(!Number.isInteger){Number.isInteger=function numberIsInteger(value){return typeof value==="number"&&isFinite(value)&&Math.floor(value)===value}}},{}],237:[function(require,module,exports){"use strict";var _objectAssign=require("object-assign");var _objectAssign2=_interopRequireDefault(_objectAssign);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}if(!Object.assign){Object.assign=_objectAssign2.default}},{"object-assign":76}],238:[function(require,module,exports){"use strict";require("./Object.assign");require("./requestAnimationFrame");require("./Math.sign");require("./Number.isInteger");if(!window.ArrayBuffer){window.ArrayBuffer=Array}if(!window.Float32Array){window.Float32Array=Array}if(!window.Uint32Array){window.Uint32Array=Array}if(!window.Uint16Array){window.Uint16Array=Array}},{"./Math.sign":235,"./Number.isInteger":236,"./Object.assign":237,"./requestAnimationFrame":239}],239:[function(require,module,exports){(function(global){"use strict";var ONE_FRAME_TIME=16;if(!(Date.now&&Date.prototype.getTime)){Date.now=function now(){return(new Date).getTime()}}if(!(global.performance&&global.performance.now)){var startTime=Date.now();if(!global.performance){global.performance={}}global.performance.now=function(){return Date.now()-startTime}}var lastTime=Date.now();var vendors=["ms","moz","webkit","o"];for(var x=0;x<vendors.length&&!global.requestAnimationFrame;++x){var p=vendors[x];global.requestAnimationFrame=global[p+"RequestAnimationFrame"];global.cancelAnimationFrame=global[p+"CancelAnimationFrame"]||global[p+"CancelRequestAnimationFrame"]}if(!global.requestAnimationFrame){global.requestAnimationFrame=function(callback){if(typeof callback!=="function"){throw new TypeError(callback+"is not a function")}var currentTime=Date.now();var delay=ONE_FRAME_TIME+lastTime-currentTime;if(delay<0){delay=0}lastTime=currentTime;return setTimeout(function(){lastTime=Date.now();callback(performance.now())},delay)}}if(!global.cancelAnimationFrame){global.cancelAnimationFrame=function(id){return clearTimeout(id)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],240:[function(require,module,exports){"use strict";exports.__esModule=true;var _core=require("../core");var core=_interopRequireWildcard(_core);var _CountLimiter=require("./limiters/CountLimiter");var _CountLimiter2=_interopRequireDefault(_CountLimiter);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var SharedTicker=core.ticker.shared;core.settings.UPLOADS_PER_FRAME=4;var BasePrepare=function(){function BasePrepare(renderer){var _this=this;_classCallCheck(this,BasePrepare);this.limiter=new _CountLimiter2.default(core.settings.UPLOADS_PER_FRAME);this.renderer=renderer;this.uploadHookHelper=null;this.queue=[];this.addHooks=[];this.uploadHooks=[];this.completes=[];this.ticking=false;this.delayedTick=function(){if(!_this.queue){return}_this.prepareItems()};this.registerFindHook(findText);this.registerFindHook(findTextStyle);this.registerFindHook(findMultipleBaseTextures);this.registerFindHook(findBaseTexture);this.registerFindHook(findTexture);this.registerUploadHook(drawText);this.registerUploadHook(calculateTextStyle)}BasePrepare.prototype.upload=function upload(item,done){if(typeof item==="function"){done=item;item=null}if(item){this.add(item)}if(this.queue.length){if(done){this.completes.push(done)}if(!this.ticking){this.ticking=true;SharedTicker.addOnce(this.tick,this,core.UPDATE_PRIORITY.UTILITY)}}else if(done){done()}};BasePrepare.prototype.tick=function tick(){setTimeout(this.delayedTick,0)};BasePrepare.prototype.prepareItems=function prepareItems(){this.limiter.beginFrame();while(this.queue.length&&this.limiter.allowedToUpload()){var item=this.queue[0];var uploaded=false;if(item&&!item._destroyed){for(var i=0,len=this.uploadHooks.length;i<len;i++){if(this.uploadHooks[i](this.uploadHookHelper,item)){this.queue.shift();uploaded=true;break}}}if(!uploaded){this.queue.shift()}}if(!this.queue.length){this.ticking=false;var completes=this.completes.slice(0);this.completes.length=0;for(var _i=0,_len=completes.length;_i<_len;_i++){completes[_i]()}}else{SharedTicker.addOnce(this.tick,this,core.UPDATE_PRIORITY.UTILITY)}};BasePrepare.prototype.registerFindHook=function registerFindHook(addHook){if(addHook){this.addHooks.push(addHook)}return this};BasePrepare.prototype.registerUploadHook=function registerUploadHook(uploadHook){if(uploadHook){this.uploadHooks.push(uploadHook)}return this};BasePrepare.prototype.add=function add(item){for(var i=0,len=this.addHooks.length;i<len;i++){if(this.addHooks[i](item,this.queue)){break}}if(item instanceof core.Container){for(var _i2=item.children.length-1;_i2>=0;_i2--){this.add(item.children[_i2])}}return this};BasePrepare.prototype.destroy=function destroy(){if(this.ticking){SharedTicker.remove(this.tick,this)}this.ticking=false;this.addHooks=null;this.uploadHooks=null;this.renderer=null;this.completes=null;this.queue=null;this.limiter=null;this.uploadHookHelper=null};return BasePrepare}();exports.default=BasePrepare;function findMultipleBaseTextures(item,queue){var result=false;if(item&&item._textures&&item._textures.length){for(var i=0;i<item._textures.length;i++){if(item._textures[i]instanceof core.Texture){var baseTexture=item._textures[i].baseTexture;if(queue.indexOf(baseTexture)===-1){queue.push(baseTexture);result=true}}}}return result}function findBaseTexture(item,queue){if(item instanceof core.BaseTexture){if(queue.indexOf(item)===-1){queue.push(item)}return true}return false}function findTexture(item,queue){if(item._texture&&item._texture instanceof core.Texture){var texture=item._texture.baseTexture;if(queue.indexOf(texture)===-1){queue.push(texture)}return true}return false}function drawText(helper,item){if(item instanceof core.Text){item.updateText(true);return true}return false}function calculateTextStyle(helper,item){if(item instanceof core.TextStyle){var font=item.toFontString();core.TextMetrics.measureFont(font);return true}return false}function findText(item,queue){if(item instanceof core.Text){if(queue.indexOf(item.style)===-1){queue.push(item.style)}if(queue.indexOf(item)===-1){queue.push(item)}var texture=item._texture.baseTexture;if(queue.indexOf(texture)===-1){queue.push(texture)}return true}return false}function findTextStyle(item,queue){if(item instanceof core.TextStyle){if(queue.indexOf(item)===-1){queue.push(item)}return true}return false}},{"../core":121,"./limiters/CountLimiter":243}],241:[function(require,module,exports){"use strict";exports.__esModule=true;var _core=require("../../core");var core=_interopRequireWildcard(_core);var _BasePrepare2=require("../BasePrepare");var _BasePrepare3=_interopRequireDefault(_BasePrepare2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var CANVAS_START_SIZE=16;var CanvasPrepare=function(_BasePrepare){_inherits(CanvasPrepare,_BasePrepare);function CanvasPrepare(renderer){_classCallCheck(this,CanvasPrepare);var _this=_possibleConstructorReturn(this,_BasePrepare.call(this,renderer));_this.uploadHookHelper=_this;_this.canvas=document.createElement("canvas");_this.canvas.width=CANVAS_START_SIZE;_this.canvas.height=CANVAS_START_SIZE;_this.ctx=_this.canvas.getContext("2d");_this.registerUploadHook(uploadBaseTextures);return _this}CanvasPrepare.prototype.destroy=function destroy(){_BasePrepare.prototype.destroy.call(this);this.ctx=null;this.canvas=null};return CanvasPrepare}(_BasePrepare3.default);exports.default=CanvasPrepare;function uploadBaseTextures(prepare,item){if(item instanceof core.BaseTexture){var image=item.source;var imageWidth=image.width===0?prepare.canvas.width:Math.min(prepare.canvas.width,image.width);var imageHeight=image.height===0?prepare.canvas.height:Math.min(prepare.canvas.height,image.height);prepare.ctx.drawImage(image,0,0,imageWidth,imageHeight,0,0,prepare.canvas.width,prepare.canvas.height);return true}return false}core.CanvasRenderer.registerPlugin("prepare",CanvasPrepare)},{"../../core":121,"../BasePrepare":240}],242:[function(require,module,exports){"use strict";exports.__esModule=true;var _WebGLPrepare=require("./webgl/WebGLPrepare");Object.defineProperty(exports,"webgl",{enumerable:true,get:function get(){return _interopRequireDefault(_WebGLPrepare).default}});var _CanvasPrepare=require("./canvas/CanvasPrepare");Object.defineProperty(exports,"canvas",{enumerable:true,get:function get(){return _interopRequireDefault(_CanvasPrepare).default}});var _BasePrepare=require("./BasePrepare");Object.defineProperty(exports,"BasePrepare",{enumerable:true,get:function get(){return _interopRequireDefault(_BasePrepare).default}});var _CountLimiter=require("./limiters/CountLimiter");Object.defineProperty(exports,"CountLimiter",{enumerable:true,get:function get(){return _interopRequireDefault(_CountLimiter).default}});var _TimeLimiter=require("./limiters/TimeLimiter");Object.defineProperty(exports,"TimeLimiter",{enumerable:true,get:function get(){return _interopRequireDefault(_TimeLimiter).default}});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./BasePrepare":240,"./canvas/CanvasPrepare":241,"./limiters/CountLimiter":243,"./limiters/TimeLimiter":244,"./webgl/WebGLPrepare":245}],243:[function(require,module,exports){"use strict";exports.__esModule=true;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CountLimiter=function(){function CountLimiter(maxItemsPerFrame){_classCallCheck(this,CountLimiter);this.maxItemsPerFrame=maxItemsPerFrame;this.itemsLeft=0}CountLimiter.prototype.beginFrame=function beginFrame(){this.itemsLeft=this.maxItemsPerFrame};CountLimiter.prototype.allowedToUpload=function allowedToUpload(){return this.itemsLeft-- >0};return CountLimiter}();exports.default=CountLimiter},{}],244:[function(require,module,exports){"use strict";exports.__esModule=true;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TimeLimiter=function(){function TimeLimiter(maxMilliseconds){_classCallCheck(this,TimeLimiter);this.maxMilliseconds=maxMilliseconds;this.frameStart=0}TimeLimiter.prototype.beginFrame=function beginFrame(){this.frameStart=Date.now()};TimeLimiter.prototype.allowedToUpload=function allowedToUpload(){return Date.now()-this.frameStart<this.maxMilliseconds};return TimeLimiter}();exports.default=TimeLimiter},{}],245:[function(require,module,exports){"use strict";exports.__esModule=true;var _core=require("../../core");var core=_interopRequireWildcard(_core);var _BasePrepare2=require("../BasePrepare");var _BasePrepare3=_interopRequireDefault(_BasePrepare2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var WebGLPrepare=function(_BasePrepare){_inherits(WebGLPrepare,_BasePrepare);function WebGLPrepare(renderer){_classCallCheck(this,WebGLPrepare);var _this=_possibleConstructorReturn(this,_BasePrepare.call(this,renderer));_this.uploadHookHelper=_this.renderer;_this.registerFindHook(findGraphics);_this.registerUploadHook(uploadBaseTextures);_this.registerUploadHook(uploadGraphics);return _this}return WebGLPrepare}(_BasePrepare3.default);exports.default=WebGLPrepare;function uploadBaseTextures(renderer,item){if(item instanceof core.BaseTexture){if(!item._glTextures[renderer.CONTEXT_UID]){renderer.textureManager.updateTexture(item)}return true}return false}function uploadGraphics(renderer,item){if(item instanceof core.Graphics){if(item.dirty||item.clearDirty||!item._webGL[renderer.plugins.graphics.CONTEXT_UID]){renderer.plugins.graphics.updateGraphics(item)}return true}return false}function findGraphics(item,queue){if(item instanceof core.Graphics){queue.push(item);return true}return false}core.WebGLRenderer.registerPlugin("prepare",WebGLPrepare)},{"../../core":121,"../BasePrepare":240}],246:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],247:[function(require,module,exports){(function(global){(function(root){var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=typeof module=="object"&&module&&!module.nodeType&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal){root=freeGlobal}var punycode,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode,key;function error(type){throw new RangeError(errors[type])}function map(array,fn){var length=array.length;var result=[];while(length--){result[length]=fn(array[length])}return result}function mapDomain(string,fn){var parts=string.split("@");var result="";if(parts.length>1){result=parts[0]+"@";string=parts[1]}string=string.replace(regexSeparators,".");var labels=string.split(".");var encoded=map(labels,fn).join(".");return result+encoded}function ucs2decode(string){var output=[],counter=0,length=string.length,value,extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output}function ucs2encode(array){return map(array,function(value){var output="";if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023}output+=stringFromCharCode(value);return output}).join("")}function basicToDigit(codePoint){if(codePoint-48<10){return codePoint-22}if(codePoint-65<26){return codePoint-65}if(codePoint-97<26){return codePoint-97}return base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((flag!=0)<<5)}function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin)}return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var output=[],inputLength=input.length,out,i=0,n=initialN,bias=initialBias,basic,j,index,oldi,w,k,digit,t,baseMinusT;basic=input.lastIndexOf(delimiter);if(basic<0){basic=0}for(j=0;j<basic;++j){if(input.charCodeAt(j)>=128){error("not-basic")}output.push(input.charCodeAt(j))}for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;;k+=base){if(index>=inputLength){error("invalid-input")}digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>floor((maxInt-i)/w)){error("overflow")}i+=digit*w;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t){break}baseMinusT=base-t;if(w>floor(maxInt/baseMinusT)){error("overflow")}w*=baseMinusT}out=output.length+1;bias=adapt(i-oldi,out,oldi==0);if(floor(i/out)>maxInt-n){error("overflow")}n+=floor(i/out);i%=out;output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,output=[],inputLength,handledCPCountPlusOne,baseMinusT,qMinusT;input=ucs2decode(input);inputLength=input.length;n=initialN;delta=0;bias=initialBias;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<128){output.push(stringFromCharCode(currentValue))}}handledCPCount=basicLength=output.length;if(basicLength){output.push(delimiter)}while(handledCPCount<inputLength){for(m=maxInt,j=0;j<inputLength;++j){currentValue=input[j];if(currentValue>=n&&currentValue<m){m=currentValue}}handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){error("overflow")}delta+=(m-n)*handledCPCountPlusOne;n=m;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<n&&++delta>maxInt){error("overflow")}if(currentValue==n){for(q=delta,k=base;;k+=base){t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t){break}qMinusT=q-t;baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount}}++delta;++n}return output.join("")}function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})}punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define("punycode",function(){return punycode})}else if(freeExports&&freeModule){if(module.exports==freeExports){freeModule.exports=punycode}else{for(key in punycode){punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key])}}}else{root.punycode=punycode}})(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],248:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&";eq=eq||"=";var obj={};if(typeof qs!=="string"||qs.length===0){return obj}var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;if(options&&typeof options.maxKeys==="number"){maxKeys=options.maxKeys}var len=qs.length;if(maxKeys>0&&len>maxKeys){len=maxKeys}for(var i=0;i<len;++i){var x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq),kstr,vstr,k,v;if(idx>=0){kstr=x.substr(0,idx);vstr=x.substr(idx+1)}else{kstr=x;vstr=""}k=decodeURIComponent(kstr);v=decodeURIComponent(vstr);if(!hasOwnProperty(obj,k)){obj[k]=v}else if(isArray(obj[k])){obj[k].push(v)}else{obj[k]=[obj[k],v]}}return obj};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"}},{}],249:[function(require,module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){sep=sep||"&";eq=eq||"=";if(obj===null){obj=undefined}if(typeof obj==="object"){return map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;if(isArray(obj[k])){return map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep)}else{return ks+encodeURIComponent(stringifyPrimitive(obj[k]))}}).join(sep)}if(!name)return"";return encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj))};var isArray=Array.isArray||function(xs){return Object.prototype.toString.call(xs)==="[object Array]"};function map(xs,f){if(xs.map)return xs.map(f);var res=[];for(var i=0;i<xs.length;i++){res.push(f(xs[i],i))}return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))res.push(key)}return res}},{}],250:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode");exports.encode=exports.stringify=require("./encode")},{"./decode":248,"./encode":249}],251:[function(require,module,exports){"use strict";module.exports=function removeItems(arr,startIdx,removeCount){var i,length=arr.length;if(startIdx>=length||removeCount===0){return}removeCount=startIdx+removeCount>length?length-startIdx:removeCount;var len=length-removeCount;for(i=startIdx;i<len;++i){arr[i]=arr[i+removeCount]}arr.length=len}},{}],252:[function(require,module,exports){"use strict";exports.__esModule=true;var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _miniSignals=require("mini-signals");var _miniSignals2=_interopRequireDefault(_miniSignals);var _parseUri=require("parse-uri");var _parseUri2=_interopRequireDefault(_parseUri);var _async=require("./async");var async=_interopRequireWildcard(_async);var _Resource=require("./Resource");var _Resource2=_interopRequireDefault(_Resource);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var MAX_PROGRESS=100;var rgxExtractUrlHash=/(#[\w-]+)?$/;var Loader=function(){function Loader(){var _this=this;var baseUrl=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var concurrency=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;_classCallCheck(this,Loader);this.baseUrl=baseUrl;this.progress=0;this.loading=false;this.defaultQueryString="";this._beforeMiddleware=[];this._afterMiddleware=[];this._resourcesParsing=[];this._boundLoadResource=function(r,d){return _this._loadResource(r,d)};this._queue=async.queue(this._boundLoadResource,concurrency);this._queue.pause();this.resources={};this.onProgress=new _miniSignals2.default;this.onError=new _miniSignals2.default;this.onLoad=new _miniSignals2.default;this.onStart=new _miniSignals2.default;this.onComplete=new _miniSignals2.default}Loader.prototype.add=function add(name,url,options,cb){if(Array.isArray(name)){for(var i=0;i<name.length;++i){this.add(name[i])}return this}if((typeof name==="undefined"?"undefined":_typeof(name))==="object"){cb=url||name.callback||name.onComplete;options=name;url=name.url;name=name.name||name.key||name.url}if(typeof url!=="string"){cb=options;options=url;url=name}if(typeof url!=="string"){throw new Error("No url passed to add resource to loader.")}if(typeof options==="function"){cb=options;options=null}if(this.loading&&(!options||!options.parentResource)){throw new Error("Cannot add resources while the loader is running.")}if(this.resources[name]){throw new Error('Resource named "'+name+'" already exists.')}url=this._prepareUrl(url);this.resources[name]=new _Resource2.default(name,url,options);if(typeof cb==="function"){this.resources[name].onAfterMiddleware.once(cb)}if(this.loading){var parent=options.parentResource;var incompleteChildren=[];for(var _i=0;_i<parent.children.length;++_i){if(!parent.children[_i].isComplete){incompleteChildren.push(parent.children[_i])}}var fullChunk=parent.progressChunk*(incompleteChildren.length+1);var eachChunk=fullChunk/(incompleteChildren.length+2);parent.children.push(this.resources[name]);parent.progressChunk=eachChunk;for(var _i2=0;_i2<incompleteChildren.length;++_i2){incompleteChildren[_i2].progressChunk=eachChunk}this.resources[name].progressChunk=eachChunk}this._queue.push(this.resources[name]);return this};Loader.prototype.pre=function pre(fn){this._beforeMiddleware.push(fn);return this};Loader.prototype.use=function use(fn){this._afterMiddleware.push(fn);return this};Loader.prototype.reset=function reset(){this.progress=0;this.loading=false;this._queue.kill();this._queue.pause();for(var k in this.resources){var res=this.resources[k];if(res._onLoadBinding){res._onLoadBinding.detach()}if(res.isLoading){res.abort()}}this.resources={};return this};Loader.prototype.load=function load(cb){if(typeof cb==="function"){this.onComplete.once(cb)}if(this.loading){return this}if(this._queue.idle()){this._onStart();this._onComplete()}else{var numTasks=this._queue._tasks.length;var chunk=100/numTasks;for(var i=0;i<this._queue._tasks.length;++i){this._queue._tasks[i].data.progressChunk=chunk}this._onStart();this._queue.resume()}return this};Loader.prototype._prepareUrl=function _prepareUrl(url){var parsedUrl=(0,_parseUri2.default)(url,{strictMode:true});var result=void 0;if(parsedUrl.protocol||!parsedUrl.path||url.indexOf("//")===0){result=url}else if(this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&url.charAt(0)!=="/"){result=this.baseUrl+"/"+url}else{result=this.baseUrl+url}if(this.defaultQueryString){var hash=rgxExtractUrlHash.exec(result)[0];result=result.substr(0,result.length-hash.length);if(result.indexOf("?")!==-1){result+="&"+this.defaultQueryString}else{result+="?"+this.defaultQueryString}result+=hash}return result};Loader.prototype._loadResource=function _loadResource(resource,dequeue){var _this2=this;resource._dequeue=dequeue;async.eachSeries(this._beforeMiddleware,function(fn,next){fn.call(_this2,resource,function(){next(resource.isComplete?{}:null)})},function(){if(resource.isComplete){_this2._onLoad(resource)}else{resource._onLoadBinding=resource.onComplete.once(_this2._onLoad,_this2);resource.load()}},true)};Loader.prototype._onStart=function _onStart(){this.progress=0;this.loading=true;this.onStart.dispatch(this)};Loader.prototype._onComplete=function _onComplete(){this.progress=MAX_PROGRESS;this.loading=false;this.onComplete.dispatch(this,this.resources)};Loader.prototype._onLoad=function _onLoad(resource){var _this3=this;resource._onLoadBinding=null;this._resourcesParsing.push(resource);resource._dequeue();async.eachSeries(this._afterMiddleware,function(fn,next){fn.call(_this3,resource,next)},function(){resource.onAfterMiddleware.dispatch(resource);_this3.progress+=resource.progressChunk;_this3.onProgress.dispatch(_this3,resource);if(resource.error){_this3.onError.dispatch(resource.error,_this3,resource)}else{_this3.onLoad.dispatch(_this3,resource)}_this3._resourcesParsing.splice(_this3._resourcesParsing.indexOf(resource),1);if(_this3._queue.idle()&&_this3._resourcesParsing.length===0){_this3._onComplete()}},true)};_createClass(Loader,[{key:"concurrency",get:function get(){return this._queue.concurrency},set:function set(concurrency){this._queue.concurrency=concurrency}}]);return Loader}();exports.default=Loader},{"./Resource":253,"./async":254,"mini-signals":71,"parse-uri":77}],253:[function(require,module,exports){"use strict";exports.__esModule=true;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _parseUri=require("parse-uri");var _parseUri2=_interopRequireDefault(_parseUri);var _miniSignals=require("mini-signals");var _miniSignals2=_interopRequireDefault(_miniSignals);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var useXdr=!!(window.XDomainRequest&&!("withCredentials"in new XMLHttpRequest));var tempAnchor=null;var STATUS_NONE=0;var STATUS_OK=200;var STATUS_EMPTY=204;var STATUS_IE_BUG_EMPTY=1223;var STATUS_TYPE_OK=2;function _noop(){}var Resource=function(){Resource.setExtensionLoadType=function setExtensionLoadType(extname,loadType){setExtMap(Resource._loadTypeMap,extname,loadType)};Resource.setExtensionXhrType=function setExtensionXhrType(extname,xhrType){setExtMap(Resource._xhrTypeMap,extname,xhrType)};function Resource(name,url,options){_classCallCheck(this,Resource);if(typeof name!=="string"||typeof url!=="string"){throw new Error("Both name and url are required for constructing a resource.")}options=options||{};this._flags=0;this._setFlag(Resource.STATUS_FLAGS.DATA_URL,url.indexOf("data:")===0);this.name=name;this.url=url;this.extension=this._getExtension();this.data=null;this.crossOrigin=options.crossOrigin===true?"anonymous":options.crossOrigin;this.loadType=options.loadType||this._determineLoadType();this.xhrType=options.xhrType;this.metadata=options.metadata||{};this.error=null;this.xhr=null;this.children=[];this.type=Resource.TYPE.UNKNOWN;this.progressChunk=0;this._dequeue=_noop;this._onLoadBinding=null;this._boundComplete=this.complete.bind(this);this._boundOnError=this._onError.bind(this);this._boundOnProgress=this._onProgress.bind(this);this._boundXhrOnError=this._xhrOnError.bind(this);this._boundXhrOnAbort=this._xhrOnAbort.bind(this);this._boundXhrOnLoad=this._xhrOnLoad.bind(this);this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this);this.onStart=new _miniSignals2.default;this.onProgress=new _miniSignals2.default;this.onComplete=new _miniSignals2.default;this.onAfterMiddleware=new _miniSignals2.default}Resource.prototype.complete=function complete(){if(this.data&&this.data.removeEventListener){this.data.removeEventListener("error",this._boundOnError,false);this.data.removeEventListener("load",this._boundComplete,false);this.data.removeEventListener("progress",this._boundOnProgress,false);this.data.removeEventListener("canplaythrough",this._boundComplete,false)}if(this.xhr){if(this.xhr.removeEventListener){this.xhr.removeEventListener("error",this._boundXhrOnError,false);this.xhr.removeEventListener("abort",this._boundXhrOnAbort,false);this.xhr.removeEventListener("progress",this._boundOnProgress,false);this.xhr.removeEventListener("load",this._boundXhrOnLoad,false)}else{this.xhr.onerror=null;this.xhr.ontimeout=null;this.xhr.onprogress=null;this.xhr.onload=null}}if(this.isComplete){throw new Error("Complete called again for an already completed resource.")}this._setFlag(Resource.STATUS_FLAGS.COMPLETE,true);this._setFlag(Resource.STATUS_FLAGS.LOADING,false);this.onComplete.dispatch(this)};Resource.prototype.abort=function abort(message){if(this.error){return}this.error=new Error(message);if(this.xhr){this.xhr.abort()}else if(this.xdr){this.xdr.abort()}else if(this.data){if(this.data.src){this.data.src=Resource.EMPTY_GIF}else{while(this.data.firstChild){this.data.removeChild(this.data.firstChild)}}}this.complete()};Resource.prototype.load=function load(cb){var _this=this;if(this.isLoading){return}if(this.isComplete){if(cb){setTimeout(function(){return cb(_this)},1)}return}else if(cb){this.onComplete.once(cb)}this._setFlag(Resource.STATUS_FLAGS.LOADING,true);this.onStart.dispatch(this);if(this.crossOrigin===false||typeof this.crossOrigin!=="string"){this.crossOrigin=this._determineCrossOrigin(this.url)}switch(this.loadType){case Resource.LOAD_TYPE.IMAGE:this.type=Resource.TYPE.IMAGE;this._loadElement("image");break;case Resource.LOAD_TYPE.AUDIO:this.type=Resource.TYPE.AUDIO;this._loadSourceElement("audio");break;case Resource.LOAD_TYPE.VIDEO:this.type=Resource.TYPE.VIDEO;this._loadSourceElement("video");break;case Resource.LOAD_TYPE.XHR:default:if(useXdr&&this.crossOrigin){this._loadXdr()}else{this._loadXhr()}break}};Resource.prototype._hasFlag=function _hasFlag(flag){return!!(this._flags&flag)};Resource.prototype._setFlag=function _setFlag(flag,value){this._flags=value?this._flags|flag:this._flags&~flag};Resource.prototype._loadElement=function _loadElement(type){if(this.metadata.loadElement){this.data=this.metadata.loadElement}else if(type==="image"&&typeof window.Image!=="undefined"){this.data=new Image}else{this.data=document.createElement(type)}if(this.crossOrigin){this.data.crossOrigin=this.crossOrigin}if(!this.metadata.skipSource){this.data.src=this.url}this.data.addEventListener("error",this._boundOnError,false);this.data.addEventListener("load",this._boundComplete,false);this.data.addEventListener("progress",this._boundOnProgress,false)};Resource.prototype._loadSourceElement=function _loadSourceElement(type){if(this.metadata.loadElement){this.data=this.metadata.loadElement}else if(type==="audio"&&typeof window.Audio!=="undefined"){this.data=new Audio}else{this.data=document.createElement(type)}if(this.data===null){this.abort("Unsupported element: "+type);return}if(!this.metadata.skipSource){if(navigator.isCocoonJS){this.data.src=Array.isArray(this.url)?this.url[0]:this.url}else if(Array.isArray(this.url)){var mimeTypes=this.metadata.mimeType;for(var i=0;i<this.url.length;++i){this.data.appendChild(this._createSource(type,this.url[i],Array.isArray(mimeTypes)?mimeTypes[i]:mimeTypes))}}else{var _mimeTypes=this.metadata.mimeType;this.data.appendChild(this._createSource(type,this.url,Array.isArray(_mimeTypes)?_mimeTypes[0]:_mimeTypes))}}this.data.addEventListener("error",this._boundOnError,false);this.data.addEventListener("load",this._boundComplete,false);this.data.addEventListener("progress",this._boundOnProgress,false);this.data.addEventListener("canplaythrough",this._boundComplete,false);this.data.load()};Resource.prototype._loadXhr=function _loadXhr(){if(typeof this.xhrType!=="string"){this.xhrType=this._determineXhrType()}var xhr=this.xhr=new XMLHttpRequest;xhr.open("GET",this.url,true);if(this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON||this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT){xhr.responseType=Resource.XHR_RESPONSE_TYPE.TEXT}else{xhr.responseType=this.xhrType}xhr.addEventListener("error",this._boundXhrOnError,false);xhr.addEventListener("abort",this._boundXhrOnAbort,false);xhr.addEventListener("progress",this._boundOnProgress,false);xhr.addEventListener("load",this._boundXhrOnLoad,false);xhr.send()};Resource.prototype._loadXdr=function _loadXdr(){if(typeof this.xhrType!=="string"){this.xhrType=this._determineXhrType()}var xdr=this.xhr=new XDomainRequest;xdr.timeout=5e3;xdr.onerror=this._boundXhrOnError;xdr.ontimeout=this._boundXdrOnTimeout;xdr.onprogress=this._boundOnProgress;xdr.onload=this._boundXhrOnLoad;xdr.open("GET",this.url,true);setTimeout(function(){return xdr.send()},1)};Resource.prototype._createSource=function _createSource(type,url,mime){if(!mime){mime=type+"/"+this._getExtension(url)}var source=document.createElement("source");source.src=url;source.type=mime;return source};Resource.prototype._onError=function _onError(event){this.abort("Failed to load element using: "+event.target.nodeName)};Resource.prototype._onProgress=function _onProgress(event){if(event&&event.lengthComputable){this.onProgress.dispatch(this,event.loaded/event.total)}};Resource.prototype._xhrOnError=function _xhrOnError(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request failed. Status: "+xhr.status+', text: "'+xhr.statusText+'"')};Resource.prototype._xhrOnAbort=function _xhrOnAbort(){this.abort(reqType(this.xhr)+" Request was aborted by the user.")};Resource.prototype._xdrOnTimeout=function _xdrOnTimeout(){this.abort(reqType(this.xhr)+" Request timed out.")};Resource.prototype._xhrOnLoad=function _xhrOnLoad(){var xhr=this.xhr;var text="";var status=typeof xhr.status==="undefined"?STATUS_OK:xhr.status;if(xhr.responseType===""||xhr.responseType==="text"||typeof xhr.responseType==="undefined"){text=xhr.responseText}if(status===STATUS_NONE&&(text.length>0||xhr.responseType===Resource.XHR_RESPONSE_TYPE.BUFFER)){status=STATUS_OK}else if(status===STATUS_IE_BUG_EMPTY){status=STATUS_EMPTY}var statusType=status/100|0;if(statusType===STATUS_TYPE_OK){if(this.xhrType===Resource.XHR_RESPONSE_TYPE.TEXT){this.data=text;this.type=Resource.TYPE.TEXT}else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON){try{this.data=JSON.parse(text);this.type=Resource.TYPE.JSON}catch(e){this.abort("Error trying to parse loaded json: "+e);return}}else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT){try{if(window.DOMParser){var domparser=new DOMParser;this.data=domparser.parseFromString(text,"text/xml")}else{var div=document.createElement("div");div.innerHTML=text;this.data=div}this.type=Resource.TYPE.XML}catch(e){this.abort("Error trying to parse loaded xml: "+e);return}}else{this.data=xhr.response||text}}else{this.abort("["+xhr.status+"] "+xhr.statusText+": "+xhr.responseURL);return}this.complete()};Resource.prototype._determineCrossOrigin=function _determineCrossOrigin(url,loc){if(url.indexOf("data:")===0){return""}loc=loc||window.location;if(!tempAnchor){tempAnchor=document.createElement("a")}tempAnchor.href=url;url=(0,_parseUri2.default)(tempAnchor.href,{strictMode:true});var samePort=!url.port&&loc.port===""||url.port===loc.port;var protocol=url.protocol?url.protocol+":":"";if(url.host!==loc.hostname||!samePort||protocol!==loc.protocol){return"anonymous"}return""};Resource.prototype._determineXhrType=function _determineXhrType(){return Resource._xhrTypeMap[this.extension]||Resource.XHR_RESPONSE_TYPE.TEXT};Resource.prototype._determineLoadType=function _determineLoadType(){return Resource._loadTypeMap[this.extension]||Resource.LOAD_TYPE.XHR};Resource.prototype._getExtension=function _getExtension(){var url=this.url;var ext="";if(this.isDataUrl){var slashIndex=url.indexOf("/");ext=url.substring(slashIndex+1,url.indexOf(";",slashIndex))}else{var queryStart=url.indexOf("?");var hashStart=url.indexOf("#");var index=Math.min(queryStart>-1?queryStart:url.length,hashStart>-1?hashStart:url.length);url=url.substring(0,index);ext=url.substring(url.lastIndexOf(".")+1)}return ext.toLowerCase()};Resource.prototype._getMimeFromXhrType=function _getMimeFromXhrType(type){switch(type){case Resource.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case Resource.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case Resource.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case Resource.XHR_RESPONSE_TYPE.JSON:return"application/json";case Resource.XHR_RESPONSE_TYPE.DEFAULT:case Resource.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}};_createClass(Resource,[{key:"isDataUrl",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function get(){return this._hasFlag(Resource.STATUS_FLAGS.LOADING)}}]);return Resource}();exports.default=Resource;Resource.STATUS_FLAGS={NONE:0,DATA_URL:1<<0,COMPLETE:1<<1,LOADING:1<<2};Resource.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6};Resource.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4};Resource.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"};Resource._loadTypeMap={gif:Resource.LOAD_TYPE.IMAGE,png:Resource.LOAD_TYPE.IMAGE,bmp:Resource.LOAD_TYPE.IMAGE,jpg:Resource.LOAD_TYPE.IMAGE,jpeg:Resource.LOAD_TYPE.IMAGE,tif:Resource.LOAD_TYPE.IMAGE,tiff:Resource.LOAD_TYPE.IMAGE,webp:Resource.LOAD_TYPE.IMAGE,tga:Resource.LOAD_TYPE.IMAGE,svg:Resource.LOAD_TYPE.IMAGE,"svg+xml":Resource.LOAD_TYPE.IMAGE,mp3:Resource.LOAD_TYPE.AUDIO,ogg:Resource.LOAD_TYPE.AUDIO,wav:Resource.LOAD_TYPE.AUDIO,mp4:Resource.LOAD_TYPE.VIDEO,webm:Resource.LOAD_TYPE.VIDEO};Resource._xhrTypeMap={xhtml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,html:Resource.XHR_RESPONSE_TYPE.DOCUMENT,htm:Resource.XHR_RESPONSE_TYPE.DOCUMENT,xml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,svg:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tsx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,gif:Resource.XHR_RESPONSE_TYPE.BLOB,png:Resource.XHR_RESPONSE_TYPE.BLOB,bmp:Resource.XHR_RESPONSE_TYPE.BLOB,jpg:Resource.XHR_RESPONSE_TYPE.BLOB,jpeg:Resource.XHR_RESPONSE_TYPE.BLOB,tif:Resource.XHR_RESPONSE_TYPE.BLOB,tiff:Resource.XHR_RESPONSE_TYPE.BLOB,webp:Resource.XHR_RESPONSE_TYPE.BLOB,tga:Resource.XHR_RESPONSE_TYPE.BLOB,json:Resource.XHR_RESPONSE_TYPE.JSON,text:Resource.XHR_RESPONSE_TYPE.TEXT,txt:Resource.XHR_RESPONSE_TYPE.TEXT,ttf:Resource.XHR_RESPONSE_TYPE.BUFFER,otf:Resource.XHR_RESPONSE_TYPE.BUFFER};Resource.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";function setExtMap(map,extname,val){if(extname&&extname.indexOf(".")===0){extname=extname.substring(1)}if(!extname){return}map[extname]=val}function reqType(xhr){return xhr.toString().replace("object ","")}},{"mini-signals":71,"parse-uri":77}],254:[function(require,module,exports){"use strict";exports.__esModule=true;exports.eachSeries=eachSeries;exports.queue=queue;function _noop(){}function eachSeries(array,iterator,callback,deferNext){var i=0;var len=array.length;(function next(err){if(err||i===len){if(callback){callback(err)}return}if(deferNext){setTimeout(function(){iterator(array[i++],next)},1)}else{iterator(array[i++],next)}})()}function onlyOnce(fn){return function onceWrapper(){if(fn===null){throw new Error("Callback was already called.")}var callFn=fn;fn=null;callFn.apply(this,arguments)}}function queue(worker,concurrency){if(concurrency==null){concurrency=1}else if(concurrency===0){throw new Error("Concurrency must not be zero")}var workers=0;var q={_tasks:[],concurrency:concurrency,saturated:_noop,unsaturated:_noop,buffer:concurrency/4,empty:_noop,drain:_noop,error:_noop,started:false,paused:false,push:function push(data,callback){_insert(data,false,callback)},kill:function kill(){workers=0;q.drain=_noop;q.started=false;q._tasks=[]},unshift:function unshift(data,callback){_insert(data,true,callback)},process:function process(){while(!q.paused&&workers<q.concurrency&&q._tasks.length){var task=q._tasks.shift();if(q._tasks.length===0){q.empty()}workers+=1;if(workers===q.concurrency){q.saturated()}worker(task.data,onlyOnce(_next(task)))}},length:function length(){return q._tasks.length},running:function running(){return workers},idle:function idle(){return q._tasks.length+workers===0},pause:function pause(){if(q.paused===true){return}q.paused=true},resume:function resume(){if(q.paused===false){return}q.paused=false;for(var w=1;w<=q.concurrency;w++){q.process()}}};function _insert(data,insertAtFront,callback){if(callback!=null&&typeof callback!=="function"){throw new Error("task callback must be a function")}q.started=true;if(data==null&&q.idle()){setTimeout(function(){return q.drain()},1);return}var item={data:data,callback:typeof callback==="function"?callback:_noop};if(insertAtFront){q._tasks.unshift(item)}else{q._tasks.push(item)}setTimeout(function(){return q.process()},1)}function _next(task){return function next(){workers-=1;task.callback.apply(task,arguments);if(arguments[0]!=null){q.error(arguments[0],task.data)}if(workers<=q.concurrency-q.buffer){q.unsaturated()}if(q.idle()){q.drain()}q.process()}}return q}},{}],255:[function(require,module,exports){"use strict";exports.__esModule=true;exports.encodeBinary=encodeBinary;var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function encodeBinary(input){var output="";var inx=0;while(inx<input.length){var bytebuffer=[0,0,0];var encodedCharIndexes=[0,0,0,0];for(var jnx=0;jnx<bytebuffer.length;++jnx){if(inx<input.length){bytebuffer[jnx]=input.charCodeAt(inx++)&255}else{bytebuffer[jnx]=0}}encodedCharIndexes[0]=bytebuffer[0]>>2;encodedCharIndexes[1]=(bytebuffer[0]&3)<<4|bytebuffer[1]>>4;encodedCharIndexes[2]=(bytebuffer[1]&15)<<2|bytebuffer[2]>>6;encodedCharIndexes[3]=bytebuffer[2]&63;var paddingBytes=inx-(input.length-1);switch(paddingBytes){case 2:encodedCharIndexes[3]=64;encodedCharIndexes[2]=64;break;case 1:encodedCharIndexes[3]=64;break;default:break}for(var _jnx=0;_jnx<encodedCharIndexes.length;++_jnx){output+=_keyStr.charAt(encodedCharIndexes[_jnx])}}return output}},{}],256:[function(require,module,exports){"use strict";var Loader=require("./Loader").default;var Resource=require("./Resource").default;var async=require("./async");var b64=require("./b64");Loader.Resource=Resource;Loader.async=async;Loader.base64=b64;module.exports=Loader;module.exports.default=Loader},{"./Loader":252,"./Resource":253,"./async":254,"./b64":255}],257:[function(require,module,exports){"use strict";exports.__esModule=true;var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.blobMiddlewareFactory=blobMiddlewareFactory;var _Resource=require("../../Resource");var _Resource2=_interopRequireDefault(_Resource);var _b=require("../../b64");var _b2=_interopRequireDefault(_b);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Url=window.URL||window.webkitURL;function blobMiddlewareFactory(){return function blobMiddleware(resource,next){if(!resource.data){next();return}if(resource.xhr&&resource.xhrType===_Resource2.default.XHR_RESPONSE_TYPE.BLOB){if(!window.Blob||typeof resource.data==="string"){var type=resource.xhr.getResponseHeader("content-type");if(type&&type.indexOf("image")===0){resource.data=new Image;resource.data.src="data:"+type+";base64,"+_b2.default.encodeBinary(resource.xhr.responseText);resource.type=_Resource2.default.TYPE.IMAGE;resource.data.onload=function(){resource.data.onload=null;next()};return}}else if(resource.data.type.indexOf("image")===0){var _ret=function(){var src=Url.createObjectURL(resource.data);resource.blob=resource.data;resource.data=new Image;resource.data.src=src;resource.type=_Resource2.default.TYPE.IMAGE;resource.data.onload=function(){Url.revokeObjectURL(src);resource.data.onload=null;next()};return{v:void 0}}();if((typeof _ret==="undefined"?"undefined":_typeof(_ret))==="object")return _ret.v}}next()}}},{"../../Resource":253,"../../b64":255}],258:[function(require,module,exports){(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.Split=factory()})(this,function(){"use strict";var global=window;var document=global.document;var addEventListener="addEventListener";var removeEventListener="removeEventListener";var getBoundingClientRect="getBoundingClientRect";var NOOP=function(){return false};var isIE8=global.attachEvent&&!global[addEventListener];var calc=["","-webkit-","-moz-","-o-"].filter(function(prefix){var el=document.createElement("div");el.style.cssText="width:"+prefix+"calc(9px)";return!!el.style.length}).shift()+"calc";var elementOrSelector=function(el){if(typeof el==="string"||el instanceof String){return document.querySelector(el)}return el};var Split=function(ids,options){if(options===void 0)options={};var dimension;var clientDimension;var clientAxis;var position;var paddingA;var paddingB;var elements;var parent=elementOrSelector(ids[0]).parentNode;var parentFlexDirection=global.getComputedStyle(parent).flexDirection;var sizes=options.sizes||ids.map(function(){return 100/ids.length});var minSize=options.minSize!==undefined?options.minSize:100;var minSizes=Array.isArray(minSize)?minSize:ids.map(function(){return minSize});var gutterSize=options.gutterSize!==undefined?options.gutterSize:10;var snapOffset=options.snapOffset!==undefined?options.snapOffset:30;var direction=options.direction||"horizontal";var cursor=options.cursor||(direction==="horizontal"?"ew-resize":"ns-resize");var gutter=options.gutter||function(i,gutterDirection){var gut=document.createElement("div");gut.className="gutter gutter-"+gutterDirection;return gut};var elementStyle=options.elementStyle||function(dim,size,gutSize){var style={};if(typeof size!=="string"&&!(size instanceof String)){if(!isIE8){style[dim]=calc+"("+size+"% - "+gutSize+"px)"}else{style[dim]=size+"%"}}else{style[dim]=size}return style};var gutterStyle=options.gutterStyle||function(dim,gutSize){return obj={},obj[dim]=gutSize+"px",obj;var obj};if(direction==="horizontal"){dimension="width";clientDimension="clientWidth";clientAxis="clientX";position="left";paddingA="paddingLeft";paddingB="paddingRight"}else if(direction==="vertical"){dimension="height";clientDimension="clientHeight";clientAxis="clientY";position="top";paddingA="paddingTop";paddingB="paddingBottom"}function setElementSize(el,size,gutSize){var style=elementStyle(dimension,size,gutSize);Object.keys(style).forEach(function(prop){return el.style[prop]=style[prop]})}function setGutterSize(gutterElement,gutSize){var style=gutterStyle(dimension,gutSize);Object.keys(style).forEach(function(prop){return gutterElement.style[prop]=style[prop]})}function adjust(offset){var a=elements[this.a];var b=elements[this.b];var percentage=a.size+b.size;a.size=offset/this.size*percentage;b.size=percentage-offset/this.size*percentage;setElementSize(a.element,a.size,this.aGutterSize);setElementSize(b.element,b.size,this.bGutterSize)}function drag(e){var offset;if(!this.dragging){return}if("touches"in e){offset=e.touches[0][clientAxis]-this.start}else{offset=e[clientAxis]-this.start}if(offset<=elements[this.a].minSize+snapOffset+this.aGutterSize){offset=elements[this.a].minSize+this.aGutterSize}else if(offset>=this.size-(elements[this.b].minSize+snapOffset+this.bGutterSize)){offset=this.size-(elements[this.b].minSize+this.bGutterSize)}adjust.call(this,offset);if(options.onDrag){options.onDrag()}}function calculateSizes(){var a=elements[this.a].element;var b=elements[this.b].element;this.size=a[getBoundingClientRect]()[dimension]+b[getBoundingClientRect]()[dimension]+this.aGutterSize+this.bGutterSize;this.start=a[getBoundingClientRect]()[position]}function stopDragging(){var self=this;var a=elements[self.a].element;var b=elements[self.b].element;if(self.dragging&&options.onDragEnd){options.onDragEnd()}self.dragging=false;global[removeEventListener]("mouseup",self.stop);global[removeEventListener]("touchend",self.stop);global[removeEventListener]("touchcancel",self.stop);self.parent[removeEventListener]("mousemove",self.move);self.parent[removeEventListener]("touchmove",self.move);delete self.stop;delete self.move;a[removeEventListener]("selectstart",NOOP);a[removeEventListener]("dragstart",NOOP);b[removeEventListener]("selectstart",NOOP);b[removeEventListener]("dragstart",NOOP);a.style.userSelect="";a.style.webkitUserSelect="";a.style.MozUserSelect="";a.style.pointerEvents="";b.style.userSelect="";b.style.webkitUserSelect="";b.style.MozUserSelect="";b.style.pointerEvents="";self.gutter.style.cursor="";self.parent.style.cursor=""}function startDragging(e){var self=this;var a=elements[self.a].element;var b=elements[self.b].element;if(!self.dragging&&options.onDragStart){options.onDragStart()}e.preventDefault();self.dragging=true;self.move=drag.bind(self);self.stop=stopDragging.bind(self);global[addEventListener]("mouseup",self.stop);global[addEventListener]("touchend",self.stop);global[addEventListener]("touchcancel",self.stop);self.parent[addEventListener]("mousemove",self.move);self.parent[addEventListener]("touchmove",self.move);a[addEventListener]("selectstart",NOOP);a[addEventListener]("dragstart",NOOP);b[addEventListener]("selectstart",NOOP);b[addEventListener]("dragstart",NOOP);a.style.userSelect="none";a.style.webkitUserSelect="none";a.style.MozUserSelect="none";a.style.pointerEvents="none";b.style.userSelect="none";b.style.webkitUserSelect="none";b.style.MozUserSelect="none";b.style.pointerEvents="none";self.gutter.style.cursor=cursor;self.parent.style.cursor=cursor;calculateSizes.call(self)}var pairs=[];elements=ids.map(function(id,i){var element={element:elementOrSelector(id),size:sizes[i],minSize:minSizes[i]};var pair;if(i>0){pair={a:i-1,b:i,dragging:false,isFirst:i===1,isLast:i===ids.length-1,direction:direction,parent:parent};pair.aGutterSize=gutterSize;pair.bGutterSize=gutterSize;if(pair.isFirst){pair.aGutterSize=gutterSize/2}if(pair.isLast){pair.bGutterSize=gutterSize/2}if(parentFlexDirection==="row-reverse"||parentFlexDirection==="column-reverse"){var temp=pair.a;pair.a=pair.b;pair.b=temp}}if(!isIE8){if(i>0){var gutterElement=gutter(i,direction);setGutterSize(gutterElement,gutterSize);gutterElement[addEventListener]("mousedown",startDragging.bind(pair));gutterElement[addEventListener]("touchstart",startDragging.bind(pair));parent.insertBefore(gutterElement,element.element);pair.gutter=gutterElement}}if(i===0||i===ids.length-1){setElementSize(element.element,element.size,gutterSize/2)}else{setElementSize(element.element,element.size,gutterSize)}var computedSize=element.element[getBoundingClientRect]()[dimension];if(computedSize<element.minSize){element.minSize=computedSize}if(i>0){pairs.push(pair)}return element});function setSizes(newSizes){newSizes.forEach(function(newSize,i){if(i>0){var pair=pairs[i-1];var a=elements[pair.a];var b=elements[pair.b];a.size=newSizes[i-1];b.size=newSize;setElementSize(a.element,a.size,pair.aGutterSize);setElementSize(b.element,b.size,pair.bGutterSize)}})}function destroy(){pairs.forEach(function(pair){pair.parent.removeChild(pair.gutter);elements[pair.a].element.style[dimension]="";elements[pair.b].element.style[dimension]=""})}if(isIE8){return{setSizes:setSizes,destroy:destroy}}return{setSizes:setSizes,getSizes:function getSizes(){return elements.map(function(element){return element.size})},collapse:function collapse(i){if(i===pairs.length){var pair=pairs[i-1];calculateSizes.call(pair);if(!isIE8){adjust.call(pair,pair.size-pair.bGutterSize)}}else{var pair$1=pairs[i];calculateSizes.call(pair$1);if(!isIE8){adjust.call(pair$1,pair$1.aGutterSize)}}},destroy:destroy}};return Split})},{}],259:[function(require,module,exports){"use strict";var punycode=require("punycode");var util=require("./util");exports.parse=urlParse;exports.resolve=urlResolve;exports.resolveObject=urlResolveObject;exports.format=urlFormat;exports.Url=Url;function Url(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:true,"javascript:":true},hostlessProtocol={javascript:true,"javascript:":true},slashedProtocol={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},querystring=require("querystring");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;u.parse(url,parseQueryString,slashesDenoteHost);return u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url)){throw new TypeError("Parameter 'url' must be a string, not "+typeof url)}var queryIndex=url.indexOf("?"),splitter=queryIndex!==-1&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter),slashRegex=/\\/g;uSplit[0]=uSplit[0].replace(slashRegex,"/");url=uSplit.join(splitter);var rest=url;rest=rest.trim();if(!slashesDenoteHost&&url.split("#").length===1){var simplePath=simplePathPattern.exec(rest);if(simplePath){this.path=rest;this.href=rest;this.pathname=simplePath[1];if(simplePath[2]){this.search=simplePath[2];if(parseQueryString){this.query=querystring.parse(this.search.substr(1))}else{this.query=this.search.substr(1)}}else if(parseQueryString){this.search="";this.query={}}return this}}var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto;rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes=rest.substr(0,2)==="//";if(slashes&&!(proto&&hostlessProtocol[proto])){rest=rest.substr(2);this.slashes=true}}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){var hostEnd=-1;for(var i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}var auth,atSign;if(hostEnd===-1){atSign=rest.lastIndexOf("@")}else{atSign=rest.lastIndexOf("@",hostEnd)}if(atSign!==-1){auth=rest.slice(0,atSign);rest=rest.slice(atSign+1);this.auth=decodeURIComponent(auth)}hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd))hostEnd=hec}if(hostEnd===-1)hostEnd=rest.length;this.host=rest.slice(0,hostEnd);rest=rest.slice(hostEnd);this.parseHost();this.hostname=this.hostname||"";var ipv6Hostname=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ipv6Hostname){var hostparts=this.hostname.split(/\./);for(var i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(!part)continue;if(!part.match(hostnamePartPattern)){var newpart="";for(var j=0,k=part.length;j<k;j++){if(part.charCodeAt(j)>127){newpart+="x"}else{newpart+=part[j]}}if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i);var notHost=hostparts.slice(i+1);var bit=part.match(hostnamePartStart);if(bit){validParts.push(bit[1]);notHost.unshift(bit[2])}if(notHost.length){rest="/"+notHost.join(".")+rest}this.hostname=validParts.join(".");break}}}}if(this.hostname.length>hostnameMaxLen){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!ipv6Hostname){this.hostname=punycode.toASCII(this.hostname)}var p=this.port?":"+this.port:"";var h=this.hostname||"";this.host=h+p;this.href+=this.host;if(ipv6Hostname){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(rest[0]!=="/"){rest="/"+rest}}}if(!unsafeProtocol[lowerProto]){for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(rest.indexOf(ae)===-1)continue;var esc=encodeURIComponent(ae);if(esc===ae){esc=escape(ae)}rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");if(hash!==-1){this.hash=rest.substr(hash);rest=rest.slice(0,hash)}var qm=rest.indexOf("?");if(qm!==-1){this.search=rest.substr(qm);this.query=rest.substr(qm+1);if(parseQueryString){this.query=querystring.parse(this.query)}rest=rest.slice(0,qm)}else if(parseQueryString){this.search="";this.query={}}if(rest)this.pathname=rest;if(slashedProtocol[lowerProto]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var p=this.pathname||"";var s=this.search||"";this.path=p+s}this.href=this.format();return this};function urlFormat(obj){if(util.isString(obj))obj=urlParse(obj);if(!(obj instanceof Url))return Url.prototype.format.call(obj);return obj.format()}Url.prototype.format=function(){var auth=this.auth||"";if(auth){auth=encodeURIComponent(auth);auth=auth.replace(/%3A/i,":");auth+="@"}var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=false,query="";if(this.host){host=auth+this.host}else if(this.hostname){host=auth+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){host+=":"+this.port}}if(this.query&&util.isObject(this.query)&&Object.keys(this.query).length){query=querystring.stringify(this.query)}var search=this.search||query&&"?"+query||"";if(protocol&&protocol.substr(-1)!==":")protocol+=":";if(this.slashes||(!protocol||slashedProtocol[protocol])&&host!==false){host="//"+(host||"");if(pathname&&pathname.charAt(0)!=="/")pathname="/"+pathname}else if(!host){host=""}if(hash&&hash.charAt(0)!=="#")hash="#"+hash;if(search&&search.charAt(0)!=="?")search="?"+search;pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)});search=search.replace("#","%23");return protocol+host+pathname+search+hash};function urlResolve(source,relative){return urlParse(source,false,true).resolve(relative)}Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,false,true)).format()};function urlResolveObject(source,relative){if(!source)return relative;return urlParse(source,false,true).resolveObject(relative)}Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,false,true);relative=rel}var result=new Url;var tkeys=Object.keys(this);for(var tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}result.hash=relative.hash;if(relative.href===""){result.href=result.format();return result}if(relative.slashes&&!relative.protocol){var rkeys=Object.keys(relative);for(var rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];if(rkey!=="protocol")result[rkey]=relative[rkey]}if(slashedProtocol[result.protocol]&&result.hostname&&!result.pathname){result.path=result.pathname="/"}result.href=result.format();return result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){var keys=Object.keys(relative);for(var v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}result.href=result.format();return result}result.protocol=relative.protocol;if(!relative.host&&!hostlessProtocol[relative.protocol]){var relPath=(relative.pathname||"").split("/");while(relPath.length&&!(relative.host=relPath.shift()));if(!relative.host)relative.host="";if(!relative.hostname)relative.hostname="";if(relPath[0]!=="")relPath.unshift("");if(relPath.length<2)relPath.unshift("");result.pathname=relPath.join("/")}else{result.pathname=relative.pathname}result.search=relative.search;result.query=relative.query;result.host=relative.host||"";result.auth=relative.auth;result.hostname=relative.hostname||relative.host;result.port=relative.port;if(result.pathname||result.search){var p=result.pathname||"";var s=result.search||"";result.path=p+s}result.slashes=result.slashes||relative.slashes;result.href=result.format();return result}var isSourceAbs=result.pathname&&result.pathname.charAt(0)==="/",isRelAbs=relative.host||relative.pathname&&relative.pathname.charAt(0)==="/",mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic){result.hostname="";result.port=null;if(result.host){if(srcPath[0]==="")srcPath[0]=result.host;else srcPath.unshift(result.host)}result.host="";if(relative.protocol){relative.hostname=null;relative.port=null;if(relative.host){if(relPath[0]==="")relPath[0]=relative.host;else relPath.unshift(relative.host)}relative.host=null}mustEndAbs=mustEndAbs&&(relPath[0]===""||srcPath[0]==="")}if(isRelAbs){result.host=relative.host||relative.host===""?relative.host:result.host;result.hostname=relative.hostname||relative.hostname===""?relative.hostname:result.hostname;result.search=relative.search;result.query=relative.query;srcPath=relPath}else if(relPath.length){if(!srcPath)srcPath=[];srcPath.pop();srcPath=srcPath.concat(relPath);result.search=relative.search;result.query=relative.query}else if(!util.isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}result.search=relative.search;result.query=relative.query;if(!util.isNull(result.pathname)||!util.isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.href=result.format();return result}if(!srcPath.length){result.pathname=null;if(result.search){result.path="/"+result.search}else{result.path=null}result.href=result.format();return result}var last=srcPath.slice(-1)[0];var hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&(last==="."||last==="..")||last==="";var up=0;for(var i=srcPath.length;i>=0;i--){last=srcPath[i];if(last==="."){srcPath.splice(i,1)}else if(last===".."){srcPath.splice(i,1);up++}else if(up){srcPath.splice(i,1);up--}}if(!mustEndAbs&&!removeAllDots){for(;up--;up){srcPath.unshift("..")}}if(mustEndAbs&&srcPath[0]!==""&&(!srcPath[0]||srcPath[0].charAt(0)!=="/")){srcPath.unshift("")}if(hasTrailingSlash&&srcPath.join("/").substr(-1)!=="/"){srcPath.push("")}var isAbsolute=srcPath[0]===""||srcPath[0]&&srcPath[0].charAt(0)==="/";if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.host=result.hostname=authInHost.shift()}}mustEndAbs=mustEndAbs||result.host&&srcPath.length;if(mustEndAbs&&!isAbsolute){srcPath.unshift("")}if(!srcPath.length){result.pathname=null;result.path=null}else{result.pathname=srcPath.join("/")}if(!util.isNull(result.pathname)||!util.isNull(result.search)){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.auth=relative.auth||result.auth;result.slashes=result.slashes||relative.slashes;result.href=result.format();return result};Url.prototype.parseHost=function(){var host=this.host;var port=portPattern.exec(host);if(port){port=port[0];if(port!==":"){this.port=port.substr(1)}host=host.substr(0,host.length-port.length)}if(host)this.hostname=host}},{"./util":260,punycode:247,querystring:250}],260:[function(require,module,exports){"use strict";module.exports={isString:function(arg){return typeof arg==="string"},isObject:function(arg){return typeof arg==="object"&&arg!==null},isNull:function(arg){return arg===null},isNullOrUndefined:function(arg){return arg==null}}},{}],261:[function(require,module,exports){(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.Picker=factory()})(this,function(){"use strict";var classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}};var createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();String.prototype.startsWith=String.prototype.startsWith||function(needle){return this.indexOf(needle)===0};String.prototype.padStart=String.prototype.padStart||function(len,pad){var str=this;while(str.length<len){str=pad+str}return str};var colorNames="735AACA770//Xub218Pj/mo5+uvX6mdAP//gtpf//Ur258P//q1d9fXcxop/+TEq9zAAAAqfg/+vN6m1AAD/ngoiiviqt6pSoqzyo3riHxvdX56grk1f/8Aax10mkeqts/39QxbtZJXttkb//jcyxm3BQ86rmAP//wl5AACLwqqAIuL3y8uIYLwv1qampniqAGQAns5vbdrmohiwCLw5uVWsvsdd/4wAsegmTLMqagiwAAsqi6ZZ6uz6j7yPxtzSD2Lxk3L09PudbAM7RwsolADT0kz/xSTfuhAL//vfhaWlpyuxHpD/43rsiIiwn9//rw39uIosi9bp/wD/6w73Nzc9s5+Pj/6v8/9cA3b42qUg6vxgICArmaAIAAtdfrf8vf9n8P/wek3/2m0xnczVxc3bvSwCCsdt///wrvp8OaMs5i5ub6iyk//D1e8ifPwAoui//rNpyxrdjmw9c8ICAq4i4P//mx9+vrSq8t09PTx1ukO6Qqlv/7bBuuy/6B690uILKqpfdh876sd9d4iZnehsMTe0dv///g71lAP8A4nmMs0ys9u+vDmg9d/wD/4pmgAAAcurZs2qzllAADN4lkulXT6txk3Db66qPLNxozre2juokuAPqalj3SNHMgdkxxWF60pGRlwxfl9f/6hr5/+Thx6q/+S1m85/96tutd/fXmszxgIAAe4ma44j8rl/6UAmu0/0UA8so2nDWji87uiqumqmPuY9xbr+7u4rs23CTsb8/+/V95a/9q577xzYU/78z/8DL7b53aDdsu1sODmb11gACAy5nZjOZ1so/wAAlvevI+Pn09QWnhm7ui0UT94q+oBy7ei9KRg5aqLotXad5oFItasmwMDAaihh87r9fdalrN9p9cICQ7gz//r6k5uAP9/4qhRoK01te0rSM7cwAICA91x2L/Yclr/2NHcw1QODQd6w7oLuua09d6zudh////t359fX1enn//8Ao0ims0y";var colorNamesDeser=void 0;var Color=function(){function Color(r,g,b,a){classCallCheck(this,Color);var that=this;function parseString(input){if(input.startsWith("hsl")){var _input$match$map=input.match(/([\-\d\.e]+)/g).map(Number),_input$match$map2=slicedToArray(_input$match$map,4),h=_input$match$map2[0],s=_input$match$map2[1],l=_input$match$map2[2],_a=_input$match$map2[3];if(_a===undefined){_a=1}h/=360;s/=100;l/=100;that.hsla=[h,s,l,_a]}else if(input.startsWith("rgb")){var _input$match$map3=input.match(/([\-\d\.e]+)/g).map(Number),_input$match$map4=slicedToArray(_input$match$map3,4),_r=_input$match$map4[0],_g=_input$match$map4[1],_b=_input$match$map4[2],_a2=_input$match$map4[3];if(_a2===undefined){_a2=1}that.rgba=[_r,_g,_b,_a2]}else{if(input.startsWith("#")){that.rgba=Color.hexToRgb(input)}else{that.rgba=Color.nameToRgb(input)||Color.hexToRgb(input)}}}if(r===undefined);else if(Array.isArray(r)){this.rgba=r}else if(b===undefined){var color=r&&(""+r).trim();if(color){parseString(color.toLowerCase())}}else{this.rgba=[r,g,b,a===undefined?1:a]}}createClass(Color,[{key:"rgba",get:function get$$1(){if(this._rgba){return this._rgba}if(!this._hsla){throw new Error("No color is set")}return this._rgba=Color.hslToRgb(this._hsla)},set:function set$$1(rgb){if(rgb.length===3){rgb[3]=1}this._rgba=rgb;this._hsla=null}},{key:"rgbString",get:function get$$1(){return"rgb("+this.rgba.slice(0,3)+")"}},{key:"rgbaString",get:function get$$1(){return"rgba("+this.rgba+")"}},{key:"hsla",get:function get$$1(){if(this._hsla){return this._hsla}if(!this._rgba){throw new Error("No color is set")}return this._hsla=Color.rgbToHsl(this._rgba)},set:function set$$1(hsl){if(hsl.length===3){hsl[3]=1}this._hsla=hsl;this._rgba=null}},{key:"hslString",get:function get$$1(){var c=this.hsla;return"hsl("+c[0]*360+","+c[1]*100+"%,"+c[2]*100+"%)"}},{key:"hslaString",get:function get$$1(){var c=this.hsla;return"hsla("+c[0]*360+","+c[1]*100+"%,"+c[2]*100+"%,"+c[3]+")"}},{key:"hex",get:function get$$1(){var rgb=this.rgba,hex=rgb.map(function(x,i){return i<3?x.toString(16):Math.round(x*255).toString(16)});return"#"+hex.map(function(x){return x.padStart(2,"0")}).join("")},set:function set$$1(hex){this.rgba=Color.hexToRgb(hex)}}],[{key:"hexToRgb",value:function hexToRgb(input){var hex=(input.startsWith("#")?input.slice(1):input).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!hex.match(/^([0-9a-fA-F]{8})$/)){throw new Error("Unknown hex color; "+input)}var rgba=hex.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(x){return parseInt(x,16)});rgba[3]=rgba[3]/255;return rgba}},{key:"nameToRgb",value:function nameToRgb(input){if(!colorNamesDeser){colorNamesDeser={};colorNames.match(/.{7}/g).forEach(function(x){return colorNamesDeser[x.slice(0,3)]=atob(x.slice(-4)).split("").map(function(b){return b.charCodeAt(0)})})}var hash=[].reduce.call(input.replace("ey","ay"),function(h,c){return(h<<2)+c.charCodeAt(0)},0).toString(36).slice(-3);return colorNamesDeser[hash]}},{key:"rgbToHsl",value:function rgbToHsl(_ref){var _ref2=slicedToArray(_ref,4),r=_ref2[0],g=_ref2[1],b=_ref2[2],a=_ref2[3];r/=255;g/=255;b/=255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h=void 0,s=void 0,l=(max+min)/2;if(max===min){h=s=0}else{var d=max-min;s=l>.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break}h/=6}return[h,s,l,a]}},{key:"hslToRgb",value:function hslToRgb(_ref3){var _ref4=slicedToArray(_ref3,4),h=_ref4[0],s=_ref4[1],l=_ref4[2],a=_ref4[3];var r=void 0,g=void 0,b=void 0;if(s===0){r=g=b=l}else{var hue2rgb=function hue2rgb(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p};var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3)}var rgba=[r*255,g*255,b*255].map(Math.round);rgba[3]=a;return rgba}}]);return Color}();var root=window;function dragTracker(options){var ep=Element.prototype;if(!ep.matches)ep.matches=ep.msMatchesSelector||ep.webkitMatchesSelector;if(!ep.closest)ep.closest=function(s){var node=this;do{if(node.matches(s))return node;node=node.tagName==="svg"?node.parentNode:node.parentElement}while(node);return null};options=options||{};var container=options.container||document.documentElement,selector=options.selector,callback=options.callback||console.log,callbackStart=options.callbackDragStart,callbackEnd=options.callbackDragEnd,callbackClick=options.callbackClick,propagate=options.propagateEvents,roundCoords=options.roundCoords!==false,dragOutside=options.dragOutside!==false,handleOffset=options.handleOffset||options.handleOffset!==false;var offsetToCenter=null;switch(handleOffset){case"center":offsetToCenter=true;break;case"topleft":case"top-left":offsetToCenter=false;break}var dragState=void 0;function getMousePos(e,elm,offset,stayWithin){var x=e.clientX,y=e.clientY;function respectBounds(value,min,max){return Math.max(min,Math.min(value,max))}if(elm){var bounds=elm.getBoundingClientRect();x-=bounds.left;y-=bounds.top;if(offset){x-=offset[0];y-=offset[1]}if(stayWithin){x=respectBounds(x,0,bounds.width);y=respectBounds(y,0,bounds.height)}if(elm!==container){var center=offsetToCenter!==null?offsetToCenter:elm.nodeName==="circle"||elm.nodeName==="ellipse";if(center){x-=bounds.width/2;y-=bounds.height/2}}}return roundCoords?[Math.round(x),Math.round(y)]:[x,y]}function stopEvent(e){e.preventDefault();if(!propagate){e.stopPropagation()}}function onDown(e){var target=void 0;if(selector){target=selector instanceof Element?selector.contains(e.target)?selector:null:e.target.closest(selector)}else{target={}}if(target){stopEvent(e);var mouseOffset=selector&&handleOffset?getMousePos(e,target):[0,0],startPos=getMousePos(e,container,mouseOffset);dragState={target:target,mouseOffset:mouseOffset,startPos:startPos,actuallyDragged:false};if(callbackStart){callbackStart(target,startPos)}}}function onMove(e){if(!dragState){return}stopEvent(e);var start=dragState.startPos,pos=getMousePos(e,container,dragState.mouseOffset,!dragOutside);dragState.actuallyDragged=dragState.actuallyDragged||start[0]!==pos[0]||start[1]!==pos[1];callback(dragState.target,pos,start)}function onEnd(e,cancelled){if(!dragState){return}if(callbackEnd||callbackClick){var isClick=!dragState.actuallyDragged,pos=isClick?dragState.startPos:getMousePos(e,container,dragState.mouseOffset,!dragOutside);if(callbackClick&&isClick&&!cancelled){callbackClick(dragState.target,pos)}if(callbackEnd){callbackEnd(dragState.target,pos,dragState.startPos,cancelled||isClick&&callbackClick)}}dragState=null}addEvent(container,"mousedown",function(e){if(isLeftButton(e)){onDown(e)}else{onEnd(e,true)}});addEvent(container,"touchstart",function(e){return relayTouch(e,onDown)});addEvent(root,"mousemove",function(e){if(!dragState){return}if(isLeftButton(e)){onMove(e)}else{onEnd(e)}});addEvent(root,"touchmove",function(e){return relayTouch(e,onMove)});addEvent(container,"mouseup",function(e){if(dragState&&!isLeftButton(e)){onEnd(e)}});function onTouchEnd(e,cancelled){onEnd(tweakTouch(e),cancelled)}addEvent(container,"touchend",function(e){return onTouchEnd(e)});addEvent(container,"touchcancel",function(e){return onTouchEnd(e,true)});function addEvent(target,type,handler){target.addEventListener(type,handler)}function isLeftButton(e){return e.buttons!==undefined?e.buttons===1:e.which===1}function relayTouch(e,handler){if(e.touches.length!==1){onEnd(e,true);return}handler(tweakTouch(e))}function tweakTouch(e){var touch=e.targetTouches[0];if(!touch){touch=e.changedTouches[0]}touch.preventDefault=e.preventDefault.bind(e);touch.stopPropagation=e.stopPropagation.bind(e);return touch}}var BG_TRANSP="url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='2' height='2'%3E%3Cpath d='M1,0H0V1H2V2H1' fill='lightgrey'/%3E%3C/svg%3E\")";var HUES=360;var EVENT_KEY="keydown",EVENT_CLICK_OUTSIDE="mousedown",EVENT_TAB_MOVE="focusin";function parseHTML(htmlString){var div=document.createElement("div");div.innerHTML=htmlString;return div.firstElementChild}function $(selector,context){return(context||document).querySelector(selector)}function addEvent(target,type,handler){target.addEventListener(type,handler,false)}function stopEvent(e){e.preventDefault();e.stopPropagation()}function onKey(target,keys,handler,stop){addEvent(target,EVENT_KEY,function(e){if(keys.indexOf(e.key)>=0){if(stop){stopEvent(e)}handler(e)}})}document.documentElement.firstElementChild.appendChild(document.createElement("style")).textContent=".picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:'';display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:'';display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6rem}.layout_default .picker_editor input{width:calc(100% + 2px);height:calc(100% + 2px)}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{margin:-1px}.picker_selector{position:absolute;z-index:1;display:block;transform:translate(-50%, -50%);border:2px solid white;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255,255,255,0) 50%),linear-gradient(0deg, black, rgba(0,0,0,0) 50%),linear-gradient(90deg, gray, rgba(128,128,128,0))}.picker_alpha,.picker_sample{position:relative;background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='2' height='2'%3E%3Cpath d='M1,0H0V1H2V2H1' fill='lightgrey'/%3E%3C/svg%3E\") left top/contain white;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{box-sizing:border-box;font-family:monospace;padding:.1em .2em}.picker_sample::before{content:'';position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_done button{box-sizing:border-box;padding:.2em .5em;cursor:pointer}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,0.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:\"\";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;transform:skew(45deg);transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}";var Picker=function(){function Picker(options){var _this=this;classCallCheck(this,Picker);this.settings={popup:"right",layout:"default",alpha:true,editor:true};this._openProxy=function(e){return _this.openHandler(e)};this.onChange=null;this.onDone=null;this.onOpen=null;this.onClose=null;this.setOptions(options)}createClass(Picker,[{key:"setOptions",value:function setOptions(options){if(!options){return}var settings=this.settings;function transfer(source,target,skipKeys){for(var key in source){if(skipKeys&&skipKeys.indexOf(key)>=0){continue}target[key]=source[key]}}if(options instanceof HTMLElement){settings.parent=options}else{if(settings.parent&&options.parent&&settings.parent!==options.parent){settings.parent.removeEventListener("click",this._openProxy,false);this._popupInited=false}transfer(options,settings);if(options.onChange){this.onChange=options.onChange}if(options.onDone){this.onDone=options.onDone}if(options.onOpen){this.onOpen=options.onOpen}if(options.onClose){this.onClose=options.onClose}var col=options.color||options.colour;if(col){this._setColor(col)}}var parent=settings.parent;if(parent&&settings.popup&&!this._popupInited){addEvent(parent,"click",this._openProxy);onKey(parent,[" ","Spacebar","Enter"],this._openProxy);this._popupInited=true}else if(options.parent&&!settings.popup){this.show()}}},{key:"openHandler",value:function openHandler(e){if(this.show()){e&&e.preventDefault();this.settings.parent.style.pointerEvents="none";var toFocus=e&&e.type===EVENT_KEY?this._domEdit:this.domElement;setTimeout(function(){return toFocus.focus()},100);if(this.onOpen){this.onOpen(this.colour)}}}},{key:"closeHandler",value:function closeHandler(e){var event=e&&e.type;var doHide=false;if(!e){doHide=true}else if(event===EVENT_CLICK_OUTSIDE||event===EVENT_TAB_MOVE){if(!this.domElement.contains(e.target)){doHide=true}}else{stopEvent(e);doHide=true}if(doHide&&this.hide()){this.settings.parent.style.pointerEvents="";if(event!==EVENT_CLICK_OUTSIDE){this.settings.parent.focus()}if(this.onClose){this.onClose(this.colour)}}}},{key:"movePopup",value:function movePopup(options,open){this.closeHandler();this.setOptions(options);if(open){this.openHandler()}}},{key:"setColor",value:function setColor(color,silent){this._setColor(color,{silent:silent})}},{key:"_setColor",value:function _setColor(color,flags){if(typeof color==="string"){color=color.trim()}if(!color){return}flags=flags||{};var c=void 0;try{c=new Color(color)}catch(ex){if(flags.failSilently){return}throw ex}if(!this.settings.alpha){var hsla=c.hsla;hsla[3]=1;c.hsla=hsla}this.colour=this.color=c;this._setHSLA(null,null,null,null,flags)}},{key:"setColour",value:function setColour(colour,silent){this.setColor(colour,silent)}},{key:"show",value:function show(){var parent=this.settings.parent;if(!parent){return false}if(this.domElement){var toggled=this._toggleDOM(true);this._setPosition();return toggled}var html=this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div></div>';var wrapper=parseHTML(html);this.domElement=wrapper;this._domH=$(".picker_hue",wrapper);this._domSL=$(".picker_sl",wrapper);this._domA=$(".picker_alpha",wrapper);this._domEdit=$(".picker_editor input",wrapper);this._domSample=$(".picker_sample",wrapper);this._domOkay=$(".picker_done button",wrapper);wrapper.classList.add("layout_"+this.settings.layout);if(!this.settings.alpha){wrapper.classList.add("no_alpha")}if(!this.settings.editor){wrapper.classList.add("no_editor")}this._ifPopup(function(){return wrapper.classList.add("popup")});this._setPosition();if(this.colour){this._updateUI()}else{this._setColor("#0cf")}this._bindEvents();return true}},{key:"hide",value:function hide(){return this._toggleDOM(false)}},{key:"_bindEvents",value:function _bindEvents(){var _this2=this;var that=this,dom=this.domElement;addEvent(dom,"click",function(e){return e.preventDefault()});function createDragConfig(container,callbackRelative){function relayDrag(_,pos){var relX=pos[0]/container.clientWidth,relY=pos[1]/container.clientHeight;callbackRelative(relX,relY)}var config={container:container,dragOutside:false,callback:relayDrag,callbackClick:relayDrag,callbackDragStart:relayDrag,propagateEvents:true};return config}dragTracker(createDragConfig(this._domH,function(x,y){return that._setHSLA(x)}));dragTracker(createDragConfig(this._domSL,function(x,y){return that._setHSLA(null,x,1-y)}));if(this.settings.alpha){dragTracker(createDragConfig(this._domA,function(x,y){return that._setHSLA(null,null,null,1-y)}))}var editInput=this._domEdit;{addEvent(editInput,"input",function(e){that._setColor(this.value,{fromEditor:true,failSilently:true})});addEvent(editInput,"focus",function(e){var input=this;if(input.selectionStart===input.selectionEnd){input.select()}})}var popupCloseProxy=function popupCloseProxy(e){_this2._ifPopup(function(){return _this2.closeHandler(e)})};var onDoneProxy=function onDoneProxy(e){_this2._ifPopup(function(){return _this2.closeHandler(e)});if(_this2.onDone){_this2.onDone(_this2.colour)}};addEvent(window,EVENT_CLICK_OUTSIDE,popupCloseProxy);addEvent(window,EVENT_TAB_MOVE,popupCloseProxy);onKey(dom,["Esc","Escape"],popupCloseProxy);addEvent(this._domOkay,"click",onDoneProxy);onKey(dom,["Enter"],onDoneProxy)}},{key:"_setPosition",value:function _setPosition(){var parent=this.settings.parent,elm=this.domElement;if(parent!==elm.parentNode){parent.appendChild(elm)}this._ifPopup(function(popup){if(getComputedStyle(parent).position==="static"){parent.style.position="relative"}var cssClass=popup===true?"popup_right":"popup_"+popup;["popup_top","popup_bottom","popup_left","popup_right"].forEach(function(c){if(c===cssClass){elm.classList.add(c)}else{elm.classList.remove(c)}});elm.classList.add(cssClass)})}},{key:"_setHSLA",value:function _setHSLA(h,s,l,a,flags){flags=flags||{};var col=this.colour,hsla=col.hsla;[h,s,l,a].forEach(function(x,i){if(x||x===0){hsla[i]=x}});col.hsla=hsla;this._updateUI(flags);if(this.onChange&&!flags.silent){this.onChange(col)}}},{key:"_updateUI",value:function _updateUI(flags){if(!this.domElement){return}flags=flags||{};var col=this.colour,hsl=col.hsla,cssHue="hsl("+hsl[0]*HUES+", 100%, 50%)",cssHSL=col.hslString,cssHSLA=col.hslaString;var uiH=this._domH,uiSL=this._domSL,uiA=this._domA,thumbH=$(".picker_selector",uiH),thumbSL=$(".picker_selector",uiSL),thumbA=$(".picker_selector",uiA);function posX(parent,child,relX){child.style.left=relX*100+"%"}function posY(parent,child,relY){child.style.top=relY*100+"%"}posX(uiH,thumbH,hsl[0]);this._domSL.style.backgroundColor=this._domH.style.color=cssHue;posX(uiSL,thumbSL,hsl[1]);posY(uiSL,thumbSL,1-hsl[2]);uiSL.style.color=cssHSL;posY(uiA,thumbA,1-hsl[3]);var opaque=cssHSL,transp=opaque.replace("hsl","hsla").replace(")",", 0)"),bg="linear-gradient("+[opaque,transp]+")";this._domA.style.backgroundImage=bg+", "+BG_TRANSP;if(!flags.fromEditor){var hex=col.hex;this._domEdit.value=this.settings.alpha?hex:hex.substr(0,7)}this._domSample.style.color=cssHSLA}},{key:"_ifPopup",value:function _ifPopup(actionIf,actionElse){if(this.settings.parent&&this.settings.popup){actionIf&&actionIf(this.settings.popup)}else{actionElse&&actionElse()}}},{key:"_toggleDOM",value:function _toggleDOM(toVisible){var dom=this.domElement;if(!dom){return false}var displayStyle=toVisible?"":"none",toggle=dom.style.display!==displayStyle;if(toggle){dom.style.display=displayStyle}return toggle}}]);return Picker}();return Picker})},{}],262:[function(require,module,exports){if(!window.$)window.$=require("jquery");if(!window.jQuery)window.jQuery=$;if(!window.$.ui){require("jquery-ui/ui/core");require("jquery-ui/ui/widget")}if(!window.$.ui.mouse)require("jquery-ui/ui/mouse");if(!window.$.ui.slider)require("jquery-ui/ui/slider");if(!window.$.ui.tabs)require("jquery-ui/ui/tabs");if(!window.$.contextMenu)require("jquery-contextmenu");var PIXI=require("pixi.js");var Split=require("split.js");require("chart.js");var ColorPicker=require("vanilla-picker");var Louvain=require("../../filters/louvain/src/louvain.js");var SciViCGraph=require("../../build/scivi-cgraph.js");module.exports=CGraph;function CGraph(){CGraph.prototype.nodesTabVisible=true;CGraph.prototype.filtersTabVisible=true;CGraph.prototype.clustersTabVisible=true}CGraph.prototype.parse=function(data){var parser=new SciViCGraph.Parser(data);return parser.graphStates};CGraph.prototype.parseStates=function(data){var parser=new SciViCGraph.StatesParser(data);return parser.graphStates};CGraph.prototype.parseStatesHierarchy=function(data){var parser=new SciViCGraph.HierarchicalStatesParser(data);return parser.graphStates};CGraph.prototype.parseDynamicStates=function(data){var parser=new SciViCGraph.DynamicStatesParser(data);return parser.graphStates};CGraph.prototype.createScale=function(steps,colors,textColors,names,getValue){return new SciViCGraph.Scale(steps,colors,textColors,names,getValue)};CGraph.prototype.createClassifier=function(tree,getKlass){return new SciViCGraph.Classifier(tree,getKlass)};CGraph.prototype.loadFilterSet=function(filterSet){this.renderer.loadFilterSet(filterSet)};CGraph.prototype.colorWithHSV=function(h,s,v){return SciViCGraph.Color.hsv2rgb([h,s,v])};CGraph.prototype.maxContrastColor=function(color){return SciViCGraph.Color.maxContrast(color)};CGraph.prototype.reshape=function(){if(this.graphContainer){if(this.graphContainer.width()<=this.graphContainer.height())this.graphSplit.collapse(1);this.renderer.reshape()}};CGraph.prototype.run=function(loc,data,scales,colors,title,info,classifier,container){container=container||"body";var splitGraph=$("<div>");var split1G,splitS,stateLine;var graphContainer=$(container);splitGraph.attr("id","scivi_cgraph_a");splitGraph.attr("class","split split-horizontal");if(data.hasStates){splitG=$("<div>");splitS=$("<div>");splitG.attr("id","scivi_cgraph_a1");splitG.attr("class","split split-vertical");splitS.attr("id","scivi_cgraph_a2");splitS.attr("class","split split-vertical");stateLine=$("<div>");stateLine.attr("id","scivi_cgraph_stateline");splitS.append(stateLine);splitGraph.append(splitG);splitGraph.append(splitS)}else{splitG=splitGraph;stateLine=null}if(title)splitG.html('<div id="scivi_cgraph_title">'+title+'</div><div id="scivi_cgraph_view" style="height: calc(100% - 30px)"></div>');else splitG.html('<div id="scivi_cgraph_view"></div>');var splitInfo=$("<div>").html('<div id="scivi_cgraph_tabs">'+"    <ul>"+'        <li><a href="#scivi_cgraph_info">'+loc["LOC_INFO"]+"</a></li>"+(this.nodesTabVisible?'        <li><a href="#scivi_cgraph_list">'+loc["LOC_NODES"]+"</a></li>":"")+'        <li><a href="#scivi_cgraph_settings">'+loc["LOC_SETTINGS"]+"</a></li>"+(this.filtersTabVisible?'        <li><a href="#scivi_cgraph_filters">'+loc["LOC_FILTERS"]+"</a></li>":"")+(this.clustersTabVisible?'        <li><a href="#scivi_cgraph_stats">'+loc["LOC_GROUPS"]+"</a></li>":"")+(classifier?'        <li><a href="#scivi_cgraph_tree">'+loc["LOC_TREE"]+"</a></li>":"")+(data.hasStates?'        <li><a href="#scivi_cgraph_calc">'+loc["LOC_CALCULATOR"]+"</a></li>":"")+(info?'        <li><a href="#scivi_cgraph_ginfo">'+loc["LOC_GINFO"]+"</a></li>":"")+"    </ul>"+'    <div id="scivi_cgraph_info"></div>'+(this.nodesTabVisible?'    <div id="scivi_cgraph_list"></div>':"")+'    <div id="scivi_cgraph_settings"></div>'+(this.filtersTabVisible?'    <div id="scivi_cgraph_filters"></div>':"")+(this.clustersTabVisible?'    <div id="scivi_cgraph_stats"></div>':"")+'    <div id="scivi_cgraph_tree"></div>'+'    <div id="scivi_cgraph_calc"></div>'+(info?'    <div id="scivi_cgraph_ginfo">'+info+"</div>":"")+"</div>");splitInfo.attr("id","scivi_cgraph_b");splitInfo.attr("class","split split-horizontal");graphContainer.prepend(splitInfo);graphContainer.prepend(splitGraph);var renderer=new SciViCGraph.Renderer($("#scivi_cgraph_view")[0],$("#scivi_cgraph_info")[0],this.nodesTabVisible?$("#scivi_cgraph_list")[0]:null,$("#scivi_cgraph_settings")[0],this.filtersTabVisible?$("#scivi_cgraph_filters")[0]:null,this.clustersTabVisible?$("#scivi_cgraph_stats")[0]:null,data.hasStates?$("#scivi_cgraph_stateline")[0]:null,classifier?$("#scivi_cgraph_tree")[0]:null,data.hasStates?$("#scivi_cgraph_calc")[0]:null,loc);if(data.hasStates){var h=(data.stateLines.length*50+16)/graphContainer.height()*100;Split(["#scivi_cgraph_a1","#scivi_cgraph_a2"],{gutterSize:8,cursor:"row-resize",direction:"vertical",sizes:[100-h,h],minSize:[100,0],onDrag:function(){renderer.reshape()}})}var graphSplit=Split(["#scivi_cgraph_a","#scivi_cgraph_b"],{gutterSize:8,cursor:"col-resize",minSize:[100,0],onDrag:function(){renderer.reshape()}});if(graphContainer.width()<=graphContainer.height())graphSplit.collapse(1);$("#scivi_cgraph_tabs").tabs({heightStyle:"fill"});colors=colors||[43520,170,43690,15079755,3978315,33480,9510580,4649200,15741670,13825340,16432830,32896,15122175,11169320,16775880,8388608,11206595,8421376,16767153,128,8421504,16711680,65280,255,16711935,16776960,65535];renderer.setInput(data,colors);renderer.setColorPicker(ColorPicker);renderer.addModularityFilter(Louvain);if(classifier){renderer.scaleLevels=classifier.generateScaleLevels();renderer.classifier=classifier}else{renderer.scaleLevels=scales}renderer.sortNodesByRingScale(true);renderer.run();this.renderer=renderer;this.graphContainer=graphContainer;this.graphSplit=graphSplit;return renderer}},{"../../build/scivi-cgraph.js":1,"../../filters/louvain/src/louvain.js":2,"chart.js":4,jquery:70,"jquery-contextmenu":64,"jquery-ui/ui/core":65,"jquery-ui/ui/mouse":66,"jquery-ui/ui/slider":67,"jquery-ui/ui/tabs":68,"jquery-ui/ui/widget":69,"pixi.js":211,"split.js":258,"vanilla-picker":261}]},{},[262])(262)});